(self.webpackChunk=self.webpackChunk||[]).push([[6358],{9363:(e,t,r)=>{r.d(t,{T5:()=>I,YX:()=>u,a9:()=>F,v0:()=>_,yn:()=>b});var n=r(62482),s=r(24961),i=r(36661),a=(0,i.S)((function(e){return(0,s.wf)(o(e),e.struct({}))(e)})),o=(0,i.S)((function(e){return e.struct({id:e.number,agentId:e.string,correlationId:e.string})})),u=(0,i.S)((function(e){return(0,s.wf)(o(e),e.struct({}))(e)})),l=((0,i.S)((function(e){return _(e)})),(0,i.S)((function(e){var t;return e.sum("kind")(((t={}).sensitivity=d(e),t.badRequest=c(e),t.serviceLimitExceeded=f(e),t.unsupportedLanguage=p(e),t.updateClient=g(e),t.backendError=m(e),t.other=h(e),t))}))),d=(0,i.S)((function(e){return e.struct({kind:e.literal("sensitivity")})})),c=(0,i.S)((function(e){return e.intersect(e.partial({errorCode:e.number}))(e.struct({kind:e.literal("badRequest")}))})),f=(0,i.S)((function(e){return e.struct({kind:e.literal("serviceLimitExceeded")})})),p=(0,i.S)((function(e){return e.struct({kind:e.literal("unsupportedLanguage")})})),g=(0,i.S)((function(e){return e.struct({kind:e.literal("updateClient")})})),m=(0,i.S)((function(e){return e.struct({kind:e.literal("backendError")})})),h=(0,i.S)((function(e){return e.struct({kind:e.literal("other"),type:e.string})})),_=(0,i.S)((function(e){var t;return e.sum("action")(((t={})["agent_generic:request"]=v(e),t["agent_generic:response"]=I(e),t["agent_generic:feedbackRequest"]=S(e),t["agent_generic:feedbackResponse"]=b(e),t["agent_generic:error"]=F(e),t))})),v=(0,i.S)((function(e){return(0,s.wf)(a(e),o(e),e.struct({action:e.literal("agent_generic:request"),commandId:e.string,payload:e.string}))(e)})),I=(0,i.S)((function(e){return(0,s.wf)(o(e),u(e),e.struct({action:e.literal("agent_generic:response"),payload:e.string,kind:P(e)}))(e)})),S=(0,i.S)((function(e){return(0,s.wf)(a(e),o(e),e.struct({action:e.literal("agent_generic:feedbackRequest"),eventName:e.string,eventData:e.string}))(e)})),b=(0,i.S)((function(e){return(0,s.wf)(o(e),u(e),e.struct({action:e.literal("agent_generic:feedbackResponse"),errorMessage:e.string,result:w(e)}))(e)})),F=(0,i.S)((function(e){return(0,s.wf)(o(e),u(e),e.struct({action:e.literal("agent_generic:error"),errorType:l(e),title:e.string,details:e.string}))(e)})),w=(0,s.Dd)(n.e),P=(0,s.Dd)(n.P);(0,i.S)((function(e){var t;return e.sum("action")(((t={})["agent_generic:request"]=v(e),t["agent_generic:feedbackRequest"]=S(e),t))})),(0,i.S)((function(e){var t;return e.sum("action")(((t={})["agent_generic:request"]=v(e),t["agent_generic:response"]=I(e),t["agent_generic:feedbackRequest"]=S(e),t["agent_generic:feedbackResponse"]=b(e),t["agent_generic:error"]=F(e),t))})),(0,i.S)((function(e){var t;return e.sum("action")(((t={})["agent_generic:response"]=I(e),t["agent_generic:feedbackResponse"]=b(e),t["agent_generic:error"]=F(e),t))}))},62482:(e,t,r)=>{var n,s;r.d(t,{P:()=>s,e:()=>n}),function(e){e.Success="success",e.FailedValidation="failed_validation",e.Error="error"}(n||(n={})),function(e){e.Final="final",e.Partial="partial"}(s||(s={}))},92649:(e,t,r)=>{r.d(t,{g:()=>n,u:()=>i});var n=(e=>(e.Forbidden="Forbidden: User not assigned to feature",e.Unauthorized="Unauthorized: User not assigned to feature",e.UnprocessableContent="Document did not pass pre-filtering",e.Sensitivity="Document did not pass sensitivity filtering",e.InternalServerError="Internal server error",e.ServiceLimitExceeded="Service limit exceeded",e.UnsupportedLanguage="Unsupported language",e.UpdateClient="Client has to be updated to process the result of the requested action",e.Other="Other error",e.NothingToImprove="Nothing to improve",e))(n||{});const s=class e extends Error{constructor(e,t){super(`[${e}] ${t}`),this.kind=e}static fromMessageError(t){return new e(e.getKind(t),t.title)}};s.getKind=e=>{switch(e.errorType.kind){case"sensitivity":return"Document did not pass sensitivity filtering";case"serviceLimitExceeded":return"Service limit exceeded";case"unsupportedLanguage":return"Unsupported language";case"updateClient":return"Client has to be updated to process the result of the requested action";case"backendError":return"Internal server error";case"badRequest":switch(e.errorType.errorCode){case 403:return"Forbidden: User not assigned to feature";case 401:return"Unauthorized: User not assigned to feature";case 422:return"Document did not pass pre-filtering";default:return"Internal server error"}default:return"Other error"}};let i=s},11851:(e,t,r)=>{r.d(t,{W:()=>n});var n,s=r(17479),i=r(25453),a=r(55341),o=r(64443),u=r(92054),l=r(11393),d=r(12518),c=r(90023),f=r(67177),p=r(92649),g=r(62482),m=Object.defineProperty,h=Object.defineProperties,_=Object.getOwnPropertyDescriptors,v=Object.getOwnPropertySymbols,I=Object.prototype.hasOwnProperty,S=Object.prototype.propertyIsEnumerable,b=(e,t,r)=>t in e?m(e,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):e[t]=r,F=(e,t)=>{for(var r in t||(t={}))I.call(t,r)&&b(e,r,t[r]);if(v)for(var r of v(t))S.call(t,r)&&b(e,r,t[r]);return e},w=(e,t)=>h(e,_(t));(n||(n={})).create=e=>{const t=o.C8.Logging.getLogger("AgentGenericService"),r=new l.PJ(6e4,"AgentGeneric"),n=new l.PJ(5e3,"AgentGenericFeedback"),m=new Map,h=e=>e.action.startsWith("agent_generic")?(((0,s._j)(e)||(0,s.OK)(e))&&(e=>{const i=m.get(e.correlationId);i?(0,s._j)(e)?(t.debug("Received streamed response",e),i.next(d.F2(e)),"final"===e.kind&&(i.complete(),m.delete(e.correlationId))):(0,s.OK)(e)&&(t.debug("Received streamed error",e),i.next(d.t$(p.u.fromMessageError(e))),i.complete(),m.delete(e.correlationId)):((0,s._j)(e)&&"final"===e.kind&&(t.debug("Received message",e),r.onValue(e.correlationId,e)),(0,s.OK)(e)&&(t.debug("Received error",e),r.onError(e.correlationId,p.u.fromMessageError(e))),(0,s.wP)(e)&&(t.debug("Received feedback response",e),e.result===g.e.Success?n.onValue(e.correlationId,e):n.onError(e.correlationId,{name:e.result,message:e.errorMessage})))})(e),i._.Result.STOP_HANDLING):i._.Result.CONTINUE_HANDLING;return e.registerExternalMessageHandler(h),{request:(n,s)=>((n,s)=>{t.debug("Sending message",n);const i=(0,u.Z)();return(0,c.zG)(e.enqueueExternalCommand((({id:e})=>F({id:e,correlationId:i},n))),f.tS((()=>()=>r.watchRequest(i,null==s?void 0:s.timeout))))})(w(F({},n),{action:"agent_generic:request"}),s),requestWithStreaming:r=>(r=>{t.debug("Sending message with streaming",r);const n=(0,u.Z)(),s=new a.t;return m.set(n,s),(0,c.zG)(e.enqueueExternalCommand((({id:e})=>F({id:e,correlationId:n},r))),f.UI((()=>s)))})(w(F({},r),{action:"agent_generic:request"})),sendFeedback:r=>((r,s)=>{t.debug("Sending feedback message",r);const i=(0,u.Z)();return(0,c.zG)(e.enqueueExternalCommand((({id:e})=>F({id:e,correlationId:i},r))),f.tS((()=>()=>n.watchRequest(i,null==s?void 0:s.timeout))))})(w(F({},r),{action:"agent_generic:feedbackRequest"})),dispose:()=>{e.unregisterExternalMessageHandler(h)}}}},17479:(e,t,r)=>{r.d(t,{OK:()=>o,_j:()=>a,rE:()=>u,wP:()=>l});var n=r(6824),s=r(36661),i=r(9363);const a=s.n(n.Schemable)(i.T5).is,o=s.n(n.Schemable)(i.a9).is,u=s.n(n.Schemable)(i.YX).is,l=(s.n(n.Schemable)(i.v0).is,s.n(n.Schemable)(i.yn).is)},10556:(e,t,r)=>{r.d(t,{D8:()=>s.D,TJ:()=>s.T,kX:()=>n.k});var n=r(16386),s=r(24071)},29594:(e,t,r)=>{r.d(t,{Js:()=>w,Ob:()=>q,QD:()=>R,ZF:()=>I,a9:()=>k,iN:()=>v,k3:()=>U,rt:()=>P,v0:()=>_});var n=r(9119),s=r(24961),i=r(36661),a=(0,i.S)((function(e){return(0,s.wf)(o(e),e.struct({}))(e)})),o=(0,i.S)((function(e){return e.struct({id:e.number,fileIdentifier:e.string})})),u=(0,i.S)((function(e){return(0,s.wf)(o(e),e.struct({}))(e)})),l=((0,i.S)((function(e){return _(e)})),(0,i.S)((function(e){var t;return e.sum("kind")(((t={}).sensitivity=d(e),t.unsupportedLanguage=c(e),t.failedProcessing=f(e),t.checksumMismatch=p(e),t.unsupportedFileFormat=g(e),t.other=m(e),t))}))),d=(0,i.S)((function(e){return e.struct({kind:e.literal("sensitivity")})})),c=(0,i.S)((function(e){return e.struct({kind:e.literal("unsupportedLanguage")})})),f=(0,i.S)((function(e){return e.struct({kind:e.literal("failedProcessing")})})),p=(0,i.S)((function(e){return e.struct({kind:e.literal("checksumMismatch")})})),g=(0,i.S)((function(e){return e.struct({kind:e.literal("unsupportedFileFormat")})})),m=(0,i.S)((function(e){return e.struct({kind:e.literal("other"),type:e.string})})),h=(0,s.Dd)(n.d),_=(0,i.S)((function(e){var t;return e.sum("action")(((t={})["assistant_file_upload:uploadUrlRequest"]=v(e),t["assistant_file_upload:uploadUrlResponse"]=I(e),t["assistant_file_upload:processFile"]=w(e),t["assistant_file_upload:success"]=P(e),t["assistant_file_upload:error"]=k(e),t["assistant_file_upload:removePersistedData"]=R(e),t["assistant_file_upload:removeFile"]=q(e),t["assistant_file_upload:fileRemoved"]=U(e),t))})),v=(0,i.S)((function(e){return(0,s.wf)(a(e),o(e),e.struct({action:e.literal("assistant_file_upload:uploadUrlRequest")}))(e)})),I=(0,i.S)((function(e){return(0,s.wf)(o(e),u(e),e.struct({action:e.literal("assistant_file_upload:uploadUrlResponse"),s3UploadPath:e.string}))(e)})),S=(0,i.S)((function(e){var t;return e.sum("kind")(((t={}).customTone=b(e),t.customAudience=F(e),t))})),b=(0,i.S)((function(e){return e.struct({kind:e.literal("customTone"),name:e.string})})),F=(0,i.S)((function(e){return e.struct({kind:e.literal("customAudience"),name:e.string})})),w=(0,i.S)((function(e){return(0,s.wf)(a(e),o(e),e.intersect(e.partial({useCaseParameters:S(e)}))(e.struct({action:e.literal("assistant_file_upload:processFile"),fileFormat:h(e),useCase:y(e)})))(e)})),P=(0,i.S)((function(e){return(0,s.wf)(o(e),u(e),e.struct({action:e.literal("assistant_file_upload:success"),fileFormat:h(e),fileContent:e.string}))(e)})),k=(0,i.S)((function(e){return(0,s.wf)(o(e),u(e),e.struct({action:e.literal("assistant_file_upload:error"),errorType:l(e),title:e.string}))(e)})),C=(0,i.S)((function(e){var t;return e.sum("kind")(((t={}).customTone=b(e),t.customAudience=F(e),t))})),R=(0,i.S)((function(e){return(0,s.wf)(a(e),o(e),e.intersect(e.partial({useCaseParameters:C(e)}))(e.struct({action:e.literal("assistant_file_upload:removePersistedData"),useCase:y(e)})))(e)})),q=(0,i.S)((function(e){return(0,s.wf)(a(e),o(e),e.struct({action:e.literal("assistant_file_upload:removeFile")}))(e)})),U=(0,i.S)((function(e){return(0,s.wf)(o(e),u(e),e.struct({action:e.literal("assistant_file_upload:fileRemoved")}))(e)})),y=(0,s.Dd)(n._);(0,i.S)((function(e){return e.struct({supportedFileFormats:e.readonly(e.array(h(e))),maxFileSize:e.number})})),(0,i.S)((function(e){var t;return e.sum("action")(((t={})["assistant_file_upload:uploadUrlRequest"]=v(e),t["assistant_file_upload:processFile"]=w(e),t["assistant_file_upload:removePersistedData"]=R(e),t["assistant_file_upload:removeFile"]=q(e),t))})),(0,i.S)((function(e){var t;return e.sum("action")(((t={})["assistant_file_upload:uploadUrlRequest"]=v(e),t["assistant_file_upload:uploadUrlResponse"]=I(e),t["assistant_file_upload:processFile"]=w(e),t["assistant_file_upload:success"]=P(e),t["assistant_file_upload:error"]=k(e),t["assistant_file_upload:removePersistedData"]=R(e),t["assistant_file_upload:removeFile"]=q(e),t["assistant_file_upload:fileRemoved"]=U(e),t))})),(0,i.S)((function(e){var t;return e.sum("action")(((t={})["assistant_file_upload:uploadUrlResponse"]=I(e),t["assistant_file_upload:success"]=P(e),t["assistant_file_upload:error"]=k(e),t["assistant_file_upload:fileRemoved"]=U(e),t))}))},9119:(e,t,r)=>{var n,s;r.d(t,{_:()=>s,d:()=>n}),function(e){e.Txt="txt",e.Rtf="rtf",e.Doc="doc",e.Docx="docx",e.Pdf="pdf",e.Md="md",e.Json="json",e.Xml="xml",e.Html="html",e.Htm="htm",e.Csv="csv",e.Xls="xls",e.Xlsx="xlsx",e.Ppt="ppt",e.Pptx="pptx"}(n||(n={})),function(e){e.Assistant="assistant",e.CustomTone="customTone",e.CustomAudience="customAudience",e.AiGraderRubrics="aiGraderRubrics"}(s||(s={}))},62404:(e,t,r)=>{r.d(t,{D:()=>a,k:()=>s});var n=r(28338),s=(e=>(e.Sensitivity="Document did not pass sensitivity filtering",e.UnsupportedLanguage="Unsupported language",e.FailedProcessing="Failed to process file",e.ChecksumMismatch="Checksum mismatch",e.UnsupportedFileFormat="Unsupported file format",e.Other="Other error",e))(s||{});const i=class e extends Error{constructor(e,t){super(`[${e}] ${t}`),this.kind=e}static fromMessageError(t){return new e(e.getKind(t),t.title)}};i.getKind=e=>{const{kind:t}=e.errorType;switch(t){case"sensitivity":return"Document did not pass sensitivity filtering";case"unsupportedLanguage":return"Unsupported language";case"failedProcessing":return"Failed to process file";case"checksumMismatch":return"Checksum mismatch";case"unsupportedFileFormat":return"Unsupported file format";case"other":return"Other error";default:(0,n.vE)(t)}};let a=i},15782:(e,t,r)=>{r.d(t,{J:()=>g});var n=r(64443),s=r(25453),i=r(90023),a=r(67177),o=r(92054),u=r(11393),l=r(11972),d=r(62404),c=r(76707),f=r(12518),p=r(9119);var g,m=Object.defineProperty,h=Object.defineProperties,_=Object.getOwnPropertyDescriptors,v=Object.getOwnPropertySymbols,I=Object.prototype.hasOwnProperty,S=Object.prototype.propertyIsEnumerable,b=(e,t,r)=>t in e?m(e,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):e[t]=r,F=(e,t,r)=>new Promise(((n,s)=>{var i=e=>{try{o(r.next(e))}catch(e){s(e)}},a=e=>{try{o(r.throw(e))}catch(e){s(e)}},o=e=>e.done?n(e.value):Promise.resolve(e.value).then(i,a);o((r=r.apply(e,t)).next())}));(g||(g={})).create=(e,t)=>{const r=t||n.C8.Logging.getLogger("FileUploadService"),g=new l.v,m=new u.PJ(6e4,"FileUpload"),w=new u.PJ(6e4,"FileUpload"),P=new u.PJ(6e4,"FileUpload"),k=new u.PJ(6e4,"FileUpload"),C=t=>(r.debug("Sending message",t),(0,i.zG)(e.enqueueExternalCommand((({id:e})=>((e,t)=>h(e,_(t)))(((e,t)=>{for(var r in t||(t={}))I.call(t,r)&&b(e,r,t[r]);if(v)for(var r of v(t))S.call(t,r)&&b(e,r,t[r]);return e})({},t),{id:e}))),a.tS((()=>(0,c.WT)(t)?()=>m.watchRequest(t.fileIdentifier):(0,c.Xl)(t)?()=>w.watchRequest(t.fileIdentifier):(0,c.gs)(t)?()=>P.watchRequest(t.fileIdentifier):(0,c.Iz)(t)?()=>k.watchRequest(t.fileIdentifier):a.t$(new d.D(d.k.Other,"Unknown message type (sendMessage)")))))),R=e=>e.action.startsWith("assistant_file_upload")?((0,c.r2)(e)||(0,c.wV)(e)||(0,c.bm)(e)||(0,c.Sy)(e)?(e=>{if((0,c.bm)(e))return r.debug("Received message (MessageUploadUrlResponse)",e),void m.onValue(e.fileIdentifier,e);if((0,c.r2)(e))return r.debug("Received message (MessageSuccess)",e),void w.onValue(e.fileIdentifier,e);if((0,c.Sy)(e))return r.debug("Received message (MessageFileRemoved)",e),P.hasRequest(e.fileIdentifier)&&P.onValue(e.fileIdentifier,e),void(k.hasRequest(e.fileIdentifier)&&k.onValue(e.fileIdentifier,e));if((0,c.wV)(e)){r.debug("Received error (MessageError)",e);const t=d.D.fromMessageError(e);m.hasRequest(e.fileIdentifier)?m.onError(e.fileIdentifier,t):w.hasRequest(e.fileIdentifier)?w.onError(e.fileIdentifier,t):P.hasRequest(e.fileIdentifier)?P.onError(e.fileIdentifier,t):k.hasRequest(e.fileIdentifier)&&k.onError(e.fileIdentifier,t)}})(e):r.warn("Unknown message type (handler)",e),s._.Result.STOP_HANDLING):s._.Result.CONTINUE_HANDLING;e.registerExternalMessageHandler(R);const q=e=>(r.debug("Getting file upload URL",{fileIdentifier:e}),(0,i.zG)(C({id:0,action:"assistant_file_upload:uploadUrlRequest",fileIdentifier:e}),a.tS((e=>(0,c.bm)(e)?a.F2(e.s3UploadPath):a.t$(new d.D(d.k.Other,"Unknown message type (getFileUploadUrl)")))),a.UI((t=>(r.debug("Successfully received s3UploadPath",{fileIdentifier:e,s3UploadPath:t}),t))),a.Vn((t=>(r.error("Failed to get upload URL",{fileIdentifier:e,error:t}),t))))),U=e=>{const{fileIdentifier:t,uploadUrl:n,file:s}=e;return r.debug("Uploading file",{fileIdentifier:t,uploadUrl:n}),(0,i.zG)(a.Uo(function(e){switch(e.type){case"text/plain":return f.F2(p.d.Txt);case"text/rtf":case"application/rtf":return f.F2(p.d.Rtf);case"application/msword":return f.F2(p.d.Doc);case"application/vnd.openxmlformats-officedocument.wordprocessingml.document":return f.F2(p.d.Docx);case"application/pdf":case"application/x-pdf":case"application/x-bzpdf":case"application/x-gzpdf":return f.F2(p.d.Pdf);case"text/markdown":return f.F2(p.d.Md);case"application/json":return f.F2(p.d.Json);case"application/xml":case"text/xml":return f.F2(p.d.Xml);case"text/html":return e.name.endsWith(".htm")?f.F2(p.d.Htm):f.F2(p.d.Html);case"text/csv":return f.F2(p.d.Csv);case"application/vnd.ms-excel":return f.F2(p.d.Xls);case"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet":return f.F2(p.d.Xlsx);case"application/vnd.ms-powerpoint":return f.F2(p.d.Ppt);case"application/vnd.openxmlformats-officedocument.presentationml.presentation":return f.F2(p.d.Pptx);default:return f.t$(new d.D(d.k.UnsupportedFileFormat,"Unsupported file format"))}}(s)),a.tS((e=>a.Y3((()=>F(void 0,null,(function*(){const r=yield fetch(n,{method:"PUT",headers:{"Content-Type":s.type,"x-amz-tagging":"ttl=1day"},body:s});if(!r.ok)throw new Error(`S3 upload failed: ${r.status} ${r.statusText}`);return{fileIdentifier:t,fileFormat:e}}))),(e=>{const t=e instanceof Error?e:new Error(String(e));return new d.D(d.k.FailedProcessing,t.message)})))))};return{uploadText:e=>{const{content:t,useCase:n,useCaseParameters:s,agentId:u}=e,l=(0,o.Z)();return r.debug("Uploading text",{useCase:n,useCaseParameters:s,fileIdentifier:l,agentId:u}),g.emit("uploadTextStarted",{useCase:n,useCaseParameters:s,fileIdentifier:l,agentId:u}),(0,i.zG)(q(l),a.tS((e=>(e=>{const{fileIdentifier:t,uploadUrl:n,content:s}=e;return r.debug("Uploading references",{fileIdentifier:t,uploadUrl:n}),a.Y3((()=>F(void 0,null,(function*(){const e=yield fetch(n,{method:"PUT",headers:{"Content-Type":"text/plain","x-amz-tagging":"ttl=1day"},body:s});if(!e.ok)throw new Error(`S3 upload failed: ${e.status} ${e.statusText}`);return{fileIdentifier:t,fileFormat:p.d.Txt}}))),(e=>{const t=e instanceof Error?e:new Error(String(e));return new d.D(d.k.FailedProcessing,t.message)}))})({fileIdentifier:l,uploadUrl:e,content:t}))),a.tS((e=>((e,t,n,s,o)=>{r.debug("Requesting file processing",{fileIdentifier:e,fileFormat:t});const u={id:0,action:"assistant_file_upload:processFile",fileIdentifier:e,fileFormat:t,useCase:n,useCaseParameters:s};return r.debug("useCaseParameters",s),r.debug("Requesting file processing",{request:u}),(0,i.zG)(C(u),a.tS((r=>(0,c.r2)(r)?a.F2({useCase:n,useCaseParameters:s,fileIdentifier:e,fileFormat:t,agentId:o||"unknown"}):a.t$(new d.D(d.k.Other,"Unknown message type (requestFileProcessing)")))),a.Vn((t=>(r.error("Failed to process file",{fileIdentifier:e,error:t}),t))))})(e.fileIdentifier,e.fileFormat,n,s,u))),a.Vn((e=>(g.emit("uploadTextFailed",{useCase:n,useCaseParameters:s,fileIdentifier:l,error:e,agentId:u}),e))),a.UI((e=>(g.emit("uploadTextFinished",e),e))))},uploadFile:e=>{const{file:t,useCase:n,useCaseParameters:s,agentId:u}=e,l=(0,o.Z)();return r.debug("Uploading file",{useCase:n,useCaseParameters:s,fileIdentifier:l,agentId:u}),g.emit("uploadFileStarted",{useCase:n,useCaseParameters:s,fileIdentifier:l,fileName:t.name,agentId:u}),(0,i.zG)(q(l),a.tS((e=>U({fileIdentifier:l,uploadUrl:e,file:t}))),a.tS((e=>((e,t,n,s,o)=>{r.debug("Requesting file processing",{fileIdentifier:e,fileFormat:t});const u={id:0,action:"assistant_file_upload:processFile",fileIdentifier:e,fileFormat:t,useCase:n,useCaseParameters:s};return r.debug("useCaseParameters",s),r.debug("Requesting file processing",{request:u}),(0,i.zG)(C(u),a.tS((r=>(0,c.r2)(r)?a.F2({useCase:n,useCaseParameters:s,fileIdentifier:e,fileFormat:t,fileContent:r.fileContent,agentId:o||"unknown"}):a.t$(new d.D(d.k.Other,"Unknown message type (requestFileProcessing)")))),a.Vn((t=>(r.error("Failed to process file",{fileIdentifier:e,error:t}),t))))})(e.fileIdentifier,e.fileFormat,n,s,u))),a.Vn((e=>(g.emit("uploadFileFailed",{useCase:n,useCaseParameters:s,fileIdentifier:l,fileName:t.name,error:e,agentId:u}),e))),a.UI((e=>(g.emit("uploadFileFinished",e),e))))},removeFile:e=>{const{fileIdentifier:t,agentId:n}=e;return r.debug("Removing file",{fileIdentifier:t,agentId:n}),g.emit("removeFileStarted",{fileIdentifier:t,agentId:n}),(0,i.zG)((e=>{r.debug("Requesting file removal",{fileIdentifier:e});const t={id:0,action:"assistant_file_upload:removeFile",fileIdentifier:e};return r.debug("Requesting file removal",{request:t}),(0,i.zG)(C(t),a.tS((e=>(0,c.Sy)(e)?a.F2(void 0):a.t$(new d.D(d.k.Other,"Unknown message type (requestFileRemoval)")))),a.Vn((t=>(r.error("Failed to process file",{fileIdentifier:e,error:t}),t))))})(t),a.Vn((e=>(g.emit("removeFileFailed",{fileIdentifier:t,error:e,agentId:n}),e))),a.UI((e=>(g.emit("removeFileFinished",{fileIdentifier:t,agentId:n}),e))))},removePersistentData:e=>{const{useCase:t,useCaseParameters:n,agentId:s}=e,u=(0,o.Z)();return r.debug("Removing persistent data",{useCase:t,useCaseParameters:n,fileIdentifier:u,agentId:s}),g.emit("removePersistentDataStarted",{useCase:t,useCaseParameters:n,fileIdentifier:u,agentId:s}),(0,i.zG)(C({id:0,action:"assistant_file_upload:removePersistedData",fileIdentifier:u,useCase:t,useCaseParameters:n}),a.tS((e=>(0,c.Sy)(e)?a.F2({useCase:t,useCaseParameters:n,fileIdentifier:u,agentId:s}):a.t$(new d.D(d.k.Other,"Unknown message type (removePersistentData)")))),a.Vn((e=>(r.error("Failed to remove the persistent data",{fileIdentifier:u,error:e}),g.emit("removePersistentDataFailed",{useCase:t,useCaseParameters:n,fileIdentifier:u,error:e,agentId:s}),e))),a.UI((e=>(g.emit("removePersistentDataFinished",e),e))))},on:g.on.bind(g),dispose:()=>{e.unregisterExternalMessageHandler(R)}}}},76707:(e,t,r)=>{r.d(t,{Iz:()=>p,Sy:()=>f,WT:()=>l,Xl:()=>a,bm:()=>d,eJ:()=>g,gs:()=>c,r2:()=>o,wV:()=>u});var n=r(6824),s=r(36661),i=r(29594);const a=s.n(n.Schemable)(i.Js).is,o=s.n(n.Schemable)(i.rt).is,u=s.n(n.Schemable)(i.a9).is,l=s.n(n.Schemable)(i.iN).is,d=s.n(n.Schemable)(i.ZF).is,c=s.n(n.Schemable)(i.Ob).is,f=s.n(n.Schemable)(i.k3).is,p=s.n(n.Schemable)(i.QD).is,g=s.n(n.Schemable)(i.v0).is},25453:(e,t,r)=>{var n,s,i;r.d(t,{_:()=>n}),s=n||(n={}),(i=s.Result||(s.Result={}))[i.CONTINUE_HANDLING=0]="CONTINUE_HANDLING",i[i.STOP_HANDLING=1]="STOP_HANDLING"},11393:(e,t,r)=>{r.d(t,{EP:()=>o,PJ:()=>l,W5:()=>a,YG:()=>u});var n=r(12518),s=r(64443),i=r(28338);class a extends i.sH{constructor(e){super(Boolean(e)?e:"Timeout"),this.name="TimeoutError"}static isTimeoutError(e){return e instanceof a}}class o extends i.sH{constructor(e){super(Boolean(e)?e:"Dropped"),this.name="DroppedError"}static isDroppedError(e){return e instanceof o}}class u extends i.sH{constructor(e){super(Boolean(e)?e:"Not Connected to WS"),this.name="NotConnectedError"}static isNotConnectedError(e){return e instanceof u}}class l{constructor(e=5e3,t="",r=new a){this._timeout=e,this.name=t,this._timeoutError=r,this._requests=new Map,this._log=s.C8.Logging.getLogger("coreclients.valueRequester"+(t.length>0?"."+t:""))}watchRequest(e,t=this._timeout){return this._startRequestWatch(e,t)}hasRequest(e){return this._requests.has(e)}onValue(e,t){this._stopRequest(e,n.F2(t))}onError(e,t){this._log.trace(`onError:(${e})`),this._stopRequest(e,n.t$(t))}clear(e){this._log.trace("clearing request watches: "+e),this._requests.forEach(((t,r)=>{this.onError(r,new o(`command (${this.name}) can not be executed, reason: ${e}`))}))}_startRequestWatch(e,t){this._log.debug(`Starting request watch: ${e}`),(0,i.kG)(!this._requests.has(e),"must not start watch for same request twice, request already watched: "+e);const r={};return r.promise=new Promise((e=>{r.resolve=e})),r.timer=self.setTimeout((()=>this._stopRequest(e,n.t$(this._timeoutError))),t),this._requests.set(e,r),r.promise}_stopRequest(e,t){this._log.trace(`_stopRequest: stopping request watch: ${e}`,t);const r=this._requests.get(e);void 0===r?this._log.warn("Got result for unknown request or request has already expired.",{id:e,result:t}):(clearTimeout(r.timer),r.resolve(t),this._requests.delete(e))}}},11972:(e,t,r)=>{r.d(t,{v:()=>n});class n{listeners=new Map;on(e,t){return this._getOrInitializeListeners(e).add(t),{dispose:()=>{this.listeners.get(e)?.delete(t)}}}emit(e,t){const r=this.listeners.get(e);if(r)for(const n of r)try{n(t)}catch(t){console.error(`Error in event listener for event "${String(e)}":`,t)}}_getOrInitializeListeners(e){return this.listeners.has(e)||this.listeners.set(e,new Set),this.listeners.get(e)}}}}]);
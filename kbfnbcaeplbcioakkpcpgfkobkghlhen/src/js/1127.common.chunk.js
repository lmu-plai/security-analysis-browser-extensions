(self.webpackChunk=self.webpackChunk||[]).push([[1127],{31127:(e,t,s)=>{s.r(t),s.d(t,{activate:()=>C});var n=s(90023),a=s(32073),i=s(59179),r=s(78129),c=s(84308),o=s(84714),d=s(90572),u=s(29416),p=s(63532),l=s(20161),b=s(28338),v=s(77115),h=s(85936),S=s(80661),f=s(84848),k=s(84197),g=s(96632),w=s(56544),A=(e,t)=>(t=Symbol[e])?t:Symbol.for("Symbol."+e),y=e=>{throw TypeError(e)};const C=e=>{return t=void 0,s=[e],C=function*({bus:e,capiConnectionStatus:t,agentGenericService:s,pushedContentService:C,experimentation:x,document:m,navigation:I,fileUploadService:E,trackingServiceProvider:P}){var R=[];try{const K=((e,t,s)=>{var n;return null!=t?("object"!=typeof t&&"function"!=typeof t&&y("Object expected"),s&&(n=t[A("asyncDispose")]),void 0===n&&(n=t[A("dispose")]),"function"!=typeof n&&y("Object not disposable"),e.push([s,n,t])):s&&e.push([s]),t})(R,new DisposableStack),T=K.adopt(new a.w0,(e=>e.unsubscribe())),_=K.use(e.state.agentState.create(m.id,{kind:h.x.State.Kind.Initial})),j=K.use(e.state.audience.create(m.id,null)),D=K.use(e.state.capiSessionId.create(m.id,null)),G=K.use(e.state.textInfo.create(m.id,{wordsCount:0,charsCount:0})),B=K.use(e.state.hasTextChanges.create(m.id,!1)),M=G.pipe(i.U((e=>e.charsCount)),r.G(),i.U((([e,t])=>t-e))),Z=x.isAssigned(k.cV)?c.a([M,I.isPanelOpen],((e,t)=>t&&Math.abs(e)>w.tK)):o.of(!1),z=S.z.create({agentGenericService:s,pushedContentService:C,fileUploadService:E,agentId:f.Qi.Id}),F=K.adopt(h.x.create({capiSessionId:D.view((e=>null!=e?e:void 0)),agenticService:z,trackingServiceProvider:P,textInfo:G,textChanged:Z,featureFlags:{customAudiences:x.isAssigned(k.bI)}}),(e=>e.dispose())),L=t.pipe(i.U((e=>"connected"===e.kind?e:null)),d.h(v.C_));return T.add(F.state.subscribe((e=>_.set(e)))),T.add(F.audience.subscribe((e=>j.set(null!=e?e:null)))),T.add(L.subscribe((e=>D.set(e.sessionId)))),T.add(m.textInfo.pipe(d.h(v.C_)).subscribe((e=>G.set({wordsCount:e.wordCount,charsCount:e.charCount})))),T.add(F.hasTextChanges.subscribe((e=>B.set(e)))),T.add(e.events.trackingEvent.view(m.id).subscribe((e=>F.context.tracking.trackEvent(e.event,e.detail)))),x.isAssigned(k.l0)&&T.add(C.rebaseItems(g.Z).subscribe()),T.add(c.a([G,F.state,I.isPanelOpen],((e,t,s)=>s&&t.kind===h.x.State.Kind.Empty&&e.wordsCount>h.x.MIN_WORDS_TEXT_SIZE)).pipe(d.h(n.yR),u.b(100),d.h((()=>F.state.get().kind===h.x.State.Kind.Empty)),p.b((()=>F.loadReactions()))).subscribe()),T.add(L.pipe(l.w((e=>c.a([F.state,I.isPanelOpen],((e,t)=>t&&e.kind===h.x.State.Kind.Initial)).pipe(d.h(n.yR),u.b(100),p.b((()=>F.loadReactions())))))).subscribe()),T.add(e.events.panelUIAction.view(m.id).subscribe((e=>{switch(e.kind){case"loadReactionsAction":F.loadReactions();break;case"selectAudienceAction":F.selectAudience();break;case"setAudienceAction":F.setAudience(e.audience);break;case"editAudienceAction":F.editAudience();break;case"saveAudienceAction":F.saveAudience(e.name);break;case"goBackAction":F.goBack();break;default:(0,b.L0)(e)}}))),K.move()}catch(e){var O=e,U=!0}finally{((e,t,s)=>{var n="function"==typeof SuppressedError?SuppressedError:function(e,t,s,n){return(n=Error(s)).name="SuppressedError",n.error=e,n.suppressed=t,n},a=e=>t=s?new n(e,t,"An error was suppressed during disposal"):(s=!0,e),i=n=>{for(;n=e.pop();)try{var r=n[1]&&n[1].call(n[2]);if(n[0])return Promise.resolve(r).then(i,(e=>(a(e),i())))}catch(e){a(e)}if(s)throw t};i()})(R,O,U)}},new Promise(((e,n)=>{var a=e=>{try{r(C.next(e))}catch(e){n(e)}},i=e=>{try{r(C.throw(e))}catch(e){n(e)}},r=t=>t.done?e(t.value):Promise.resolve(t.value).then(a,i);r((C=C.apply(t,s)).next())}));var t,s,C}}}]);
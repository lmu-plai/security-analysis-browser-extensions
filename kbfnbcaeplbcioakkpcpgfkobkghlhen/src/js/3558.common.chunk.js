(self.webpackChunk=self.webpackChunk||[]).push([[3558],{73558:(e,s,t)=>{t.r(s),t.d(s,{activate:()=>E});var n=t(32073),r=t(84714),o=t(90572),i=t(28338),a=t(90023),c=t(58303),u=t(559),p=t(1491),d=t(12518),l=t(88012),b=t(18519),h=t(66878),v=t(36344);class g{constructor(e){this._agentGenericService=e,this._subs=new l.w.Keeper,this._lastPendingRequests=new Map}cancelLastPendingRequest(e){const s=this._lastPendingRequests.get(e);void 0!==s&&(s.unsubscribe(),this._lastPendingRequests.delete(e))}runRequest(e,s,t,n){return this._agentGenericService.requestWithStreaming({agentId:p.Gq,commandId:e,payload:s})().then((e=>(0,a.zG)(e,d.pF((e=>{throw e}))))).then((s=>new Promise(((r,o)=>{const i=(0,a.zG)(t,c.g_((()=>s),(e=>s.pipe(b.V(e),h.K((e=>(b.W,o(e),v.E))))))).subscribe((e=>{(0,a.zG)(e,d.KB((e=>{o(e)}),(e=>{n(e),"final"===e.kind&&r()})))}));this._subs.push(i),this._lastPendingRequests.set(e,i)}))))}dispose(){this._subs.dispose()}}var f=t(18782),w=t(1947),y=t(84197),x=(e,s)=>(s=Symbol[e])?s:Symbol.for("Symbol."+e),k=e=>{throw TypeError(e)},m=(e,s,t)=>new Promise(((n,r)=>{var o=e=>{try{a(t.next(e))}catch(e){r(e)}},i=e=>{try{a(t.throw(e))}catch(e){r(e)}},a=e=>e.done?n(e.value):Promise.resolve(e.value).then(o,i);a((t=t.apply(e,s)).next())}));const E=e=>m(void 0,[e],(function*({bus:e,document:s,agentGenericService:t,pushedContentService:d,capiEvents:l,experimentation:b,navigation:h,sessionChecksState:v,trackingServiceProvider:E}){var A=[];try{const I=((e,s,t)=>{var n;return null!=s?("object"!=typeof s&&"function"!=typeof s&&k("Object expected"),t&&(n=s[x("asyncDispose")]),void 0===n&&(n=s[x("dispose")]),"function"!=typeof n&&k("Object not disposable"),e.push([t,n,s])):t&&e.push([t]),s})(A,new DisposableStack),P=I.adopt(new n.w0,(e=>e.unsubscribe())),U=I.use(e.state.agentState.create(s.id,w.b6)),R=I.use(e.state.followUpTopics.create(s.id,[])),q=I.use(e.state.capiSessionId.create(s.id,null)),_=I.use(e.state.textInfo.create(s.id,{wordsCount:0,charsCount:0})),B=new g(t),T=I.adopt(new p.XC(d,{events:l},E,B,_,{setFocusMode:a.Q1,focusModeDecorationType:r.of(c.YP),removeAgentDecorations:a.Q1},f.p,{followUpActions:b.isAssigned(y.ob),followUpActionsFreeformInput:b.isAssigned(y.sq),shouldAutoScrollToFirstVBar:b.isAssigned(y.aR),usePushedContentRebasing:b.isAssigned(y.yK)},h.isPanelOpen,h.isPanelOpen),(e=>e[Symbol.dispose]()));return P.add(T.state.subscribe((e=>U.set(e)))),P.add(T.followUpTopics.subscribe((e=>{R.set(e)}))),P.add(l.pipe(o.h(u.hX.is("session_started"))).subscribe((e=>q.set(e.sessionUuid)))),P.add(v.textInfo.subscribe((e=>(0,a.zG)(e,c.UI((e=>({wordsCount:e.wordsCount,charsCount:e.charsCount}))),c.fS((()=>({wordsCount:0,charsCount:0}))),_.set)))),P.add(e.events.trackingEvent.view(s.id).subscribe((e=>T.context.tracking.trackEvent(e.event,e.detail)))),P.add(e.events.panelUIAction.view(s.id).subscribe((t=>m(void 0,null,(function*(){switch(t.kind){case"selectExpert":T.internalActions.selectExpert(t.expertName);break;case"deselectExpert":T.internalActions.deselectExpert();break;case"removeExpert":T.internalActions.removeExpert(t.expertName);break;case"goToChooseExperts":T.internalActions.goToChooseExperts();break;case"goBackFromChooseExperts":T.internalActions.goBackFromChooseExperts();break;case"reloadAgent":T.internalActions.reloadAgent();break;case"addExpertsByTopic":yield T.internalActions.addExpertsByTopic(t.topic),e.events.panelUIResponse.emit(s.id,{kind:"addExpertsByTopicResponse",topic:t.topic});break;case"addExpertsByUserInput":yield T.internalActions.addExpertsByUserInput(t.userInput),e.events.panelUIResponse.emit(s.id,{kind:"addExpertsByUserInputResponse",userInput:t.userInput});break;case"requestFollowUpSuggestions":T.internalActions.requestFollowUpSuggestions();break;default:(0,i.L0)(t)}}))))),I.move()}catch(e){var S=e,C=!0}finally{((e,s,t)=>{var n="function"==typeof SuppressedError?SuppressedError:function(e,s,t,n){return(n=Error(t)).name="SuppressedError",n.error=e,n.suppressed=s,n},r=e=>s=t?new n(e,s,"An error was suppressed during disposal"):(t=!0,e),o=n=>{for(;n=e.pop();)try{var i=n[1]&&n[1].call(n[2]);if(n[0])return Promise.resolve(i).then(o,(e=>(r(e),o())))}catch(e){r(e)}if(t)throw s};o()})(A,S,C)}}))},66878:(e,s,t)=>{t.d(s,{K:()=>i});var n=t(16537),r=t(96643),o=t(19064);function i(e){return(0,o.e)((function(s,t){var o,a=null,c=!1;a=s.subscribe((0,r.x)(t,void 0,void 0,(function(r){o=(0,n.Xf)(e(r,i(e)(s))),a?(a.unsubscribe(),a=null,o.subscribe(t)):c=!0}))),c&&(a.unsubscribe(),a=null,o.subscribe(t))}))}}}]);
(self.webpackChunk=self.webpackChunk||[]).push([[4779],{39117:(e,t,a)=>{a.d(t,{b:()=>s});var i=a(651),n=a(75362),r=a(60454);const s=({size:e})=>(0,i.jsx)(n.J,{accessibilityLabel:"Reader Reactions Agent",size:e,icon:r.Q})},9790:(e,t,a)=>{a.d(t,{n:()=>xe});var i=a(651);const n="_root_d97e6_1",r="_agentRadioGroup_d97e6_11",s="_agentTextareaContainer_d97e6_23";var c=a(92379),d=a(33986),o=a(74091),l=a(3343),u=a(12787),g=a(28338),p=a(33885),m=a(39117);const h=(0,c.createContext)(void 0);var x=(e=>(e.ComponentImpression="componentImpression",e.ComponentClicked="componentClicked",e))(x||{}),v=(e=>(e.LoadingView="agentPanel/readerReactions/loadingView",e.LoadingStreamingView="agentPanel/readerReactions/loadingStreamingView",e.LoadedView="agentPanel/readerReactions/loadedView",e.ReloadButton="agentPanel/readerReactions/reloadButton",e.AudienceSelectionButton="agentPanel/readerReactions/audienceSelectionButton",e.AudienceSelectionView="agentPanel/readerReactions/audienceSelectionView",e.RecheckButton="agentPanel/readerReactions/recheckButton",e.ErrorView="agentPanel/readerReactions/errorView",e.EmptyView="agentPanel/readerReactions/emptyView",e.AddAudienceButton="agentPanel/readerReactions/addAudienceButton",e.AudienceEditView="agentPanel/readerReactions/audienceEditView",e.SaveAudienceButton="agentPanel/readerReactions/saveAudienceButton",e.NewAudienceView="agentPanel/readerReactions/newAudienceView",e.UseNewAudienceButton="agentPanel/readerReactions/useNewAudienceButton",e.RemoveAudienceButton="agentPanel/readerReactions/removeAudienceButton",e))(v||{}),b=a(51601),k=a(84848),j=a(25258);var y=Object.defineProperty,w=Object.getOwnPropertySymbols,S=Object.prototype.hasOwnProperty,f=Object.prototype.propertyIsEnumerable,z=(e,t,a)=>t in e?y(e,t,{enumerable:!0,configurable:!0,writable:!0,value:a}):e[t]=a;const I=(0,j.j)("Tracking"),A=(e,t,a={trackImpressionOnce:!1})=>{const[i,n]=(0,c.useState)(!1),r=(()=>{var e;return null==(e=(0,c.useContext)(h))?void 0:e.tracking})(),s=(0,c.useContext)(h),d=((e,t)=>{for(var a in t||(t={}))S.call(t,a)&&z(e,a,t[a]);if(w)for(var a of w(t))f.call(t,a)&&z(e,a,t[a]);return e})({agentId:k.Qi.Id,capiSessionId:null==s?void 0:s.capiSessionId.get(),textWordsCount:null==s?void 0:s.textWordsCount.get()},t),o=(0,c.useCallback)(((e,t,s)=>{const c={componentId:e,detail:s};switch(t){case b.Jn.Impression:if(a.trackImpressionOnce&&i)return;return null==r||r.trackEvent(x.ComponentImpression,c),I.debug("Track event impression",c),void(a.trackImpressionOnce&&n(!0));case b.Jn.Clicked:return null==r||r.trackEvent(x.ComponentClicked,c),void I.debug("Track event clicked",c);default:return(0,g.vE)(t)}}),[r,a.trackImpressionOnce,i]);return(0,b.B9)({componentId:e,detail:d,trackEvent:o,autoTrackedInteractions:b.IX.Impression})};var C=a(85936),O=a(18956),_=a(54295),P=a(75362),R=a(42015),E=a(88035);const B=()=>{const e="Not enough content to review",{trackingRef:t}=A(v.EmptyView,{message:e});return(0,i.jsx)(O.x,{borderRadius:2,bgColor:"background-base-subdued",padding:3,width:"100%",ref:t,children:(0,i.jsxs)(_.k,{gap:2,children:[(0,i.jsx)(P.J,{icon:R.q,size:"large",accessibilityLabel:"Writing pen icon"}),(0,i.jsxs)(_.k,{direction:"column",children:[(0,i.jsx)(E.x,{as:"p",variant:"text-xsmall",weight:"semibold",align:"start",children:e}),(0,i.jsxs)(E.x,{as:"p",variant:"text-xsmall",align:"start",children:["Text must be a minimum of ",C.x.MIN_WORDS_TEXT_SIZE," words to receive feedback."]})]})]})})};var V=a(6837),T=a(79223);const M=e=>{const{title:t,description:a}=e.state,{trackingRef:n}=A(v.ErrorView,{message:t});return(0,i.jsxs)(_.k,{direction:"column",align:"center",justify:"center",height:"100%",ref:n,children:[(0,i.jsx)(P.J,{icon:V.F,size:"xlarge",accessibilityLabel:"Warning icon"}),(0,i.jsx)(T.X,{as:"h3",variant:"heading-xsmall",color:"base-default",align:"center",children:t}),(0,i.jsx)(E.x,{as:"p",variant:"text-small",color:"base-subdued",align:"center",children:a})]})};var L=a(91259),K=a(2240),F=a(78393),N=a(23515),G=a(89052);const U=({bgColor:e,color:t,marker:a,lineHeight:n})=>(0,i.jsx)(O.x,{width:24,height:24,borderRadius:3,bgColor:e,style:{flex:"none"},children:(0,i.jsx)(_.k,{align:"center",justify:"space-evenly",children:(0,i.jsx)(E.x,{as:"span",variant:"text-small",weight:"semibold",style:{lineHeight:n},children:(0,i.jsx)("span",{style:{color:t,verticalAlign:"middle"},children:a})})})}),D=({itemMarker:e,itemText:t})=>(0,i.jsxs)(_.k,{gap:3,children:[(0,i.jsx)(U,{bgColor:"green-20",color:G.jN,marker:e,lineHeight:"22px"}),(0,i.jsx)(E.x,{as:"p",variant:"text-small",color:"base-default",align:"start",children:t})]}),Z=({category:e,question:t})=>(0,i.jsxs)(_.k,{gap:3,children:[(0,i.jsx)(U,{bgColor:"gold-20",color:G.kE,marker:"?",lineHeight:"22px"}),(0,i.jsxs)(E.x,{as:"p",color:"base-default",align:"start",children:[(0,i.jsx)(E.x,{as:"span",variant:"text-small",weight:"bold",children:e}),(0,i.jsx)(E.x,{as:"span",variant:"text-small",children:" · "}),(0,i.jsx)(E.x,{as:"span",variant:"text-small",children:t})]})]});var H=a(692),X=Object.defineProperty,q=Object.defineProperties,$=Object.getOwnPropertyDescriptors,W=Object.getOwnPropertySymbols,J=Object.prototype.hasOwnProperty,Q=Object.prototype.propertyIsEnumerable,Y=(e,t,a)=>t in e?X(e,t,{enumerable:!0,configurable:!0,writable:!0,value:a}):e[t]=a,ee=(e,t)=>{for(var a in t||(t={}))J.call(t,a)&&Y(e,a,t[a]);if(W)for(var a of W(t))Q.call(t,a)&&Y(e,a,t[a]);return e};const te=e=>{const t=e,{iconStart:a,iconEnd:n,text:r,style:s}=t,c=((e,t)=>{var a={};for(var i in e)J.call(e,i)&&t.indexOf(i)<0&&(a[i]=e[i]);if(null!=e&&W)for(var i of W(e))t.indexOf(i)<0&&Q.call(e,i)&&(a[i]=e[i]);return a})(t,["iconStart","iconEnd","text","style"]),d=ee({borderRadius:"var(--space-3)",padding:"var(--space-3)",justifyContent:"start",height:"auto"},s);return(0,i.jsx)(H.z,((e,t)=>q(e,$(t)))(ee({variant:"secondary",width:"full",style:d},c),{children:e.children||(0,i.jsxs)(_.k,{gap:3,align:"center",width:"100%",children:[a&&(0,i.jsx)(P.J,{icon:a,size:"large",accessibilityLabel:""}),(0,i.jsx)(E.x,{as:"span",color:"base-subdued",variant:"text-small",style:{flexGrow:1},children:r}),n&&(0,i.jsx)(P.J,{icon:n,size:"small",accessibilityLabel:""})]})}))},ae=()=>(0,i.jsxs)(_.k,{direction:"row",gap:3,children:[(0,i.jsx)(L.g.Icon,{}),(0,i.jsxs)(_.k,{direction:"column",width:"90%",children:[(0,i.jsx)(L.g.Text,{variant:"text-small"}),(0,i.jsx)(L.g.Text,{variant:"text-small"}),(0,i.jsx)(L.g.Text,{variant:"text-small"})]})]}),ie=({state:e})=>{var t,a,n,r,s,c,d,o,l,u,g,p,m,h,x;const{trackingRef:b}=A(null!=e&&e.payload?v.LoadingStreamingView:v.LoadingView,{}),k=({items:e,renderItem:t,renderLoader:a,keepLastLoader:n})=>{const r=Math.max(n?1:0,3-(null!=e?e:[]).length);return(0,i.jsxs)(i.Fragment,{children:[(null!=e?e:[]).map(t),[...Array(r).keys()].map(a)]})},j=(null==(t=null==e?void 0:e.payload)?void 0:t.analysis)&&N.O.getSummary(null==(a=null==e?void 0:e.payload)?void 0:a.analysis),y=null==(n=null==e?void 0:e.payload)?void 0:n.audience_description,w=null==(s=null!=(r=null==y?void 0:y.selected_recipient)?r:null==y?void 0:y.most_probable_recipient)?void 0:s.probable_recipient;return(0,i.jsxs)(_.k,{direction:"column",gap:6,ref:b,children:[(0,i.jsxs)(_.k,{direction:"column",gap:2,children:[w?(0,i.jsx)(te,{isDisabled:!0,children:(0,i.jsxs)(_.k,{gap:3,align:"center",width:"100%",children:[(0,i.jsx)(P.J,{icon:K.E,size:"large",accessibilityLabel:""}),(0,i.jsx)(E.x,{as:"span",color:"base-subdued",variant:"text-small",style:{flexGrow:1},children:w}),(0,i.jsx)(P.J,{icon:F.M,size:"small",accessibilityLabel:""})]})}):(0,i.jsx)(L.g.Text,{variant:"text-small"}),j?(0,i.jsx)(E.x,{as:"p",variant:"text-small",color:"base-default",align:"start",children:j}):(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)(L.g.Text,{variant:"text-small"}),(0,i.jsx)(L.g.Text,{variant:"text-small"}),(0,i.jsx)(L.g.Text,{variant:"text-small"})]})]}),(0,i.jsxs)(_.k,{direction:"column",gap:4,children:[(0,i.jsx)(T.X,{as:"h3",variant:"heading-xsmall",align:"start",children:null!=(o=null==(d=null==(c=null==e?void 0:e.payload)?void 0:c.analysis)?void 0:d.keyTakeawaysHeader)?o:"Reader will remember"}),(0,i.jsx)(_.k,{direction:"column",gap:3,children:k({items:null==(u=null==(l=null==e?void 0:e.payload)?void 0:l.analysis)?void 0:u.keyTakeaways,renderItem:(e,t)=>(0,i.jsx)(D,{itemMarker:t+1,itemText:e},`item_${t}`),renderLoader:e=>(0,i.jsx)(ae,{},`loader_${e}`),keepLastLoader:!1})})]}),(0,i.jsxs)(_.k,{direction:"column",gap:4,children:[(0,i.jsx)(T.X,{as:"h3",variant:"heading-xsmall",align:"start",children:null!=(m=null==(p=null==(g=null==e?void 0:e.payload)?void 0:g.analysis)?void 0:p.openQuestionsHeader)?m:"Reader will ask"}),(0,i.jsx)(_.k,{direction:"column",gap:3,children:k({items:null==(x=null==(h=null==e?void 0:e.payload)?void 0:h.analysis)?void 0:x.openQuestions,renderItem:(e,t)=>(0,i.jsx)(Z,{category:e.questionHeader,question:e.question},`item_${t}`),renderLoader:e=>(0,i.jsx)(ae,{},`loader_${e}`),keepLastLoader:!0})})]})]})},ne=e=>{var t;const{trackingRef:a}=A(v.LoadedView,{loadingTimeMs:e.loadingTimeMs},{trackImpressionOnce:!0}),{trackClicked:n}=A(v.AudienceSelectionButton,{}),{result:r}=e.state;return(0,i.jsxs)(_.k,{direction:"column",gap:6,paddingBottom:4,ref:a,children:[(0,i.jsxs)(_.k,{direction:"column",gap:2,children:[(0,i.jsx)(te,{onClick:()=>{n(),e.onSelectAudience()},iconStart:K.E,iconEnd:F.M,text:null==(t=e.audience)?void 0:t.probable_recipient}),(0,i.jsx)(E.x,{as:"p",variant:"text-small",color:"base-default",align:"start",children:N.O.getSummary(r)})]}),(0,i.jsxs)(_.k,{direction:"column",gap:4,children:[(0,i.jsx)(T.X,{as:"h3",variant:"heading-xsmall",align:"start",children:r.keyTakeawaysHeader}),(0,i.jsx)(_.k,{direction:"column",gap:3,children:r.keyTakeaways.map(((e,t)=>(0,i.jsx)(D,{itemMarker:t+1,itemText:e},`item_${t}`)))})]}),(0,i.jsxs)(_.k,{direction:"column",gap:4,children:[(0,i.jsx)(T.X,{as:"h3",variant:"heading-xsmall",align:"start",children:r.openQuestionsHeader}),(0,i.jsx)(_.k,{direction:"column",gap:3,children:r.openQuestions.map(((e,t)=>(0,i.jsx)(Z,{category:e.questionHeader,question:e.question},`item_${t}`)))})]})]})};var re=a(94781),se=a(76957);const ce=({audience:e})=>(0,i.jsx)(re.E,{value:e.id,children:(0,i.jsx)(E.x,{as:"p",color:"base-subdued",variant:"text-small",children:e.probable_recipient})}),de=({state:e,onSetAudience:t,onEditAudience:a})=>{var n;const{audiences:s,selectedAudience:d,allowCustomAudience:o}=e,[l,u]=(0,c.useState)(d),{trackingRef:g}=A(v.AudienceSelectionView,{audiences:s.map((e=>e.probable_recipient))},{trackImpressionOnce:!0}),{trackClicked:p}=A(v.RecheckButton,{audienceName:null!=(n=null==l?void 0:l.probable_recipient)?n:""}),{trackClicked:m}=A(v.AddAudienceButton,{});return(0,i.jsxs)(_.k,{direction:"column",justify:"space-between",height:"100%",ref:g,children:[(0,i.jsxs)(_.k,{direction:"column",gap:2,children:[(0,i.jsxs)(_.k,{direction:"column",gap:1,children:[(0,i.jsx)(T.X,{as:"h2",variant:"heading-small",align:"start",children:"Audience"}),(0,i.jsx)(E.x,{as:"p",variant:"text-small",color:"base-default",align:"start",children:"Tailor the feedback to who you're writing for"})]}),(0,i.jsxs)(re.F,{legend:"Audiences",legendDisplay:"hidden",defaultValue:null==d?void 0:d.id,className:r,onChange:e=>{const t=s.find((t=>t.id===e));t&&u(t)},children:[(0,i.jsx)(_.k,{direction:"column",gap:2,children:s.map((e=>(0,i.jsx)(ce,{audience:e},e.id)))}),o&&(0,i.jsx)(te,{onClick:()=>{m(),a()},iconStart:se.m,text:"Create audience"})]})]}),(0,i.jsx)(H.z,{variant:"primary",width:"full",size:"large",text:"Save and recheck",isDisabled:!l,onClick:()=>{p(),l&&t(l)}})]})};var oe=a(65428),le=a(83816);const ue=({state:e,onSaveAudience:t})=>{const{text:a}=e,[n,r]=(0,c.useState)(a),[d,o]=(0,c.useState)(!1),{trackingRef:l}=A(v.AudienceEditView,{}),{trackClicked:u}=A(v.SaveAudienceButton,{sampleLength:n.length});return(0,i.jsxs)(_.k,{direction:"column",justify:"space-between",height:"100%",gap:6,ref:l,children:[(0,i.jsxs)(_.k,{direction:"column",height:"100%",gap:4,className:s,children:[(0,i.jsx)(T.X,{as:"h2",variant:"heading-small",align:"start",children:"Create an audience"}),(0,i.jsx)(E.x,{as:"p",variant:"text-small",color:"base-default",align:"start",children:"Describe a reader to give you feedback. Be detailed and specific about who they are and what they care about."}),(0,i.jsx)(oe.g,{placeholder:"Describe your reader",defaultValue:n,onChange:r,label:"Describe your reader",labelDisplay:"hidden",resizable:"off"})]}),(0,i.jsx)(H.z,{variant:"primary",width:"full",size:"large",text:"Create audience",isLoading:d,isDisabled:!(e=>{const t=(0,le.iD)(e);return 3<=t&&t<=1600})(n),onClick:()=>{o(!0),u(),t(n)}})]})},ge=({state:e,onUseAudience:t})=>{const{audience:a}=e,{trackingRef:n}=A(v.NewAudienceView,{audienceName:a.probable_recipient}),{trackClicked:r}=A(v.UseNewAudienceButton,{audienceName:a.probable_recipient});return(0,i.jsxs)(_.k,{direction:"column",justify:"space-between",height:"100%",ref:n,children:[(0,i.jsxs)(_.k,{direction:"column",gap:4,children:[(0,i.jsxs)(_.k,{direction:"column",gap:2,children:[(0,i.jsx)(T.X,{as:"h2",variant:"heading-small",align:"start",children:"Review your audience"}),(0,i.jsx)(E.x,{as:"p",variant:"text-small",color:"base-default",align:"start",children:"Does this sound right? You can go back to make changes."})]}),(0,i.jsx)(O.x,{bgColor:"background-success-subdued",borderRadius:3,padding:4,children:(0,i.jsxs)(_.k,{direction:"column",gap:1,children:[(0,i.jsxs)(_.k,{gap:1,color:"brand-default",children:[(0,i.jsx)(P.J,{icon:K.E,variant:"inherit",size:"small",accessibilityLabel:"Audience icon"}),(0,i.jsx)(E.x,{as:"p",variant:"text-xsmall",weight:"semibold",children:"Audience"})]}),(0,i.jsx)(E.x,{as:"p",variant:"text-medium",weight:"semibold",children:a.probable_recipient}),(0,i.jsx)(E.x,{as:"p",variant:"text-small",children:a.overall_recipient_description})]})})]}),(0,i.jsx)(H.z,{variant:"primary",width:"full",size:"large",text:"Use this audience",onClick:()=>{r(),t(a)}})]})};var pe=a(60132),me=a(39981);const he=({onBack:e,title:t})=>(0,i.jsxs)(_.k,{height:48,justify:"space-between",align:"center",paddingLeft:4,paddingRight:4,children:[(0,i.jsx)(pe.h,{variant:"tertiary",icon:me.n,accessibilityLabel:"Back",size:"medium",onClick:e}),(0,i.jsxs)(_.k,{gap:2,align:"center",children:[(0,i.jsx)(m.b,{size:"small"}),(0,i.jsx)(T.X,{as:"h3",variant:"heading-xxsmall",color:"base-default",children:t})]}),(0,i.jsx)("div",{style:{width:"var(--space-6)"}})]}),xe=({viewModel:e,onClosePanel:t})=>{const a=(0,c.useRef)(),[r,s]=(0,c.useState)(0);(0,c.useEffect)((()=>{switch(e.state.get().kind){case C.x.State.Kind.Initial:case C.x.State.Kind.Loading:a.current||(a.current=performance.now());break;case C.x.State.Kind.Loaded:s(a.current?performance.now()-a.current:0),a.current=void 0;break;default:a.current=void 0}}),[e.state]);const{trackClicked:x}=A(v.ReloadButton,{}),b=(0,d.PK)(e.hasTextChanges);return(0,i.jsx)(h.Provider,{value:e.context,children:(0,i.jsx)(o.Py,{renderHeader:()=>(0,i.jsx)(p.F.div,{children:e.state.view((a=>{const n=a.kind===C.x.State.Kind.Initial||a.kind===C.x.State.Kind.Loading?{}:{left:t&&[{icon:l.V,label:"Close",onClick:t}],right:[{icon:u.a,label:"Reload",onClick:()=>{x(),e.loadReactions()},popover:b}]};return a.kind===C.x.State.Kind.AudienceSelection||a.kind===C.x.State.Kind.AudienceEditing||a.kind===C.x.State.Kind.AudienceSummary?(0,i.jsx)(he,{onBack:e.goBack,title:e.title}):(0,i.jsx)(o.i7,{title:e.title,renderIcon:({size:e})=>(0,i.jsx)(m.b,{size:e}),state:"expanded",controls:n})}))}),renderBody:()=>(0,i.jsx)(p.F.div,{className:n,children:e.state.view((t=>{const a=t.kind;switch(a){case C.x.State.Kind.Initial:return(0,i.jsx)(ie,{});case C.x.State.Kind.Loading:return(0,i.jsx)(ie,{state:t});case C.x.State.Kind.Empty:return(0,i.jsx)(B,{});case C.x.State.Kind.Error:return(0,i.jsx)(M,{state:t});case C.x.State.Kind.Loaded:return(0,i.jsx)(ne,{state:t,loadingTimeMs:r,audience:e.audience.get(),onSelectAudience:e.selectAudience});case C.x.State.Kind.AudienceSelection:return(0,i.jsx)(de,{state:t,onSetAudience:e.setAudience,onEditAudience:e.editAudience});case C.x.State.Kind.AudienceEditing:return(0,i.jsx)(ue,{state:t,onSaveAudience:e.saveAudience});case C.x.State.Kind.AudienceSummary:return(0,i.jsx)(ge,{state:t,onUseAudience:e.setAudience});default:(0,g.L0)(a)}}))})})})}},84848:(e,t,a)=>{a.d(t,{Qi:()=>T});var i=a(88028),n=a(10941),r=a(14930),s=a(39736),c=a(16395),d=a(84197),o=a(60454),l=a(13391),u=a(84308),g=a(84714),p=a(90572),m=a(88012),h=a(59179),x=a(29416),v=a(63532),b=a(20161),k=a(559),j=a(33986),y=a(58303),w=a(86399),S=a(90023),f=a(56544),z=a(96632),I=a(25258),A=a(85936),C=a(80661),O=(a(9790),a(39117),Object.defineProperty),_=Object.defineProperties,P=Object.getOwnPropertyDescriptors,R=Object.getOwnPropertySymbols,E=Object.prototype.hasOwnProperty,B=Object.prototype.propertyIsEnumerable,V=(e,t,a)=>t in e?O(e,t,{enumerable:!0,configurable:!0,writable:!0,value:a}):e[t]=a;d.RU,d.tg;var T,M;(M=T||(T={})).Id=f.oJ,M.getVBarTitle=e=>{var t;return i.h.isWithRewriteOrComment(e)?null!=(t=e.surface.explanation)?t:e.surface.title:void 0},M.getAgentMetadataSource=e=>(0,z.Z)(e)&&i.h.isWithRewriteOrComment(e)?{sourceAction:e.surface.sourceAction}:void 0,M.pushedContentItemsFilter=e=>e.view((e=>t=>(0,z.Z)(t)&&(e.kind!==A.x.State.Kind.Loading||!i.h.isWithRewrite(t)))),M.create=e=>{const t=e.decorationService.createDecorationFactory(M.Id),a=e.experimentationBridge.isAssigned(d.RK),i=e.initNavigation(M.Id,a?s.r.Regular:s.r.SingleThread),O=l.h.create(void 0),T=C.z.create({agentId:M.Id,agentGenericService:e.agentGenericService,pushedContentService:e.pushedContentService,fileUploadService:e.fileUploadService}),L=e.sessionChecksState.textInfo.view((0,S.ls)(y.UI((e=>({wordsCount:e.wordsCount,charsCount:e.charsCount}))),y.fS((()=>({wordsCount:0,charsCount:0}))))),K=e.experimentationBridge.isAssigned(d.cV)?u.a([e.editor.changes,i.isPanelOpen],((e,t)=>t&&("flush"===e.kind||"reset"===e.kind||Math.abs(e.length)>f.tK))):g.of(!1),F={customAudiences:e.experimentationBridge.isAssigned(d.bI)},N=A.x.create({trackingServiceProvider:e.trackingServiceProvider,capiSessionId:O,agenticService:T,featureFlags:F,textChanged:K,textInfo:L}),G=n.pS.create({agentId:M.Id,decorationsFactory:t,isActive:i.isPanelOpen,pushedContentService:e.pushedContentService,vbarFeedbackService:e.vbarFeedbackService,trackingServiceProvider:e.trackingServiceProvider,decorationService:e.decorationService,uphookHubClient:e.uphookHubClient,getDecorationFactory:r.p,agentMetadataSource:M.getAgentMetadataSource,itemsFilter:(0,M.pushedContentItemsFilter)(N.state),trustedRewrite:S.jv,vbarRenderOverrides:{getCardIcon:()=>({icon:o.Q}),getCardTitle:M.getVBarTitle,getVBarProps:(e,t)=>((e,t)=>_(e,P(t)))(((e,t)=>{for(var a in t||(t={}))E.call(t,a)&&V(e,a,t[a]);if(R)for(var a of R(t))B.call(t,a)&&V(e,a,t[a]);return e})({},e),{primaryText:(0,M.getVBarTitle)(t)})}}),U=e.capiSession.events.pipe(p.h(k.hX.is("session_started"))),D=new m.w.Keeper;return e.experimentationBridge.isAssigned(d.l0)&&D.push(e.pushedContentService.rebaseItems(z.Z).subscribe()),D.push((0,j.bH)({agentId:M.Id,decorationService:e.decorationService,isPanelOpen:i.isPanelOpen,state:N.state,logger:(0,I.j)(),findFirstVBarForAction:e=>T.currentVBars.pipe(h.U(w.YM)),filterAllowedStates:e=>e.kind===A.x.State.Kind.Loaded,getSelectedAction:e=>y.G({}),equals:S.jv}).subscribe()),D.push(U.subscribe((e=>O.set(e.sessionUuid))),u.a([L,N.state,i.isPanelOpen],((e,t,a)=>a&&t.kind===A.x.State.Kind.Empty&&e.wordsCount>A.x.MIN_WORDS_TEXT_SIZE)).pipe(p.h(S.yR),x.b(100),p.h((()=>N.state.get().kind===A.x.State.Kind.Empty)),v.b((()=>N.loadReactions()))).subscribe(),u.a([U,e.sessionChecksState.checkingState.pipe(p.h((e=>"idle"===e)))]).pipe(b.w((e=>u.a([N.state,i.isPanelOpen],((e,t)=>t&&e.kind===A.x.State.Kind.Initial)).pipe(p.h(S.yR),x.b(100),v.b((()=>N.loadReactions())))))).subscribe()),{agent:{id:M.Id,decorations:c.dX.Collection.create(M.Id,{pushedContent:G}),viewModel:N,dispose:()=>{D.dispose(),N.dispose()}},isAvailable:l.h.create(!0)}}},23515:(e,t,a)=>{a.d(t,{E:()=>n,O:()=>i});var i,n,r,s=a(11633),c=a(43351),d=a(90023),o=a(12518),l=a(59833);(e=>{const t=s.OT(s.dt({questionHeader:s.Z_,question:s.Z_}));e.ReactionsIO=s.OT(s.jV([s.dt({probableAudience:s.Z_,keyTakeawaysHeader:s.Z_,keyTakeaways:s.IX(s.Z_),openQuestionsHeader:s.Z_,openQuestions:s.IX(t)}),s.r$({strengthSummary:s.Z_,summary:s.Z_})])),e.AudienceIO=s.OT(s.dt({id:s.Z_,probable_recipient:s.Z_,overall_recipient_description:s.Z_}));const a=s.OT(s.jV([s.dt({most_probable_recipient:e.AudienceIO,other_probable_recipients:s.IX(e.AudienceIO)}),s.r$({selected_recipient:e.AudienceIO})]));e.PayloadIO=s.OT(s.dt({analysis:e.ReactionsIO,audience_description:a})),e.isPartial=e=>"rawPayload"in e,e.getSummary=e=>{var t;return null!=(t=e.summary?e.summary:e.strengthSummary)?t:""},e.decode=t=>(0,d.zG)(o.Y3((()=>JSON.parse(t)),l.of),o.tS(e.PayloadIO.decode),o.Vn(c.Rn),o.Vn((e=>new Error(`Failed to parse reactions:\n${e.join("\n")}`)))),e.decodeAudience=t=>(0,d.zG)(o.Y3((()=>JSON.parse(t)),l.of),o.tS(e.AudienceIO.decode),o.Vn(c.Rn),o.Vn((e=>new Error(`Failed to parse audience:\n${e.join("\n")}`))))})(i||(i={})),(r=n||(n={})).PartialPayloadIO=s.OT(s.r$(i.PayloadIO.type.props)),r.decode=e=>(0,d.zG)(o.Y3((()=>JSON.parse(e)),l.of),o.tS(r.PartialPayloadIO.decode),o.Vn(c.Rn),o.Vn((e=>new Error(`Failed to parse partial reactions:\n${e.join("\n")}`))),(t=>({rawPayload:e,parsedPayload:t}))),r.encodeAudience=(e,t)=>JSON.stringify(r.PartialPayloadIO.encode({audience_description:{most_probable_recipient:t[0],selected_recipient:e,other_probable_recipients:t.slice(1)}}))},80661:(e,t,a)=>{a.d(t,{z:()=>i});var i,n=a(9119),r=a(35020),s=a(63532),c=a(59179),d=a(84714),o=a(20232),l=a(12518),u=a(67177),g=a(90023),p=a(96632),m=a(25258),h=a(23515);(i||(i={})).create=e=>{const{agentGenericService:t,pushedContentService:a,fileUploadService:i,agentId:x}=e,v=(0,m.j)("AgentService"),b=e=>(0,g.zG)(e,u.SA((e=>(v.error("Error requesting reactions",e),e)),(e=>e.pipe(s.b((e=>v.debug("Received reactions",e))),c.U(l.VS((e=>"partial"===e.kind?l.F2(h.E.decode(e.payload)):(0,g.zG)(h.O.decode(e.payload),l.Vn((e=>(v.error("Error decoding reactions",e),e))),l.UI((e=>(v.debug("Decoded reactions"),e)))))))))),u.fS((e=>o.of(d.of(l.t$(e))))));return{getReactions:()=>(0,g.zG)(t.requestWithStreaming({commandId:"start",payload:"",agentId:x}),b),setAudience:(e,a)=>(a.find((t=>t.id===e.id))||(a=[...a,e]),(0,g.zG)(t.requestWithStreaming({commandId:"audienceSelection",payload:h.E.encodeAudience(e,a),agentId:x}),b)),createAudience:e=>(0,g.zG)(i.uploadFile({file:new File([e],"custom_audience",{type:"text/plain"}),useCase:n._.CustomAudience,useCaseParameters:{kind:"customAudience",name:"Custom audience"},agentId:x}),u.Vn((e=>new Error(e.message))),u.tS((e=>u.Uo(h.O.decodeAudience(e.fileContent))))),currentVBars:a.getCollection(p.Z).view((e=>r.$.values(e))),clearVBars:()=>{v.debug("Clearing vBars"),a.clear(p.Z)}}}},96632:(e,t,a)=>{a.d(t,{Z:()=>n});var i=a(88028);const n=e=>i.z.isVBar(e)&&i.h.isWithRewriteOrComment(e)&&"readerReactions"===e.surface.sourceAgent},25258:(e,t,a)=>{a.d(t,{j:()=>r});var i=a(64443);const n="ReaderReactions";function r(e=""){return i.C8.Logging.getLogger(e?`${n}.${e}`:n)}},85936:(e,t,a)=>{a.d(t,{x:()=>i});var i,n,r,s,c=a(88012),d=a(13391),o=a(90023),l=a(59179),u=a(20232),g=a(12518),p=a(23515),m=a(25258);n=i||(i={}),r=n.State||(n.State={}),(s=r.Kind||(r.Kind={})).Initial="initial",s.Loading="loading",s.Loaded="loaded",s.Empty="empty",s.Error="error",s.AudienceSelection="audienceSelection",s.AudienceEditing="audienceEditing",s.AudienceSummary="audienceSummary",n.MIN_WORDS_TEXT_SIZE=100,n.create=e=>{var t;const{agenticService:a,capiSessionId:i,featureFlags:r,textChanged:s,textInfo:h,trackingServiceProvider:x}=e,v=new c.w.Keeper,b=(0,m.j)("AgentViewModel"),k=d.h.create(null!=(t=e.state)?t:{kind:"initial"}),j=d.h.create([]),y=d.h.create(void 0),w={capiSessionId:i,textWordsCount:h.view((e=>e.wordsCount)),tracking:x.getTrackingService()},S=[],f=d.h.create(!1);v.push(s.subscribe((e=>f.set(e))));const z=e=>(0,o.zG)(e,u.UI(l.U((e=>(0,o.zG)(e,g.bw((e=>(p.O.isPartial(e)&&g.nM(e.parsedPayload)&&a.clearVBars(),g.F2(e)))),g.UI((e=>{var t;let a;return p.O.isPartial(e)?g.tO(e.parsedPayload)&&(a=e.parsedPayload.right.audience_description):a=e.audience_description,a&&(j.set([a.most_probable_recipient,...a.other_probable_recipients]),y.set(null!=(t=a.selected_recipient)?t:a.most_probable_recipient)),e})),g.g_((()=>({kind:"error",title:"Something went wrong",description:"To chat with Grammarly, please close this sidebar, then reopen it."})),(e=>p.O.isPartial(e)?g.tO(e.parsedPayload)?{kind:"loading",payload:e.parsedPayload.right}:k.get():(f.set(!1),{kind:"loaded",result:e.analysis}))))))),u.UI((e=>e.subscribe((e=>k.set(e))))),u.UI((e=>v.push(e))));return{title:"Reader Reactions",state:k,audience:y,context:w,featureFlags:r,hasTextChanges:f,loadReactions:()=>(b.debug("Loading evaluation"),"loading"===k.get().kind?Promise.resolve():h.view((e=>e.wordsCount)).get()<n.MIN_WORDS_TEXT_SIZE?(k.set({kind:"empty"}),Promise.resolve()):(k.set({kind:"loading"}),a.clearVBars(),(0,o.zG)(a.getReactions(),z)())),selectAudience:()=>{S.push(k.get()),k.set({kind:"audienceSelection",audiences:j.get(),selectedAudience:y.get(),allowCustomAudience:r.customAudiences})},editAudience:()=>{S.push(k.get()),k.set({kind:"audienceEditing",text:""})},saveAudience:e=>(b.debug("Saving audience"),S.push({kind:"audienceEditing",text:e}),(0,o.zG)(a.createAudience(e),u.UI((0,o.zG)(g.g_((e=>({kind:"error",title:e.name,description:e.message})),(e=>({kind:"audienceSummary",audience:e}))))),u.UI((e=>k.set(e))))()),setAudience:e=>(b.debug(`Setting new audience: ${e}`),"loading"===k.get().kind?Promise.resolve():(S.length=0,k.set({kind:"loading"}),a.clearVBars(),(0,o.zG)(a.setAudience(e,j.get()),z)())),goBack:()=>{const e=S.pop();e&&k.set(e)},dispose:()=>{v.dispose()}}}},39981:(e,t,a)=>{a.d(t,{n:()=>s});var i=a(92379),n=a(82491),r=a(38076);const s=(0,n.I)("color",(({title:e,titleId:t,desc:a,descId:n,resourcePrefix:s=(0,r.O)(),...c})=>i.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",width:16,height:16,fill:"none",viewBox:"0 0 16 16","aria-hidden":"true","data-icon":"InterfaceLeft",stroke:"transparent","aria-labelledby":t,"aria-describedby":n,...c},a?i.createElement("desc",{id:n},a):null,e?i.createElement("title",{id:t},e):null,i.createElement("path",{stroke:"#646B81",strokeLinecap:"round",d:"M11 2 5 8l6 6"}))))},2240:(e,t,a)=>{a.d(t,{E:()=>s});var i=a(92379),n=a(82491),r=a(38076);const s=(0,n.I)("color",(({title:e,titleId:t,desc:a,descId:n,resourcePrefix:s=(0,r.O)(),...c})=>i.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",width:16,height:16,fill:"none",viewBox:"0 0 16 16","aria-hidden":"true","data-icon":"InterfaceNewTeam",stroke:"transparent","aria-labelledby":t,"aria-describedby":n,...c},a?i.createElement("desc",{id:n},a):null,e?i.createElement("title",{id:t},e):null,i.createElement("path",{fill:"#6D758D",d:"M4.629 10.999a.5.5 0 1 0 0-1zm-2.13-.5H2a.5.5 0 0 0 .5.5zm3.21-3.75a.5.5 0 1 0-1 0zm2.585 2.43a.5.5 0 1 0 .412-.912zm-1.036-2.43a.5.5 0 0 0-1 0zm.578 1.673.207-.455zm-3.682.049.228.445zm-.6.306-.227-.446zm7.817 3.722a.5.5 0 0 0 0 1zm2.13.5v.5a.5.5 0 0 0 .5-.5zm-2.21-3.75a.5.5 0 0 0-1 0zm.554 1.722-.227.445zm.6.306.228-.445zm-.816 2.222a.5.5 0 1 0 0-1zm-5.13-.5H6a.5.5 0 0 0 .5.5zm3.21-3.75a.5.5 0 0 0-1 0zm-1.555 1.722-.227-.445zm-.6.306.227.445zM4.63 9.999h-2.13v1h2.13zm-.848-.777.6-.306-.454-.89-.6.305zm4.925-.955-.663-.3-.413.91.664.301zm-3.77-2.899v-.79h-1v.79zm2.096-.79v.79h1v-.79zm0 .79c0 .605-.478 1.079-1.048 1.079v1c1.14 0 2.048-.94 2.048-2.079zM5.984 3.5c.57 0 1.048.474 1.048 1.079h1c0-1.14-.908-2.079-2.048-2.079zM4.935 4.579c0-.605.479-1.079 1.049-1.079v-1c-1.14 0-2.049.94-2.049 2.079zm-1 .789c0 1.139.908 2.079 2.049 2.079v-1c-.57 0-1.049-.474-1.049-1.079zm4.108 2.599a1.34 1.34 0 0 1-.785-1.218h-1c0 .918.536 1.75 1.372 2.128zm-3.661.95a2.43 2.43 0 0 0 1.327-2.168h-1c0 .539-.302 1.032-.782 1.277zM3 10.498c0-.539.302-1.032.781-1.277l-.454-.89A2.43 2.43 0 0 0 2 10.498zm8.371 3h2.13v-1h-2.13zm1.302-2.668-.6-.305-.455.89.6.306zm-.608-2.963v-.79h-1v.79zm-4.097-.79v.79h1v-.79zm0 .79c0 1.139.908 2.079 2.048 2.079v-1c-.57 0-1.048-.474-1.048-1.079zM10.016 5c-1.14 0-2.048.94-2.048 2.079h1c0-.605.478-1.079 1.048-1.079zm2.049 2.079c0-1.14-.908-2.079-2.049-2.079v1c.57 0 1.049.474 1.049 1.079zm-1 .789c0 .605-.479 1.079-1.049 1.079v1c1.14 0 2.049-.94 2.049-2.079zm1.008 2.658a1.43 1.43 0 0 1-.782-1.277h-1c0 .915.513 1.752 1.327 2.167zM14 12.999c0-.915-.513-1.752-1.328-2.168l-.454.891c.48.245.782.738.782 1.277zm-2.372-.5h-5.13v1h5.13zm-3.848-.777.6-.306-.454-.89-.6.306zm1.154-3.854v-.79h-1v.79zm2.097-.79v.79h1v-.79zm0 .79c0 .605-.478 1.079-1.048 1.079v1c1.14 0 2.048-.94 2.048-2.079zM9.984 6c.57 0 1.048.474 1.048 1.079h1c0-1.14-.908-2.079-2.048-2.079zM8.935 7.079C8.935 6.474 9.414 6 9.984 6V5c-1.14 0-2.049.94-2.049 2.079zm-1 .789c0 1.139.908 2.079 2.049 2.079v-1c-.57 0-1.049-.474-1.049-1.079zm.447 3.548A2.43 2.43 0 0 0 9.709 9.25h-1c0 .539-.302 1.032-.782 1.277zM7 13c0-.539.302-1.032.781-1.277l-.454-.89A2.43 2.43 0 0 0 6 12.999z"}))))},12787:(e,t,a)=>{a.d(t,{a:()=>s});var i=a(92379),n=a(82491),r=a(38076);const s=(0,n.I)("color",(({title:e,titleId:t,desc:a,descId:n,resourcePrefix:s=(0,r.O)(),...c})=>i.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",width:16,height:16,fill:"none",viewBox:"0 0 16 16","aria-hidden":"true","data-icon":"InterfaceReload",stroke:"transparent","aria-labelledby":t,"aria-describedby":n,...c},a?i.createElement("desc",{id:n},a):null,e?i.createElement("title",{id:t},e):null,i.createElement("path",{stroke:"#646B81",d:"M5.818 2.429A5.92 5.92 0 0 0 2 8a6 6 0 0 0 3.857 5.606m4.286-11.177C12.398 3.29 14 5.44 14 8a5.97 5.97 0 0 1-3.824 5.606M2.546 2h3.272v3.273M13.455 14h-3.273v-3.273"}))))},42015:(e,t,a)=>{a.d(t,{q:()=>s});var i=a(92379),n=a(82491),r=a(38076);const s=(0,n.I)("color",(({title:e,titleId:t,desc:a,descId:n,resourcePrefix:s=(0,r.O)(),...c})=>i.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",width:20,height:20,fill:"none",viewBox:"0 0 20 20","aria-hidden":"true","data-icon":"InterfaceWriting",stroke:"transparent","aria-labelledby":t,"aria-describedby":n,...c},a?i.createElement("desc",{id:n},a):null,e?i.createElement("title",{id:t},e):null,i.createElement("path",{fill:"#646B81",d:"M1.504 17.437a.5.5 0 0 0 .992.126zm3.529-1.333-.218.45zm1.502 1.316.088-.492zm2.798-1.219-.166-.471zm2.976.409-.18.466zm1.856.46.042-.499zm4.005-.337a.5.5 0 0 0-.34-.94zM15.246 4.542l.39.314a.5.5 0 0 0-.095-.718zM12.46 2.5l.295-.403a.5.5 0 0 0-.716.132zM6.706 7.53l-.18-.467a.5.5 0 0 0-.315.396zm-1.031 7.307-.496-.07a.5.5 0 0 0 .716.519zm6.583-3.236.22.449a.5.5 0 0 0 .28-.421zm-6.976 2.942a.5.5 0 1 0 .81.585zm5.106-5.373a.5.5 0 0 0-.811-.585zm.489-4.532a.5.5 0 0 0-.559.83zm2.368 2.798a.5.5 0 1 0 .558-.83zM2.496 17.563c.003-.023.043-.135.236-.31.177-.161.427-.324.711-.458s.58-.229.84-.269c.273-.041.447-.014.532.028l.436-.9c-.348-.168-.756-.171-1.118-.116a4.1 4.1 0 0 0-1.116.353c-.353.166-.692.38-.958.622-.25.228-.507.544-.555.924zm2.32-1.01c.18.088.26.23.483.555.209.304.519.691 1.147.805l.177-.985c-.228-.04-.339-.152-.5-.387-.149-.216-.393-.656-.872-.888zm1.63 1.36c.753.135 1.357-.179 1.826-.484.118-.077.234-.158.343-.234q.164-.116.317-.219c.208-.137.39-.24.567-.303l-.332-.943c-.293.103-.556.26-.787.413q-.176.117-.339.233c-.11.076-.212.148-.315.215-.417.271-.742.402-1.103.337zm3.053-1.24c.842-.296 1.629.016 2.63.403l.36-.932c-.91-.352-2.068-.855-3.322-.414zm2.63.403c.63.244 1.271.43 1.994.492l.084-.997c-.597-.05-1.142-.205-1.718-.427zm1.994.492c1.541.13 2.802-.384 4.047-.835l-.34-.94c-1.302.47-2.343.886-3.623.778zM12.459 2.5l-.42-.271-.002.001-.004.007-.018.028-.078.113a17.281 17.281 0 0 1-1.467 1.81C9.473 5.26 8.096 6.455 6.526 7.063l.362.932c1.774-.687 3.274-2.007 4.315-3.126a18 18 0 0 0 1.558-1.922l.119-.176zM6.21 7.46l-1.032 7.307.99.14 1.032-7.308zm-.316 7.826 6.583-3.236-.44-.897-6.584 3.235zm6.862-3.657c.094-1.695.8-3.382 1.508-4.669a17 17 0 0 1 1.26-1.962l.083-.109.021-.026.005-.006.001-.001-.778-.628h-.001l-.002.003-.033.042-.094.123a18.319 18.319 0 0 0-1.338 2.083c-.738 1.341-1.525 3.183-1.63 5.095zm-6.664 3.499 4.295-5.958-.811-.585-4.295 5.958zm4.226-9.66 2.926 1.968.558-.83-2.927-1.968zm5.222-1.33-2.787-2.041-.591.806 2.788 2.042z"}))))}}]);
(self.webpackChunk=self.webpackChunk||[]).push([[1491],{92649:(e,t,r)=>{r.d(t,{g:()=>s,u:()=>o});var s=(e=>(e.Forbidden="Forbidden: User not assigned to feature",e.Unauthorized="Unauthorized: User not assigned to feature",e.UnprocessableContent="Document did not pass pre-filtering",e.Sensitivity="Document did not pass sensitivity filtering",e.InternalServerError="Internal server error",e.ServiceLimitExceeded="Service limit exceeded",e.UnsupportedLanguage="Unsupported language",e.UpdateClient="Client has to be updated to process the result of the requested action",e.Other="Other error",e.NothingToImprove="Nothing to improve",e))(s||{});const i=class e extends Error{constructor(e,t){super(`[${e}] ${t}`),this.kind=e}static fromMessageError(t){return new e(e.getKind(t),t.title)}};i.getKind=e=>{switch(e.errorType.kind){case"sensitivity":return"Document did not pass sensitivity filtering";case"serviceLimitExceeded":return"Service limit exceeded";case"unsupportedLanguage":return"Unsupported language";case"updateClient":return"Client has to be updated to process the result of the requested action";case"backendError":return"Internal server error";case"badRequest":switch(e.errorType.errorCode){case 403:return"Forbidden: User not assigned to feature";case 401:return"Unauthorized: User not assigned to feature";case 422:return"Document did not pass pre-filtering";default:return"Internal server error"}default:return"Other error"}};let o=i},47283:(e,t,r)=>{r.d(t,{RJ:()=>u,bE:()=>g,el:()=>l,fl:()=>d,nI:()=>h});var s=r(88028),i=r(35020),o=r(90023),n=r(58303),a=r(59833);const l=(e,t,r)=>(0,o.zG)(r,(e=>d(e)?n.G(e):n.YP),n.g_(o.jv,(r=>p(r.surface.sourceAgent)&&(e=>{var r,s;const i=null==(s=null==(r=e.surface.additionalElements)?void 0:r.expertPanel)?void 0:s.expertName;return void 0!==i&&t.has(i)})(r)&&(t=>{var r,s;return n.Wi(e)||e.value.expertName===(null==(s=null==(r=t.surface.additionalElements)?void 0:r.expertPanel)?void 0:s.expertName)})(r)))),p=e=>"expertpanel"===e.toLowerCase()||"expert-panel"===e,d=e=>s.z.isVBar(e)&&s.h.isWithComment(e)&&p(e.surface.sourceAgent),u=(e,t)=>(0,o.zG)(e,i.$.filter((e=>l(n.YP,t,e))),i.$.values,a.DZ((e=>d(e)?n.G(e):n.YP)),(e=>(0,o.zG)(e,a.u4({},((e,t)=>{var r,s;const i=null==(s=null==(r=t.surface.additionalElements)?void 0:r.expertPanel)?void 0:s.expertName;return void 0===i||(void 0===e[i]&&(e[i]=[]),e[i].push({text:t.surface.text})),e}))))),h=e=>{e.clear(d)},g=(e,t)=>{e.clear((e=>{var r,i;return s.z.isVBar(e)&&s.h.isWithComment(e)&&(null==(i=null==(r=e.surface.additionalElements)?void 0:r.expertPanel)?void 0:i.expertName)===t}))}},80502:(e,t,r)=>{r.d(t,{c:()=>o});var s=r(13391),i=r(58303);class o{constructor(){this._loadingFollowUpExpertsCount=s.h.create(0),this._loadingFollowUpSuggestionsCount=s.h.create(0),this.isLoadingMain=s.h.create(!1),this.isLoadingFollowUpExperts=this._loadingFollowUpExpertsCount.view((e=>e>0)),this.isLoadingFollowUpSuggestions=this._loadingFollowUpSuggestionsCount.view((e=>e>0)),this.mainLoadingError=s.h.create(i.YP),this.followUpExpertsLoadingError=s.h.create(i.YP),this.followUpSuggestionsLoadingError=s.h.create(i.YP),this.loadedExpertsNumber=s.h.create(0),this.setMainLoaded=e=>{this.loadedExpertsNumber.set(e),this.isLoadingMain.set(!1),this.mainLoadingError.set(i.YP)},this.setMainLoadedWithError=e=>{this.isLoadingMain.set(!1),this.mainLoadingError.set(i.G(e)),this.loadedExpertsNumber.set(0)},this.setMainLoading=()=>{this.isLoadingMain.set(!0),this.mainLoadingError.set(i.YP),this._loadingFollowUpExpertsCount.set(0),this.followUpExpertsLoadingError.set(i.YP),this._loadingFollowUpSuggestionsCount.set(0),this.followUpSuggestionsLoadingError.set(i.YP),this.loadedExpertsNumber.set(0)},this.setFollowUpExpertsLoaded=()=>{this._loadingFollowUpExpertsCount.modify((e=>e-1)),this.followUpExpertsLoadingError.set(i.YP)},this.setFollowUpExpertsLoadedWithError=e=>{this._loadingFollowUpExpertsCount.modify((e=>e-1)),this.followUpExpertsLoadingError.modify(i.g_((()=>i.G(e)),(e=>i.G(e))))},this.setFollowUpExpertsLoading=()=>{this._loadingFollowUpExpertsCount.modify((e=>e+1))},this.setFollowUpSuggestionsLoaded=()=>{this._loadingFollowUpSuggestionsCount.modify((e=>e-1)),this.followUpSuggestionsLoadingError.set(i.YP)},this.setFollowUpSuggestionsLoadedWithError=e=>{this._loadingFollowUpSuggestionsCount.modify((e=>e-1)),this.followUpSuggestionsLoadingError.set(i.G(e))},this.setFollowUpSuggestionsLoading=()=>{this._loadingFollowUpSuggestionsCount.modify((e=>e+1)),this.followUpSuggestionsLoadingError.set(i.YP)}}}},1491:(e,t,r)=>{r.d(t,{Gq:()=>H,ro:()=>B,XC:()=>j});var s=r(92649),i=r(64443),o=r(13391),n=r(88012),a=r(84308),l=r(90572),p=r(84178),d=r(59179),u=r(18519),h=r(559),g=r(11633),c=r(90023),x=r(12518);const m=e=>Array.isArray(e)?e.join(", "):e||"",f=g.r$({work_description:g.Z_,work_name:g.Z_,work_type:g.Z_}),E=g.r$({call_for_dimension_experts:g.Z_,dimension:g.Z_,done:g.O7,expert_initials:g.G0([g.Z_,g.IX(g.Z_)]),expert_name:g.G0([g.Z_,g.IX(g.Z_)]),expert_role:g.Z_,expert_works:g.IX(f)}),w=g.r$({suggested_experts:g.IX(E),text_analysis:g.Z_,follow_up_categories:g.IX(g.Z_),key_areas_of_improvement:g.IX(g.Z_)}),_=g.r$({author_name:g.G0([g.Z_,g.IX(g.Z_)]),cta:g.Z_,original_part:g.Z_,source:g.Z_,text:g.Z_}),v=g.r$({experts:w,comments:g.IX(_),summary:g.Z_}),S=(e,t)=>{var r,s,i;const o=[];let n={},a=[],l=[];try{const p=(0,c.zG)(x.Y3((()=>JSON.parse(e.payload)),(e=>new Error(`JSON parsing failed: ${String(e)}`))),x.tS((e=>(0,c.zG)(v.decode(e),x.Vn((e=>new Error(`Validation failed: ${e.map((e=>e.message||"Validation error")).join(", ")}`)))))));if(x.nM(p))return t.error("Error parsing response payload:",p.left),{parsedExperts:o,textSummary:n,followUpTopics:a,payloadExperts:l,parsingError:p.left};const d=p.right;null!=(r=d.experts)&&r.suggested_experts&&(l=d.experts.suggested_experts,Array.from(new Map(null==(s=d.experts)?void 0:s.suggested_experts.map((e=>[m(e.expert_name),{kind:"reference",expertName:m(e.expert_name),expertInitials:m(e.expert_initials),topic:e.dimension||"",description:e.expert_role||"",isFullyLoaded:e.done||!1}]))).values()).forEach((e=>o.push(e)))),d.summary&&(n={kind:"markdown",content:d.summary}),null!=(i=d.experts)&&i.follow_up_categories&&(a=d.experts.follow_up_categories)}catch(e){t.error("Unexpected error during parsing:",e)}return{parsedExperts:o,textSummary:n,followUpTopics:a,payloadExperts:l}},U=(e,t,r,s)=>{try{const s=[...e];return t&&s.push(...t.filter((t=>!r.includes(m(t.expert_name))&&!e.some((e=>m(e.expert_name)===m(t.expert_name)))))),s}catch(e){s.error("Error parsing response payload:",e)}return e};var b=r(58303),y=r(80502),F=r(77115),L=r(47283),C=r(59833),P=r(24666),I=r(20161),q=r(36344),A=r(74822),G=r(99887),M=r(37108),k=r(52826),N=r(10883),R=r(63532),T=r(30346),Z=r(78129),z=r(57792),Y=r(86399);var V=Object.defineProperty,W=Object.getOwnPropertySymbols,O=Object.prototype.hasOwnProperty,X=Object.prototype.propertyIsEnumerable,$=(e,t,r)=>t in e?V(e,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):e[t]=r;const B=150,H="expertPanel";class j{constructor(e,t,r,s,u,g,x,m,f,E){this._pushedContentService=e,this._capiSession=t,this._trackingServiceProvider=r,this._requestHelper=s,this._textInfo=u,this._decorationService=g,this._agentId=x,this._log=i.C8.Logging.getLogger("ExpertPanelViewModelImpl"),this._subs=new n.w.Keeper,this._committedExperts=new Set,this._newExperts=new Set,this._mergedFollowUpExpertsResponse=b.YP,this.experts=o.h.create(new Map),this.threadTextItems=o.h.create([]),this.currentView=o.h.create("expertThread"),this.isAgentActive=o.h.create(!1),this.selectedExpert=o.h.create(b.YP),this.textSummary=o.h.create({}),this.followUpTopics=o.h.create([]),this.loadingState=new y.c,this.internalActions={startAgent:c.Q1,stopAgent:c.Q1,selectExpert:e=>{const t=this.experts.get().get(e);void 0!==t&&this.selectedExpert.set(b.ij(t))},deselectExpert:()=>{this.selectedExpert.set(b.YP)},removeExpert:e=>{this.experts.modify((t=>{const r=new Map(t);return r.delete(e),r})),this._committedExperts.delete(e),this._newExperts.delete(e),this._mergedFollowUpExpertsResponse=(0,c.zG)(this._mergedFollowUpExpertsResponse,b.UI((t=>t.filter((t=>t.expert_name!==e))))),(0,L.bE)(this._pushedContentService,e)},goToChooseExperts:()=>{this.currentView.set("chooseExperts")},goBackFromChooseExperts:()=>{this.experts.modify((e=>new Map([...e.entries()].filter((([e])=>!this._newExperts.has(e)))))),this._newExperts.clear(),this.currentView.set("expertThread")},reloadAgent:()=>{!this.loadingState.isLoadingMain.get()&&!this.loadingState.isLoadingFollowUpSuggestions.get()&&this._doInitialRequest()},addExpertsByTopic:e=>this._doExpertFollowUpRequest(e),addExpertsByUserInput:e=>this._doExpertFollowUpRequest(void 0,e),requestFollowUpSuggestions:()=>{const e=this._doSuggestionsFollowUpRequest();return this.currentView.set("expertThread"),e}},this.featureFlags=m;(()=>{const e=o.h.create(void 0);this.context={capiSessionId:e,tracking:this._trackingServiceProvider.getTrackingService(),textLength:this._textInfo.view((e=>e.charsCount)),expertsCount:this.experts.view((e=>e.size))},this._subs.push(this._capiSession.events.pipe(l.h(h.hX.is("session_started")),d.U((e=>e.sessionUuid))).subscribe((t=>e.set(t))))})(),(()=>{const e=a.a([this._capiSession.events.pipe(l.h((e=>"ready"===e.kind))),f.pipe(l.h((e=>!0===e))),this._textInfo.view((e=>e.wordsCount)).pipe(l.h((e=>e>=B)))]);this._subs.push(e.pipe(p.q(1)).subscribe((()=>{!this.loadingState.isLoadingMain.get()&&!this.loadingState.isLoadingFollowUpSuggestions.get()&&this._doInitialRequest()})))})(),this.featureFlags.usePushedContentRebasing&&this._subs.push(this._pushedContentService.rebaseItems(L.fl).subscribe()),this.commentsPerExpert=o.h.combine(this._pushedContentService.getCollection(L.fl),this.experts,L.RJ),this._subs.push(this._requestHelper),this.allSuggestionsCount=o.h.combine(this.commentsPerExpert,this.loadingState.isLoadingMain||this.loadingState.isLoadingFollowUpSuggestions,((e,t)=>{const r=Object.values(e).map((e=>e.length)).reduce(F.Sm,0);if(0!==r||!t)return r})),this._subs.push(this.experts.subscribe((e=>{this._clearSelectedExpertIfNoLongerAvailable(e)}))),this.state=o.h.combine(o.h.combine(this.loadingState.isLoadingMain,this.loadingState.isLoadingFollowUpExperts,this.loadingState.isLoadingFollowUpSuggestions,this.loadingState.mainLoadingError,this.loadingState.followUpExpertsLoadingError,this.loadingState.followUpSuggestionsLoadingError,this.loadingState.loadedExpertsNumber,((e,t,r,s,i,o,n)=>({isLoadingMain:e,isLoadingFollowUpExperts:t,isLoadingFollowUpSuggestions:r,mainLoadingError:s,followUpExpertsLoadingError:i,followUpSuggestionsLoadingError:o,loadedExpertsNumber:n}))),this.currentView,this._textInfo.view((e=>e.wordsCount)),o.h.combine(this.experts,this.textSummary,this.selectedExpert,this.commentsPerExpert,this.allSuggestionsCount,((e,t,r,s,i)=>({experts:e,textSummary:t,selectedExpert:r,commentsPerExpert:s,allSuggestionsCount:i}))),((e,t,r,s)=>{var i,o;if((0,c.zG)(e.mainLoadingError,b.Gg((e=>"fatalError"===e))))return{kind:"fatalError",title:"Something went wrong",description:"Please wait a moment, then try again.",canReload:!0};if((0,c.zG)(e.mainLoadingError,b.Gg((e=>"sensitivityError"===e))))return{kind:"fatalError",title:"Canâ€™t help with this text",description:"Expert Review is unavailable because the text may contain sensitive content. Try again with different text.",canReload:!0};if(e.isLoadingMain)return{kind:"loading",expertNames:Array.from(s.experts.values()).map((e=>e.expertName))};const n=r<B;if(n&&0===s.experts.size)return{kind:"notification",notification:"textTooShort",canReload:!1};const a=Object.values(s.commentsPerExpert).every((e=>0===e.length));if(!e.isLoadingMain&&0===e.loadedExpertsNumber&&a)return{kind:"notification",notification:b.Wi(e.mainLoadingError)?"noSuggestionsError":e.mainLoadingError.value,canReload:!0};if("chooseExperts"===t)return{kind:"chooseExperts",experts:s.experts,commentsPerExpert:s.commentsPerExpert,withFollowUpActions:null!=(i=this.featureFlags.followUpActions)&&i,withFreeformInput:null!=(o=this.featureFlags.followUpActionsFreeformInput)&&o,newExperts:this._newExperts,canRequestFollowUpSuggestions:!e.isLoadingFollowUpExperts,loadingFollowUpExperts:e.isLoadingFollowUpExperts,followUpExpertsLoadingError:e.followUpExpertsLoadingError};return((e,t)=>{for(var r in t||(t={}))O.call(t,r)&&$(e,r,t[r]);if(W)for(var r of W(t))X.call(t,r)&&$(e,r,t[r]);return e})({kind:"evaluation",notification:(0,c.zG)(e.mainLoadingError,b.g_((()=>e.loadedExpertsNumber>0&&0===s.experts.size?b.G("allExpertsRemoved"):b.YP),b.G),b.g_((()=>e.followUpSuggestionsLoadingError),b.G),b.g_((()=>n?b.G("textTooShort"):b.YP),b.G)),loadedExpertsCount:e.loadedExpertsNumber,loadingFollowUpSuggestions:e.isLoadingFollowUpSuggestions,canReload:!n&&!e.isLoadingFollowUpSuggestions&&!e.isLoadingMain},s)})),this.featureFlags.shouldAutoScrollToFirstVBar&&this._subs.push(function({state:e,commentsPerExpert:t,decorationService:r,agentId:s,isPanelOpen:o}){const n=i.C8.Logging.getLogger("autoScrollToFirstVBarForSelectedExpert");return e.pipe(l.h((e=>"evaluation"===e.kind)),d.U((e=>e.selectedExpert)),P.x(((e,t)=>{const r=(0,c.zG)(e,b.UI((e=>e.expertName))),s=(0,c.zG)(t,b.UI((e=>e.expertName)));return b.Eh({equals:(e,t)=>e===t}).equals(r,s)})),I.w((e=>{if(b.Wi(e))return n.debug("No active expert, skipping VBar focus mode"),r.setFocusMode(b.YP),r.removeAgentDecorations(s,z.Z.VbarCard),r.removeAgentDecorations(s,z.Z.Highlight),q.E;const i=new A.x,d=t.view(e.value.expertName).view((e=>e||[])).view(Y.YM),u=i.pipe(I.w((()=>d.pipe(l.h(b.Wi)))),p.q(1));return a.a([d.pipe(G.oA,p.q(1),M.Q(k.Z),N.M(o),R.b((([t,s])=>{s&&(n.debug(`Setting VBar focus mode for active expert: ${e.value.expertName}`),r.setFocusMode(b.G(z.Z.Vbar)),i.next())}))),u.pipe(R.b((()=>{n.debug(`Resetting VBar focus mode for completed expert: ${e.value.expertName}`),r.setFocusMode(b.YP)}))),o.pipe(T.E(),Z.G(),R.b((([e,t])=>{e&&!t&&(n.debug("Resetting VBar focus mode for closed panel"),r.setFocusMode(b.YP))})))])})))}({state:this.state,commentsPerExpert:this.commentsPerExpert,decorationService:this._decorationService,agentId:this._agentId,isPanelOpen:E}).subscribe())}_resetState(){this.isAgentActive.set(!0),this.experts.set(new Map),this.threadTextItems.set([]),this.textSummary.set({}),this.selectedExpert.set(b.YP),this.loadingState.setMainLoading(),(0,L.nI)(this._pushedContentService)}_clearSelectedExpertIfNoLongerAvailable(e){this.selectedExpert.modify(b.hX((t=>e.has(t.expertName))))}_getErrorTypeFromError(e){return e instanceof u.W?"timeoutError":e instanceof s.u&&e.kind===s.g.Sensitivity?"sensitivityError":"fatalError"}_doInitialRequest(){this._textInfo.get().wordsCount<B||(this._resetState(),this._requestHelper.cancelLastPendingRequest("start"),this._requestHelper.runRequest("start","",b.G({each:9e4,first:12e4}),(e=>{const{parsedExperts:t,textSummary:r,followUpTopics:s,parsingError:i}=S(e,this._log);if(this.experts.set(new Map(t.map((e=>[e.expertName,e])))),this.textSummary.set(r),this.followUpTopics.set(s),"final"===e.kind)if(void 0!==i)this.loadingState.setMainLoadedWithError("fatalError");else{const e=this._filterOnlyExpertsWithComments(this.experts.get());this.experts.set(e),this.loadingState.setMainLoaded(e.size),this._committedExperts=new Set(e.keys())}})).catch((e=>{this._log.error("Error starting expert panel agent:",e),this.loadingState.setMainLoadedWithError(this._getErrorTypeFromError(e))})))}_doExpertFollowUpRequest(e,t){return e||t?(this.loadingState.setFollowUpExpertsLoading(),this._requestHelper.runRequest("followUpExperts",JSON.stringify(e?{category:e}:{userInput:t}),b.G({each:9e4,first:12e4}),(t=>{const{parsedExperts:r,payloadExperts:s,parsingError:i}=S(t,this._log),o=(0,c.zG)(r,C.hX((e=>e.isFullyLoaded&&!this.experts.get().has(e.expertName))),C.GY,(e=>new Map(e.map((e=>[e.expertName,e]))))),n=new Map([...o,...this.experts.get()]),a=this.experts.get().size,l=n.size-a;if(this._newExperts=new Set([...this._newExperts,...o.keys()]),this.experts.set(n),"final"===t.kind){if(void 0!==i)return void(0===this._newExperts.size?this.loadingState.setFollowUpExpertsLoadedWithError("otherError"):this.loadingState.setFollowUpExpertsLoaded());e&&this.followUpTopics.modify((t=>t.filter((t=>t!==e)))),l>0||this._newExperts.size>0?this.loadingState.setFollowUpExpertsLoaded():this.loadingState.setFollowUpExpertsLoadedWithError("noFollowUpExperts"),this._mergedFollowUpExpertsResponse=(0,c.zG)(this._mergedFollowUpExpertsResponse,b.g_((()=>b.G(s)),(e=>b.G(U(e,s,[...this._committedExperts],this._log)))))}})).catch((e=>{this._log.error("Error executing expert follow up request:",e),this.loadingState.setFollowUpExpertsLoadedWithError(this._getErrorTypeFromError(e))}))):(this._log.warn("No category or user input provided for follow-up request"),Promise.resolve())}_doSuggestionsFollowUpRequest(){if(b.Wi(this._mergedFollowUpExpertsResponse)||0===this._mergedFollowUpExpertsResponse.value.length)return this._log.warn("No follow up experts response available for suggestions request"),Promise.resolve();this.loadingState.setFollowUpSuggestionsLoading(),this._committedExperts=new Set([...this._committedExperts,...this._newExperts]),this._newExperts.clear();const e=this._mergedFollowUpExpertsResponse.value;return this._mergedFollowUpExpertsResponse=b.YP,this._requestHelper.runRequest("followUpComments",JSON.stringify({suggested_experts:e}),b.G({each:9e4,first:12e4}),(e=>{if("final"===e.kind){const{textSummary:t,parsingError:r}=S(e,this._log);if(void 0!==r)return void this.loadingState.setFollowUpSuggestionsLoadedWithError("otherError");this.textSummary.set(t),this.loadingState.setFollowUpSuggestionsLoaded()}})).catch((e=>{this._log.error("Error executing follow up suggestions request:",e),this.loadingState.setFollowUpSuggestionsLoadedWithError(this._getErrorTypeFromError(e))}))}_filterOnlyExpertsWithComments(e){return(0,c.zG)(e,(e=>new Map(Array.from(e).filter((([e])=>{var t;return(null==(t=this.commentsPerExpert.get()[e])?void 0:t.length)>0})))))}[Symbol.dispose](){this._subs.dispose()}}},57792:(e,t,r)=>{r.d(t,{Z:()=>s});var s=(e=>(e.Underline="Underline",e.Highlight="Highlight",e.Card="Card",e.Vbar="Vbar",e.VbarCard="VbarCard",e.ParagraphHighlight="ParagraphHighlight",e))(s||{})},88012:(e,t,r)=>{r.d(t,{w:()=>s});var s,i=r(32073);(e=>{e.EMPTY=i.w0.EMPTY;e.Keeper=class{constructor(){this._subs=[]}push(...e){this._subs.push(...e)}dispose(){this._subs.forEach((e=>{"unsubscribe"in e?e.unsubscribe():e.dispose()})),this._subs=[]}}})(s||(s={}))},99887:(e,t,r)=>{r.d(t,{cp:()=>a,oA:()=>l});var s=r(58303),i=r(20161),o=r(24666),n=r(36344);function a(e){return(0,i.w)(s.g_((()=>n.E),e))}const l=a(r(84714).of);(0,o.x)(((e,t)=>s.Wi(e)&&s.Wi(t)||s.pC(e)&&s.pC(t)))},30346:(e,t,r)=>{r.d(t,{E:()=>a});var s=r(19064),i=r(96643),o=r(198),n=r(16537);function a(e,t){return(0,s.e)((function(r,s){var a=new Set;r.subscribe((0,i.x)(s,(function(t){var r=e?e(t):t;a.has(r)||(a.add(r),s.next(t))}))),t&&(0,n.Xf)(t).subscribe((0,i.x)(s,(function(){return a.clear()}),o.Z))}))}},78129:(e,t,r)=>{r.d(t,{G:()=>o});var s=r(19064),i=r(96643);function o(){return(0,s.e)((function(e,t){var r,s=!1;e.subscribe((0,i.x)(t,(function(e){var i=r;r=e,s&&t.next([i,e]),s=!0})))}))}},18519:(e,t,r)=>{r.d(t,{V:()=>u,W:()=>d});var s=r(25941),i=r(11203),o=r(19064),n=r(16537),a=r(3148),l=r(96643),p=r(20610),d=(0,a.d)((function(e){return function(t){void 0===t&&(t=null),e(this),this.message="Timeout has occurred",this.name="TimeoutError",this.info=t}}));function u(e,t){var r=(0,i.q)(e)?{first:e}:"number"==typeof e?{each:e}:e,a=r.first,d=r.each,u=r.with,g=void 0===u?h:u,c=r.scheduler,x=void 0===c?null!=t?t:s.z:c,m=r.meta,f=void 0===m?null:m;if(null==a&&null==d)throw new TypeError("No timeout provided.");return(0,o.e)((function(e,t){var r,s,i=null,o=0,u=function(e){s=(0,p.f)(t,x,(function(){try{r.unsubscribe(),(0,n.Xf)(g({meta:f,lastValue:i,seen:o})).subscribe(t)}catch(e){t.error(e)}}),e)};r=e.subscribe((0,l.x)(t,(function(e){null==s||s.unsubscribe(),o++,t.next(i=e),d>0&&u(d)}),void 0,void 0,(function(){(null==s?void 0:s.closed)||null==s||s.unsubscribe(),i=null}))),!o&&u(null!=a?"number"==typeof a?a:+a-x.now():d)}))}function h(e){throw new d(e)}},52826:(e,t,r)=>{r.d(t,{Z:()=>l});var s=r(5972),i=r(49571),o=r(32073),n={schedule:function(e){var t=requestAnimationFrame,r=cancelAnimationFrame,s=n.delegate;s&&(t=s.requestAnimationFrame,r=s.cancelAnimationFrame);var i=t((function(t){r=void 0,e(t)}));return new o.w0((function(){return null==r?void 0:r(i)}))},requestAnimationFrame:function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];var r=n.delegate;return((null==r?void 0:r.requestAnimationFrame)||requestAnimationFrame).apply(void 0,(0,s.ev)([],(0,s.CR)(e)))},cancelAnimationFrame:function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];var r=n.delegate;return((null==r?void 0:r.cancelAnimationFrame)||cancelAnimationFrame).apply(void 0,(0,s.ev)([],(0,s.CR)(e)))},delegate:void 0},a=function(e){function t(t,r){var s=e.call(this,t,r)||this;return s.scheduler=t,s.work=r,s}return(0,s.ZT)(t,e),t.prototype.requestAsyncId=function(t,r,s){return void 0===s&&(s=0),null!==s&&s>0?e.prototype.requestAsyncId.call(this,t,r,s):(t.actions.push(this),t._scheduled||(t._scheduled=n.requestAnimationFrame((function(){return t.flush(void 0)}))))},t.prototype.recycleAsyncId=function(t,r,s){var i;if(void 0===s&&(s=0),null!=s?s>0:this.delay>0)return e.prototype.recycleAsyncId.call(this,t,r,s);var o=t.actions;null!=r&&r===t._scheduled&&(null===(i=o[o.length-1])||void 0===i?void 0:i.id)!==r&&(n.cancelAnimationFrame(r),t._scheduled=void 0)},t}(i.o),l=new(function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return(0,s.ZT)(t,e),t.prototype.flush=function(e){var t;this._active=!0,e?t=e.id:(t=this._scheduled,this._scheduled=void 0);var r,s=this.actions;e=e||s.shift();do{if(r=e.execute(e.state,e.delay))break}while((e=s[0])&&e.id===t&&s.shift());if(this._active=!1,r){for(;(e=s[0])&&e.id===t&&s.shift();)e.unsubscribe();throw r}},t}(r(16677).v))(a)}}]);
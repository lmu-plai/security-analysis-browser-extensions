(self.webpackChunk=self.webpackChunk||[]).push([[8105],{43324:(t,e,i)=>{i.r(e),i.d(e,{Outlook:()=>A,getInjectionLayoutForGButtonInSendContainer:()=>R,getInjectionLayoutForStickyGButtonOnTheBottom:()=>P,getVBarsIntegrationInfo:()=>T});var o=i(59179),n=i(954),r=i(58303),s=i(49629),l=i(9194),a=i(31394),u=i(68418),c=i(63866),d=i(44287),g=i(18647),p=i(22234),m=i(96075),h=i(20161),y=i(84308),f=i(84766),S=i(14969),_=i(91089),b=i(31603),E=i(90572),v=i(24666),x=i(32073),C=i(45523),B=i(40594);class k{constructor(){this._logger=B.Y.create("NativeSuggestionsToggler"),this._elementsSubs=null,this._squigglers=[]}set ctx(t){this._ctx=t}static getInstance(t){return this._instance||(this._instance=new k),this._instance.ctx=t,this._instance}static _isElementNode(t){return t.nodeType===Node.ELEMENT_NODE}_waitForSquigglers(){return this._ctx.field.parentElement?C.x.create(this._ctx.field.parentElement,{childList:!0}).pipe(n.O([{target:this._ctx.field.parentElement,type:"childList"}]),h.w((t=>{for(const e of t)if("childList"===e.type&&k._isElementNode(e.target)){const t=Array.from(e.target.querySelectorAll("div.ms-editor-squiggler"));return y.a(t.map((t=>f.F(100).pipe(o.U((()=>t.shadowRoot)),S.P((t=>Boolean(t)))))))}return _.C})),h.w((t=>y.a(t.map((t=>{const e=t.querySelector("div");return e?C.x.create(e,{childList:!0}).pipe(n.O([{target:e,type:"childList"}])):_.C}))).pipe(b.J()))),o.U((t=>{for(const e of t)if("childList"===e.type&&k._isElementNode(e.target)){const t=e.target.querySelectorAll('span[role="status"]');return t?Array.from(t):null}return null})),E.h((t=>Boolean(t))),o.U((t=>t.filter((t=>"none"!==t.style.display)))),E.h((t=>t.length>0)),v.x(((t,e)=>t.reduce(((t,e)=>t+e.style.display),"")===e.reduce(((t,e)=>t+e.style.display),"")))):_.C}_waitForEditorCard(){return C.x.create(this._ctx.field.ownerDocument.documentElement,{childList:!0}).pipe(o.U((t=>{var e;for(const i of t)if("childList"===i.type&&k._isElementNode(i.target))return null!==(e=i.target.querySelector("editor-card"))&&void 0!==e?e:null;return null})),S.P((t=>Boolean(t))))}_waitForPremiumBadge(){return this._ctx.field.parentElement?C.x.create(this._ctx.field.parentElement,{childList:!0}).pipe(o.U((t=>{var e,i,o,n;for(const r of t)if("childList"===r.type&&k._isElementNode(r.target)){const t=r.target.querySelector('button[type="button"] > span > i[data-icon-name="Diamond"]');return null!==(n=null===(o=null===(i=null===(e=null==t?void 0:t.parentElement)||void 0===e?void 0:e.parentElement)||void 0===i?void 0:i.parentElement)||void 0===o?void 0:o.parentElement)&&void 0!==n?n:null}return null})),E.h((t=>Boolean(t))),E.h((t=>"none"!==t.style.display)),v.x(((t,e)=>t.style.display===e.style.display))):_.C}hideSuggestions(){this._elementsSubs=new x.w0,this._elementsSubs.add(this._waitForSquigglers().subscribe((t=>{t&&(this._logger.trace("Hiding Outlook's native suggestions underlines.",t),this._squigglers=this._squigglers.concat(t),this._originalSquigglerDisplayStyle||(this._originalSquigglerDisplayStyle=t[0].style.display),this._squigglers.forEach((t=>{t.style.display="none"})))}))),this._elementsSubs.add(this._waitForEditorCard().subscribe((t=>{t&&(this._logger.trace("Hiding Outlook's native suggestions cards."),this._editorCard=t,this._originalEditorCardDisplayStyle=this._editorCard.style.display,this._editorCard.style.display="none")}))),this._elementsSubs.add(this._waitForPremiumBadge().subscribe((t=>{t&&(this._logger.trace("Hiding Outlook's native suggestions premium badge."),this._premiumBadge=t,this._originalPremiumBadgeDisplayStyle=this._premiumBadge.style.display,this._premiumBadge.style.display="none")})))}showSuggestions(){var t;this._squigglers.length>0&&(this._logger.trace("Restoring Outlook's native suggestions underlines."),this._squigglers.forEach((t=>{t.style.display=this._originalSquigglerDisplayStyle}))),this._editorCard&&(this._logger.trace("Restoring Outlook's native suggestions cards."),this._editorCard.style.display=this._originalEditorCardDisplayStyle),this._premiumBadge&&(this._logger.trace("Restoring Outlook's native suggestions premium badge."),this._premiumBadge.style.display=this._originalPremiumBadgeDisplayStyle),null===(t=this._elementsSubs)||void 0===t||t.unsubscribe(),this._elementsSubs=null}}var q,w=i(85452),L=i(47557);!function(t){const e=t=>"BLOCKQUOTE"===t.tagName&&(0,L.Re)(t)&&""!==t.style.borderLeft;t.createEditorTextMap=t=>w.Z.create(t,{andNodeFormatting:(t,i)=>"BLOCKQUOTE"===t.tagName?e(t)?{...i,blockquote:!0}:{...i}:"Signature"===t.id?{...i,signature:!0}:w.Z.defaultNodeFormatting(t,i),overrideFilterNode:(t,i)=>w.Z.defaultFilterNodeAllowingBlockquote(t,i)&&!e(t)})}(q||(q={}));var O,F=i(25292);!function(t){t.getAuthorDomain=function(){const t=document.querySelector('[href*="https://outlook.com?login_hint"]');if(t){const e=F.X.getDomainFromEmail(decodeURIComponent(t.href));if(e)return e}const e=document.querySelector("[id*=primaryMailboxRoot_]");if(e){const t=F.X.getDomainFromEmail(e.id);if(t)return t}return null}}(O||(O={}));var D=i(18122),I=i(36769),M=i(3670);const N=B.Y.create("universal.cs.integration.rules.mail.outlook"),T=(t,e)=>r.G({kind:"outlook",integrationName:t,domain:e.pageContext.domain,isInsideIFrame:!1});var A;!function(t){t.page=(0,M.$W)({name:"outlook",domain:D.ph},[p.T.contentEditable("Outlook",(t=>({createLayout:t=>{var e;const i=(0,I.Cq)((0,g.wr)(t,(t=>t.classList.contains("owaMailComposeEditorScrollContainer")&&t.classList.contains("customScrollBar")||t.classList.contains("owaMailComposeEditorScrollContainer")))),o=i.querySelector("[data-testid=ComposeSendButton]")||i.querySelector("div[aria-label='Send'][role='button']")||(null===(e=i.querySelector('button[type="button"].ms-Button.ms-Button--primary.ms-Button--hasMenu'))||void 0===e?void 0:e.closest('div[role="button"]'))||i.querySelector(".fui-SplitButton")||document.querySelector("[data-testid=ComposeSendButton]")||document.querySelector(".fui-SplitButton");o||N.warn("Outlook Send button not found in compose area.");const n=(0,g.bp)((0,I.Cq)(o,"Outlook Send button not found")),r=U(n),s=j(r,n);return new d.A7(t,{scroller:(0,c.z)(i)||t,...s,transformElement:{getValue:(t,e)=>(0,g.f0)(i,e),getIndicator:()=>i}})},customizations:{richText:l.kn.isAvailable(t),applyFormatting:!0},textMap:{createFieldTextMap:q.createEditorTextMap},onCreate:()=>k.getInstance(t).hideSuggestions(),onDispose:()=>k.getInstance(t).showSuggestions(),getFromEmailDomainAndSignature:t=>function(t){const e=O.getAuthorDomain(),i=F.X.getSignature(t);return{fromEmailDomain:e,emailSignature:i}}(t),getVBarsIntegrationInfo:e=>T(e,t)}))),p.T.textarea("Outlook",(t=>({createLayout:()=>new d.A7(t.field,{gbuttonMinPadding:m.rR}),textMap:{createFieldTextMap:q.createEditorTextMap}})))])}(A||(A={}));const U=t=>{const e=getComputedStyle(t);return"sticky"===e.position&&"0px"===e.top?"topSticky":"sticky"===e.position&&"0px"===e.bottom?"bottomSticky":"unknown"},P=()=>({highlightsLayoutOptions:{fixUIGlitchesByForcingStackingContext:!0}}),R=t=>({customGbuttonPositioning:{injectionElement:t,injectionStyle:{top:"0",right:"0"},createPositionStyleBehavior:t=>t.pipe(o.U((t=>({position:"absolute",transform:"translate(0, -100%)",width:"auto",height:"auto",pointerEvents:"all",right:-t.left+"px",top:`${t.top}px`})))),calculateMetrics:(t,e,i)=>{const o=u.p8.create({top:i.top,left:t.size.width+i.left});return{offset:o,page:u.Cv.fromOffset(o,u.Cv.fromClient(t.client,{top:e.scrollY,left:e.scrollX}),{top:0,left:0}),client:u.Ir.create(u.E9.plus(t.client,o)),effectivePadding:{top:0,right:14,bottom:14,left:0},size:a.V.gButtonMaxSize}},createShiftBehavior:()=>s.S.sec1.pipe(o.U((()=>document.querySelector('button[aria-label*="Microsoft Editor"]')?{top:-11,left:-50}:{top:-14,left:-14})),n.O({top:-14,left:-14}))}}),j=(t,e)=>"unknown"===t?{}:"topSticky"===t?P():R(e)},25292:(t,e,i)=>{i.d(e,{X:()=>o});var o,n=i(95869);!function(t){t.getSignature=function(t){const e=[];t.getRichText().eachLine(((t,i)=>(!0===i.signature&&e.push(t),!0)));const i=e.map((t=>t.ops.reduce(((t,e)=>n.s.isInsertString(e)&&e.insert?t+e.insert:t),"")));return i.length?i.join(";"):null},t.getDomainFromEmail=function(t){const e=t.indexOf("@");return e>=0?t.substring(e+1):null}}(o||(o={}))}}]);
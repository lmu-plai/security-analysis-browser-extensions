(self.webpackChunk=self.webpackChunk||[]).push([[6144],{36144:(e,r,t)=>{t.r(r),t.d(r,{activate:()=>D});var i,n,o,s=t(32073),a=t(90572),c=t(59179),d=t(84714),u=t(58303),p=t(90023),v=t(28338),l=t(84197),g=t(35020),S=t(67177),b=t(12518),h=t(78123),f=t(39736),m=t(16395),C=t(48422),k=t(14930),y=t(88028),w=t(10941),A=t(24300),I=t(2577),P=t(13391),O=t(11087),x=t(559),B=t(77115),V=Object.defineProperty,E=Object.defineProperties,j=Object.getOwnPropertyDescriptors,F=Object.getOwnPropertySymbols,G=Object.prototype.hasOwnProperty,M=Object.prototype.propertyIsEnumerable,U=(e,r,t)=>r in e?V(e,r,{enumerable:!0,configurable:!0,writable:!0,value:t}):e[r]=t;(n=i||(i={})).Id=h.Rn,n.create=e=>{const r=(0,I.j)(),t=e.decorationService.createDecorationFactory(n.Id),i=e.experimentationBridge.isAssigned(l.RK);r.debug("Checking if underlines should be kept",{shouldKeepUnderlines:i});const s=e.initNavigation(n.Id,i?f.r.Regular:f.r.SingleThread),d=C.Z.create({capiSessionStarted:e.capiSession.events.pipe((0,a.h)(x.hX.is("session_started")),(0,c.U)((e=>({sessionId:e.sessionUuid})))),capiConnectionEvents:e.capiSession.events.pipe((0,a.h)((0,B.Kg)(x.hX.is("connect"),x.hX.is("disconnect")))),agenticService:o.create({agentGenericService:e.agentGenericService,pushedContentService:e.pushedContentService}),isPanelOpen:s.isPanelOpen,featureFlags:{customVoice:e.experimentationBridge.isAssigned(l.zg),focusCard:e.experimentationBridge.isAssigned(l.Wd),aiChat:e.experimentationBridge.isAssigned(l.Q1)},editor:e.editor,trackingServiceProvider:e.trackingServiceProvider,decorationService:e.decorationService,fileUploadService:e.fileUploadService}),v=e=>{var r;return y.h.isWithRewrite(e)?null!=(r=e.surface.explanation)?r:e.surface.title:void 0},g=w.pS.create({agentId:n.Id,pushedContentService:e.pushedContentService,vbarFeedbackService:e.vbarFeedbackService,trackingServiceProvider:e.trackingServiceProvider,decorationsFactory:t,decorationService:e.decorationService,uphookHubClient:e.uphookHubClient,isActive:s.isPanelOpen,getDecorationFactory:k.p,itemsFilter:d.selectedMode.view((e=>r=>(0,A.B)(r)&&(0,p.zG)(e,u.Gg((e=>r.surface.sourceAction===e.sourceAction))))),agentMetadataSource:e=>(0,A.B)(e)?{sourceAction:e.surface.sourceAction}:void 0,vbarRenderOverrides:{getCardTitle:v,getVBarProps:(e,r)=>((e,r)=>E(e,j(r)))(((e,r)=>{for(var t in r||(r={}))G.call(r,t)&&U(e,t,r[t]);if(F)for(var t of F(r))M.call(r,t)&&U(e,t,r[t]);return e})({},e),{primaryText:v(r)}),getCardIcon:()=>({icon:O.y,size:"medium"})},trustedRewrite:p.jv});return{agent:{id:n.Id,decorations:m.dX.Collection.create(n.Id,{pushedContent:g}),viewModel:d,dispose:()=>{d.dispose()}},isAvailable:P.h.create(!0)}},(e=>{e.create=e=>{const{agentGenericService:r,pushedContentService:t}=e,n=(0,I.j)("AgenticService"),o=t.getCollection(A.B),s=()=>g.$.values(o.get()),a=e=>(0,A.f)(e,s()),c=o.view((()=>s()));return{getModes:()=>(0,p.zG)(r.request({commandId:"start",payload:"",agentId:i.Id}),S.Vn((e=>(n.error("Error requesting evaluation",e),e))),S.tS((e=>(n.debug("Received evaluation response",e),(0,p.zG)(S.Uo(h.OB.decode(e.payload)),S.Vn((e=>(n.error("Error decoding evaluation",e),e))),S.UI((e=>(n.debug("Decoded evaluation response",e),e)))))))),getRewrites:(e,t=!1)=>{const o=a(e);return!t&&o.length>0?(n.debug("Skipping request - VBars already exist for mode and force is false"),S.F2(void 0)):S.Y3((()=>r.requestWithStreaming({commandId:"triggerMode",payload:JSON.stringify({modeId:e.id}),agentId:i.Id})().then((e=>(0,p.zG)(e,b.pF((e=>{throw e}))))).then((e=>new Promise(((r,t)=>{e.subscribe((e=>{(0,p.zG)(e,b.g_((e=>{n.error("Error requesting pushed content:",e),t(e)}),(e=>{n.debug("Received pushed content response",e),"final"===e.kind&&r(void 0)})))}))}))))),b.KC)},clearVBars:()=>{n.debug("Clearing the Paraphraser VBars"),t.clear(A.B)},getCurrentVBars:s,getCurrentVBarsForMode:a,currentVBars:c}}})(o||(o={}));var R=(e,r)=>(r=Symbol[e])?r:Symbol.for("Symbol."+e),z=e=>{throw TypeError(e)};const D=e=>{return r=void 0,t=[e],i=function*({bus:e,navigation:r,capiConnectionStatus:t,agentGenericService:i,pushedContentService:n,experimentation:g,document:S,fileUploadService:b,trackingServiceProvider:f}){var m=[];try{const w=((e,r,t)=>{var i;return null!=r?("object"!=typeof r&&"function"!=typeof r&&z("Object expected"),t&&(i=r[R("asyncDispose")]),void 0===i&&(i=r[R("dispose")]),"function"!=typeof i&&z("Object not disposable"),e.push([t,i,r])):t&&e.push([t]),r})(m,new DisposableStack),A=w.adopt(new s.w0,(e=>e.unsubscribe())),I=w.use(e.state.agentState.create(S.id,{kind:h.ZM.Kind.Initial})),P=w.use(e.state.capiSessionId.create(S.id,null)),O=w.use(e.state.wordCount.create(S.id,0)),x=w.adopt(C.Z.create({capiSessionStarted:t.pipe(a.h((e=>"connected"===e.kind)),c.U((e=>({sessionId:e.sessionId})))),capiConnectionEvents:t.view((e=>"connected"===e.kind?{kind:"connect"}:"disconnected"===e.kind?{kind:"disconnect"}:null)).pipe(a.h(B.C_)),agenticService:o.create({agentGenericService:i,pushedContentService:n}),isPanelOpen:r.isPanelOpen,featureFlags:{customVoice:g.isAssigned(l.zg),focusCard:g.isAssigned(l.Wd),aiChat:g.isAssigned(l.Q1)},editor:{changes:S.textChanges,getContents:()=>S.getText()},trackingServiceProvider:f,decorationService:{setFocusMode:p.Q1,focusModeDecorationType:d.of(u.YP),removeAgentDecorations:p.Q1},fileUploadService:b}),(e=>e.dispose()));return A.add(x.state.subscribe((e=>I.set(e)))),A.add(t.pipe(a.h((e=>"connected"===e.kind))).subscribe((e=>P.set(e.sessionId)))),A.add(x.context.textWordsCount.subscribe((e=>O.set(e)))),A.add(e.events.trackingEvent.view(S.id).subscribe((e=>x.context.tracking.trackEvent(e.event,e.detail)))),A.add(e.events.panelUIAction.view(S.id).subscribe((e=>{switch(e.kind){case"executeModeAction":x.executeMode(e.modeId);break;case"editCustomVoiceAction":x.editCustomVoice();break;case"saveCustomVoiceAction":x.saveCustomVoice(e.voiceName,e.content);break;case"removeCustomVoiceAction":x.removeCustomVoice(e.voiceName);break;case"reloadAgentAction":x.reloadAgent();break;case"goBackAction":x.goBack(e.previousState);break;default:(0,v.L0)(e)}}))),w.move()}catch(e){var k=e,y=!0}finally{((e,r,t)=>{var i="function"==typeof SuppressedError?SuppressedError:function(e,r,t,i){return(i=Error(t)).name="SuppressedError",i.error=e,i.suppressed=r,i},n=e=>r=t?new i(e,r,"An error was suppressed during disposal"):(t=!0,e),o=i=>{for(;i=e.pop();)try{var s=i[1]&&i[1].call(i[2]);if(i[0])return Promise.resolve(s).then(o,(e=>(n(e),o())))}catch(e){n(e)}if(t)throw r};o()})(m,k,y)}},new Promise(((e,n)=>{var o=e=>{try{a(i.next(e))}catch(e){n(e)}},s=e=>{try{a(i.throw(e))}catch(e){n(e)}},a=r=>r.done?e(r.value):Promise.resolve(r.value).then(o,s);a((i=i.apply(r,t)).next())}));var r,t,i}}}]);
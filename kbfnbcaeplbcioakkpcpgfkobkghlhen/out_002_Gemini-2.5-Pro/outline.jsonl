{"file":"src/js/Grammarly-bg.js","beautified":"src/js/Grammarly-bg.beautified.js","chunk":{"id":"chunk-1/46","start_line":1,"end_line":2000,"same_function_group":null},"findings":{"chrome_apis":[],"event_listeners":[],"messages":[{"name":"Internal RPC/messaging framework","direction":"other","payload_keys":[]}],"storage":[],"endpoints":[],"dom":[],"dynamic_code":[],"wasm":[],"obfuscation_hints":["webpack_modules"],"risks":[]},"evidence":[{"file":"src/js/Grammarly-bg.js","start":1,"end":2000}],"notes":"Webpack module bootstrap and internal RPC/messaging framework setup. Defines abstractions for events, state management, and services between components. Defines feature flags and modules for AI features like Paraphraser, Humanizer, and Expert Panel."}
{"file":"src/js/Grammarly-bg.js","beautified":"src/js/Grammarly-bg.beautified.js","chunk":{"id":"chunk-2/46","start_line":2001,"end_line":4000,"same_function_group":null},"findings":{"chrome_apis":[],"event_listeners":[],"messages":[],"storage":[],"endpoints":[],"dom":[],"dynamic_code":[],"wasm":[],"obfuscation_hints":[],"risks":[]},"evidence":[{"file":"src/js/Grammarly-bg.js","start":2001,"end":4000}],"notes":"This chunk defines data models and logic for managing different types of alerts, such as 'Default', 'Plagiarism', 'Super', 'Takeaway', 'ShortenIt', 'ToneAI', and 'EthicalAI'. It includes classes for managing alert ranges (`L` class) and alternatives (`U` class). It also defines how alerts are created, updated, and transitioned between states (e.g., 'registered', 'applied', 'removed')."}
{"file":"src/js/Grammarly-bg.js","beautified":"src/js/Grammarly-bg.beautified.js","chunk":{"id":"chunk-3/46","start_line":4001,"end_line":6000,"same_function_group":null},"findings":{"chrome_apis":[],"event_listeners":[],"messages":[],"storage":[],"endpoints":[{"url":"https://properties.qagr.io","method":"GET/POST","purpose":"Experimentation properties"},{"url":"https://treatment.qagr.io","method":"POST","purpose":"A/B testing treatment retrieval"},{"url":"https://gates.qagr.io","method":"POST","purpose":"Feature gate retrieval"}],"dom":[],"dynamic_code":[],"wasm":[],"obfuscation_hints":["minified_vars","function_chains","api_client_patterns"],"risks":[]},"evidence":[{"file":"/Users/jfri/Downloads/kbfnbcaeplbcioakkpcpgfkobkghlhen/src/js/Grammarly-bg.js","start":4873,"end":4873},{"file":"/Users/jfri/Downloads/kbfnbcaeplbcioakkpcpgfkobkghlhen/src/js/Grammarly-bg.js","start":5457,"end":5457}],"notes":"This chunk defines the data models for different 'Alert' types (writing suggestions), UI interaction events, and the document context (domain, goals). It also contains a client for a remote A/B testing and feature gating service, revealing endpoints for fetching experiment treatments and feature flags."}
{"file":"src/js/Grammarly-bg.js","beautified":"src/js/Grammarly-bg.beautified.js","chunk":{"id":"chunk-4/46","start_line":6001,"end_line":8000,"same_function_group":null},"findings":{"chrome_apis":[],"event_listeners":[],"messages":[],"storage":[],"endpoints":[],"dom":[],"dynamic_code":[],"wasm":[],"obfuscation_hints":["minified_vars","webpack_modules","api_client_patterns"],"risks":[]},"evidence":[{"file":"/Users/jfri/Downloads/kbfnbcaeplbcioakkpcpgfkobkghlhen/src/js/Grammarly-bg.js","start":6001,"end":8000}],"notes":"This chunk contains a custom reactive state management library, similar in concept to RxJS, with classes like Atom, Lens, and View for managing and observing application state. It also includes the remainder of the TreatmentService for the A/B testing framework and a large, generated API client for a service called 'Uphookhub', which seems to be for configuring and tracking UI elements ('uphooks')."}
{"file":"src/js/Grammarly-bg.js","beautified":"src/js/Grammarly-bg.beautified.js","chunk":{"id":"chunk-5/46","start_line":8001,"end_line":10000,"same_function_group":null},"findings":{"chrome_apis":[],"event_listeners":[],"messages":[],"storage":[],"endpoints":[],"dom":[],"dynamic_code":[],"wasm":[],"obfuscation_hints":["typescript_generated_enums", "api_client_patterns", "api_middleware"],"risks":[]},"evidence":[{"file":"src/js/Grammarly-bg.js","start":8001,"end":10000,"ast_id":null}],"notes":"Chunk 5/46 of Grammarly-bg.js. Contains extensive enum definitions for the UphookhubApi client, defining UI slots, names, and variants for dynamic UI rendering and A/B testing. Also includes the base implementation for the API client (BaseAPI, Configuration) and a specific 'VitoApi' client for handling subscriptions and plans."}
{"file":"src/js/Grammarly-bg.js","beautified":"src/js/Grammarly-bg.beautified.js","chunk":{"id":"chunk-6/46","start_line":10001,"end_line":12000,"same_function_group":null},"findings":{"chrome_apis":[],"event_listeners":[],"messages":[],"storage":[],"endpoints":[],"dom":[],"dynamic_code":[],"wasm":[],"obfuscation_hints":["api_client_patterns", "typescript_generated_enums"],"risks":[]},"evidence":[{"file":"src/js/Grammarly-bg.js","start":10001,"end":12000,"ast_id":null}],"notes":"Chunk 6/46 of Grammarly-bg.js. This chunk is dominated by the data models and type definitions for the core 'Alert' object, which represents a writing suggestion. It includes detailed structures for highlights, alternatives, and various alert properties. It also contains logic for discriminating between different alert types (e.g., 'capi', 'autocorrect') and for ordering and conflict resolution between alerts. This points to a sophisticated, type-safe data handling layer for the extension's main functionality."}
{"file":"src/js/Grammarly-bg.js","beautified":"src/js/Grammarly-bg.beautified.js","chunk":{"id":"chunk-7/46","start_line":12001,"end_line":14000,"same_function_group":null},"findings":{"chrome_apis":[],"event_listeners":[],"messages":[],"storage":[],"endpoints":[],"dom":[{"type":"sanitization","sink":"DOMPurify"}],"dynamic_code":[],"wasm":[],"obfuscation_hints":["generated_apis"],"risks":[{"type":"other","severity":"low","description":"Contains a full implementation of DOMPurify, a library for sanitizing HTML to prevent XSS. This is a defensive measure."}],"notes":"This chunk contains a dynamic feature loading system, the 'Ethical AI' feature implementation, text diffing utilities (diff-match-patch), and the DOMPurify library for security. The Ethical AI feature logs analytics and has special handling for a 'Stand With Ukraine' alert. It also includes functional programming utilities for Either and Array types."},"evidence":[{"file":"src/js/Grammarly-bg.js","start":12001,"end":14000,"ast_id":null}]}
{"file":"src/js/Grammarly-bg.js","beautified":"src/js/Grammarly-bg.beautified.js","chunk":{"id":"chunk-8/46","start_line":14001,"end_line":16000,"same_function_group":null},"findings":{"chrome_apis":[],"event_listeners":[],"messages":[],"storage":[],"endpoints":[],"dom":[],"dynamic_code":[],"wasm":[],"obfuscation_hints":["generated_apis"],"risks":[],"notes":"This chunk is composed almost entirely of functional programming utility functions for types like `Either`, `Option` (Maybe), `IO`, `IOEither`, `Reader`, and `Array`. It defines common interfaces and combinators (e.g., `map`, `chain`, `ap`, `fold`, `filter`, `partition`) for these data structures. It also includes utilities for creating and composing `Eq` (equality) and `Ord` (ordering) instances. This indicates a strong adherence to a functional programming style for handling data, state, and side-effects in a composable and predictable way."},"evidence":[{"file":"src/js/Grammarly-bg.js","start":14001,"end":16000,"ast_id":null}]}
{"file":"src/js/Grammarly-bg.js","beautified":"src/js/Grammarly-bg.beautified.js","chunk":{"id":"chunk-9/46","start_line":16001,"end_line":18000,"same_function_group":null},"findings":{"chrome_apis":[],"event_listeners":[],"messages":[],"storage":[],"endpoints":[],"dom":[],"dynamic_code":[],"wasm":[],"obfuscation_hints":["generated_apis"],"risks":[],"notes":"This chunk is almost entirely composed of the `io-ts` library and its dependencies. `io-ts` is a library for runtime type validation, decoding, and encoding of data. It includes definitions for `Task`, `TaskEither`, and `These` data structures, as well as codecs for all primitive and complex types (`string`, `number`, `array`, `union`, `intersection`, `type`, `partial`). This indicates a strong, type-safe, and functional approach to handling data from external sources. The presence of this library is a strong indicator of a mature and robust codebase focused on data integrity."},"evidence":[{"file":"src/js/Grammarly-bg.js","start":16001,"end":18000,"ast_id":null}]}
{"file":"src/js/Grammarly-bg.js","beautified":"src/js/Grammarly-bg.beautified.js","chunk":{"id":"chunk-10/46","start_line":18001,"end_line":20000,"same_function_group":null},"findings":{"chrome_apis":[],"event_listeners":[],"messages":[],"storage":[],"endpoints":[],"dom":[],"dynamic_code":["io-ts library functions","monocle-ts library functions","Levenshtein distance function"],"wasm":[],"obfuscation_hints":["minified_vars","function_chains"],"risks":[]},"evidence":[{"file":"/Users/jfri/Downloads/kbfnbcaeplbcioakkpcpgfkobkghlhen/src/js/Grammarly-bg.js","start":18001,"end":20000,"ast_id":null}],"notes":"This chunk continues the bundled 'io-ts' library for runtime type validation and introduces the 'monocle-ts' library for immutable data manipulation using optics (Lenses, Prisms). A Levenshtein distance function is also present, likely for text diffing or suggestions. This reinforces the functional programming architecture."}
{"file":"src/js/Grammarly-bg.js","beautified":"src/js/Grammarly-bg.beautified.js","chunk":{"id":"chunk-11/46","start_line":20001,"end_line":22000,"same_function_group":null},"findings":{"chrome_apis":[],"event_listeners":[],"messages":[],"storage":[],"endpoints":[],"dom":[],"dynamic_code":["ONNX model parsing library","WasmBinding for WebAssembly","GLSL shader utilities"],"wasm":["WasmBinding"],"obfuscation_hints":["minified_vars","protobuf_definitions"],"risks":[]},"evidence":[{"file":"/Users/jfri/Downloads/kbfnbcaeplbcioakkpcpgfkobkghlhen/src/js/Grammarly-bg.js","start":20001,"end":22000,"ast_id":null}],"notes":"This chunk contains a bundled library for parsing and handling ONNX (Open Neural Network Exchange) models. It includes full protobuf definitions for the ONNX format (ModelProto, GraphProto, TensorProto). It also contains a 'WasmBinding' and GLSL utilities, strongly suggesting the extension runs ML models in the browser using WebAssembly or WebGL for high-performance inference. This is a major architectural finding."}
{"file":"/Users/jfri/Downloads/kbfnbcaeplbcioakkpcpgfkobkghlhen/src/js/Grammarly-bg.js","beautified":"/Users/jfri/Downloads/kbfnbcaeplbcioakkpcpgfkobkghlhen/src/js/Grammarly-bg.beautified.js","chunk":{"id":"chunk-12/46","start_line":22001,"end_line":24000,"same_function_group":null},"findings":{"chrome_apis":[],"event_listeners":[],"messages":[],"storage":[],"endpoints":[],"dom":[],"dynamic_code":[],"wasm":[],"obfuscation_hints":["webpack_modules","minified_vars"],"risks":[],"onnx_runtime":{"protobuf_definitions":["TypeProto","OperatorSetIdProto"],"backend":"WebGL","cpu_operators":["CpuArgMax","CpuBatchNormalization","CpuBinaryOp","CpuConcat","CpuConv","CpuDropout","CpuFlatten","CpuGather","CpuGemm","CpuGlobalAveragePool","CpuGlobalMaxPool","CpuImageScaler","CpuInstanceNormalization","CpuLrn","CpuMatMul","CpuPad","CpuReduceLogSum","CpuReduceMax","CpuReduceMean","CpuReduceMin","CpuReduceProd","CpuReduceSum","CpuReduceSumSquare","CpuRelu","CpuReshape","CpuSlice","CpuSoftmax","CpuSqueeze","CpuSum","CpuTile","CpuTranspose","CpuUnaryOp","CpuUnsqueeze","CpuUpsample"],"dependencies":["Buffer","long.js"]}},"evidence":[{"file":"/Users/jfri/Downloads/kbfnbcaeplbcioakkpcpgfkobkghlhen/src/js/Grammarly-bg.js","start":22001,"end":24000}],"notes":"This chunk contains more ONNX protobuf definitions, the WebGL backend for reshape, the operator resolver, and a large number of CPU operator implementations. It also includes bundled Buffer and long.js libraries."}
{"file":"/Users/jfri/Downloads/kbfnbcaeplbcioakkpcpgfkobkghlhen/src/js/Grammarly-bg.js","beautified":"/Users/jfri/Downloads/kbfnbcaeplbcioakkpcpgfkobkghlhen/src/js/Grammarly-bg.beautified.js","chunk":{"id":"chunk-13/46","start_line":24001,"end_line":26000,"same_function_group":null},"findings":{"chrome_apis":[],"event_listeners":[],"messages":[],"storage":[],"endpoints":[],"dom":[],"dynamic_code":[],"wasm":[],"obfuscation_hints":["webpack_modules","minified_vars"],"risks":[],"onnx_runtime":{"protobuf_runtime":["Writer","Reader","BufferWriter","BufferReader"],"cpu_operators":["CpuConcat","CpuConv","CpuDropout","CpuFlatten","CpuGather","CpuImageScaler","CpuPad","CpuReduceBase","CpuReshape","CpuSlice","CpuSqueeze","CpuTile","CpuTranspose","CpuUnaryOp","CpuUnsqueeze","CpuUpsample"],"dependencies":["platform.js","path (polyfill)"]}},"evidence":[{"file":"/Users/jfri/Downloads/kbfnbcaeplbcioakkpcpgfkobkghlhen/src/js/Grammarly-bg.js","start":24001,"end":26000}],"notes":"This chunk contains the core implementation of protobuf.js Writer and Reader classes, essential for serializing/deserializing ONNX models. It also includes a bundled platform.js for environment detection and continues the extensive list of CPU operator implementations for the ONNX runtime."}
{"file":"/Users/jfri/Downloads/kbfnbcaeplbcioakkpcpgfkobkghlhen/src/js/Grammarly-bg.js","beautified":"/Users/jfri/Downloads/kbfnbcaeplbcioakkpcpgfkobkghlhen/src/js/Grammarly-bg.beautified.js","chunk":{"id":"chunk-14/46","start_line":26001,"end_line":28000,"same_function_group":null},"findings":{"chrome_apis":[],"event_listeners":[],"messages":[],"storage":[],"endpoints":[],"dom":[],"dynamic_code":["WebAssembly.instantiate","WebAssembly.instantiateStreaming"],"wasm":["onnx-wasm.wasm"],"obfuscation_hints":["webpack_modules","minified_vars"],"risks":[]},"evidence":[{"file":"/Users/jfri/Downloads/kbfnbcaeplbcioakkpcpgfkobkghlhen/src/js/Grammarly-bg.beautified.js","start":27773,"end":27816}],"notes":"This chunk contains a large number of CPU operator implementations for the ONNX runtime (Dropout, Flatten, Gather, Gemm, Pool, Reduce, Softmax, etc.). It also includes the complete JavaScript glue code for the WebAssembly (Wasm) backend, including the WasmBinding class and the Emscripten runtime for loading and interacting with 'onnx-wasm.wasm'. This confirms the use of a compiled C/C++ ONNX runtime for high-performance inference."}
{"file":"/Users/jfri/Downloads/kbfnbcaeplbcioakkpcpgfkobkghlhen/src/js/Grammarly-bg.js","beautified":"/Users/jfri/Downloads/kbfnbcaeplbcioakkpcpgfkobkghlhen/src/js/Grammarly-bg.beautified.js","chunk":{"id":"chunk-15/46","start_line":28001,"end_line":30000,"same_function_group":null},"findings":{"chrome_apis":[],"event_listeners":[],"messages":[],"storage":[],"endpoints":[],"dom":[],"dynamic_code":[],"wasm":["_batch_normalization_f32","_add_f32","_sub_f32","_mul_f32","_div_f32","_prelu_f32","_xor_u8","_or_u8","_and_u8","_clip_f32","_conv_f32","_gemm_f32","_free","_malloc","_instance_normalization_f32","_matmul_f32","_average_pool_f32","_max_pool_f32","_softmax_f32","_sum_f32"],"obfuscation_hints":["webpack_modules","minified_vars"],"risks":[]},"evidence":[{"file":"/Users/jfri/Downloads/kbfnbcaeplbcioakkpcpgfkobkghlhen/src/js/Grammarly-bg.beautified.js","start":28004,"end":28080}],"notes":"This chunk continues the Emscripten glue code, explicitly listing the functions exported from the Wasm module (e.g., _conv_f32, _gemm_f32, _matmul_f32). It then introduces the complete implementation for the WebGL backend, including the WebGLSessionHandler, WebGLInferenceHandler, and the WEBGL_OP_RESOLVE_RULES, which maps ONNX operators to their GLSL shader implementations. This confirms the presence of a third, GPU-accelerated backend for ML inference."}
{"file":"/Users/jfri/Downloads/kbfnbcaeplbcioakkpcpgfkobkghlhen/src/js/Grammarly-bg.js","beautified":"/Users/jfri/Downloads/kbfnbcaeplbcioakkpcpgfkobkghlhen/src/js/Grammarly-bg.beautified.js","chunk":{"id":"chunk-16/46","start_line":30001,"end_line":32000,"same_function_group":null},"findings":{"chrome_apis":[],"event_listeners":[],"messages":[],"storage":[],"endpoints":[],"dom":[],"dynamic_code":[],"wasm":[],"obfuscation_hints":["webpack_modules"],"risks":[],"onnx_operators":["WebGLConv","WebGLDropout","WebGLElu","WebGLFlatten","WebGLGather","WebGLGemm","WebGLImageScaler","WebGLInstanceNormalization","WebGLLeakyRelu","WebGLMatMul","WebGLPad","WebGLGlobalAveragePool","WebGLAveragePool","WebGLGlobalMaxPool","WebGLMaxPool","WebGLReduceSum","WebGLReduceMean","WebGLReduceMax","WebGLReduceMin","WebGLReduceProd","WebGLReduceLogSum","WebGLReduceSumSquare","WebGLSlice","WebGLSliceV10","WebGLSoftmax","WebGLSplit","WebGLSqueeze","WebGLSum","WebGLTile","WebGLTranspose","WebGLUnaryOp","WebGLUnsqueeze","WebGLUpsample"]},"evidence":[{"file":"/Users/jfri/Downloads/kbfnbcaeplbcioakkpcpgfkobkghlhen/src/js/Grammarly-bg.js","start":30001,"end":32000}],"notes":"This chunk details the WebGL implementations for a large number of ONNX operators. Each operator generates specific GLSL shader code. It also reveals the GLSL preprocessor and program manager responsible for compiling and running these shaders."}
{"file":"/Users/jfri/Downloads/kbfnbcaeplbcioakkpcpgfkobkghlhen/src/js/Grammarly-bg.js","beautified":"/Users/jfri/Downloads/kbfnbcaeplbcioakkpcpgfkobkghlhen/src/js/Grammarly-bg.beautified.js","chunk":{"id":"chunk-17/46","start_line":32001,"end_line":34000,"same_function_group":null},"findings":{"chrome_apis":[],"event_listeners":[],"messages":[],"storage":[],"endpoints":[],"dom":[],"dynamic_code":[],"wasm":[],"obfuscation_hints":["webpack_modules"],"risks":[],"onnx_operators":[]},"evidence":[{"file":"/Users/jfri/Downloads/kbfnbcaeplbcioakkpcpgfkobkghlhen/src/js/Grammarly-bg.js","start":32001,"end":34000}],"notes":"This chunk details the GLSL utility libraries for the WebGL backend. It includes libraries for coordinate and index manipulation (`CoordsGlslLib`, `ShapeUtilsGlslLib`), float-to-RGBA encoding/decoding for compatibility (`EncodingGlslLib`), and vector operations (`VecGlslLib`). It also shows the `TextureManager` for WebGL texture allocation/pooling and the `WebGLContext` wrapper for managing the low-level WebGL state and extensions."}
{"file":"/Users/jfri/Downloads/kbfnbcaeplbcioakkpcpgfkobkghlhen/src/js/Grammarly-bg.beautified.js","chunk":{"id":"chunk-18/46","start_line":34001,"end_line":36000,"same_function_group":null},"findings":{"chrome_apis":[],"event_listeners":[],"messages":[],"storage":[],"endpoints":[],"dom":[],"dynamic_code":[],"wasm":[],"obfuscation_hints":["webpack_modules"],"risks":[]},"evidence":[{"file":"/Users/jfri/Downloads/kbfnbcaeplbcioakkpcpgfkobkghlhen/src/js/Grammarly-bg.js","start":34001,"end":36000}],"notes":"This chunk contains the core ONNX.js model parsing and graph representation logic. It defines the `Model` class to load the `.onnx` file, and the `Graph` class which builds an in-memory representation of the computation graph. Key features include parsing nodes and values, validating the graph for cycles (`checkIsAcyclic`), and performing optimizations like removing `Identity` and `Dropout` nodes. The `Attribute` class is used to handle operator-specific parameters."}
{"file":"/Users/jfri/Downloads/kbfnbcaeplbcioakkpcpgfkobkghlhen/src/js/Grammarly-bg.beautified.js","chunk":{"id":"chunk-19/46","start_line":36001,"end_line":38000,"same_function_group":null},"findings":{"chrome_apis":[],"event_listeners":[],"messages":[],"storage":[],"endpoints":[],"dom":[],"dynamic_code":[],"wasm":[],"obfuscation_hints":["webpack_modules", "third_party_libs"],"risks":[]},"evidence":[{"file":"/Users/jfri/Downloads/kbfnbcaeplbcioakkpcpgfkobkghlhen/src/js/Grammarly-bg.js","start":36001,"end":38000}],"notes":"This chunk contains a significant amount of third-party library code. It includes a large portion of the RxJS library, used for reactive programming and managing asynchronous data streams. It also contains the UAParser.js library, which is used to parse the browser's user-agent string to identify the browser, OS, device, and CPU. A semantic versioning library (semver) is also present."}
{"file":"/Users/jfri/Downloads/kbfnbcaeplbcioakkpcpgfkobkghlhen/src/js/Grammarly-bg.js","beautified":"/Users/jfri/Downloads/kbfnbcaeplbcioakkpcpgfkobkghlhen/src/js/Grammarly-bg.beautified.js","chunk":{"id":"chunk-20/46","start_line":38001,"end_line":40000,"same_function_group":null},"findings":{"chrome_apis":[],"event_listeners":[],"messages":[],"storage":[],"endpoints":[],"dom":[],"dynamic_code":[],"wasm":[],"obfuscation_hints":["minified_vars","function_chains"],"risks":[{"type":"fingerprinting","severity":"medium","description":"The code contains the UAParser.js library, which is used for detailed browser, OS, and device fingerprinting from the user-agent string."}],"third_party_libs":["UAParser.js", "uuid.js"],"architecture_patterns":["agent_protocol"]},"evidence":[{"file":"/Users/jfri/Downloads/kbfnbcaeplbcioakkpcpgfkobkghlhen/src/js/Grammarly-bg.beautified.js","start":38001,"end":40000}],"notes":"This chunk continues the UAParser.js library and includes the uuid.js library. It also defines a 'Coda Pack' agent protocol, suggesting a modular architecture for integrating various services like Google Calendar, Gmail, and Jira, as well as internal Grammarly features."}
{"file":"/Users/jfri/Downloads/kbfnbcaeplbcioakkpcpgfkobkghlhen/src/js/Grammarly-bg.js","beautified":"/Users/jfri/Downloads/kbfnbcaeplbcioakkpcpgfkobkghlhen/src/js/Grammarly-bg.beautified.js","chunk":{"id":"chunk-21/46","start_line":40001,"end_line":42000,"same_function_group":null},"findings":{"chrome_apis":[],"event_listeners":[],"messages":[],"storage":[],"endpoints":["https://assets.extension.grammarly.com/","https://data.grammarly.com","https://auth.grammarly.com/v3","https://auth.grammarly.com/v4","https://auth.grammarly.com/v5","https://capi.grammarly.com","https://gateway.grammarly.com","https://coda.grammarly.com","wss://capi.grammarly.com/freews","https://f-log-extension.grammarly.io","https://extension.femetrics.grammarly.io/batch/import","https://api.iterable.com"],"dom":[],"dynamic_code":[],"wasm":[],"obfuscation_hints":["minified_vars"],"risks":[],"architecture_patterns":["feature_flags","telemetry_sdk","global_config_module"],"feature_flags":["AgentsFeatureInExtension","AgentParaphraserInExtension","AgentHumanizerInExtension","AgentReaderReactionsInExtension","AgentExpertPanelInExtension","AgentAiDetectorInExtension","AgentPlagiarismCheckerInExtension","CheetahFeatureFlagCompose","CheetahFeatureFlagRewrite","GDocs... (many)","VbarsGlobal","OAuth2SelectiveLogout","TSMintSdkRollout"]},"evidence":[{"file":"/Users/jfri/Downloads/kbfnbcaeplbcioakkpcpgfkobkghlhen/src/js/Grammarly-bg.beautified.js","start":40001,"end":42000}],"notes":"This chunk contains a massive amount of the extension's core configuration logic. It defines numerous backend service URLs, a comprehensive feature flag system (revealing features like 'Agents', 'Cheetah', 'GDocs', 'Vbars'), and a sophisticated telemetry/analytics SDK ('Mint') with offline queueing and retry logic. It also sets up a global configuration object with environment, build, and browser information."}
{"file":"/Users/jfri/Downloads/kbfnbcaeplbcioakkpcpgfkobkghlhen/src/js/Grammarly-bg.js","beautified":"/Users/jfri/Downloads/kbfnbcaeplbcioakkpcpgfkobkghlhen/src/js/Grammarly-bg.beautified.js","chunk":{"id":"chunk-22/46","start_line":42001,"end_line":44000,"same_function_group":null},"findings":{"chrome_apis":[],"event_listeners":[],"messages":[],"storage":[],"endpoints":[],"dom":[],"dynamic_code":[],"wasm":[],"obfuscation_hints":["minified_vars"],"risks":[],"file_system":[]},"evidence":[{"file":"/Users/jfri/Downloads/kbfnbcaeplbcioakkpcpgfkobkghlhen/src/js/Grammarly-bg.beautified.js","start":42001,"end":44000}],"notes":"This chunk contains a massive, centralized telemetry and event logging class (internally `nn`). It defines hundreds of specific events that are tracked across the entire extension, including performance metrics, errors, user interactions, and feature-specific usage. It also defines a sophisticated URL pattern matching class (`$t`) to identify 'top sites' like Google Docs, Slack, Salesforce, etc., which likely receive special handling."}
{"file":"/Users/jfri/Downloads/kbfnbcaeplbcioakkpcpgfkobkghlhen/src/js/Grammarly-bg.js","beautified":"/Users/jfri/Downloads/kbfnbcaeplbcioakkpcpgfkobkghlhen/src/js/Grammarly-bg.beautified.js","chunk":{"id":"chunk-23/46","start_line":44001,"end_line":46000,"same_function_group":null},"findings":{"chrome_apis":[],"event_listeners":[],"messages":[],"storage":[],"endpoints":[{"url":"https://auth.grammarly.com/v4/api/oauth2/authorize","method":"POST"},{"url":"https://auth.grammarly.com/v4/api/oauth2/exchange","method":"POST"},{"url":"https://auth.grammarly.com/v4/api/oauth2/token","method":"POST"},{"url":"https://auth.grammarly.com/v4/api/revoke-by-refresh-token","method":"POST"},{"url":"https://auth.grammarly.com/v4/api/userinfo","method":"POST"},{"url":"https://auth.ppgr.io","method":null},{"url":"https://auth.qagr.io","method":null}],"dom":[],"dynamic_code":[],"wasm":[],"obfuscation_hints":["minified_vars","class_declarations"],"risks":[],"file_system":[]},"evidence":[{"file":"/Users/jfri/Downloads/kbfnbcaeplbcioakkpcpgfkobkghlhen/src/js/Grammarly-bg.beautified.js","start":44001,"end":46000}],"notes":"This chunk concludes the massive telemetry class (`nn`) and introduces a comprehensive, robust OAuth 2.0 client implementation. This client handles authentication, token refreshing (with a storage-based mutex to prevent race conditions), token exchange, and PKCE. It defines multiple environments (prod, preprod, qa) for authentication endpoints."}
{"file":"/Users/jfri/Downloads/kbfnbcaeplbcioakkpcpgfkobkghlhen/src/js/Grammarly-bg.js","beautified":"/Users/jfri/Downloads/kbfnbcaeplbcioakkpcpgfkobkghlhen/src/js/Grammarly-bg.beautified.js","chunk":{"id":"chunk-24/46","start_line":46001,"end_line":48000,"same_function_group":null},"findings":{"chrome_apis":[],"event_listeners":[],"messages":[],"storage":[{"key":"oauth.tokens","type":"local","op":"get/set/remove","purpose":"Stores OAuth tokens for the authenticated fetch wrapper."},{"key":"GrCAPIStorage:*","type":"indexeddb","op":"get/set/remove/clear","purpose":"A comprehensive IndexedDB-based storage implementation with features for quota management, data eviction (TTL), and migrations."}],"endpoints":[],"dom":[],"dynamic_code":[],"wasm":[],"obfuscation_hints":["minified_vars","webpack_modules"],"risks":[],"file_system":[{"path":"/Users/jfri/Downloads/kbfnbcaeplbcioakkpcpgfkobkghlhen/src/js/Grammarly-bg.beautified.js","op":"read"}]},"evidence":[{"file":"/Users/jfri/Downloads/kbfnbcaeplbcioakkpcpgfkobkghlhen/src/js/Grammarly-bg.js","start":46188,"end":46584,"ast_id":null,"snippet":"class Rr: Main authentication client orchestrating token renewal and storage."},{"file":"/Users/jfri/Downloads/kbfnbcaeplbcioakkpcpgfkobkghlhen/src/js/Grammarly-bg.js","start":47001,"end":47088,"ast_id":null,"snippet":"class $i: A robust IndexedDB storage implementation with versioning, migrations, and quota management (eviction)."},{"file":"/Users/jfri/Downloads/kbfnbcaeplbcioakkpcpgfkobkghlhen/src/js/Grammarly-bg.js","start":47790,"end":47955,"ast_id":null,"snippet":"class lo: A from-scratch implementation of the SHA-256 hashing algorithm."}],"notes":"This chunk introduces the high-level authentication client (Rr) that manages the complete token lifecycle, including a robust renewal strategy (cache -> refresh -> exchange -> anonymous). It also defines a sophisticated IndexedDB storage abstraction ($i) with quota management and a from-scratch SHA-256 implementation (lo), likely for PKCE."}
{"file":"/Users/jfri/Downloads/kbfnbcaeplbcioakkpcpgfkobkghlhen/src/js/Grammarly-bg.js","beautified":"/Users/jfri/Downloads/kbfnbcaeplbcioakkpcpgfkobkghlhen/src/js/Grammarly-bg.beautified.js","chunk":{"id":"chunk-25/46","start_line":48001,"end_line":50000,"same_function_group":null},"findings":{"chrome_apis":["chrome.cookies.get","chrome.cookies.set","chrome.cookies.remove","chrome.cookies.getAll","chrome.runtime.lastError"],"event_listeners":["onPortConnection","onMessage","onDisconnect"],"messages":[{"name":"message-bus-port","direction":"content->background","payload_keys":[],"notes":"Used by the internal message bus to establish communication channels between different parts of the extension."}],"storage":[{"key":"gnar_containerId","type":"cookies/local","op":"get/set","purpose":"Primary identifier for the Gnar analytics client, stored resiliently across multiple storage types."},{"key":"gnar_nextPingTimestamp","type":"local","op":"get/set","purpose":"Controls the throttling of the Gnar client's periodic 'ping' event."},{"key":"gnarInternalStorage","type":"local","op":"get/set","purpose":"Internal storage for the Gnar client, likely for caching or session data."}],"endpoints":[{"url":"/events-with-token, /lite-with-token","method":"POST","purpose":"Endpoints for the Gnar analytics client to send batched event data."}],"dom":[],"dynamic_code":[{"type":"dynamic_import","snippet":"__webpack_require__.e(...).then(__webpack_require__.bind(...))","notes":"The agent platform dynamically loads agent implementations (e.g., for document analysis, assistant features) on demand. This is a core part of the modular architecture."}],"wasm":[],"obfuscation_hints":["minified_vars","webpack_modules"],"risks":[],"file_system":[{"path":"/Users/jfri/Downloads/kbfnbcaeplbcioakkpcpgfkobkghlhen/src/js/Grammarly-bg.beautified.js","op":"read"}]},"evidence":[{"file":"/Users/jfri/Downloads/kbfnbcaeplbcioakkpcpgfkobkghlhen/src/js/Grammarly-bg.js","start":48293,"end":48499,"ast_id":null,"snippet":"class La: The core of the agent platform. Manages agent lifecycles, document sessions, and communication via the message bus."},{"file":"/Users/jfri/Downloads/kbfnbcaeplbcioakkpcpgfkobkghlhen/src/js/Grammarly-bg.js","start":49251,"end":49550,"ast_id":null,"snippet":"class $c: The full implementation of the 'Gnar' analytics client, including event batching, user identification, session management, and resilient storage."},{"file":"/Users/jfri/Downloads/kbfnbcaeplbcioakkpcpgfkobkghlhen/src/js/Grammarly-bg.js","start":48055,"end":48291,"ast_id":null,"snippet":"Agent protocol definitions (ka, Ea, Pa, Ma) which specify the events, state, and dynamically loaded integrations for each agent."}],"notes":"This chunk unveils the core 'Agent Platform' (La class), a sophisticated modular architecture for managing features. It dynamically loads agents (e.g., for document analysis, assistant) on demand. It also contains the full, detailed implementation of the 'Gnar' analytics client ($c class), which uses a resilient storage strategy (cookies, localStorage) to persist its containerId and batches events to send to the backend."}
{"file":"src/js/Grammarly-bg.js","beautified":"src/js/Grammarly-bg.beautified.js","chunk":{"id":"chunk-26/46","start_line":50001,"end_line":52000,"same_function_group":null},"findings":{"chrome_apis":["chrome.runtime.connectNative","chrome.permissions"],"event_listeners":["browserApi.preferences.changes.subscribe","browserApi.message.listenToRuntimeMessage","browserApi.message.onPortConnection"],"messages":[{"name":"fg-connector-d7c96f","direction":"background<->content","payload_keys":[]},{"name":"bg-connector-d7c96f","direction":"background<->content","payload_keys":[]}],"storage":[{"key":"assistantOnboarding_*","type":"preferences","purpose":"Stores state for the Assistant feature's onboarding flow (dismissed, completed, show counts)."},{"key":"pingDate","type":"preferences","purpose":"Stores the timestamp of the last 'daily-ping' to throttle it."}],"endpoints":[{"url":"https://capi{env}/api/configuration/cheetah/v1/settings","purpose":"Get/set user-level settings for a feature named 'Cheetah'."},{"url":"https://goldengate{env}/configuration/cheetah/v1/institution/settings","purpose":"Get/set institution-level settings for the 'Cheetah' feature."},{"url":"https://gateway.grammarly.com/authorship/v1/user/{userId}/upload","purpose":"Upload data for an 'Authorship' report."},{"url":"https://gateway.grammarly.com/authorship/v1/user/{userId}/encryption/keys","purpose":"Get encryption keys for the 'Authorship' feature."}],"dynamic_code":[],"wasm":[],"obfuscation_hints":["api_client_patterns","function_chains"],"risks":[{"type":"other","severity":"low","description":"The extension uses chrome.runtime.connectNative to communicate with a native desktop application (com.grammarly.desktop). This allows for deeper integration with the OS but also increases the attack surface if the native application has vulnerabilities."}]},"evidence":[{"file":"src/js/Grammarly-bg.js","start":51438,"end":51814,"ast_id":null},{"file":"src/js/Grammarly-bg.js","start":50288,"end":50515,"ast_id":null},{"file":"src/js/Grammarly-bg.js","start":50888,"end":51087,"ast_id":null},{"file":"src/js/Grammarly-bg.js","start":51090,"end":51162,"ast_id":null}],"notes":"This chunk details the implementation of a native messaging connector, a custom alarm manager, API clients for 'Cheetah' and 'Authorship' services, and a structured framework for handling side effects."}
{"file":"src/js/Grammarly-bg.js","beautified":"src/js/Grammarly-bg.beautified.js","chunk":{"id":"chunk-27/46","start_line":52001,"end_line":54000,"same_function_group":null},"findings":{"chrome_apis":[],"event_listeners":[],"messages":[],"storage":[],"endpoints":[],"dynamic_code":[],"wasm":[],"obfuscation_hints":["private_fields","function_chains","object_property_chaining"],"risks":[],"dom":[]},"evidence":[{"file":"src/js/Grammarly-bg.js","start":52080,"end":52154,"ast_id":null},{"file":"src/js/Grammarly-bg.js","start":52158,"end":53998,"ast_id":null}],"notes":"This chunk is almost entirely composed of polyfills and shims for modern JavaScript features, ensuring compatibility across different browser environments. It includes polyfills for Error causes, SuppressedError, DisposableStack, and a complex task scheduling mechanism (setImmediate). It also contains a large number of small, interdependent utility functions characteristic of a core-js or babel-like runtime library."}
{"file":"src/js/Grammarly-bg.js","beautified":"src/js/Grammarly-bg.beautified.js","chunk":{"id":"chunk-28/46","start_line":54001,"end_line":56000,"same_function_group":null},"findings":{"chrome_apis":[],"event_listeners":[],"messages":[],"storage":[],"endpoints":[{"url":"https://f-log-inkwell.grammarly.io/batch/log","purpose":"Send batches of client-side logs for debugging and monitoring."}],"dynamic_code":[],"wasm":[],"obfuscation_hints":["private_fields","function_chains","object_property_chaining"],"risks":[],"dom":[]},"evidence":[{"file":"src/js/Grammarly-bg.js","start":54800,"end":55050,"ast_id":null},{"file":"src/js/Grammarly-bg.js","start":55052,"end":55400,"ast_id":null}],"notes":"This chunk continues the pattern of the previous one, consisting almost entirely of polyfills and shims. It notably includes a sophisticated logging client (FeLogWriter) that batches logs and sends them to a dedicated endpoint. It also contains the beginning of the RxJS library, a powerful tool for reactive programming with observables."}
{"file":"/Users/jfri/Downloads/kbfnbcaeplbcioakkpcpgfkobkghlhen/src/js/Grammarly-bg.beautified.js","beautified":"/Users/jfri/Downloads/kbfnbcaeplbcioakkpcpgfkobkghlhen/src/js/Grammarly-bg.beautified.js","chunk":{"id":"chunk-29/46","start_line":56001,"end_line":58000,"same_function_group":null},"findings":{"chrome_apis":[],"event_listeners":[],"messages":[],"storage":[{"key":"duration_service_availability_metrics_db_v1","type":"indexeddb","purpose":"Stores user view and typing duration metrics for service availability tracking."}],"endpoints":[{"url":"https://goldengate{env}/knowledge-hub/v1/institution","purpose":"API for managing institutional knowledge base (terms, presets)."},{"url":"https://goldengate{env}/settings-registry/v1","purpose":"Generic API for fetching and saving user, group, and institution settings."},{"url":"https://www.grammarly.com/api/","purpose":"Core user authentication and account management API (login, logout, profile changes, OAuth)."}],"dynamic_code":[],"wasm":[],"obfuscation_hints":["minified_vars","function_chains"],"risks":[]},"evidence":[{"file":"/Users/jfri/Downloads/kbfnbcaeplbcioakkpcpgfkobkghlhen/src/js/Grammarly-bg.beautified.js","start":56001,"end":58000}],"notes":"This chunk contains a large portion of the RxJS library implementation, a custom RPC framework, an IndexedDB wrapper, and several key API clients for knowledge hub, settings registry, and user authentication."}
{"file":"/Users/jfri/Downloads/kbfnbcaeplbcioakkpcpgfkobkghlhen/src/js/Grammarly-bg.beautified.js","beautified":"/Users/jfri/Downloads/kbfnbcaeplbcioakkpcpgfkobkghlhen/src/js/Grammarly-bg.beautified.js","chunk":{"id":"chunk-30/46","start_line":58001,"end_line":60000,"same_function_group":null},"findings":{"chrome_apis":[],"event_listeners":[],"messages":[],"storage":[{"key":"gr-oauth-key","type":"local","purpose":"Stores OAuth 2.0 tokens and related metadata."}],"endpoints":[],"dynamic_code":[],"wasm":[],"obfuscation_hints":["minified_vars","function_chains"],"risks":[]},"evidence":[{"file":"/Users/jfri/Downloads/kbfnbcaeplbcioakkpcpgfkobkghlhen/src/js/Grammarly-bg.beautified.js","start":58001,"end":60000}],"notes":"This chunk details the core authentication and API service infrastructure. It includes a comprehensive OAuth 2.0 client with telemetry, a central API service class, a large registry of feature flags/experiments, and a custom-built IndexedDB wrapper for local storage."}
{"file":"/Users/jfri/Downloads/kbfnbcaeplbcioakkpcpgfkobkghlhen/src/js/Grammarly-bg.beautified.js","beautified":"/Users/jfri/Downloads/kbfnbcaeplbcioakkpcpgfkobkghlhen/src/js/Grammarly-bg.beautified.js","chunk":{"id":"chunk-31/46","start_line":60001,"end_line":62000,"same_function_group":null},"findings":{"chrome_apis":["indexedDB.open","crypto.subtle.encrypt","crypto.subtle.decrypt","crypto.subtle.generateKey","crypto.subtle.importKey","crypto.subtle.exportKey","crypto.getRandomValues","runtime.getManifest","runtime.onUpdateAvailable","runtime.reload","runtime.requestUpdateCheck"],"event_listeners":[],"messages":[],"storage":[{"key":"human_writing_report","type":"indexeddb","op":"open"},{"key":"AppActivity","type":"indexeddb","op":"queryMap/set"},{"key":"__migration-104ccd8c-9919-9ae4-931f-782fb197486c","type":"local","op":"get/set"}],"endpoints":[{"url":"/users/{userId}/skills","method":"GET"}],"dom":[],"dynamic_code":[],"wasm":[],"obfuscation_hints":[],"risks":[{"type":"insecure_storage","severity":"low","description":"Includes a from-scratch implementation of SHA1 (dA), which is considered cryptographically weak and vulnerable to collisions."}]},"evidence":[{"file":"/Users/jfri/Downloads/kbfnbcaeplbcioakkpcpgfkobkghlhen/src/js/Grammarly-bg.beautified.js","start":60935,"end":60999},{"file":"/Users/jfri/Downloads/kbfnbcaeplbcioakkpcpgfkobkghlhen/src/js/Grammarly-bg.beautified.js","start":60223,"end":60510},{"file":"/Users/jfri/Downloads/kbfnbcaeplbcioakkpcpgfkobkghlhen/src/js/Grammarly-bg.beautified.js","start":60080,"end":60200}],"notes":"This chunk introduces a major feature: the Human Writing Report (HWR), an end-to-end encrypted storage system for document states using IndexedDB and a remote key management service. It also includes from-scratch implementations of SHA-1, SHA-2, and SHA-3 hashing algorithms."}
{"file":"/Users/jfri/Downloads/kbfnbcaeplbcioakkpcpgfkobkghlhen/src/js/Grammarly-bg.beautified.js","beautified":"/Users/jfri/Downloads/kbfnbcaeplbcioakkpcpgfkobkghlhen/src/js/Grammarly-bg.beautified.js","chunk":{"id":"chunk-32/46","start_line":62001,"end_line":64000,"same_function_group":null},"findings":{"chrome_apis":[],"event_listeners":[{"name":"installedAgentsOrderChanged","source":"ME (Agent Order Manager)"}],"messages":[],"storage":[{"key":"apollo-feedback","type":"local","op":"get/set"}],"endpoints":[{"url":"/apis/v1/packs/listings","method":"GET"},{"url":"/internalAppApi/packs/search","method":"GET"},{"url":"/internalAppApi/agentInstances/{tenantId}","method":"POST"},{"url":"/internalAppApi/agentInstances/{tenantId}/{agentInstanceId}","method":"DELETE"},{"url":"/internalAppApi/agentInstances/{tenantId}/{agentInstanceId}/reorder","method":"POST"},{"url":"/internalAppApi/account/userAccountInfo","method":"GET"},{"url":"/internalAppApi/agentInstances/brainTenantId","method":"POST"}],"dom":[],"dynamic_code":[],"wasm":[],"obfuscation_hints":[],"risks":[]},"evidence":[{"file":"/Users/jfri/Downloads/kbfnbcaeplbcioakkpcpgfkobkghlhen/src/js/Grammarly-bg.beautified.js","start":62330,"end":63050},{"file":"/Users/jfri/Downloads/kbfnbcaeplbcioakkpcpgfkobkghlhen/src/js/Grammarly-bg.beautified.js","start":63200,"end":63800},{"file":"/Users/jfri/Downloads/kbfnbcaeplbcioakkpcpgfkobkghlhen/src/js/Grammarly-bg.beautified.js","start":62100,"end":62200}],"notes":"This chunk details the 'Agent Platform' integration, which appears to be powered by Coda.io packs. It defines a comprehensive 'AgentDirectoryService' (qE) for interacting with a Coda API to list, search, install, and manage agents. It also contains a highly sophisticated autocorrect and spelling prediction engine ('xx', 'ZE') that uses n-gram language models, a noisy channel model, a neural network classifier (ONNX.js), and a feedback mechanism to learn from user actions."}
{"file":"/Users/jfri/Downloads/kbfnbcaeplbcioakkpcpgfkobkghlhen/src/js/Grammarly-bg.beautified.js","beautified":"/Users/jfri/Downloads/kbfnbcaeplbcioakkpcpgfkobkghlhen/src/js/Grammarly-bg.beautified.js","chunk":{"id":"chunk-33/46","start_line":64001,"end_line":66000,"same_function_group":null},"findings":{"chrome_apis":[],"event_listeners":[],"messages":[],"storage":[],"endpoints":[],"dom":[],"dynamic_code":[],"wasm":[],"obfuscation_hints":["typescript_generated_enums"],"risks":[],"libraries_and_frameworks":["io-ts","fp-ts"]},"evidence":[{"file":"/Users/jfri/Downloads/kbfnbcaeplbcioakkpcpgfkobkghlhen/src/js/Grammarly-bg.beautified.js","start":64188,"end":64225,"ast_id":null},{"file":"/Users/jfri/Downloads/kbfnbcaeplbcioakkpcpgfkobkghlhen/src/js/Grammarly-bg.beautified.js","start":64330,"end":64403,"ast_id":null},{"file":"/Users/jfri/Downloads/kbfnbcaeplbcioakkpcpgfkobkghlhen/src/js/Grammarly-bg.beautified.js","start":64406,"end":65989,"ast_id":null}],"notes":"This chunk defines a comprehensive, declarative UI rendering system using the `io-ts` library for runtime type validation. It includes a vast design system with color palettes and enums for UI properties. The core is a schema defining all possible UI components (`Content`), their properties, and over 40 distinct user actions (`YR`). This reveals a sophisticated, data-driven UI architecture built on functional programming principles, with components for layout, interaction, data display, and bridges to native UI elements."}
{"file":"/Users/jfri/Downloads/kbfnbcaeplbcioakkpcpgfkobkghlhen/src/js/Grammarly-bg.beautified.js","beautified":"/Users/jfri/Downloads/kbfnbcaeplbcioakkpcpgfkobkghlhen/src/js/Grammarly-bg.beautified.js","chunk":{"id":"chunk-34/46","start_line":66001,"end_line":68000,"same_function_group":null},"findings":{"chrome_apis":[],"event_listeners":[],"messages":[],"storage":[],"endpoints":[],"dom":[],"dynamic_code":[],"wasm":[],"obfuscation_hints":["minified_vars","webpack_modules"],"risks":[],"libraries_and_frameworks":["fp-ts","io-ts","quill-delta"]},"evidence":[{"file":"/Users/jfri/Downloads/kbfnbcaeplbcioakkpcpgfkobkghlhen/src/js/Grammarly-bg.beautified.js","start":66001,"end":67998,"ast_id":null}],"notes":"This chunk defines a comprehensive tree traversal and manipulation utility (`KR`) for the declarative UI (`SDUI`) component tree defined in the previous chunk. It also introduces a sophisticated Data Loss Prevention (DLP) and sanitization service (`Pj`). The DLP service uses a configurable set of regex patterns (`Oj`) to find and replace sensitive information (like emails, credit cards, SSNs) within text, `quill-delta` objects, and the SDUI tree itself. It maintains a mapping to allow for unsanitization. This indicates a strong focus on security and data privacy, likely for enterprise customers."}
{"file":"/Users/jfri/Downloads/kbfnbcaeplbcioakkpcpgfkobkghlhen/src/js/Grammarly-bg.beautified.js","beautified":"/Users/jfri/Downloads/kbfnbcaeplbcioakkpcpgfkobkghlhen/src/js/Grammarly-bg.beautified.js","chunk":{"id":"chunk-35/46","start_line":68001,"end_line":70000,"same_function_group":null},"findings":{"chrome_apis":[],"event_listeners":[],"messages":[],"storage":[],"endpoints":[],"dom":[],"dynamic_code":[],"wasm":[],"obfuscation_hints":["minified_vars"],"risks":[],"networking":[{"type":"WebSocket","url_pattern":"(dynamic, via connect method)","implementation_details":"A comprehensive WebSocket handling architecture including a DLP-sanitizing wrapper, a finite state machine for connection state, and a sophisticated reconnection strategy with exponential backoff."}],"session_management":[{"protocol":"CAPI (Client API)","details":"A custom application-level session protocol over WebSocket. Manages session lifecycle (start, reconnect, close), message sequencing, and acknowledgment. Uses a message queue that supports chunking large messages and transforming pending data against in-flight text changes."}]},"evidence":[{"file":"/Users/jfri/Downloads/kbfnbcaeplbcioakkpcpgfkobkghlhen/src/js/Grammarly-bg.beautified.js","start":68315,"end":68385,"description":"Rj: DLP-Sanitizing WebSocket Handler wrapper."},{"file":"/Users/jfri/Downloads/kbfnbcaeplbcioakkpcpgfkobkghlhen/src/js/Grammarly-bg.beautified.js","start":68488,"end":68701,"description":"Gj: Generic Finite State Machine implementation."},{"file":"/Users/jfri/Downloads/kbfnbcaeplbcioakkpcpgfkobkghlhen/src/js/Grammarly-bg.beautified.js","start":69000,"end":69180,"description":"Jj: WebSocket reconnection logic with backoff strategies."},{"file":"/Users/jfri/Downloads/kbfnbcaeplbcioakkpcpgfkobkghlhen/src/js/Grammarly-bg.beautified.js","start":69182,"end":70000,"description":"iF: Core WebSocket handler managing connection lifecycle and events."},{"file":"/Users/jfri/Downloads/kbfnbcaeplbcioakkpcpgfkobkghlhen/src/js/Grammarly-bg.beautified.js","start":69600,"end":69990,"description":"KF: CAPI (Client API) session management protocol implementation."},{"file":"/Users/jfri/Downloads/kbfnbcaeplbcioakkpcpgfkobkghlhen/src/js/Grammarly-bg.beautified.js","start":69811,"end":69985,"description":"UL: CAPI message queue with support for chunking, staging, and delta transformation."}],"notes":"This chunk details the extension's sophisticated networking layer, built around a resilient WebSocket connection managed by a finite state machine. It introduces the CAPI (Client API) protocol for session management, which includes a message queue capable of chunking large messages and transforming data against pending edits. Crucially, it integrates the DLP service directly into the WebSocket handler, ensuring all communication is sanitized."}
{"file":"/Users/jfri/Downloads/kbfnbcaeplbcioakkpcpgfkobkghlhen/src/js/Grammarly-bg.beautified.js","beautified":"/Users/jfri/Downloads/kbfnbcaeplbcioakkpcpgfkobkghlhen/src/js/Grammarly-bg.beautified.js","chunk":{"id":"chunk-36/46","start_line":70001,"end_line":72000,"same_function_group":null},"findings":{"chrome_apis":["chrome.tabs.create","chrome.tabs.onUpdated","chrome.tabs.onRemoved","chrome.tabs.remove","chrome.tabs.getActiveTabZoom","chrome.management.uninstallSelf","chrome.identity.getRedirectURL"],"event_listeners":[],"messages":[{"type":"RPC","channel":"cs-to-bg-rpc-1557421403805","direction":"content->background","description":"A comprehensive RPC interface exposing dozens of background script functions to content scripts."}],"storage":[],"endpoints":[],"dom":[],"dynamic_code":[],"wasm":[],"obfuscation_hints":["minified_vars","large_classes_with_many_dependencies"],"risks":[],"authentication":[{"type":"OAuth 2.0","details":"A full OAuth 2.0 client (`mG`, `bG`) is implemented to handle user authentication. It uses `chrome.identity.getRedirectURL` and `chrome.tabs` to manage the interactive login flow, exchanging an authorization code for a token."}],"api_surface":[{"name":"cG (CAPI Client)","description":"The core implementation of the CAPI (Client API) protocol. Manages WebSocket state via an FSM, handles message queuing with chunking for large OT deltas, processes server messages, and orchestrates session reconnection."},{"name":"CG (CS-to-BG RPC API)","description":"A massive RPC facade that exposes a wide array of background services to content scripts. This is the primary bridge between the page context and the extension's core logic."}]},"evidence":[{"file":"/Users/jfri/Downloads/kbfnbcaeplbcioakkpcpgfkobkghlhen/src/js/Grammarly-bg.beautified.js","start":70054,"end":71850,"description":"cG: The core CAPI client implementation, managing state, message queues, and event handling."},{"file":"/Users/jfri/Downloads/kbfnbcaeplbcioakkpcpgfkobkghlhen/src/js/Grammarly-bg.beautified.js","start":71853,"end":72000,"description":"CG: The CS-to-BG RPC API implementation, exposing numerous background services."},{"file":"/Users/jfri/Downloads/kbfnbcaeplbcioakkpcpgfkobkghlhen/src/js/Grammarly-bg.beautified.js","start":71700,"end":71850,"description":"bG: OAuth 2.0 interactive authentication flow management using chrome.tabs API."},{"file":"/Users/jfri/Downloads/kbfnbcaeplbcioakkpcpgfkobkghlhen/src/js/Grammarly-bg.beautified.js","start":71852,"end":71852,"description":"kG.rpcLegacyMessageName: The constant defining the RPC channel name."}],"notes":"This chunk details the main CAPI client (`cG`) and the CS-to-BG RPC API (`CG`). The CAPI client is the engine for server communication, managing the WebSocket, queuing messages, and handling OT. The RPC API exposes a vast surface of the background script's functionality to content scripts, including auth, experiments, settings, and various backend services. It also contains a full OAuth 2.0 implementation for user authentication."}
{"file":"/Users/jfri/Downloads/kbfnbcaeplbcioakkpcpgfkobkghlhen/src/js/Grammarly-bg.js","beautified":"/Users/jfri/Downloads/kbfnbcaeplbcioakkpcpgfkobkghlhen/src/js/Grammarly-bg.beautified.js","chunk":{"id":"chunk-37/46","start_line":72001,"end_line":74000,"same_function_group":null},"findings":{"chrome_apis":["chrome.permissions.contains","chrome.permissions.request","chrome.permissions.watchAdded","chrome.permissions.watchRemoved","chrome.tabs.executeScript","chrome.tabs.getActiveTab","chrome.tabs.getAllTabs","chrome.tabs.reload","chrome.notifications.create"],"event_listeners":[],"messages":[{"name":"cs-to-bg-rpc-1557421403805","direction":"content->background","payload_keys":["agentDirectoryListAgents","agentDirectorySearchAgents","agentDirectoryCreateAgentInstance","agentDirectoryCreateDefaultAgentInstances","agentDirectoryEditAgentInstance","agentDirectoryAddAgent","agentDirectoryRemoveAgentInstance","agentDirectorySaveInstalledAgentsOrder","agentDirectoryGetUserAccountInfo","agentDirectoryGetConnectionsInfoForUser","agentDirectoryGetBrainTenantId","agentDirectoryGetExternalPackMetadata","agentDirectoryGetAgentPackListing","agentDirectoryGetAgentInstallationContext","agentDirectoryListIngestions","getSystemInfo","disableOnFocusTab","launchAuthFlow","openSuperhumanGoWelcomePage","isTypingTrackingEnabled","addTypingDurationMetric","logClient","loadContentScript","enableHistoryLoggerUntil","disableHistoryLogger","enableAdvancedHistoryLoggerUntil","disableAdvancedHistoryLogger","toggleDebugMenu","getBGLogs","checkAuthPermissions","requestAuthPermissions","proxyMessageToDevtools","getTabId","openSidePanel","isSidePanelSupported","openPopupSettings","isCurrentTabFocused","openSubscriptionPage","sendToPopup","getUserGoExperience","getAlwaysAvailableAssistantSettings","getSpecialOffer","getUphookHubConfiguration","getUphookHubConfigurationsFromSlots","trackUphookHubConfiguration","getAccessToken","getCSRFToken"]},{"name":"cs-to-bg-static-capi-rpc-1668544923207","direction":"content->background","payload_keys":["log","startSession","stopSession","sendFeedback","close","setSessionOption","ping","getStatus"]},{"name":"cs-to-bg-static-capi-observable-rpc-1668544923207","direction":"content->background","payload_keys":["getStatusObs","getEventsObs","updateContextInfo","connect"]}],"storage":[],"endpoints":[{"url":"https://goldengate.../snippets/v1/snippets","purpose":"API for managing text snippets and folders for institutions and users."}],"dom":[],"dynamic_code":[],"wasm":[],"obfuscation_hints":["webpack_modules"],"risks":[{"type":"other","severity":"low","description":"The cs-to-bg-rpc API exposes a very large number of background functions to content scripts, including methods to get access tokens, CSRF tokens, and control various settings. This large attack surface could be a risk if a content script is compromised."}],"evidence":[{"file":"/Users/jfri/Downloads/kbfnbcaeplbcioakkpcpgfkobkghlhen/src/js/Grammarly-bg.js","start":72001,"end":74000}]},"notes":"This chunk details the generic observable RPC framework (jG, WG, LG) that powers communication between the content script and background script. It reveals the continuation of the main 'cs-to-bg-rpc' API, adding methods for agent directory management, auth, and debugging. It also defines a new 'cs-to-bg-static-capi-rpc' for controlling the CAPI WebSocket session. A major new feature, a 'Snippets' service (eB) with a backend API client (JG), is also introduced."}
{"file":"/Users/jfri/Downloads/kbfnbcaeplbcioakkpcpgfkobkghlhen/src/js/Grammarly-bg.js","beautified":"/Users/jfri/Downloads/kbfnbcaeplbcioakkpcpgfkobkghlhen/src/js/Grammarly-bg.beautified.js","chunk":{"id":"chunk-38/46","start_line":74001,"end_line":76000,"same_function_group":null},"findings":{"chrome_apis":[],"event_listeners":[],"messages":[{"name":"cs-to-bg-rpc-1557421403805","direction":"background->content"},{"name":"cs-to-bg-rpc-1587687052565","direction":"background->content"},{"name":"cs-to-bg-static-capi-rpc-1668544923207","direction":"background->content"}],"storage":[],"endpoints":[{"url":"https://data.../api","purpose":"DAPI (Data API) for loading and saving user properties."},{"url":"https://capi.../api/configuration/language/v1/settings","purpose":"Get user's dialect settings."},{"url":"https://goldengate.../institution/api/institution/admin","purpose":"API for institution administrators to manage members, domains, SSO, etc."},{"url":"https://.../iterable/access/token","purpose":"MISe service endpoint to get an access token for the Iterable API."},{"url":"(Iterable URLs)","purpose":"Multiple endpoints for Iterable marketing automation platform (getInAppMessages, track, userUpdate, etc.)."},{"url":"(Dynamic Config URL)","purpose":"Endpoint to fetch the main dynamic configuration JSON for the extension."}],"dom":[],"dynamic_code":[],"wasm":[],"obfuscation_hints":["webpack_modules","minified_vars"],"risks":[{"type":"tracking","severity":"medium","description":"Deep integration with Iterable, a marketing automation platform, for tracking user events, updating user profiles, and delivering targeted in-app messages. Events like 'trackInAppOpen', 'trackInAppClick', and 'userUpdate' are sent."}],"evidence":[{"file":"/Users/jfri/Downloads/kbfnbcaeplbcioakkpcpgfkobkghlhen/src/js/Grammarly-bg.js","start":74001,"end":76000}]},"notes":"This chunk is packed with service definitions and data models. It details the client-side implementations for the various RPC channels, a DAPI service for user properties, a dialect settings service, an institution admin service, and a comprehensive service for integrating with the 'Iterable' marketing automation platform. A massive, io-ts-validated data structure for the extension's dynamic configuration is defined, covering dozens of feature flags and settings, along with the logic to fetch it from a remote server."}
{"file":"src/js/Grammarly-bg.beautified.js","beautified":"src/js/Grammarly-bg.beautified.js","chunk":{"id":"chunk-39/46","start_line":76001,"end_line":78000,"same_function_group":null},"findings":{"chrome_apis":["identity.launchWebAuthFlow","tabs.onActiveTabChange","tabs.onWindowOrActiveTabChange","alarms.onAlarm","managedStorage.get"],"event_listeners":["visibilitychange"],"messages":[],"storage":["persistent storage for experiment overrides","persistent storage for experiment cache"],"endpoints":[],"dom":["document.getElementById","document.createElement","document.body.appendChild","iframe.contentWindow"],"dynamic_code":[],"wasm":[],"obfuscation_hints":["webpack_modules","minified_vars"],"risks":[{"type":"tracking","severity":"medium","description":"A comprehensive performance telemetry system is in place, sending detailed metrics about user interactions (text input latency, scroll latency, alert interactions) and application performance to a Databracks dataset. This includes metadata like domain, text length, and alert counts."}],"notes":"This chunk defines several core infrastructure components: a declarative UI positioning engine, the client-side orchestration and view logic for Iterable In-App Messages (IPM), a comprehensive performance telemetry system, a central Side Effect Manager for orchestrating application workflows, and the client-side implementation of the experimentation framework (fetching, caching, and managing treatments)."},"evidence":[{"file":"src/js/Grammarly-bg.beautified.js","start":76070,"end":76550,"ast_id":null},{"file":"src/js/Grammarly-bg.beautified.js","start":76658,"end":77070,"ast_id":null},{"file":"src/js/Grammarly-bg.beautified.js","start":77071,"end":77580,"ast_id":null},{"file":"src/js/Grammarly-bg.beautified.js","start":77800,"end":78000,"ast_id":null}]}
{"file":"src/js/Grammarly-bg.beautified.js","beautified":"src/js/Grammarly-bg.beautified.js","chunk":{"id":"chunk-40/46","start_line":78001,"end_line":80000,"same_function_group":null},"findings":{"chrome_apis":[],"event_listeners":[],"messages":[],"storage":[],"endpoints":[],"dom":[],"dynamic_code":[],"wasm":[],"obfuscation_hints":["webpack_modules","minified_vars"],"risks":[{"type":"tracking","severity":"medium","description":"The performance telemetry system is further detailed, with specific data schemas (`qH`) for metrics like `gButtonDisplay`, `textInputLatencyV1`, and `httpRequestLatency`. These schemas define the exact dimensions and metadata sent to the analytics backend, confirming a deep level of user interaction and performance tracking."}],"notes":"This chunk is almost entirely composed of `io-ts` schema definitions for the various CAPI (Client API) protocols. It defines the precise shape of messages for the 'Cheetah' generative AI agent, a generic agent protocol, and a file upload assistant. This is the data contract for the extension's most advanced features, detailing every possible action, request, response, and data structure. It also includes the data validation schemas for the performance telemetry system discovered in the previous chunk."},"evidence":[{"file":"src/js/Grammarly-bg.beautified.js","start":78001,"end":78500,"ast_id":null},{"file":"src/js/Grammarly-bg.beautified.js","start":78501,"end":80000,"ast_id":null}]}
{"file":"/Users/jfri/Downloads/kbfnbcaeplbcioakkpcpgfkobkghlhen/src/js/Grammarly-bg.beautified.js","chunk":{"id":"chunk-41/46","start_line":80001,"end_line":82000,"same_function_group":null},"findings":{"chrome_apis":[],"event_listeners":[],"messages":[],"storage":[],"endpoints":[{"url":"https://gateway/privacy/v1/api/data-sharing/","method":"GET/PUT"}],"dom":[],"dynamic_code":[],"wasm":[],"obfuscation_hints":["minified_vars","function_chains"],"risks":[],"file_system":[]},"evidence":[{"file":"/Users/jfri/Downloads/kbfnbcaeplbcioakkpcpgfkobkghlhen/src/js/Grammarly-bg.beautified.js","start":81818,"end":81821},{"file":"/Users/jfri/Downloads/kbfnbcaeplbcioakkpcpgfkobkghlhen/src/js/Grammarly-bg.beautified.js","start":80001,"end":82000}],"notes":"This chunk defines several critical io-ts schemas and service implementations. It details the 'pushed_content' server-driven UI protocol, which renders various cards (rewrite, plagiarism, upsell) and notifications. It also defines protocols for 'trusted_rewrite' (to avoid re-checking approved text), 'vbar_feedback', and 'vbars_lockedui' (for monetization). Key implementations include the 'DenaliCapiRpcApi' (a high-level RPC layer over CAPI), a 'Storage Message Handler' for CAPI, a 'DataSharingService' for privacy settings, a 'SubscriptionServiceHandler' with Apple IAP logic, and extensive domain-specific configurations to alter extension behavior on sites like Google Docs."}
{"file":"/Users/jfri/Downloads/kbfnbcaeplbcioakkpcpgfkobkghlhen/src/js/Grammarly-bg.beautified.js","beautified":"/Users/jfri/Downloads/kbfnbcaeplbcioakkpcpgfkobkghlhen/src/js/Grammarly-bg.beautified.js","chunk":{"id":"chunk-42/46","start_line":82001,"end_line":84000,"same_function_group":null},"findings":{"chrome_apis":["chrome.storage.local.get","chrome.storage.local.set","chrome.runtime.onInstalled.addListener","chrome.runtime.onStartup.addListener","chrome.runtime.onConnectExternal.addListener","chrome.alarms.create","chrome.alarms.onAlarm.addListener"],"event_listeners":["runtime.onInstalled","runtime.onStartup","runtime.onConnectExternal","alarms.onAlarm"],"messages":[],"storage":[{"key":"passport","type":"local","op":"get/set"},{"key":"blocklist","type":"local","op":"get/set"}],"endpoints":[{"url_pattern":"https://config.grammarly.com/browserplugin/v3/page_config.json","method":"GET","purpose":"Fetches remote page-specific configuration"},{"url_pattern":"https://goldengate.grammarly.com/passport/api/v1/passport","method":"GET","purpose":"Fetches user feature entitlements (Passport)"}],"dom":[],"dynamic_code":[],"wasm":[],"obfuscation_hints":[],"risks":[],"evidence":[{"file":"/Users/jfri/Downloads/kbfnbcaeplbcioakkpcpgfkobkghlhen/src/js/Grammarly-bg.js","start":82004,"end":82141,"ast_id":null},{"file":"/Users/jfri/Downloads/kbfnbcaeplbcioakkpcpgfkobkghlhen/src/js/Grammarly-bg.js","start":82143,"end":82369,"ast_id":null},{"file":"/Users/jfri/Downloads/kbfnbcaeplbcioakkpcpgfkobkghlhen/src/js/Grammarly-bg.js","start":82444,"end":83998,"ast_id":null}]},"notes":"This chunk contains the main application bootstrap logic. It defines the `PageConfigLoader` (_Q) which fetches remote configuration from a CDN, and the `PassportService` (xQ) which fetches user feature entitlements from the 'goldengate' API. The primary class, `b0`, is the main background application orchestrator, initializing all core services like Auth, Settings, CAPI, DAPI, Experimentation, and setting up lifecycle event listeners (`onInstalled`, `onStartup`)."}
{"file":"/Users/jfri/Downloads/kbfnbcaeplbcioakkpcpgfkobkghlhen/src/js/Grammarly-bg.beautified.js","beautified":"/Users/jfri/Downloads/kbfnbcaeplbcioakkpcpgfkobkghlhen/src/js/Grammarly-bg.beautified.js","chunk":{"id":"chunk-43/46","start_line":84001,"end_line":86000,"same_function_group":null},"findings":{"chrome_apis":["chrome.storage.managed.get","chrome.storage.session.get","chrome.storage.session.set","chrome.storage.session.clear","chrome.storage.session.remove","chrome.storage.session.onChanged","chrome.scripting.executeScript","chrome.scripting.insertCSS","chrome.tabs.create","chrome.tabs.remove","chrome.tabs.update","chrome.tabs.query","chrome.tabs.getZoom","chrome.tabs.onActivated","chrome.tabs.onUpdated","chrome.windows.onFocusChanged","chrome.runtime.connectNative","chrome.action.setBadgeText","chrome.action.setIcon","chrome.action.setTitle","chrome.action.setBadgeBackgroundColor","chrome.notifications.create","chrome.notifications.clear","chrome.cookies.get","chrome.cookies.remove","chrome.cookies.getAll","chrome.cookies.set","chrome.cookies.onChanged","chrome.management.uninstallSelf","chrome.permissions.onAdded","chrome.permissions.onRemoved","chrome.permissions.getAll","chrome.permissions.request","chrome.permissions.contains","chrome.runtime.reload","chrome.i18n.detectLanguage","chrome.i18n.getUILanguage","chrome.i18n.getAcceptLanguages","chrome.identity.*","chrome.runtime.setUninstallURL","chrome.sidePanel.open"],"event_listeners":["chrome.runtime.onConnect","chrome.runtime.onMessage","chrome.storage.onChanged","chrome.tabs.onActivated","chrome.tabs.onUpdated","chrome.windows.onFocusChanged","chrome.windows.onRemoved","chrome.cookies.onChanged","chrome.permissions.onAdded","chrome.permissions.onRemoved"],"messages":[],"storage":[{"key":"GrammarlyEnrollmentToken","type":"managed","op":"get"},{"key":"GrammarlyBlockedClients","type":"managed","op":"get"},{"key":"GrammarlyBlockedDomains","type":"managed","op":"get"},{"key":"GrammarlyConfidentialModeEnabled","type":"managed","op":"get"},{"key":"GrammarlyDlpEnabled","type":"managed","op":"get"},{"key":"GrammarlyExtensionMode","type":"managed","op":"get"}],"endpoints":[{"url_pattern":"/logv2","method":"POST","purpose":"Telemetry logging"},{"url_pattern":"/crashv2","method":"POST","purpose":"Crash report logging"}],"dom":[],"dynamic_code":[],"wasm":[],"obfuscation_hints":["generated_apis"],"risks":[],"evidence":[{"file":"/Users/jfri/Downloads/kbfnbcaeplbcioakkpcpgfkobkghlhen/src/js/Grammarly-bg.js","start":84048,"end":84145,"ast_id":null},{"file":"/Users/jfri/Downloads/kbfnbcaeplbcioakkpcpgfkobkghlhen/src/js/Grammarly-bg.js","start":84338,"end":84499,"ast_id":null},{"file":"/Users/jfri/Downloads/kbfnbcaeplbcioakkpcpgfkobkghlhen/src/js/Grammarly-bg.js","start":84888,"end":85861,"ast_id":null},{"file":"/Users/jfri/Downloads/kbfnbcaeplbcioakkpcpgfkobkghlhen/src/js/Grammarly-bg.js","start":85864,"end":86000,"ast_id":null}]},"notes":"This chunk defines the core infrastructure for telemetry and browser API abstraction. It includes a comprehensive telemetry client (C0, E0) for sending logs, crashes, and metrics. A central background environment singleton (x0) is initialized, holding references to all key services. A large Browser API wrapper (H0) is defined to abstract away MV2/MV3 differences for APIs like storage, scripting, tabs, notifications, cookies, and sidePanel. It also defines a massive 'gnarSpecClass' which acts as a schema for hundreds of specific user and system analytics events."}
{"file":"/Users/jfri/Downloads/kbfnbcaeplbcioakkpcpgfkobkghlhen/src/js/Grammarly-bg.beautified.js","beautified":"/Users/jfri/Downloads/kbfnbcaeplbcioakkpcpgfkobkghlhen/src/js/Grammarly-bg.beautified.js","chunk":{"id":"chunk-44/46","start_line":86001,"end_line":88000,"same_function_group":"gnarSpecClass"},"findings":{"chrome_apis":[],"event_listeners":[],"messages":[],"storage":[],"endpoints":[],"dom":[],"dynamic_code":[],"wasm":[],"obfuscation_hints":["generated_apis"],"risks":[{"type":"tracking","severity":"medium","justification":"Extremely detailed user action tracking. Hundreds of specific events are defined, covering almost every conceivable interaction with the extension's UI, from button clicks and popup views to feature usage and onboarding steps. This represents a very granular level of user behavior monitoring."}],"evidence":[{"file":"/Users/jfri/Downloads/kbfnbcaeplbcioakkpcpgfkobkghlhen/src/js/Grammarly-bg.js","start":86001,"end":88000,"ast_id":null}]},"notes":"This chunk continues the definition of the massive `gnarSpecClass`. It adds hundreds more analytics tracking methods. Key tracked features include: Auto-apply suggestions, brand tones uphooks, business features, citation generation, desktop integration, dunning messages, email summarization, ethical AI warnings, GDocs integration, handwriting recognition (HWR), in-product messages (IPM), and knowledge hub features. The level of detail in tracking is extremely high."}
{"file":"src/js/Grammarly-bg.js","beautified":"src/js/Grammarly-bg.beautified.js","chunk":{"id":"chunk-45/46","start_line":88001,"end_line":90439,"same_function_group":null},"findings":{"chrome_apis":[],"event_listeners":[],"messages":[],"storage":[],"endpoints":[],"dom":[],"dynamic_code":[],"wasm":[],"obfuscation_hints":["generated_apis"],"risks":[{"type":"tracking","severity":"high","description":"Final part of a massive, auto-generated analytics client (gnarSpecClass) with hundreds of methods for tracking granular user and system events across the entire application."}]},"evidence":[{"file":"src/js/Grammarly-bg.js","start":88001,"end":90438,"ast_id":null},{"file":"src/js/Grammarly-bg.js","start":90439,"end":90439,"ast_id":null}],"notes":"This final chunk completes the definition of the massive `gnarSpecClass` for analytics and contains the single most important line: `x0.init($0)`, which triggers the entire background script's initialization sequence."}
{"file":"/Users/jfri/Downloads/kbfnbcaeplbcioakkpcpgfkobkghlhen/src/js/Grammarly-check.js","beautified":"/Users/jfri/Downloads/kbfnbcaeplbcioakkpcpgfkobkghlhen/src/js/Grammarly-check.beautified.js","chunk":{"id":"chunk-1/8","start_line":1,"end_line":2000,"same_function_group":null},"findings":{"chrome_apis":[],"event_listeners":[],"messages":[],"storage":[],"endpoints":[{"url":"https://properties.grammarly.com","method":"GET/POST"},{"url":"https://treatment.grammarly.com","method":"POST"},{"url":"https://gates.grammarly.com","method":"POST"},{"url":"https://f-log-extension.grammarly.io","method":"POST"},{"url":"https://extension.femetrics.grammarly.io/batch/import","method":"POST"}],"dom":[],"dynamic_code":[],"wasm":[],"obfuscation_hints":["webpack_modules","minified_vars"],"risks":[{"type":"tracking","severity":"medium","description":"The extension includes a comprehensive A/B testing and feature gating framework that reports user interactions and experiment exposures to Grammarly servers."}]},"evidence":[{"file":"/Users/jfri/Downloads/kbfnbcaeplbcioakkpcpgfkobkghlhen/src/js/Grammarly-check.js","start":25,"end":400},{"file":"/Users/jfri/Downloads/kbfnbcaeplbcioakkpcpgfkobkghlhen/src/js/Grammarly-check.js","start":1800,"end":1900}],"notes":"This chunk contains the core of a sophisticated experimentation (A/B testing) and feature gating system. It defines clients for fetching treatments and gates from remote services, logging user exposure, and dynamically configuring the application. It also includes a reactive state management library."}
{"file":"/Users/jfri/Downloads/kbfnbcaeplbcioakkpcpgfkobkghlhen/src/js/Grammarly-check.js","beautified":"/Users/jfri/Downloads/kbfnbcaeplbcioakkpcpgfkobkghlhen/src/js/Grammarly-check.beautified.js","chunk":{"id":"chunk-2/8","start_line":2001,"end_line":4000,"same_function_group":null},"findings":{"chrome_apis":[],"event_listeners":[],"messages":[],"storage":[],"endpoints":[{"url":"https://data.grammarly.com","method":"N/A"},{"url":"https://auth.grammarly.com/v3","method":"N/A"},{"url":"https://auth.grammarly.com/v4","method":"N/A"},{"url":"https://auth.grammarly.com/v5","method":"N/A"},{"url":"https://capi.grammarly.com/api/configuration/cheetah/v1/settings","method":"N/A"},{"url":"https://gateway.grammarly.com/skills","method":"N/A"},{"url":"https://capi.grammarly.com","method":"N/A"},{"url":"https://coda.grammarly.com","method":"N/A"},{"url":"wss://capi.grammarly.com/freews","method":"WebSocket"},{"url":"https://dox.grammarly.com/documents","method":"N/A"},{"url":"https://gateway.grammarly.com/passport/api/v1/passport","method":"N/A"},{"url":"https://config.extension.grammarly.com/dynamicConfig.json","method":"GET"},{"url":"https://config.extension.grammarly.com/browserplugin/config.json","method":"GET"},{"url":"https://rwsgfy.grammarly.com/stand-with-ukraine","method":"N/A"},{"url":"https://in-product.report.grammarly.io/v1/report","method":"N/A"},{"url":"https://gateway.grammarly.com/privacy/v1/api/data-sharing","method":"N/A"},{"url":"https://gateway.grammarly.com/vito","method":"N/A"},{"url":"https://gateway.grammarly.com/uhub","method":"N/A"},{"url":"https://gateway.grammarly.com/mise/api/v1","method":"N/A"}],"dom":[],"dynamic_code":[],"wasm":[],"obfuscation_hints":["minified_vars"],"risks":[]},"evidence":[{"file":"/Users/jfri/Downloads/kbfnbcaeplbcioakkpcpgfkobkghlhen/src/js/Grammarly-check.js","start":2001,"end":2200}],"notes":"This chunk defines a massive configuration object containing a large number of URLs for various Grammarly services, including authentication, API gateways, data services, logging, and settings. It also defines a shared environment for the content script, initializes logging services, and sets up telemetry. The code continues to be structured as Webpack modules."}
{"file":"/Users/jfri/Downloads/kbfnbcaeplbcioakkpcpgfkobkghlhen/src/js/Grammarly-check.js","beautified":"/Users/jfri/Downloads/kbfnbcaeplbcioakkpcpgfkobkghlhen/src/js/Grammarly-check.beautified.js","chunk":{"id":"chunk-3/8","start_line":4001,"end_line":6000,"same_function_group":null},"findings":{"chrome_apis":[],"event_listeners":[],"messages":[],"storage":[],"endpoints":[],"dom":[],"dynamic_code":[],"wasm":[],"obfuscation_hints":["minified_vars"],"risks":[{"type":"tracking","severity":"medium","description":"Extensive and granular telemetry system tracking a wide range of user interactions, feature usage, performance metrics, and errors. The volume of data collected could have privacy implications."}]},"evidence":[{"file":"/Users/jfri/Downloads/kbfnbcaeplbcioakkpcpgfkobkghlhen/src/js/Grammarly-check.js","start":4001,"end":6000}],"notes":"This chunk continues the definition of a massive telemetry object. It contains hundreds of methods for logging specific events related to UI interactions, feature usage (GDocs, KnowledgeHub, Auto-apply), performance, errors, and in-app marketing campaigns (via Iterable). The primary risk is the extensive user activity tracking."}
{"file":"/Users/jfri/Downloads/kbfnbcaeplbcioakkpcpgfkobkghlhen/src/js/Grammarly-check.js","beautified":"/Users/jfri/Downloads/kbfnbcaeplbcioakkpcpgfkobkghlhen/src/js/Grammarly-check.beautified.js","chunk":{"id":"chunk-4/8","start_line":6001,"end_line":8000,"same_function_group":null},"findings":{"chrome_apis":[],"event_listeners":[],"messages":[{"name":"tracking/RPC","direction":"content->background","payload_keys":["function_name","...args"],"evidence":[{"file":"/Users/jfri/Downloads/kbfnbcaeplbcioakkpcpgfkobkghlhen/src/js/Grammarly-check.js","start":6070,"end":6085}]}],"storage":[],"endpoints":[],"dom":[{"type":"style_injection","description":"Injects CSS for UI elements like animated underlines.","evidence":[{"file":"/Users/jfri/Downloads/kbfnbcaeplbcioakkpcpgfkobkghlhen/src/js/Grammarly-check.js","start":7000,"end":7010}]}],"dynamic_code":[],"wasm":[],"obfuscation_hints":["minified_vars","webpack_modules"],"risks":[{"type":"tracking","severity":"low","description":"A generic RPC mechanism for tracking function calls from the content script to the background script exists, labeled 'tracking/RPC'."}]},"evidence":[{"file":"/Users/jfri/Downloads/kbfnbcaeplbcioakkpcpgfkobkghlhen/src/js/Grammarly-check.js","start":6001,"end":8000}],"notes":"This chunk contains utility functions for the telemetry system, including error formatters, performance measurement tools, and domain classification helpers ('top sites'). It also includes a generic proxy for tracking function calls via an RPC message named 'tracking/RPC'. The file contains a significant portion of the RxJS library, indicating a reactive programming model. Finally, it includes CSS-in-JS modules for injecting styles into the DOM."}{"file":"src/js/Grammarly-check.js","beautified":"src/js/Grammarly-check.beautified.js","chunk":{"id":"chunk-5/8","start_line":8001,"end_line":10000,"same_function_group":null},"findings":{"chrome_apis":["chrome.runtime.getManifest","chrome.runtime.sendMessage","chrome.runtime.getURL"],"event_listeners":[],"messages":[],"storage":[],"endpoints":[],"dom":[],"dynamic_code":["import()","__webpack_require__.e"],"wasm":[],"obfuscation_hints":["minified_vars","webpack_modules"],"risks":[{"type":"fingerprinting","severity":"medium","description":"The code includes UAParser.js, a library for parsing user-agent strings to identify browser, OS, CPU, and device, which is a form of fingerprinting."},{"type":"tracking","severity":"medium","description":"The fingerprinting data is likely sent with other telemetry, enriching the user tracking profile."}]},"evidence":[{"file":"src/js/Grammarly-check.js","start":8799,"end":9803,"ast_id":null}],"notes":"This chunk contains RxJS utilities, the UAParser.js library for fingerprinting, and the webpack runtime for dynamic script/CSS loading. It also has logic for managing content script updates and loading the main assistant based on feature gates."}
{"file":"src/js/Grammarly-check.js","beautified":"src/js/Grammarly-check.beautified.js","chunk":{"id":"chunk-6/8","start_line":10001,"end_line":12000,"same_function_group":null},"findings":{"chrome_apis":[],"event_listeners":[],"messages":[],"storage":[],"endpoints":[],"dom":[{"selector":"[contenteditable]","action":"read"},{"selector":"textarea","action":"read"},{"selector":"iframe","action":"read"}],"dynamic_code":[],"wasm":[],"obfuscation_hints":["minified_vars","webpack_modules"],"risks":[{"type":"tracking","severity":"high","description":"A TypingTracker is implemented to monitor all user keystrokes in contenteditable elements, textareas, and iframes. It captures the text, duration, and field type, and sends this detailed typing data to a remote server for analysis. This constitutes extensive user activity tracking."},{"type":"pii_exfiltration","severity":"high","description":"The TypingTracker captures all text typed by the user. If the user is writing sensitive personal information (PII), that data is collected and sent to Grammarly's servers."}]},"evidence":[{"file":"src/js/Grammarly-check.js","start":10250,"end":10500,"ast_id":null}],"notes":"This chunk defines logic for identifying editable fields (contenteditable, textareas, various rich text editors) and implements a TypingTracker to monitor and report detailed user typing activity, including the text itself, for analytics."}
{"file":"src/js/Grammarly-check.beautified.js","beautified":"src/js/Grammarly-check.beautified.js","chunk":{"id":"chunk-7/8","start_line":12001,"end_line":14000,"same_function_group":null},"findings":{"chrome_apis":["chrome.storage.managed.get","chrome.storage.session.get","chrome.storage.session.set","chrome.storage.session.remove","chrome.storage.session.clear","chrome.storage.session.onChanged","chrome.scripting.executeScript","chrome.scripting.insertCSS","chrome.runtime.connectNative","chrome.notifications.create","chrome.cookies.get","chrome.cookies.remove","chrome.cookies.getAll","chrome.cookies.set","chrome.permissions.onAdded","chrome.permissions.onRemoved","chrome.permissions.getAll","chrome.permissions.request"],"event_listeners":["port.onMessage","port.onDisconnect","chrome.runtime.onMessage","chrome.windows.onFocusChanged","chrome.windows.onRemoved","chrome.tabs.onActivated","chrome.tabs.onUpdated","chrome.cookies.onChanged"],"messages":[{"name":"message:to-priv","direction":"content->background","payload_keys":[]},{"name":"side-panel-close-status","direction":"background->content","payload_keys":[]},{"name":"message-bus-port","direction":"content->background","payload_keys":[]}],"storage":[{"key":"gr-oauth-key","type":"local","op":"set"},{"key":"gr-oauth-service-state","type":"local","op":"set"},{"key":"gr-oauth-state","type":"local","op":"set"},{"key":"GrammarlyEnrollmentToken","type":"managed","op":"get"},{"key":"GrammarlyBlockedClients","type":"managed","op":"get"},{"key":"GrammarlyBlockedDomains","type":"managed","op":"get"}],"endpoints":[{"url":"https://auth.grammarly.com/v4/api/oauth2/authorize","method":"POST"},{"url":"https://auth.grammarly.com/v4/api/oauth2/exchange","method":"POST"},{"url":"https://auth.grammarly.com/v4/api/oauth2/token","method":"POST"},{"url":"https://auth.grammarly.com/v4/api/revoke-by-refresh-token","method":"POST"},{"url":"https://auth.grammarly.com/v4/api/userinfo","method":"POST"},{"url":"https://auth.ppgr.io/v4/api/oauth2/authorize","method":"POST"},{"url":"https://auth.qagr.io/v4/api/oauth2/authorize","method":"POST"}],"dom":[],"dynamic_code":["chrome.scripting.executeScript","chrome.scripting.insertCSS"],"wasm":[],"obfuscation_hints":[],"risks":[{"type":"other","severity":"low","description":"Complex authentication flow could be an attack surface."}]},"evidence":[{"file":"src/js/Grammarly-check.beautified.js","start":12300,"end":13000},{"file":"src/js/Grammarly-check.beautified.js","start":12185,"end":12285},{"file":"src/js/Grammarly-check.beautified.js","start":13208,"end":13288},{"file":"src/js/Grammarly-check.beautified.js","start":13510,"end":13560}],"notes":"This chunk contains a full OAuth 2.0 client, a robust HTTP client with retry logic, the content script bootstrapper, and support for enterprise policies."}
{"file":"src/js/Grammarly-check.beautified.js","beautified":"src/js/Grammarly-check.beautified.js","chunk":{"id":"chunk-8/8","start_line":14001,"end_line":14264,"same_function_group":null},"findings":{"chrome_apis":["chrome.sidePanel.open","chrome.action.openPopup","chrome.runtime.reload","chrome.i18n.detectLanguage","chrome.i18n.getUILanguage","chrome.i18n.getAcceptLanguages","chrome.identity.*","chrome.runtime.setUninstallURL","chrome.runtime.connectNative","chrome.storage.onChanged"],"event_listeners":["chrome.runtime.onMessage"],"messages":[],"storage":[],"endpoints":[],"dom":[{"selector":"#click-to-run","action":"addEventListener","event":"click"}],"dynamic_code":[],"wasm":[],"obfuscation_hints":[],"risks":[{"type":"fingerprinting","severity":"low","description":"Detects if other specific extensions (Microsoft Editor, Office) are installed."}]},"evidence":[{"file":"src/js/Grammarly-check.beautified.js","start":14001,"end":14264}],"notes":"This is the final chunk and the main entry point for the content check script. It initializes all core components, fetches A/B test configurations, sets up reactive state management with RxJS, and decides whether to inject the main content script. It also includes logic for handling the side panel, popups, and detecting other installed extensions."}
{"file":"src/js/Grammarly.beautified.js","beautified":"src/js/Grammarly.beautified.js","chunk":{"id":"chunk-1/48","start_line":1,"end_line":2000,"same_function_group":null},"findings":{"chrome_apis":[],"event_listeners":[],"messages":[],"storage":[],"endpoints":[],"dom":[],"dynamic_code":[],"wasm":[],"obfuscation_hints":["webpack_modules"],"risks":[]},"evidence":[{"file":"src/js/Grammarly.beautified.js","start":1,"end":2000}],"notes":"This chunk contains the Webpack bootstrap code, color definitions, and low-level data structure manipulations for the editor's delta format. It includes utilities for diffing, composing, and iterating over document changes."}
{"file":"/Users/jfri/Downloads/kbfnbcaeplbcioakkpcpgfkobkghlhen/src/js/Grammarly.beautified.js","beautified":"/Users/jfri/Downloads/kbfnbcaeplbcioakkpcpgfkobkghlhen/src/js/Grammarly.beautified.js","chunk":{"id":"chunk-2/48","start_line":2001,"end_line":4000,"same_function_group":null},"findings":{"chrome_apis":[],"event_listeners":[],"messages":[],"storage":[],"endpoints":[],"dom":[],"dynamic_code":[],"wasm":[],"obfuscation_hints":["webpack_modules"],"risks":[]},"evidence":[{"file":"/Users/jfri/Downloads/kbfnbcaeplbcioakkpcpgfkobkghlhen/src/js/Grammarly.beautified.js","start":2001,"end":4000}],"notes":"This chunk defines the core data models and management classes for alerts. It includes the BaseAlert class and its many subclasses (PremiumAlert, PlagiarismAlert, DefaultAlert, etc.), which represent different types of suggestions. It also defines AlertRangeManager and AlertAlternativeManager to handle the lifecycle of text ranges and suggestion alternatives. The chunk also contains a suite of custom React hooks (useFocusTrap), styling utilities, and geometric calculation helpers for positioning UI."}
{"file":"/Users/jfri/Downloads/kbfnbcaeplbcioakkpcpgfkobkghlhen/src/js/Grammarly.beautified.js","beautified":"/Users/jfri/Downloads/kbfnbcaeplbcioakkpcpgfkobkghlhen/src/js/Grammarly.beautified.js","chunk":{"id":"chunk-3/48","start_line":4001,"end_line":6000,"same_function_group":null},"findings":{"chrome_apis":[],"event_listeners":[],"messages":[],"storage":[],"endpoints":[],"dom":[],"dynamic_code":[],"wasm":[],"obfuscation_hints":["webpack_modules"],"risks":[]},"evidence":[{"file":"/Users/jfri/Downloads/kbfnbcaeplbcioakkpcpgfkobkghlhen/src/js/Grammarly.beautified.js","start":4001,"end":6000}],"notes":"This chunk contains a large number of predicate functions for determining the type and state of alerts (e.g., isCritical, isPlagiarism, isToneAI). It includes a factory function for creating alert objects, mock data generation functions for testing, and the core PositionManager class. The PositionManager is responsible for tracking text ranges and updating their positions when the document changes, using a delta-based update mechanism. It also defines a comprehensive set of constants for all possible UI actions and events."}
{"file":"/Users/jfri/Downloads/kbfnbcaeplbcioakkpcpgfkobkghlhen/src/js/Grammarly.beautified.js","beautified":"/Users/jfri/Downloads/kbfnbcaeplbcioakkpcpgfkobkghlhen/src/js/Grammarly.beautified.js","chunk":{"id":"chunk-4/48","start_line":6001,"end_line":8000,"same_function_group":null},"findings":{"chrome_apis":[],"event_listeners":[],"messages":[],"storage":[],"endpoints":[{"url":"https://properties.grammarly.com","purpose":"Experimentation service for feature properties","evidence_file":"src/js/Grammarly.beautified.js","start_line":7638,"end_line":7647},{"url":"https://treatment.grammarly.com","purpose":"Experimentation service for A/B testing treatments","evidence_file":"src/js/Grammarly.beautified.js","start_line":7638,"end_line":7647},{"url":"https://gates.grammarly.com/gates/get","purpose":"Feature gating service","evidence_file":"src/js/Grammarly.beautified.js","start_line":7818,"end_line":7818}],"dom":[],"dynamic_code":[],"wasm":[],"obfuscation_hints":["minified_vars","webpack_modules"],"risks":[{"type":"remote_code","severity":"low","description":"The extension uses a feature flagging and A/B testing client that fetches configuration from remote servers (e.g., grammarly.com, ppgr.io, qagr.io). This allows for remote configuration of the extension's behavior.","evidence_file":"src/js/Grammarly.beautified.js","start_line":7708,"end_line":7789}]},"evidence":[{"file":"/Users/jfri/Downloads/kbfnbcaeplbcioakkpcpgfkobkghlhen/src/js/Grammarly.beautified.js","start":6001,"end":8000}],"notes":"Discovered a comprehensive DLP/sanitization module for scrubbing sensitive user data (PII, credit cards, etc.) using regex. Also found a full-featured experimentation (A/B testing) and feature gating client that communicates with remote endpoints to configure extension behavior. This chunk also defines the document context (domain, goals, audience) used for tailoring suggestions and contains many DOM/geometry utilities."}
{"file":"/Users/jfri/Downloads/kbfnbcaeplbcioakkpcpgfkobkghlhen/src/js/Grammarly.beautified.js","beautified":"/Users/jfri/Downloads/kbfnbcaeplbcioakkpcpgfkobkghlhen/src/js/Grammarly.beautified.js","chunk":{"id":"chunk-5/48","start_line":8001,"end_line":10000,"same_function_group":null},"findings":{"chrome_apis":[],"event_listeners":[],"messages":[],"storage":[],"endpoints":[],"dom":[],"dynamic_code":[],"wasm":[],"obfuscation_hints":["webpack_modules","minified_vars","third_party_libs"],"risks":[]},"evidence":[{"file":"/Users/jfri/Downloads/kbfnbcaeplbcioakkpcpgfkobkghlhen/src/js/Grammarly.beautified.js","start":8001,"end":10000}],"notes":"This chunk contains a large, bundled portion of the RxJS library and a related reactive programming library, likely '@grammarly/focal'. It includes core reactive programming primitives like Observable, Subject, BehaviorSubject, Atom, and Lens, along with a vast number of operators (map, filter, switchMap, etc.). This code provides the foundational framework for managing state and events throughout the application but contains no specific Grammarly business logic itself."}
{"file":"/Users/jfri/Downloads/kbfnbcaeplbcioakkpcpgfkobkghlhen/src/js/Grammarly.beautified.js","beautified":"/Users/jfri/Downloads/kbfnbcaeplbcioakkpcpgfkobkghlhen/src/js/Grammarly.beautified.js","chunk":{"id":"chunk-6/48","start_line":10001,"end_line":12000,"same_function_group":null},"findings":{"chrome_apis":[],"event_listeners":[],"messages":[],"storage":[],"endpoints":[],"dom":[],"dynamic_code":[],"wasm":[],"obfuscation_hints":["webpack_modules","minified_vars","third_party_libs"],"risks":[]},"evidence":[{"file":"/Users/jfri/Downloads/kbfnbcaeplbcioakkpcpgfkobkghlhen/src/js/Grammarly.beautified.js","start":10001,"end":12000}],"notes":"This chunk continues the bundled RxJS/Focal library code. It includes a vast number of RxJS operators and a comprehensive internal logging framework with features like log levels, rate limiting, metrics, and different sinks (including a remote logging sink). It also contains utilities for working with Quill-like delta operations, which are used for representing document changes."}
{"file":"/Users/jfri/Downloads/kbfnbcaeplbcioakkpcpgfkobkghlhen/src/js/Grammarly.beautified.js","beautified":"/Users/jfri/Downloads/kbfnbcaeplbcioakkpcpgfkobkghlhen/src/js/Grammarly.beautified.js","chunk":{"id":"chunk-7/48","start_line":12001,"end_line":14000,"same_function_group":null},"findings":{"chrome_apis":[],"event_listeners":[],"messages":[],"storage":[],"endpoints":[],"dom":["getBoundingClientRect","getOffsetParent","getComputedStyle"],"dynamic_code":[],"wasm":[],"obfuscation_hints":["minified_vars"],"risks":[],"third_party_libs":["Popper.js"]},"evidence":[{"file":"/Users/jfri/Downloads/kbfnbcaeplbcioakkpcpgfkobkghlhen/src/js/Grammarly.beautified.js","start":13800,"end":14000}],"notes":"This chunk details the implementation of the Alternative class for managing text suggestions, including complex rebase and compose logic. It also defines the comprehensive data model for Alerts, including parsers (fromAlertMessage) and type guards for specialized alerts like Plagiarism, ToneAI, and Citations. A large number of enums define user interaction events (e.g., ACCEPTED, IGNORE, APPLY, REVERT). Finally, it includes the start of the bundled Popper.js library for UI positioning."}
{"file":"/Users/jfri/Downloads/kbfnbcaeplbcioakkpcpgfkobkghlhen/src/js/Grammarly.beautified.js","beautified":"/Users/jfri/Downloads/kbfnbcaeplbcioakkpcpgfkobkghlhen/src/js/Grammarly.beautified.js","chunk":{"id":"chunk-8/48","start_line":14001,"end_line":16000,"same_function_group":null},"findings":{"chrome_apis":[],"event_listeners":[],"messages":[],"storage":[],"endpoints":[],"dom":[],"dynamic_code":[],"wasm":[],"obfuscation_hints":["minified_vars"],"risks":[],"third_party_libs":["Popper.js"]},"evidence":[{"file":"/Users/jfri/Downloads/kbfnbcaeplbcioakkpcpgfkobkghlhen/src/js/Grammarly.beautified.js","start":14001,"end":15000}],"notes":"This chunk continues the bundled Popper.js library, including modifiers for `preventOverflow`, `arrow`, and `hide`. It also contains a large, declarative definition of the extension's UI component model. This model defines the schema for all UI elements, such as `ContentText`, `AssistantCard`, `PopoverStack`, various `gButton` types, `list`, `row`, `column`, `icon`, `image`, etc. This appears to be a comprehensive, in-house UI framework or view-model definition layer, likely used with a rendering library like React."}
{"file":"/Users/jfri/Downloads/kbfnbcaeplbcioakkpcpgfkobkghlhen/src/js/Grammarly.beautified.js","beautified":"/Users/jfri/Downloads/kbfnbcaeplbcioakkpcpgfkobkghlhen/src/js/Grammarly.beautified.js","chunk":{"id":"chunk-9/48","start_line":16001,"end_line":18000,"same_function_group":null},"findings":{"chrome_apis":[],"event_listeners":[],"messages":[],"storage":[],"endpoints":[],"dom":[],"dynamic_code":[],"wasm":[],"obfuscation_hints":["minified_vars"],"risks":[],"third_party_libs":[]},"evidence":[{"file":"/Users/jfri/Downloads/kbfnbcaeplbcioakkpcpgfkobkghlhen/src/js/Grammarly.beautified.js","start":16001,"end":18000}],"notes":"This chunk continues the declarative definition of the UI component model. It specifies the schemas for many more components, including `Tooltip`, `ClickableText`, `Count`, `AlternativeChoice`, `Slider`, and numerous 'native' components (`nativeSkillsModal`, `nativeToneInsightsModal`, etc.). It also defines the data structures for user actions and behaviors that can be attached to these components. The code uses a custom type-checking or schema-definition library (likely minified `io-ts` or similar) to define every property of every component, from colors and sizes to complex nested content. This chunk reinforces the conclusion that the extension uses a highly structured, data-driven approach to building its user interface."}
{"file":"/Users/jfri/Downloads/kbfnbcaeplbcioakkpcpgfkobkghlhen/src/js/Grammarly.beautified.js","beautified":"/Users/jfri/Downloads/kbfnbcaeplbcioakkpcpgfkobkghlhen/src/js/Grammarly.beautified.js","chunk":{"id":"chunk-10/48","start_line":18001,"end_line":20000,"same_function_group":null},"findings":{"chrome_apis":[],"event_listeners":[],"messages":[],"storage":[],"endpoints":[],"dom":[],"dynamic_code":[],"wasm":[],"obfuscation_hints":["minified_vars"],"risks":[],"third_party_libs":[]},"evidence":[{"file":"/Users/jfri/Downloads/kbfnbcaeplbcioakkpcpgfkobkghlhen/src/js/Grammarly.beautified.js","start":18001,"end":20000}],"notes":"This chunk is dense with core logic. It finalizes the UI tree traversal utilities and defines a `dslRootParser` that uses a schema to validate the UI component tree, confirming a data-driven UI approach. It contains a comprehensive theme/color palette mapping semantic names to hex codes. A significant finding is the implementation of a Server-Driven UI (SDUI) system, complete with data structures (`Item`, `AlertId`) and a sophisticated `Diff` engine to efficiently apply updates from the server. The chunk also includes the `AlwaysAvailableAssistantLoader` class, which controls the loading and unloading of the main assistant based on feature flags and extension version updates. Finally, it details the `FieldIntegrationStore` and `TypingTrackerImpl` classes, which manage how Grammarly integrates with text fields and tracks user typing for metrics and language detection."}
{"file":"/Users/jfri/Downloads/kbfnbcaeplbcioakkpcpgfkobkghlhen/src/js/Grammarly.beautified.js","beautified":"/Users/jfri/Downloads/kbfnbcaeplbcioakkpcpgfkobkghlhen/src/js/Grammarly.beautified.js","chunk":{"id":"chunk-11/48","start_line":20001,"end_line":22000,"same_function_group":null},"findings":{"chrome_apis":["chrome.runtime.connect","chrome.storage.managed.get","chrome.storage.session.get","chrome.storage.session.set","chrome.storage.session.remove","chrome.storage.session.clear","chrome.storage.onChanged","chrome.scripting.executeScript","chrome.scripting.insertCSS","chrome.tabs.create","chrome.tabs.remove","chrome.tabs.update","chrome.tabs.query","chrome.tabs.getZoom","chrome.tabs.onActivated","chrome.tabs.onUpdated","chrome.windows.onFocusChanged","chrome.windows.onRemoved","chrome.tabs.sendMessage","chrome.action.setBadgeText","chrome.action.setIcon","chrome.action.setTitle","chrome.action.setBadgeBackgroundColor","chrome.runtime.getURL","chrome.notifications.create","chrome.notifications.onClicked","chrome.notifications.onButtonClicked","chrome.notifications.onClosed","chrome.notifications.clear","chrome.cookies.get","chrome.cookies.remove","chrome.cookies.getAll","chrome.cookies.set","chrome.cookies.onChanged","chrome.management.uninstallSelf","chrome.permissions.onAdded","chrome.permissions.onRemoved","chrome.permissions.getAll","chrome.permissions.request","chrome.permissions.contains","chrome.runtime.reload","chrome.i18n.detectLanguage","chrome.i18n.getUILanguage","chrome.i18n.getAcceptLanguages","chrome.runtime.onMessage","chrome.runtime.setUninstallURL","chrome.sidePanel.open","chrome.action.openPopup"],"event_listeners":["port.onMessage","port.onDisconnect","runtime.onMessage","tabs.onUpdated","tabs.onRemoved","tabs.onActivated","windows.onFocusChanged","windows.onRemoved","cookies.onChanged","permissions.onAdded","permissions.onRemoved"],"messages":[{"name":"CODE_SPLITTING_INJECT","direction":"other","payload_keys":[]},{"name":"contentScript-disconnected","direction":"other","payload_keys":[]}],"storage":[{"key":"any","type":"managed","op":"get"},{"key":"any","type":"local","op":"get"},{"key":"any","type":"local","op":"set"},{"key":"any","type-":"local","op":"remove"},{"key":"any","type":"session","op":"get"},{"key":"any","type":"session","op":"set"},{"key":"any","type":"session","op":"remove"},{"key":"any","type":"session","op":"clear"}],"endpoints":[],"dom":["document.body.dataset"],"dynamic_code":["chrome.scripting.executeScript"],"wasm":[],"obfuscation_hints":["minified_vars"],"risks":[],"third_party_libs":[]},"evidence":[{"file":"/Users/jfri/Downloads/kbfnbcaeplbcioakkpcpgfkobkghlhen/src/js/Grammarly.beautified.js","start":20001,"end":22000}],"notes":"This chunk is a massive collection of API wrappers and client-side business logic. It defines actions for modifying all parts of the extension's settings, including GDocs integration, Cheetah (generative AI), knowledge hub, user data sharing, and various uphooks and popups. It introduces a `Kt` class, a transport layer for RPC between frames/tabs. A significant portion is dedicated to a comprehensive wrapper around the Chrome Extension API (`un` class), abstracting away differences between Manifest V2 and V3 and providing a consistent interface for managing tabs, storage (local, session, managed), notifications, cookies, permissions, and i18n. It also includes the logic for the main application controller (`Kn` class), which initializes all integrations, manages the application lifecycle, and handles state updates from the persistent store."}
{"file":"src/js/Grammarly.beautified.js","beautified":"src/js/Grammarly.beautified.js","chunk":{"id":"chunk-12/48","start_line":22001,"end_line":24000,"same_function_group":null},"findings":{"chrome_apis":["chrome.runtime.getManifest","chrome.runtime.id","chrome.sessionStorage.get","chrome.sessionStorage.set","chrome.sessionStorage.onChange","chrome.bgRpc.api.openSidePanel","chrome.bgRpc.api.isPermissionGranted","chrome.nativeMessaging"],"event_listeners":[],"messages":[{"name":"gr-fieldIntegration-to-aaaNotch-to-server","direction":"content->background","payload_keys":[]},{"name":"gr-fieldIntegration-to-aaaNotch-to-client","direction":"background->content","payload_keys":[]},{"name":"side-panel-to-cs-text-field-rpc_to-client","direction":"background->content","payload_keys":[]},{"name":"side-panel-to-cs-text-field-rpc_to-server","direction":"content->background","payload_keys":[]},{"name":"cs-text-field-to-side-panel-rpc_to-client","direction":"background->content","payload_keys":[]},{"name":"cs-text-field-to-side-panel-rpc_to-server","direction":"content->background","payload_keys":[]},{"name":"setActiveTextFieldId","direction":"content->background","payload_keys":["textFieldId","alertCounts"]},{"name":"unsetActiveTextFieldId","direction":"content->background","payload_keys":["textFieldId"]}],"storage":[{"key":"alwaysOnAssistantOnOpenData","type":"session","op":"set"},{"key":"alwaysOnAssistant","type":"session","op":"set"},{"key":"isSidePanelOpen","type":"session","op":"get"}],"endpoints":[],"dom":[{"element":"document.body.dataset","kind":"write","evidence":[{"file":"src/js/Grammarly.beautified.js","start":22081,"end":22081}]},{"element":"document.body.dataset","kind":"read","evidence":[{"file":"src/js/Grammarly.beautified.js","start":22084,"end":22084}]}],"dynamic_code":[],"wasm":[],"obfuscation_hints":["minified_vars","function_chains"],"risks":[]},"evidence":[{"file":"src/js/Grammarly.beautified.js","start":22001,"end":24000,"ast_id":null}],"notes":"Chunk 12 contains extensive logic for the Always-On Assistant (AAA) and Cheetah (GenAI) integrations. It defines RPC channels for communication between the content script, the AAA notch, and the side panel. It includes an `ActiveTextFieldReporter` to keep the side panel updated on the active text field. The `CheetahIntegrationBase` class provides core logic for GenAI features in text fields, with specific implementations for contenteditable and textarea. This chunk also reveals a native messaging connector for integration with a desktop app and numerous feature gates for controlling AI agents and UI flows."}
{"file":"src/js/Grammarly.beautified.js","beautified":"src/js/Grammarly.beautified.js","chunk":{"id":"chunk-13/48","start_line":24001,"end_line":26000,"same_function_group":null},"findings":{"chrome_apis":[],"event_listeners":[],"messages":[],"storage":[],"endpoints":[],"dom":[],"dynamic_code":[],"wasm":[],"obfuscation_hints":["minified_vars","webpack_modules","function_chains"],"risks":[{"type":"tracking","severity":"medium","justification":"The extension contains a detailed performance monitoring and metrics collection system (`PerformanceTimer`, `ProductMetricsClient`). It samples and sends various performance timers (e.g., `textInputLatencyV1`, `scrollLatencyV1`, `httpRequestLatency`) to backend services, including Databricks. This constitutes tracking of user interaction performance."}]},"evidence":[{"file":"src/js/Grammarly.beautified.js","start":24001,"end":26000,"ast_id":null}],"notes":"This chunk details a sophisticated system for feature flagging and performance monitoring. It includes logic for G2 vBars, Ghost Protocol, Human Writing Report (HWR), Knowledge Hub, and TouchTypist features, with availability determined by a complex combination of user type, domain, integration name, and numerous experiment flags. A `PerformanceTimer` class is used to collect and send detailed performance metrics (e.g., latency for text input, scrolling, HTTP requests) to backends like Femetrics and Databricks, using a sampling system to manage data volume. The code also uses `io-ts` for schema validation of these metrics. The `TouchTypist` feature has its own CAPI service and state management for real-time writing assistance."}
{"file":"src/js/Grammarly.beautified.js","beautified":"src/js/Grammarly.beautified.js","chunk":{"id":"chunk-14/48","start_line":26001,"end_line":28000,"same_function_group":null},"findings":{"chrome_apis":["chrome.storage"],"event_listeners":["message.on('sendCsLogsToPopup')","message.on('downloadDebugReportsFromCS')"],"messages":[],"storage":[{"key":"csHistoryLogs","type":"sessionStorage","op":"backup"},{"key":"bgHistoryLogs","type":"sessionStorage","op":"backup"}],"endpoints":[],"dom":[],"dynamic_code":[],"wasm":[],"obfuscation_hints":["webpack_modules","minified_vars"],"risks":[{"type":"tracking","severity":"medium","description":"A comprehensive SessionStatsManager and Iterable marketing client collect and report a wide range of granular user interactions, including text replacement statistics (by source, type, length) and engagement with in-product messages."}]},"evidence":[{"file":"src/js/Grammarly.beautified.js","start":27115,"end":27915,"ast_id":null},{"file":"src/js/Grammarly.beautified.js","start":26056,"end":26158,"ast_id":null},{"file":"src/js/Grammarly.beautified.js","start":27916,"end":28991,"ast_id":null}],"notes":"This chunk details a sophisticated declarative UI framework, a client for the 'Iterable' marketing/telemetry platform, and the core alert processing and session statistics management systems. The AlertProcessor is responsible for rebasing alert positions as text changes, while the SessionStatsManager collects and reports detailed metrics on user interactions and feature performance."}
{"file":"src/js/Grammarly.beautified.js","beautified":"src/js/Grammarly.beautified.js","chunk":{"id":"chunk-15/48","start_line":28001,"end_line":30000,"same_function_group":null},"findings":{"chrome_apis":[],"event_listeners":["document.addEventListener('keydown')","document.addEventListener('keypress')"],"messages":[],"storage":[],"endpoints":[],"dom":[],"dynamic_code":[],"wasm":[],"obfuscation_hints":["webpack_modules","minified_vars"],"risks":[{"type":"tracking","severity":"high","description":"This chunk implements an extremely detailed performance and interaction tracking system. It includes multiple profilers for 'resizeLatencyV1', 'scrollLatencyV1', 'textInputLatencyV1', 'alertProcessing', 'gButtonTextCheck', 'highlightsDisplay', and 'inlineAlertApply'. It also captures keyboard events ('keydown', 'keypress') during text replacements to preserve user input, which could be logged. The 'TouchTypist' and 'Human Writing Report' features also imply significant data collection."}]},"evidence":[{"file":"src/js/Grammarly.beautified.js","start":29308,"end":29880,"ast_id":null},{"file":"src/js/Grammarly.beautified.js","start":28184,"end":28310,"ast_id":null},{"file":"src/js/Grammarly.beautified.js","start":29106,"end":29298,"ast_id":null},{"file":"src/js/Grammarly.beautified.js","start":28992,"end":29105,"ast_id":null}],"notes":"This chunk details the implementation of 'AutoApply' and 'Autocorrect' features, including a sophisticated 'CaretPreservingReplacementServiceDecorator' that captures keyboard events. It also introduces a massive performance telemetry system with numerous profilers for various UI and processing latencies. Additionally, it lays the groundwork for several major features: 'TouchTypist' (with its own UI and auto-opt-out logic), 'Human Writing Report' (with encryption and storage clients), 'Inkwell' integration, and a deep linking service."}
{"file":"src/js/Grammarly.beautified.js","beautified":"src/js/Grammarly.beautified.js","chunk":{"id":"chunk-16/48","start_line":30001,"end_line":32000,"same_function_group":null},"findings":{"chrome_apis":[],"event_listeners":[],"messages":[],"storage":[{"key":"claimedUserSettings","type":"local","op":"get/patch","purpose":"Used by `Ji.h` (likely a settings manager) to track when a claimed user popup was last seen, to control its re-appearance."},{"key":"UserEngagedByAlertsAccepted","type":"local","op":"get/patch","purpose":"Used by `Fr` to track user engagement via alert acceptances for Iterable marketing campaigns."}],"endpoints":[],"dom":[{"element":"document","interaction":"execCommand","details":"The `br` (FormattingService) uses `document.execCommand` for 'bold', 'italic', 'underline', 'formatBlock' (for headers), and list creation ('insertOrderedList', 'insertUnorderedList')."},{"element":"grammarly-popups","interaction":"querySelectorAll","details":"The `wo` function queries for `grammarly-popups` and then for specific inner elements (`.assistant-root`, `.assistant-prompt-editor`) to programmatically focus the assistant when opened via a keyboard shortcut."}],"dynamic_code":[],"wasm":[],"obfuscation_hints":["minified_vars","webpack_modules","object_property_chaining"],"risks":[],"file_system":[]},"evidence":[{"file":"src/js/Grammarly.beautified.js","start_line":31800,"end_line":31807,"snippet":"this._ownerDoc.execCommand(\"bold\", !1), t.italic && this._ownerDoc.execCommand(\"italic\", !1), t.underline && this._ownerDoc.execCommand(\"underline\", !1)), _r.m.isHeaderFormatting(t) && void 0 !== t.header && this._ownerDoc.execCommand(\"formatBlock\", !1, `<H${t.header}>`), _r.m.isListFormatting(t) && this._ownerDoc.execCommand(\"ordered\" === t.list ? \"insertOrderedList\" : \"insertUnorderedList\")"},{"file":"src/js/Grammarly.beautified.js","start_line":30288,"end_line":30291,"snippet":"this._experimentClient.isGateEnabled(Ie.K.SduiBulkDismiss) ? this._sduiBufferService.pipe(E.oA, S.w((e => e.sduiFeaturesMap.view(\"bulk_dismiss\").view((e => new Set(e.map((e => e.alertIds)).flat()))))), C.O(new Set)) : R.of(new Set)"},{"file":"src/js/Grammarly.beautified.js","start_line":30500,"end_line":30509,"snippet":"const i = this._experimentClient.peekTreatment(rn.p.LockedUiDebouncedHoverUnlock); if (this._isDelayedUnlockEnabled = null !== i && \"control\" !== i, this._isDelayedUnlockEnabled) { const t = e.getDynamicConfiguration(rn.p.LockedUiDebouncedHoverUnlock); if (t) try { const e = JSON.parse(t); e && (this._unlockTimeoutValue = e.debounce_timeout_inline) } catch (e) { this._unlockTimeoutValue = 0, this._log.warn(\"Failed to parse delayed unlock experiment dynamic config\", e) }}"},{"file":"src/js/Grammarly.beautified.js","start_line":31900,"end_line":31907,"snippet":"function So() { const e = document.querySelectorAll(\"grammarly-popups\"); let t = null; return e.forEach((e => { null == t && e.shadowRoot && (t = e.shadowRoot.querySelector(yo.O0)) })), t }"},{"file":"src/js/Grammarly.beautified.js","start_line":31600,"end_line":31605,"snippet":"this._incrementCounter = async () => { const e = this._currentSettings.counter || -1 !== this._currentSettings.firstAlertAcceptedTimestamp ? this._currentSettings.firstAlertAcceptedTimestamp : Date.now(); await this._updateSettings({ firstAlertAcceptedTimestamp: e, counter: this._currentSettings.counter + 1 }) }"},{"file":"src/js/Grammarly.beautified.js","start_line":31188,"end_line":31195,"snippet":"const { user: n } = this._state.get(), i = new Ji.h(this._api.preferences), { claimedUserSettings: r } = await i.get([\"claimedUserSettings\"]), o = null !== (e = null == r ? void 0 : r.lastSeenTs) && void 0 !== e ? e : null, s = null !== (t = null == r ? void 0 : r.firstSeenTs) && void 0 !== t ? t : null, a = Date.now(), l = !s || a - s <= 20 * Ii.v0, c = !o || a - o > Ii.v0, u = l && c; Gi.n.isClaimed(n) && u && (await i.patch({ claimedUserSettings: { lastSeenTs: a, firstSeenTs: null != s ? s : a } }), this.openPopup({ type: \"claimedUser\" }))"}],"notes":"This chunk details the complex implementation of various inline card controllers, which manage the pop-ups that appear when a user interacts with an alert. It includes a factory (`Wi`) for creating different alert state services based on the interaction model (hover, click, touch). Key components include `Hi`, the main CAPI card controller, which handles rendering and user actions within the card; `ki`, an alert classifier and counter service that provides filtered views of alerts; and `zi`, a controller for a delayed-unlock feature for premium alerts controlled by an experiment. The chunk also defines a formatting service (`br`) that uses the deprecated `document.execCommand` for rich text actions, and logic (`wo`) to programmatically focus the assistant when opened via keyboard shortcut by querying the DOM for `grammarly-popups`."}
{"file":"src/js/Grammarly.beautified.js","beautified":"src/js/Grammarly.beautified.js","chunk":{"id":"chunk-17/48","start_line":32001,"end_line":34000,"same_function_group":null},"findings":{"chrome_apis":[{"api":"runtime.sendMessage","reason":"The `Qt` (HWR Storage Client) and `Jt` (HWR Encryption Client) use `(0, qe.OB)().bgRpc.api`, which is a proxy for `chrome.runtime.sendMessage` to communicate with the background script for storage and encryption operations related to the Human Writing Report feature."}],"event_listeners":[],"messages":[{"name":"hwr-storage","direction":"content->background","purpose":"Used by the Human Writing Report (HWR) feature to store and retrieve data securely via the background script."},{"name":"hwr-encryption","direction":"content->background","purpose":"Used by the Human Writing Report (HWR) feature to encrypt and decrypt data via the background script."}],"storage":[],"endpoints":[],"dom":[{"element":"document.body","interaction":"appendChild","details":"The `jr` (Perception Metrics Survey Controller) injects a `grammarly-perception-metrics-survey` element into the document body to display surveys."},{"element":"<various>","interaction":"render","details":"The `_render` method within the main `Qo` class is responsible for rendering all UI components, including highlights, the G-button, and numerous popups, into a dedicated portal in the DOM."}],"dynamic_code":[],"wasm":[],"obfuscation_hints":["minified_vars","webpack_modules","object_property_chaining"],"risks":[],"file_system":[]},"evidence":[{"file":"src/js/Grammarly.beautified.js","start_line":32800,"end_line":32815,"snippet":"const yn = new nn({ experimentClient: this._experimentClient, documentId: (0, dr.Of)(this._doc.id), alertsState: this._alertProcessor.alerts.state, alertsStateChanges: this._alertProcessor.alerts.changes, textObserver: this._textObserver, selectionSource: this._selectionSource, CSState: this._stateManager.state, replacementListener: this._replacementListener, backendClient: new Zt((0, qe.OB)().bgRpc.api), csToBgActions: this._actions, gnar: this._gnar, encryptionClient: new Jt((0, qe.OB)().bgRpc.api), sessionId: this._initialSessionUUID, dynamicConfig: this._stateManager.state.view(\"dynamicConfig\", \"hwr\"), requestPlagiarismCheck: async () => { ... }, storageClient: new Qt((0, qe.OB)().bgRpc.api), integrationName: ht });"},{"file":"src/js/Grammarly.beautified.js","start_line":32900,"end_line":32905,"snippet":"this._perceptionMetricsSurveyController = new jr(this._textField.ownerDocument, this._layout.gbutton.positionBehavior.pipe((0, l.U)((e => e.client))), (() => this._checkingService.get()), this._experimentClient);"},{"file":"src/js/Grammarly.beautified.js","start_line":33400,"end_line":33425,"snippet":"_render(e) { this._cheetahDynamicService.assistantState.view(rt.mp); const t = new or.LB(this._layout, this._highlights, this._alertProcessor, (e => { ... }), this._stateManager.state.view(\"user\"), this._fieldIntegrationController, this._gbuttonController, this._model, this._autocorrectModel.shouldVisuallyDisplay, this._autoApplyService.featureModel.shouldVisuallyDisplay, e, this._proofitDynamicService, this._emogenieService, this._originalTextField, this._autocorrectInlineCardController.view, this._teaserWeCardController.view, this._teaserWeCardController.fullCardView, this._touchTypistPreviewCardController.view, this._touchTypistRevertCardController.view, this._autoApplyService.inlineCardController.view, this._overriddenCardStream ? I.E : this._inlineCardController.view, this._overriddenCardStream ? I.E : this._synonymCardController.view, this._overriddenCardStream ? I.E : this._snippetsDynamicService.view, this._assistantDynamicService, (e => this._wrapElementStream(e, ((e, t) => e.showCard(t)))), this._experimentClient, this._doc.id, this._isCurrentFieldFocused, this._cheetahDynamicService.ui, this._cheetahDynamicService.highlightUI, this._cheetahDynamicService.ideateButtonUI, this._cheetahDynamicService.isAvailable, this._clickableCardService, new Tt(this._clickableCardService), this._getWritingExpertTracking, this._touchTypistFeatureWrapper.outerElementsUI.view(M.WG), (() => this._stateManager.state.get()), this._actions, this._snippetsTemplatingDynamicService.view, this._overriddenCardStream, (0, i.zG)(M.ij(this._stateManager.state.get().dynamicConfig.highlightsBlendingEnabled), M.hX((e => e)), M.tS((() => (0, Mr.D)(this._textField, (0, Ct.o)(this._textField)))), M.g_((() => {}), (e => e ? \"light\" : \"dark\"))), (e => { var t; null === (t = this._highlightDisplayProfiler) || void 0 === t || t.endMeasure(e) })); this._disposables.push(this._layout.render(t, { eventPropagationHandler: this._eventPropagationHandler, highlightsLayoutMargin: this._customizations.highlightsLayoutMargin })) }"},{"file":"src/js/Grammarly.beautified.js","start_line":33900,"end_line":34000,"snippet":"const re = i.memo((({ state: e, isFlipped: t, gButtonLayout: n, actions: r, assistantDynamicService: o, authUserDetails: s, user: a, experimentClient: l, csActions: c }) => { ... });"}],"notes":"This massive chunk contains the constructor for the main `Qo` class, which appears to be the central `AquaFieldIntegration` controller. It's responsible for initializing and wiring together almost every feature of the content script. Key initializations include the G2 v-bar feature, the 'Agents' framework, 'TouchTypist' predictive typing, the critical `AquaAlertsWiring` (which links alert data to visual highlights), a dynamic skill service, snippets, user surveys, and the 'Human Writing Report' (HWR). The HWR feature notably uses a proxied `chrome.runtime.sendMessage` to communicate with the background script for storage and encryption. The chunk also defines the main `_render` method, which injects all UI components into the DOM, and a large popup router component (`re`) that lazy-loads and displays various popups like login reminders, onboarding, and uphooks."}
{"file":"src/js/Grammarly.beautified.js","beautified":"src/js/Grammarly.beautified.js","chunk":{"id":"chunk-18/48","start_line":34001,"end_line":36000,"same_function_group":null},"findings":{"chrome_apis":[],"event_listeners":[],"messages":[],"storage":[{"key":"gdocs_peak_collabs_dismissed","type":"localStorage","op":"read","purpose":"Used to suppress the performance card popup in Google Docs if it has been dismissed by the user."}],"endpoints":[],"dom":[{"selector":".docs-presence-plus-collab-widget-container","action":"read","purpose":"To detect the number of collaborators in a Google Doc to trigger a 'performance card' popup."}],"dynamic_code":[{"type":"lazy_loading","details":"Continues the lazy-loading popup router, loading components like 'accountMigrationNotificationPopup', 'dunningMessagePopup', 'claimedUserPopup', 'proofit', etc."}],"wasm":[],"obfuscation_hints":["minified_vars","webpack_modules"],"risks":[{"type":"tracking","severity":"low","description":"A feature tracks the number of collaborators in a Google Docs document to conditionally show a 'performance card' popup. This is tied to an experiment flag 'ShowPerformanceCard'."}]},"evidence":[{"file":"src/js/Grammarly.beautified.js","start":35816,"end":35836,"ast_id":null},{"file":"src/js/Grammarly.beautified.js","start":35208,"end":35208,"ast_id":null},{"file":"src/js/Grammarly.beautified.js","start":34005,"end":34214,"ast_id":null}],"notes":"This chunk defines the main UI rendering controller class 'Ve' and the 'CAPIProxy' class 'k'. 'Ve' orchestrates all UI rendering, including highlights, the G-Button, and a complex system of popups and cards. It includes logic to detect collaborators in Google Docs to trigger a popup. 'CAPIProxy' is a critical data layer component that bridges the UI with the backend checking service, handling data transformation and rebasing."}
{"file":"src/js/Grammarly.beautified.js","beautified":"src/js/Grammarly.beautified.js","chunk":{"id":"chunk-19/48","start_line":36001,"end_line":38000,"same_function_group":null},"findings":{"chrome_apis":[{"name":"runtime.onMessage","file":"src/js/Grammarly.beautified.js","line":36220,"purpose":"Listens for a 'bgSW-shutdown' message to handle service worker termination and trigger reconnection logic."},{"name":"runtime.sendMessage","file":"src/js/Grammarly.beautified.js","line":37100,"purpose":"Indirectly used via the RPC client to communicate with the background script."}],"event_listeners":[{"type":"custom","event":"bgSW-shutdown","file":"src/js/Grammarly.beautified.js","line":36220,"purpose":"Handles background service worker shutdown to trigger CAPI session reconnection."}],"messages":[{"name":"bgSW-shutdown","direction":"background->content","purpose":"Notifies the content script that the service worker is about to be terminated."}],"storage":[],"endpoints":[],"dom":[],"dynamic_code":[],"wasm":[],"obfuscation_hints":["minified_vars","webpack_modules"],"risks":[]},"evidence":[{"file":"src/js/Grammarly.beautified.js","start":36030,"end":36235,"ast_id":null},{"file":"src/js/Grammarly.beautified.js","start":36915,"end":37990,"ast_id":null},{"file":"src/js/Grammarly.beautified.js","start":36220,"end":36220,"ast_id":null}],"notes":"This chunk details the CAPI (Core API) connection and checking service implementation. It defines the 'CAPIRpcConnection' class ('E'), which manages the WebSocket session with the backend, including a robust reconnection mechanism that listens for service worker shutdowns. It also defines the 'DenaliCapiCheckingServiceImpl' class ('j'), which acts as the primary interface for sending text changes (deltas) and user feedback to the backend."}
{"file":"src/js/Grammarly.beautified.js","beautified":"src/js/Grammarly.beautified.js","chunk":{"id":"chunk-20/48","start_line":38001,"end_line":40000,"same_function_group":null},"findings":{"chrome_apis":["chrome.runtime.getBackgroundPage","chrome.runtime.sendMessage"],"event_listeners":[],"messages":[],"storage":[],"endpoints":[],"dom":[],"dynamic_code":["n.e(2308)"],"wasm":[],"obfuscation_hints":["webpack_modules","minified_vars"],"risks":[]},"evidence":[{"file":"src/js/Grammarly.beautified.js","start":38388,"end":38391,"ast_id":null},{"file":"src/js/Grammarly.beautified.js","start":39138,"end":39141,"ast_id":null}],"notes":"This chunk manages the G-button UI, including various popups, banners, and states. It contains services for uphooks, permissions, and various notifications (account migration, payment issues, etc.). The GButtonController orchestrates the button's appearance and state. It uses dynamic imports to load components."}
{"file":"src/js/Grammarly.beautified.js","beautified":"src/js/Grammarly.beautified.js","chunk":{"id":"chunk-21/48","start_line":40001,"end_line":42000,"same_function_group":null},"findings":{"chrome_apis":["chrome.runtime.sendMessage"],"event_listeners":[],"messages":[],"storage":["localStorage"],"endpoints":[],"dom":["iframe creation","localStorage.setItem"],"dynamic_code":["n.e(1090)"],"wasm":[],"obfuscation_hints":["webpack_modules","minified_vars"],"risks":[{"type":"tracking","severity":"low","description":"Extensive use of a third-party service (Iterable) for in-app messaging based on user behavior."}]},"evidence":[{"file":"src/js/Grammarly.beautified.js","start":40020,"end":40022,"ast_id":null},{"file":"src/js/Grammarly.beautified.js","start":40220,"end":40220,"ast_id":null},{"file":"src/js/Grammarly.beautified.js","start":41329,"end":41332,"ast_id":null},{"file":"src/js/Grammarly.beautified.js","start":40880,"end":40880,"ast_id":null}],"notes":"This chunk implements the main popup model factory, handling various states like onboarding, login reminders, and notifications. It introduces a significant integration with 'Iterable', a third-party in-app messaging service, which is triggered by various user actions. It also contains the logic for managing highlight geometry."}
{"file":"/Users/jfri/Downloads/kbfnbcaeplbcioakkpcpgfkobkghlhen/src/js/Grammarly.beautified.js","beautified":"/Users/jfri/Downloads/kbfnbcaeplbcioakkpcpgfkobkghlhen/src/js/Grammarly.beautified.js","chunk":{"id":"chunk-22/48","start_line":42001,"end_line":44000,"same_function_group":null},"findings":{"chrome_apis":[],"event_listeners":["mousemove","touchstart","resize","keydown","mousedown","keyup","mousewheel","touchmove"],"messages":[],"storage":[],"endpoints":[],"dom":["getBoundingClientRect","getComputedStyle","scrollBy","insertAdjacentElement","createElement","appendChild","querySelector"],"dynamic_code":[],"wasm":[],"obfuscation_hints":["minified_vars","webpack_modules"],"risks":[]},"evidence":[{"file":"/Users/jfri/Downloads/kbfnbcaeplbcioakkpcpgfkobkghlhen/src/js/Grammarly.beautified.js","start":42020,"end":42028,"ast_id":null},{"file":"/Users/jfri/Downloads/kbfnbcaeplbcioakkpcpgfkobkghlhen/src/js/Grammarly.beautified.js","start":42220,"end":42295,"ast_id":null},{"file":"/Users/jfri/Downloads/kbfnbcaeplbcioakkpcpgfkobkghlhen/src/js/Grammarly.beautified.js","start":43054,"end":43234,"ast_id":null},{"file":"/Users/jfri/Downloads/kbfnbcaeplbcioakkpcpgfkobkghlhen/src/js/Grammarly.beautified.js","start":43883,"end":43920,"ast_id":null}],"notes":"This chunk contains a sophisticated set of utilities for layout, geometry, and rendering, forming the foundation of how the extension positions its UI relative to the text field. It includes an advanced IntersectionObserver for performance, color/blend mode utilities for UI contrast, core geometry primitives (Point, Rect, Size), and a major EditorLayout class that orchestrates UI injection and positioning. It also defines a generic text replacement service."}
{"file":"/Users/jfri/Downloads/kbfnbcaeplbcioakkpcpgfkobkghlhen/src/js/Grammarly.beautified.js","beautified":"/Users/jfri/Downloads/kbfnbcaeplbcioakkpcpgfkobkghlhen/src/js/Grammarly.beautified.js","chunk":{"id":"chunk-23/48","start_line":44001,"end_line":46000,"same_function_group":null},"findings":{"chrome_apis":[],"event_listeners":["paste","keydown"],"messages":[],"storage":[],"endpoints":[],"dom":["execCommand","dispatchEvent"],"dynamic_code":[],"wasm":[],"obfuscation_hints":["minified_vars","webpack_modules"],"risks":[]},"evidence":[{"file":"/Users/jfri/Downloads/kbfnbcaeplbcioakkpcpgfkobkghlhen/src/js/Grammarly.beautified.js","start":44001,"end":44050,"ast_id":null},{"file":"/Users/jfri/Downloads/kbfnbcaeplbcioakkpcpgfkobkghlhen/src/js/Grammarly.beautified.js","start":44100,"end":44150,"ast_id":null},{"file":"/Users/jfri/Downloads/kbfnbcaeplbcioakkpcpgfkobkghlhen/src/js/Grammarly.beautified.js","start":44800,"end":44950,"ast_id":null},{"file":"/Users/jfri/Downloads/kbfnbcaeplbcioakkpcpgfkobkghlhen/src/js/Grammarly.beautified.js","start":45300,"end":45800,"ast_id":null}],"notes":"This chunk details the text replacement services, including a generic service using `execCommand` and another using `paste`/`beforeinput` events. It contains utilities for rendering the internal rich text format (Delta) to both HTML and plain text. A significant part is the 'preserve formatting' logic, which transforms replacements to maintain existing styles. A validation and tracking middleware wraps the replacement service to prevent text corruption and log extensive telemetry on success or failure."}
{"file":"/Users/jfri/Downloads/kbfnbcaeplbcioakkpcpgfkobkghlhen/src/js/Grammarly.beautified.js","beautified":"/Users/jfri/Downloads/kbfnbcaeplbcioakkpcpgfkobkghlhen/src/js/Grammarly.beautified.js","chunk":{"id":"chunk-24/48","start_line":46001,"end_line":48000,"same_function_group":null},"findings":{"chrome_apis":[],"event_listeners":["click","keydown","focus"],"messages":[],"storage":[],"endpoints":[],"dom":["querySelectorAll","closest","getAttribute"],"dynamic_code":[],"wasm":[],"obfuscation_hints":["minified_vars","webpack_modules"],"risks":[]},"evidence":[{"file":"/Users/jfri/Downloads/kbfnbcaeplbcioakkpcpgfkobkghlhen/src/js/Grammarly.beautified.js","start":46050,"end":46150,"ast_id":null},{"file":"/Users/jfri/Downloads/kbfnbcaeplbcioakkpcpgfkobkghlhen/src/js/Grammarly.beautified.js","start":46900,"end":47050,"ast_id":null},{"file":"/Users/jfri/Downloads/kbfnbcaeplbcioakkpcpgfkobkghlhen/src/js/Grammarly.beautified.js","start":47150,"end":47250,"ast_id":null},{"file":"/Users/jfri/Downloads/kbfnbcaeplbcioakkpcpgfkobkghlhen/src/js/Grammarly.beautified.js","start":47500,"end":47600,"ast_id":null}],"notes":"This chunk provides a set of generic integration factories for popular rich text editors (CKEditor, Draft.js, ProseMirror, Quill, Slate.js). It also contains the core implementation of the text change buffering/batching system, which is a key performance optimization. Furthermore, it includes the logic for creating a linear text map from complex content-editable DOM structures and a suite of utilities for querying the Server-Driven UI (SDUI) component tree."}
{"file":"src/js/Grammarly.beautified.js","beautified":"src/js/Grammarly.beautified.js","chunk":{"id":"chunk-25/48","start_line":48001,"end_line":50000,"same_function_group":null},"findings":{"chrome_apis":[],"event_listeners":["compositionstart","compositionend","input","change","focus","keydown","keyup","keypress","mouseup","mousedown","pointerdown","click","dblclick","load","unload"],"dom_apis":["querySelectorAll","querySelector","getElementsByTagName","getElementById","createElement","createContext","getComputedStyle","computedStyleMap","attachShadow","adoptedStyleSheets","CSSStyleSheet.replace","CSSStyleSheet.replaceSync"],"obfuscation_hints":["minified_vars","webpack_modules"],"key_findings":["Continuation of ContentEditableTextMap for parsing HTML to a rich text model.","Specialized WhiteSpacePreservingTextMap for editors where whitespace is significant.","TextRevisionManagerImpl: Core class for creating and tracking text revisions, essential for synchronization with the server (CAPI).","Generic Integration Factory (module 96075): A high-level function that assembles all necessary components (Mirror, TextObserver, CheckingService, Layout, etc.) for a field integration.","Layout and Mirroring (module 96405): Implements the 'mirror' element, a hidden DOM element that perfectly mimics the target field's styles to enable accurate geometry calculations for UI rendering.","GenericPageIntegration (module 23790): The main class that discovers editable fields on a page, validates them, and orchestrates the creation and lifecycle of individual field integrations."],"risks":[]},"evidence":[{"file":"src/js/Grammarly.beautified.js","start":48001,"end":48350,"ast_id":null},{"file":"src/js/Grammarly.beautified.js","start":48601,"end":48850,"ast_id":null},{"file":"src/js/Grammarly.beautified.js","start":49001,"end":49400,"ast_id":null},{"file":"src/js/Grammarly.beautified.js","start":49401,"end":49800,"ast_id":null}]}
{"file":"src/js/Grammarly.beautified.js","beautified":"src/js/Grammarly.beautified.js","chunk":{"id":"chunk-26/48","start_line":50001,"end_line":52000,"same_function_group":null},"findings":{"chrome_apis":[],"event_listeners":["click","mousedown","keydown","focus","blur"],"dom_apis":["CustomEvent","dispatchEvent","addEventListener","removeEventListener","querySelector"],"obfuscation_hints":["minified_vars","webpack_modules"],"key_findings":["Page Integration Rule Engine: A factory system for creating and managing page-level integrations based on domain, URL, and browser type.","IFrame Host Integration Rule: A specific rule (`iframeHostRule`) for creating integrations that manage communication with child iframes.","GDocs Integration Logic: Specific selectors and logic for integrating with Google Docs, including identifying the main editor and the text event target iframe.","UI Components: React-like components for UI elements like 'Added to Dictionary' confirmation cards, 'Add to Dictionary' buttons, and a generic 'Positioner' component for anchoring UI elements to specific DOM rectangles.","Draggable Component (`Positioner`): A higher-order component that provides drag-and-drop functionality, including boundary constraints.","Keyboard Shortcut Manager: A class for defining and handling keyboard shortcuts within specific text fields."],"risks":[]},"evidence":[{"file":"src/js/Grammarly.beautified.js","start":50001,"end":50200,"ast_id":null},{"file":"src/js/Grammarly.beautified.js","start":51001,"end":51200,"ast_id":null},{"file":"src/js/Grammarly.beautified.js","start":51201,"end":51400,"ast_id":null},{"file":"src/js/Grammarly.beautified.js","start":51401,"end":51800,"ast_id":null}]}
{"file":"src/js/Grammarly.beautified.js","beautified":"src/js/Grammarly.beautified.js","chunk":{"id":"chunk-27/48","start_line":52001,"end_line":54000,"same_function_group":null},"findings":{"chrome_apis":[],"event_listeners":[],"messages":[],"storage":[],"endpoints":[],"dom":[],"dynamic_code":[],"wasm":[],"obfuscation_hints":["webpack_modules","react_like_components"],"risks":[]},"evidence":[{"file":"src/js/Grammarly.beautified.js","start":52001,"end":54000}],"notes":"This chunk defines a large suite of React-like UI components that form the building blocks for Grammarly's suggestion cards. Key components include: 'replacement-card' (for showing suggestions), 'definitions-card', 'synonyms-card', 'unknown-word-card', and various specialized footers for different states (authenticated, anonymous, premium). A master card component (in module 45821) assembles these parts based on props. The chunk also contains UI primitives like Popover, Tooltip, Button, and an Emoji component with CDN fallback."}
{"file":"src/js/Grammarly.beautified.js","beautified":"src/js/Grammarly.beautified.js","chunk":{"id":"chunk-28/48","start_line":54001,"end_line":56000,"same_function_group":null},"findings":{"chrome_apis":["chrome.runtime.getManifest","chrome.runtime.id"],"event_listeners":[],"messages":[],"storage":[],"endpoints":["https://assets.extension.grammarly.com/","https://gnar.grammarly.com","https://in.grammarly.com/v1/events","https://extension.femetrics.grammarly.io/batch/import","https://coda.io","https://api.iterable.com","https://auth.grammarly.com/v3","https://auth.grammarly.com/v4","https://auth.grammarly.com/v5","wss://capi.grammarly.com/freews","https://capi.grammarly.com/api/defs","https://gateway.grammarly.com/passport/api/v1/passport","https://config.extension.grammarly.com/dynamicConfig.json","https://config.extension.grammarly.com/browserplugin/config.json"],"dom":["MutationObserver","ResizeObserver"],"dynamic_code":[],"wasm":[],"obfuscation_hints":["webpack_modules","environment_based_config"],"risks":[]},"evidence":[{"file":"src/js/Grammarly.beautified.js","start":55758,"end":55758},{"file":"src/js/Grammarly.beautified.js","start":55773,"end":55773},{"file":"src/js/Grammarly.beautified.js","start":55138,"end":55141},{"file":"src/js/Grammarly.beautified.js","start":55234,"end":55237},{"file":"src/js/Grammarly.beautified.js","start":55488,"end":55751}],"notes":"This chunk contains the extension's core configuration and environment management. It defines URLs for all Grammarly services (CAPI, auth, logging, assets) and switches them based on the deployment environment (prod, qa, dev). It also includes reactive wrappers for MutationObserver and ResizeObserver, turning DOM events into observable streams, and defines logic for rendering text highlights and various UI icons."}
{"file":"src/js/Grammarly.beautified.js","beautified":"src/js/Grammarly.beautified.js","chunk":{"id":"chunk-29/48","start_line":56001,"end_line":58000,"same_function_group":null},"findings":{"chrome_apis":[],"event_listeners":[],"messages":[],"storage":[],"endpoints":[],"dom":[],"dynamic_code":[],"wasm":[],"obfuscation_hints":["webpack_modules","react_like_components","feature_flags","experiments"],"risks":[]},"evidence":[{"file":"src/js/Grammarly.beautified.js","start":56080,"end":56280},{"file":"src/js/Grammarly.beautified.js","start":57000,"end":57300}],"notes":"This chunk defines the master `CardView` component, which acts as a controller for rendering all types of inline suggestion cards. It uses a large number of feature flags and experiment checks to decide which specific card component to render (e.g., `CommonCard`, `VoxCard`, `SduiCard`, `BlurredFsiCard`, `QuickSignupFsiCard`). The chunk also defines a comprehensive set of feature flags and A/B testing experiments, covering everything from UI variations and new features (like citations and knowledge hub) to performance optimizations and internal debugging tools. This highlights a development process heavily reliant on experimentation and gradual rollouts."}
{"file":"/Users/jfri/Downloads/kbfnbcaeplbcioakkpcpgfkobkghlhen/src/js/Grammarly.beautified.js","beautified":"/Users/jfri/Downloads/kbfnbcaeplbcioakkpcpgfkobkghlhen/src/js/Grammarly.beautified.js","chunk":{"id":"chunk-30/48","start_line":58001,"end_line":60000,"same_function_group":null},"findings":{"chrome_apis":[],"event_listeners":[],"messages":[{"name":"cs-to-bg-rpc-1587687052565","direction":"content->background","payload_keys":[]},{"name":"cs-to-bg-rpc-1557421403805","direction":"content->background","payload_keys":[]},{"name":"cs-to-bg-static-capi-rpc-1668544923207","direction":"content->background","payload_keys":[]}],"storage":[{"key":"user","type":"local","op":"read"},{"key":"version","type":"local","op":"read"},{"key":"dynamicConfig","type":"local","op":"read"},{"key":"extensionSettings","type":"local","op":"read"}],"endpoints":[],"dom":[],"dynamic_code":[],"wasm":[],"obfuscation_hints":["webpack_modules","minified_vars","function_chains"],"risks":[]},"evidence":[{"file":"/Users/jfri/Downloads/kbfnbcaeplbcioakkpcpgfkobkghlhen/src/js/Grammarly.beautified.js","start":58100,"end":58250},{"file":"/Users/jfri/Downloads/kbfnbcaeplbcioakkpcpgfkobkghlhen/src/js/Grammarly.beautified.js","start":58300,"end":58500},{"file":"/Users/jfri/Downloads/kbfnbcaeplbcioakkpcpgfkobkghlhen/src/js/Grammarly.beautified.js","start":59750,"end":59850}],"notes":"This chunk contains the core data modeling for suggestion cards, including a factory to create different card models (common, vox, sdui) and the logic for parsing text transformations to display diffs. It also includes the main view component that renders the UI based on these models and the underlying RPC and persistent storage infrastructure."}
{"file":"/Users/jfri/Downloads/kbfnbcaeplbcioakkpcpgfkobkghlhen/src/js/Grammarly.beautified.js","beautified":"/Users/jfri/Downloads/kbfnbcaeplbcioakkpcpgfkobkghlhen/src/js/Grammarly.beautified.js","chunk":{"id":"chunk-31/48","start_line":60001,"end_line":62000,"same_function_group":null},"findings":{"chrome_apis":[],"event_listeners":[],"messages":[],"storage":[{"key":"authenticationStarted","type":"local","op":"write"},{"key":"connection","type":"local","op":"read"},{"key":"connection","type":"local","op":"write"},{"key":"environmentState","type":"local","op":"read"},{"key":"environmentState","type":"local","op":"write"},{"key":"extensionSettings","type":"local","op":"read"},{"key":"extensionSettings","type":"local","op":"write"}],"endpoints":[],"dom":[],"dynamic_code":[],"wasm":[],"obfuscation_hints":["webpack_modules","minified_vars"],"risks":[]},"evidence":[{"file":"/Users/jfri/Downloads/kbfnbcaeplbcioakkpcpgfkobkghlhen/src/js/Grammarly.beautified.js","start":60050,"end":60150},{"file":"/Users/jfri/Downloads/kbfnbcaeplbcioakkpcpgfkobkghlhen/src/js/Grammarly.beautified.js","start":60200,"end":60800},{"file":"/Users/jfri/Downloads/kbfnbcaeplbcioakkpcpgfkobkghlhen/src/js/Grammarly.beautified.js","start":61000,"end":61500}],"notes":"This chunk contains a suite of 'actions' for manipulating the persistent store, covering settings for authentication, connection state, environment, GDocs, and various feature toggles like the Always-Available Assistant and Touch Typist. It also includes a sophisticated logging framework with features like history buffers, custom log levels, and backup to session storage."}
{"file":"/Users/jfri/Downloads/kbfnbcaeplbcioakkpcpgfkobkghlhen/src/js/Grammarly.beautified.js","beautified":"/Users/jfri/Downloads/kbfnbcaeplbcioakkpcpgfkobkghlhen/src/js/Grammarly.beautified.js","chunk":{"id":"chunk-32/48","start_line":62001,"end_line":64000,"same_function_group":null},"findings":{"chrome_apis":[],"event_listeners":[],"messages":[],"storage":[],"endpoints":[],"dom":[],"dynamic_code":[],"wasm":[],"obfuscation_hints":["webpack_modules","minified_vars","function_chains"],"risks":[{"type":"tracking","severity":"high","description":"A comprehensive telemetry and tracking service is implemented, logging a vast number of user interactions, system events, performance metrics, and errors to a remote server."}]},"evidence":[{"file":"/Users/jfri/Downloads/kbfnbcaeplbcioakkpcpgfkobkghlhen/src/js/Grammarly.beautified.js","start":62100,"end":64000}],"notes":"This chunk is almost entirely composed of a massive, centralized Telemetry class. It provides an exhaustive API for logging user interactions, system events, performance metrics, and errors across all extension features, including GDocs, authentication, UI interactions, and A/B testing hooks."}
{"file":"src/js/Grammarly.beautified.js","beautified":"src/js/Grammarly.beautified.js","chunk":{"id":"chunk-33/48","start_line":64001,"end_line":66000,"same_function_group":null},"findings":{"chrome_apis":[],"event_listeners":[],"messages":[{"name":"tracking/RPC","direction":"content->background","payload_keys":["...any"],"evidence_file":"src/js/Grammarly.beautified.js","evidence_start":64700,"evidence_end":64713}],"storage":[{"key":"...","type":"sessionStorage","purpose":"Fallback for debug logs","evidence_file":"src/js/Grammarly.beautified.js","evidence_start":65558,"evidence_end":65583}],"endpoints":[],"dom":[],"dynamic_code":[],"wasm":[],"obfuscation_hints":["minified_vars","webpack_modules"],"risks":[{"type":"tracking","severity":"high","description":"This chunk details an exceptionally comprehensive and granular tracking system. It logs a vast array of user interactions, performance data, and environmental details, including typing duration, view duration, and activity across different domains.","evidence_file":"src/js/Grammarly.beautified.js","evidence_start":64001,"evidence_end":64670}]},"evidence":[{"file":"src/js/Grammarly.beautified.js","start":64001,"end":66000}],"notes":"This chunk continues the massive Telemetry class, providing an exhaustive API for logging user interactions, performance metrics, and errors. It includes specific logging for replacements, service availability, feature integrations (Inkwell, gOS), permissions, and A/B testing. It also contains utilities for error classification, domain classification, and debug report generation. A full copy of the DOMPurify library is also embedded in this chunk."}
{"file":"src/js/Grammarly.beautified.js","beautified":"src/js/Grammarly.beautified.js","chunk":{"id":"chunk-34/48","start_line":66001,"end_line":68000,"same_function_group":null},"findings":{"chrome_apis":[],"event_listeners":[],"messages":[],"storage":[],"endpoints":[],"dom":[],"dynamic_code":[],"wasm":[],"obfuscation_hints":["minified_vars","webpack_modules","third_party_libs"],"risks":[]},"evidence":[{"file":"src/js/Grammarly.beautified.js","start":66001,"end":68000}],"notes":"This chunk contains the remainder of the bundled DOMPurify library for HTML sanitization. It also includes a large portion of the 'diff-match-patch' library for computing text differences, and a significant number of functional programming utilities from 'fp-ts' and 'io-ts' for data validation and manipulation. This indicates a strong focus on security, data integrity, and robust, functional-style programming."}
{"file":"/Users/jfri/Downloads/kbfnbcaeplbcioakkpcpgfkobkghlhen/src/js/Grammarly.beautified.js","beautified":"/Users/jfri/Downloads/kbfnbcaeplbcioakkpcpgfkobkghlhen/src/js/Grammarly.beautified.js","chunk":{"id":"chunk-35/48","start_line":68001,"end_line":70000,"same_function_group":null},"findings":{"chrome_apis":[],"event_listeners":[],"messages":[],"storage":[],"endpoints":[],"dom":[],"dynamic_code":[],"wasm":[],"obfuscation_hints":["minified_vars","webpack_modules","function_chains"],"risks":[]},"evidence":[],"notes":"This chunk consists almost entirely of functional programming utilities, likely from a library similar to fp-ts. It provides extensive helper functions for data structures like Map, Array (ReadonlyArray), and Option, along with type class instances (Functor, Monad, Foldable, etc.). No direct Chrome APIs or risky behaviors were observed."}
{"file":"/Users/jfri/Downloads/kbfnbcaeplbcioakkpcpgfkobkghlhen/src/js/Grammarly.beautified.js","beautified":"/Users/jfri/Downloads/kbfnbcaeplbcioakkpcpgfkobkghlhen/src/js/Grammarly.beautified.js","chunk":{"id":"chunk-36/48","start_line":70001,"end_line":72000,"same_function_group":null},"findings":{"chrome_apis":[],"event_listeners":[],"messages":[],"storage":[],"endpoints":[],"dom":[],"dynamic_code":[],"wasm":[],"obfuscation_hints":["minified_vars","webpack_modules","function_chains"],"risks":[]},"evidence":[],"notes":"This chunk continues the functional programming library, likely fp-ts. It includes modules for `ReadonlyArray`, `Record` (objects), `Task` (async computations), and `TaskEither` (async computations that can fail). It also contains core utilities for function composition (`pipe`), data types (`Option`, `Either`), and type classes (`Functor`, `Monad`). The code is foundational and does not contain any application-specific logic or risky calls."}
{"file":"/Users/jfri/Downloads/kbfnbcaeplbcioakkpcpgfkobkghlhen/src/js/Grammarly.beautified.js","beautified":"/Users/jfri/Downloads/kbfnbcaeplbcioakkpcpgfkobkghlhen/src/js/Grammarly.beautified.js","chunk":{"id":"chunk-37/48","start_line":72001,"end_line":74000,"same_function_group":null},"findings":{"chrome_apis":[],"event_listeners":[],"messages":[],"storage":[],"endpoints":[],"dom":[],"dynamic_code":[],"wasm":[],"obfuscation_hints":["minified_vars","webpack_modules","function_chains"],"risks":[]},"evidence":[],"notes":"This chunk is a continuation of the `io-ts` library, a popular runtime type-checking and decoding library for TypeScript. It defines the core data types and combinators for creating complex type definitions (`Type`, `Interface`, `Literal`, `Union`, `Intersection`, `Array`, `Record`, etc.). It also includes a CSS-in-JS library (`freestyle`) for dynamically generating stylesheets. No application-specific logic or risky behaviors are present."}
{"file":"src/js/Grammarly.beautified.js","beautified":"src/js/Grammarly.beautified.js","chunk":{"id":"chunk-38/48","start_line":74001,"end_line":76000,"same_function_group":null},"findings":{"chrome_apis":[],"event_listeners":[],"messages":[],"storage":[],"endpoints":[],"dom":[],"dynamic_code":[],"wasm":[],"obfuscation_hints":["webpack_modules","minified_vars"],"risks":[],"libraries":["io-ts","monocle-ts","css-in-js"]},"evidence":[],"notes":"This chunk continues the implementation of the 'io-ts' library, defining complex type constructors like PartialType, DictionaryType, UnionType, IntersectionType, and TupleType. It also includes the implementation for 'monocle-ts', a library for functional optics (Lens, Prism, etc.). A Levenshtein distance function is also present. The latter half contains many small modules exporting hashed CSS class names, indicating a CSS-in-JS styling approach."}
{"file":"src/js/Grammarly.beautified.js","beautified":"src/js/Grammarly.beautified.js","chunk":{"id":"chunk-39/48","start_line":76001,"end_line":78000,"same_function_group":null},"findings":{"chrome_apis":[],"event_listeners":[],"messages":[],"storage":[],"endpoints":[],"dom":["document.createElement","document.createRange","element.focus","element.scrollLeft","element.scrollTop","element.dispatchEvent","element.addEventListener","element.removeEventListener"],"dynamic_code":[],"wasm":[],"obfuscation_hints":["webpack_modules","minified_vars"],"risks":[],"libraries":["react-dom"]},"evidence":[],"notes":"This chunk contains a significant portion of the React DOM library. It includes the core logic for React's synthetic event system, handling of DOM properties and attributes, controlled components, and event scheduling. It defines numerous event handlers and the internal Fiber node traversal logic."}
{"file":"src/js/Grammarly.beautified.js","beautified":"src/js/Grammarly.beautified.js","chunk":{"id":"chunk-40/48","start_line":78001,"end_line":80000,"same_function_group":null},"findings":{"chrome_apis":[],"event_listeners":[],"messages":[],"storage":[],"endpoints":[],"dom":[],"dynamic_code":[],"wasm":[],"obfuscation_hints":["webpack_modules","minified_vars"],"risks":[],"libraries":["react-dom"]},"evidence":[],"notes":"This chunk continues the React DOM implementation, focusing on the core reconciliation (diffing) algorithm. It includes the internal logic for React's context API, component lifecycle methods (shouldComponentUpdate, getDerivedStateFromError), the main reconciler function, and the internal implementation of various hooks (useState, useEffect, useReducer, etc.). It also contains logic for handling Suspense and dehydrated server-rendered content."}
{"file":"/Users/jfri/Downloads/kbfnbcaeplbcioakkpcpgfkobkghlhen/src/js/Grammarly.beautified.js","beautified":"/Users/jfri/Downloads/kbfnbcaeplbcioakkpcpgfkobkghlhen/src/js/Grammarly.beautified.js","chunk":{"id":"chunk-41/48","start_line":80001,"end_line":82000,"same_function_group":null},"findings":{"chrome_apis":[],"event_listeners":[],"messages":[],"storage":[],"endpoints":[],"dom":["appendChild","insertBefore","removeChild","dangerouslySetInnerHTML","textContent"],"dynamic_code":[],"wasm":[],"obfuscation_hints":["minified_vars","webpack_modules"],"risks":[]},"evidence":[{"file":"/Users/jfri/Downloads/kbfnbcaeplbcioakkpcpgfkobkghlhen/src/js/Grammarly.beautified.js","start":80002,"end":81998}],"notes":"This chunk continues the implementation of the react-dom library, focusing on the 'commit' phase. It includes the logic for applying DOM mutations (updates, insertions, deletions), calling lifecycle methods (componentDidMount, componentWillUnmount), and running useEffect hooks. It also contains the core implementation for the public React DOM API like createRoot, hydrateRoot, and unmountComponentAtNode, as well as the integration with React DevTools."}
{"file":"/Users/jfri/Downloads/kbfnbcaeplbcioakkpcpgfkobkghlhen/src/js/Grammarly.beautified.js","beautified":"/Users/jfri/Downloads/kbfnbcaeplbcioakkpcpgfkobkghlhen/src/js/Grammarly.beautified.js","chunk":{"id":"chunk-42/48","start_line":82001,"end_line":84000,"same_function_group":null},"findings":{"chrome_apis":[],"event_listeners":[],"messages":[],"storage":[],"endpoints":[],"dom":["createElement","clientWidth","clientHeight","getComputedStyle","getBBox"],"dynamic_code":[],"wasm":[],"obfuscation_hints":["minified_vars","webpack_modules"],"risks":[]},"evidence":[{"file":"/Users/jfri/Downloads/kbfnbcaeplbcioakkpcpgfkobkghlhen/src/js/Grammarly.beautified.js","start":82002,"end":83998}],"notes":"This chunk contains several bundled utility libraries. It includes 'react-fast-compare' for deep object comparison, the 'usePopper' React hook for positioning elements, a 'react-is' like utility for checking React component types, and the implementation of a ResizeObserver polyfill or wrapper for monitoring element size changes. It also contains the core logic for RxJS, including Observable, Subject, Subscriber, and various operators."}
{"file":"/Users/jfri/Downloads/kbfnbcaeplbcioakkpcpgfkobkghlhen/src/js/Grammarly.beautified.js","beautified":"/Users/jfri/Downloads/kbfnbcaeplbcioakkpcpgfkobkghlhen/src/js/Grammarly.beautified.js","chunk":{"id":"chunk-43/48","start_line":84001,"end_line":86000,"same_function_group":null},"findings":{"chrome_apis":[],"event_listeners":[],"messages":[],"storage":[],"endpoints":[],"dom":[],"dynamic_code":[],"wasm":[],"obfuscation_hints":["minified_vars","webpack_modules"],"risks":[]},"evidence":[{"file":"/Users/jfri/Downloads/kbfnbcaeplbcioakkpcpgfkobkghlhen/src/js/Grammarly.beautified.js","start":84002,"end":85998}],"notes":"This chunk continues the bundled RxJS library, containing the implementation for a large number of pipeable operators. These include operators for transformation (map, scan), filtering (filter, skip, take), combination (zip, combineLatest, merge), error handling (catchError, retry), and utility (tap, delay, debounceTime)."}
{"file":"src/js/Grammarly.beautified.js","beautified":"src/js/Grammarly.beautified.js","chunk":{"id":"chunk-44/48","start_line":86001,"end_line":88000,"same_function_group":null},"findings":{"chrome_apis":[],"event_listeners":[],"messages":[],"storage":[],"endpoints":[],"dom":[],"dynamic_code":[],"wasm":[],"obfuscation_hints":["webpack_modules"],"risks":[]},"evidence":[{"file":"src/js/Grammarly.beautified.js","start":86001,"end":88000}],"notes":"This chunk contains more RxJS operators (take, takeLast, takeUntil, takeWhile, tap, throttle, timeout, toArray, window, zip), the implementation of RxJS schedulers (async, asap, queue, animationFrame), a bundled version of React's internal cooperative scheduler (with priorities like UserBlocking, Normal, Idle), and the 'typestyle' CSS-in-JS library."}
{"file":"src/js/Grammarly.beautified.js","beautified":"src/js/Grammarly.beautified.js","chunk":{"id":"chunk-45/48","start_line":88001,"end_line":90000,"same_function_group":null},"findings":{"chrome_apis":[],"event_listeners":[],"messages":[],"storage":[],"endpoints":[],"dom":[],"dynamic_code":["Promise.all([n.e(5020), n.e(6890), ...]).then(...)"],"wasm":[],"obfuscation_hints":["webpack_modules","dynamic_code_loading"],"risks":[]},"evidence":[{"file":"src/js/Grammarly.beautified.js","start":88001,"end":90000}],"notes":"This chunk contains the remainder of the 'typestyle' CSS-in-JS library, a full implementation of 'ua-parser-js' for user agent sniffing, a UUID generator, and the core definitions for the 'AI Detector' and 'Plagiarism Checker' features, including their protocols and dynamic module loading integration points."}
{"file":"src/js/Grammarly.beautified.js","beautified":"src/js/Grammarly.beautified.js","chunk":{"id":"chunk-46/48","start_line":90001,"end_line":92000,"same_function_group":null},"findings":{"chrome_apis":[],"event_listeners":[],"messages":[],"storage":[],"endpoints":["https://auth.grammarly.com/v4/api/oauth2/authorize","https://auth.grammarly.com/v4/api/oauth2/exchange","https://auth.grammarly.com/v4/api/oauth2/token","https://auth.grammarly.com/v4/api/oauth2/revoke-by-refresh-token","https://auth.grammarly.com/v4/api/userinfo"],"dom":[],"dynamic_code":[],"wasm":[],"obfuscation_hints":["webpack_modules"],"risks":[]},"evidence":[{"file":"src/js/Grammarly.beautified.js","start":90001,"end":92000}],"notes":"This chunk contains the core implementation of Grammarly's OAuth 2.0 client. It handles token acquisition, refresh, and exchange, including PKCE flow (code verifier, code challenge using SHA-256). It defines logic for retries with backoff, mutex locking for token requests, and caching tokens in storage. It also includes endpoint URLs for production, pre-production, and QA environments."}
{"file":"src/js/Grammarly.beautified.js","beautified":"src/js/Grammarly.beautified.js","chunk":{"id":"chunk-47/48","start_line":92001,"end_line":94000,"same_function_group":null},"findings":{"chrome_apis":[],"event_listeners":[],"messages":[],"storage":[{"key":"gr-oauth-key","type":"local","op":"get/set/remove"},{"key":"gr-oauth-service-state","type":"local","op":"set"},{"key":"gr-oauth-state","type":"local","op":"get/set/remove"}],"endpoints":[{"url_pattern":"<DYNAMIC>/oauth2/token","method":"POST"},{"url_pattern":"<DYNAMIC>/oauth2/exchange","method":"POST"},{"url_pattern":"<DYNAMIC>/oauth2/revoke","method":"POST"},{"url_pattern":"<DYNAMIC>/user-info","method":"POST"}],"dom":[],"dynamic_code":[{"type":"webpack_runtime","evidence":"__webpack_require__.e"}],"wasm":[],"obfuscation_hints":["typescript_generated_enums","api_client_patterns","webpack_modules"],"risks":[{"type":"fingerprinting","severity":"low","description":"Webpack module manifest maps internal feature names and chunk IDs, exposing the internal module structure of the extension."}]},"evidence":[{"file":"src/js/Grammarly.js","start":92178,"end":93238,"ast_id":"class_de"},{"file":"src/js/Grammarly.js","start":93241,"end":93341,"ast_id":"class_ge"},{"file":"src/js/Grammarly.js","start":93480,"end":93698,"ast_id":"class_be"},{"file":"src/js/Grammarly.js","start":93725,"end":94238,"ast_id":"webpack_runtime"}],"notes":"This chunk contains the complete client-side authentication and session management library, including a multi-layered token refresh/exchange strategy and JWT validation. It also contains the Webpack runtime, including the dynamic chunk loading logic and a manifest mapping chunk IDs to filenames, which reveals the internal module structure."}
{"file":"src/js/Grammarly.beautified.js","beautified":"src/js/Grammarly.beautified.js","chunk":{"id":"chunk-48/48","start_line":94001,"end_line":94238,"same_function_group":null},"findings":{"chrome_apis":["chrome.runtime.sendMessage","chrome.runtime.getURL"],"event_listeners":[],"messages":[{"name":"CODE_SPLITTING_INJECT","direction":"unknown","payload_keys":["type","file"]}],"storage":[],"endpoints":[],"dom":[{"type":"insert","tag":"link"},{"type":"insert","tag":"script"}],"dynamic_code":[{"type":"webpack_runtime","evidence":"__webpack_require__.l"}],"wasm":[],"obfuscation_hints":["webpack_modules"],"risks":[]},"evidence":[{"file":"src/js/Grammarly.js","start":94088,"end":94143,"ast_id":"function___webpack_require__.l"},{"file":"src/js/Grammarly.js","start":94159,"end":94160,"ast_id":"function_chrome.runtime.getURL"}],"notes":"This final chunk contains the remainder of the Webpack runtime, including dynamic CSS loading (`loadStylesheet`) and a robust chunk loading fallback mechanism. If a dynamic import() fails, it sends a 'CODE_SPLITTING_INJECT' message via chrome.runtime.sendMessage, likely to the service worker, to inject the script, and then polls for completion. The public asset path is also dynamically configured using chrome.runtime.getURL."}
{"file":"/Users/jfri/Downloads/kbfnbcaeplbcioakkpcpgfkobkghlhen/src/js/Grammarly-gDocs.js","beautified":"/Users/jfri/Downloads/kbfnbcaeplbcioakkpcpgfkobkghlhen/src/js/Grammarly-gDocs.beautified.js","chunk":{"id":"chunk-1/53","start_line":1,"end_line":2000,"same_function_group":null},"findings":{"chrome_apis":[],"event_listeners":[],"messages":[],"storage":[],"endpoints":[{"url":"https://assets.grammarly.com/emoji/v1/"},{"url":"https://assets.grammarly.com/animations/v1/"}],"dom":[],"dynamic_code":[],"wasm":[],"obfuscation_hints":["webpack_modules","minified_vars"],"risks":[]},"evidence":[{"file":"/Users/jfri/Downloads/kbfnbcaeplbcioakkpcpgfkobkghlhen/src/js/Grammarly-gDocs.beautified.js","start":233,"end":236}],"notes":"This chunk contains webpack module definitions, color constants, and various utility functions. It defines asset URLs for emojis and animations. The code is clearly a bundled artifact."}
{"file":"/Users/jfri/Downloads/kbfnbcaeplbcioakkpcpgfkobkghlhen/src/js/Grammarly-gDocs.js","beautified":"/Users/jfri/Downloads/kbfnbcaeplbcioakkpcpgfkobkghlhen/src/js/Grammarly-gDocs.beautified.js","chunk":{"id":"chunk-2/53","start_line":2001,"end_line":4000,"same_function_group":null},"findings":{"chrome_apis":[],"event_listeners":[],"messages":[],"storage":[],"endpoints":[],"dom":[],"dynamic_code":[],"wasm":[],"obfuscation_hints":["minified_vars"],"risks":[]},"evidence":[{"file":"/Users/jfri/Downloads/kbfnbcaeplbcioakkpcpgfkobkghlhen/src/js/Grammarly-gDocs.beautified.js","start":2001,"end":4000}],"notes":"This chunk continues the implementation of a text processing library (similar to Quill Delta) and defines the core data models for different types of Grammarly alerts (e.g., Premium, Plagiarism, ToneAI, ShortenIt). It includes logic for managing alert states, ranges, and alternatives, as well as React-like hooks and focus management utilities. This section is focused on internal application logic and data structures."}
{"file":"/Users/jfri/Downloads/kbfnbcaeplbcioakkpcpgfkobkghlhen/src/js/Grammarly-gDocs.js","beautified":"/Users/jfri/Downloads/kbfnbcaeplbcioakkpcpgfkobkghlhen/src/js/Grammarly-gDocs.beautified.js","chunk":{"id":"chunk-3/53","start_line":4001,"end_line":6000,"same_function_group":null},"findings":{"chrome_apis":[],"event_listeners":[],"messages":[],"storage":[],"endpoints":[],"dom":[],"dynamic_code":[],"wasm":[],"obfuscation_hints":["webpack_modules","minified_vars"],"risks":[]},"evidence":[],"notes":"This chunk defines core data models and managers for Grammarly alerts. It includes a factory for creating different alert types (Plagiarism, ToneAI, etc.), a PositionManager for tracking highlight ranges in the text, a Lens system for filtering alerts, and a comprehensive set of constants for UI actions. The code is part of a Webpack bundle and uses minified variable names."}
{"file":"/Users/jfri/Downloads/kbfnbcaeplbcioakkpcpgfkobkghlhen/src/js/Grammarly-gDocs.js","beautified":"/Users/jfri/Downloads/kbfnbcaeplbcioakkpcpgfkobkghlhen/src/js/Grammarly-gDocs.beautified.js","chunk":{"id":"chunk-4/53","start_line":6001,"end_line":8000,"same_function_group":null},"findings":{"chrome_apis":[],"event_listeners":[],"messages":[],"storage":[],"endpoints":[],"dom":[],"dynamic_code":[],"wasm":[],"obfuscation_hints":["webpack_modules","minified_vars"],"risks":[]},"evidence":[],"notes":"This chunk defines models and utilities for feature flagging (ExperimentClient, GatesService), Data Loss Prevention (DLP) with text sanitization, UI components (CardItem), DOM utilities, and document context management (DocumentContext)."}
{"file":"/Users/jfri/Downloads/kbfnbcaeplbcioakkpcpgfkobkghlhen/src/js/Grammarly-gDocs.js","beautified":"/Users/jfri/Downloads/kbfnbcaeplbcioakkpcpgfkobkghlhen/src/js/Grammarly-gDocs.beautified.js","chunk":{"id":"chunk-5/53","start_line":8001,"end_line":10000,"same_function_group":null},"findings":{"chrome_apis":[],"event_listeners":[],"messages":[],"storage":[],"endpoints":[],"dom":[],"dynamic_code":[],"wasm":[],"obfuscation_hints":["webpack_modules","minified_vars"],"risks":[]},"evidence":[],"notes":"This chunk is a large module that appears to be a custom build or re-export of the RxJS library. It also includes modules for feature flagging and treatment management (ExperimentClient, GatesService, TreatmentService), and various utility functions. The code is structured as webpack modules."}
{"file":"src/js/Grammarly-gDocs.beautified.js","beautified":"src/js/Grammarly-gDocs.beautified.js","chunk":{"id":"chunk-6/53","start_line":10001,"end_line":12000,"same_function_group":null},"findings":{"chrome_apis":[],"event_listeners":[],"messages":[],"storage":[],"endpoints":[],"dom":[{"name":"isomorphic-dompurify","evidence":[{"file":"src/js/Grammarly-gDocs.beautified.js","start":10220,"end":10220}]}],"dynamic_code":[],"wasm":[],"obfuscation_hints":["minified_vars","webpack_modules"],"risks":[]},"evidence":[{"file":"src/js/Grammarly-gDocs.beautified.js","start":10001,"end":12000}],"notes":"This chunk contains a collection of high-level utility modules. Key functionalities include reactive utilities (RxJS-like), string and DOM sanitization (isomorphic-dompurify), a comprehensive logging and metrics framework, and core primitives for Operational Transforms (OT) used in text editing."}
{"file":"src/js/Grammarly-gDocs.beautified.js","beautified":"src/js/Grammarly-gDocs.beautified.js","chunk":{"id":"chunk-7/53","start_line":12001,"end_line":14000,"same_function_group":null},"findings":{"chrome_apis":[],"event_listeners":[],"messages":[],"storage":[],"endpoints":[],"dom":[{"name":"Popper.js","evidence":[{"file":"src/js/Grammarly-gDocs.beautified.js","start":13000,"end":14000}]}],"dynamic_code":[],"wasm":[],"obfuscation_hints":["minified_vars","webpack_modules"],"risks":[]},"evidence":[{"file":"src/js/Grammarly-gDocs.beautified.js","start":12001,"end":14000}],"notes":"This chunk details the data models for Grammarly alerts, including parsing from backend messages and transformation logic. It contains sophisticated machinery for Operational Transforms (OT) via an `Alternative` class, crucial for applying suggestions. It also includes what appears to be the Popper.js library, used for positioning UI elements like suggestion cards."}
{"file":"src/js/Grammarly-gDocs.beautified.js","beautified":"src/js/Grammarly-gDocs.beautified.js","chunk":{"id":"chunk-8/53","start_line":14001,"end_line":16000,"same_function_group":null},"findings":{"chrome_apis":[],"event_listeners":[],"messages":[],"storage":[],"endpoints":[],"dom":[{"name":"Popper.js","evidence":[{"file":"src/js/Grammarly-gDocs.beautified.js","start":14001,"end":14500}]}],"dynamic_code":[],"wasm":[],"obfuscation_hints":["minified_vars","webpack_modules"],"risks":[]},"evidence":[{"file":"src/js/Grammarly-gDocs.beautified.js","start":14001,"end":16000}],"notes":"This chunk continues the implementation of Popper.js for UI element positioning and defines a comprehensive schema for the extensions UI components. It details the structure of various content types like text, buttons, cards, lists, and layout containers using a runtime type-checking library. This forms the backbone of the dynamic UI rendering system."}
{"file":"src/js/Grammarly-gDocs.beautified.js","beautified":"src/js/Grammarly-gDocs.beautified.js","chunk":{"id":"chunk-9/53","start_line":16001,"end_line":18000,"same_function_group":null},"findings":{"chrome_apis":[],"event_listeners":[],"messages":[],"storage":[],"endpoints":[],"dom":[],"dynamic_code":[],"wasm":[],"obfuscation_hints":["webpack_modules","minified_vars"],"risks":[]},"evidence":[{"file":"src/js/Grammarly-gDocs.beautified.js","start":16001,"end":18000}],"notes":"This chunk finalizes the UI component schema and introduces a large set of design system constants (colors, sizes, states) and a comprehensive suite of utility functions for creating, traversing, and manipulating the UI component tree."}
{"file":"src/js/Grammarly-gDocs.beautified.js","beautified":"src/js/Grammarly-gDocs.beautified.js","chunk":{"id":"chunk-10/53","start_line":18001,"end_line":20000,"same_function_group":null},"findings":{"chrome_apis":[],"event_listeners":[],"messages":[],"storage":[],"endpoints":[],"dom":[],"dynamic_code":[],"wasm":[],"obfuscation_hints":["webpack_modules","minified_vars"],"risks":[]},"evidence":[{"file":"src/js/Grammarly-gDocs.beautified.js","start":18001,"end":20000}],"notes":"This chunk contains the implementation of the UI tree manipulation logic, a color mapping utility for the design system, a typing tracker for analytics, a dictionary card UI manager, and the beginning of the core content script logic that orchestrates various features like page integration, settings management, and communication with the background script."}
{"file":"src/js/Grammarly-gDocs.beautified.js","beautified":"src/js/Grammarly-gDocs.beautified.js","chunk":{"id":"chunk-11/53","start_line":20001,"end_line":22000,"same_function_group":null},"findings":{"chrome_apis":["chrome.runtime.connectNative","chrome.storage.managed.get","chrome.storage.session.get","chrome.storage.session.set","chrome.storage.session.remove","chrome.storage.session.clear","chrome.storage.session.onChanged","chrome.scripting.executeScript","chrome.scripting.insertCSS","chrome.tabs.executeScript","chrome.tabs.insertCSS","chrome.tabs.create","chrome.tabs.remove","chrome.tabs.update","chrome.tabs.query","chrome.tabs.getZoom","chrome.tabs.onActivated","chrome.tabs.onUpdated","chrome.tabs.get","chrome.tabs.reload","chrome.tabs.sendMessage","chrome.tabs.onRemoved","chrome.action.setBadgeText","chrome.action.setIcon","chrome.action.setTitle","chrome.action.setBadgeBackgroundColor","chrome.action.openPopup","chrome.browserAction.setBadgeText","chrome.browserAction.setIcon","chrome.browserAction.setTitle","chrome.browserAction.setBadgeBackgroundColor","chrome.notifications.create","chrome.notifications.clear","chrome.notifications.onClicked","chrome.notifications.onButtonClicked","chrome.notifications.onClosed","chrome.cookies.get","chrome.cookies.remove","chrome.cookies.getAll","chrome.cookies.set","chrome.cookies.onChanged","chrome.management.uninstallSelf","chrome.permissions.onAdded","chrome.permissions.onRemoved","chrome.permissions.getAll","chrome.permissions.request","chrome.permissions.contains","chrome.runtime.getURL","chrome.sidePanel.open","chrome.runtime.reload","chrome.i18n.detectLanguage","chrome.i18n.getUILanguage","chrome.i18n.getAcceptLanguages","chrome.identity.*","chrome.runtime.onMessage","chrome.runtime.setUninstallURL"],"event_listeners":["runtime.onMessage.addListener","pageshow","visibilitychange","prerenderingchange"],"messages":[{"name":"CODE_SPLITTING_INJECT","direction":"other","payload_keys":["file"],"evidence":[{"file":"src/js/Grammarly-gDocs.beautified.js","start":21216,"end":21220}]}],"storage":[{"key":"GrammarlyEnrollmentToken","type":"managed","op":"get"},{"key":"GrammarlyBlockedClients","type":"managed","op":"get"},{"key":"GrammarlyBlockedDomains","type":"managed","op":"get"},{"key":"GrammarlyConfidentialModeEnabled","type":"managed","op":"get"},{"key":"GrammarlyDlpEnabled","type":"managed","op":"get"},{"key":"GrammarlyExtensionMode","type":"managed","op":"get"}],"endpoints":[],"dom":[],"dynamic_code":[],"wasm":[],"obfuscation_hints":["minified_vars","function_chains","webpack_modules"],"risks":[{"type":"remote_code","severity":"high","description":"The extension uses chrome.runtime.connectNative, which allows it to communicate with and execute code in a native application outside the browser sandbox. This is a high-risk permission as the native component is not subject to browser security policies."},{"type":"fingerprinting","severity":"low","description":"The extension checks for the installation of other specific extensions (mseditor, office), which could be used to fingerprint the users browser setup."}]},"evidence":[{"file":"src/js/Grammarly-gDocs.beautified.js","start":20001,"end":22000}],"notes":"This chunk contains the core application controller (er) and a comprehensive Chrome API facade (mn) that abstracts MV2/V3 differences. It includes wrappers for managed storage, session storage, native messaging, scripting, and tabs. It also defines the main application lifecycle, performance monitoring (INP), and the foundational classes for observing and manipulating text in editable fields."}
{"file":"src/js/Grammarly-gDocs.beautified.js","beautified":"src/js/Grammarly-gDocs.beautified.js","chunk":{"id":"chunk-12/53","start_line":22001,"end_line":24000,"same_function_group":null},"findings":{"chrome_apis":[],"event_listeners":["dblclick","MutationObserver","focus"],"messages":[{"name":"iframe-integration-rpc","direction":"other","payload_keys":["showCard","openAssistant","closeAssistant","pushTextChanges","selectHighlight","syncHighlights"],"evidence":[{"file":"src/js/Grammarly-gDocs.beautified.js","start":23438,"end":23488}]}],"storage":[],"endpoints":[],"dom":[{"type":"MutationObserver","details":"The `Io` (GenericPageIntegration) class uses a MutationObserver to watch for DOM changes and discover/cleanup text field integrations."}],"dynamic_code":[],"wasm":[],"obfuscation_hints":["minified_vars","webpack_modules","function_chains"],"risks":[{"type":"other","severity":"low","description":"The generic page integration logic is highly complex, relying on MutationObserver and various heuristics to detect and manage integrations. This could be a source of performance issues or conflicts with the host web applications own DOM manipulation."}]},"evidence":[{"file":"src/js/Grammarly-gDocs.beautified.js","start":22001,"end":24000}],"notes":"This chunk details the core logic for discovering and integrating with various rich text editors (Draft.js, CKEditor, Slate, etc.) via the `Io` (GenericPageIntegration) controller. It defines rules for matching specific editors and a sophisticated system (`is`, `as`) for managing integrations within iframes via RPC. It also includes a validation layer (`fs`) and the CAPI serialization logic (`Ks`)."}
{"file":"src/js/Grammarly-gDocs.beautified.js","beautified":"src/js/Grammarly-gDocs.beautified.js","chunk":{"id":"chunk-13/53","start_line":24001,"end_line":26000,"same_function_group":null},"findings":{"chrome_apis":[],"event_listeners":[],"messages":[{"name":"bgSW-shutdown","direction":"background->content","payload_keys":[]},{"name":"pushChanges","direction":"content->background","payload_keys":["token","rev","args"]},{"name":"setSessionOption","direction":"content->background","payload_keys":["token","args"]}],"storage":[],"endpoints":[],"dom":[],"dynamic_code":[],"wasm":[],"obfuscation_hints":["minified_vars","function_chains"],"risks":[]},"evidence":[{"file":"src/js/Grammarly-gDocs.beautified.js","start":24001,"end":26000}],"notes":"This chunk contains the core CAPI (Content API) connection management, including the RPC client (`Ys`), connection lifecycle with reconnection logic (`ia`), and the main checking service (`_a`) that handles diffing and event translation. It also defines integration rule factories."}
{"file":"src/js/Grammarly-gDocs.beautified.js","beautified":"src/js/Grammarly-gDocs.beautified.js","chunk":{"id":"chunk-14/53","start_line":26001,"end_line":28000,"same_function_group":null},"findings":{"chrome_apis":["chrome.runtime.connect","chrome.runtime.sendMessage","chrome.storage.onChanged"],"event_listeners":["storage.onChanged"],"messages":[{"name":"side-panel-to-cs-text-field-rpc","direction":"other","payload_keys":[]},{"name":"cs-text-field-to-side-panel-rpc","direction":"other","payload_keys":[]}],"storage":[],"endpoints":[],"dom":[],"dynamic_code":[],"wasm":[],"obfuscation_hints":["minified_vars","webpack_modules"],"risks":[]},"evidence":[{"file":"src/js/Grammarly-gDocs.beautified.js","start":26001,"end":28000}],"notes":"This chunk contains the core implementation for the Cheetah (GrammarlyGO) feature, its state management, and specialized integration for Google Docs (`CheetahIntegrationGDocsCanvas`). It also includes feature flagging for G2 vBars, Knowledge Hub, and a native messaging connector."}
{"file":"src/js/Grammarly-gDocs.beautified.js","beautified":"src/js/Grammarly-gDocs.beautified.js","chunk":{"id":"chunk-15/53","start_line":28001,"end_line":30000,"same_function_group":null},"findings":{"chrome_apis":[],"event_listeners":[],"messages":[{"name":"sendCsLogsToPopup","direction":"other","payload_keys":[]},{"name":"downloadDebugReportsFromCS","direction":"other","payload_keys":[]}],"storage":[],"endpoints":[],"dom":[],"dynamic_code":[],"wasm":[],"obfuscation_hints":["minified_vars","webpack_modules"],"risks":[]},"evidence":[{"file":"src/js/Grammarly-gDocs.beautified.js","start":28001,"end":30000}],"notes":"This chunk is focused on instrumentation and advanced feature models. It includes a performance measurement system (`67223`), a session statistics manager (`17159`), and data models for Knowledge Hub (`33442`) and TouchTypist (`74789`, `98409`). It also defines services for special offers and debug report generation."}
{"file":"src/js/Grammarly-gDocs.beautified.js","beautified":"src/js/Grammarly-gDocs.beautified.js","chunk":{"id":"chunk-16/53","start_line":30001,"end_line":32000,"same_function_group":null},"findings":{"chrome_apis":[],"event_listeners":[],"messages":[],"storage":[],"endpoints":[],"dom":[],"dynamic_code":[],"wasm":[],"obfuscation_hints":["minified_vars","webpack_modules"],"risks":[{"type":"tracking","severity":"medium","description":"Extensive client-side metrics on user interactions, alert acceptance/rejection, and text characteristics are collected and sent to a product metrics client."}]},"evidence":[{"file":"src/js/Grammarly-gDocs.beautified.js","start":30103,"end":30121}],"notes":"This chunk details the client-side logic for processing alerts, managing their state, and implementing automated correction features like Auto-Apply and Autocorrect. It includes sophisticated machinery for maintaining suggestion accuracy in a dynamic text environment and reporting detailed session metrics."}
{"file":"src/js/Grammarly-gDocs.beautified.js","beautified":"src/js/Grammarly-gDocs.beautified.js","chunk":{"id":"chunk-17/53","start_line":32001,"end_line":34000,"same_function_group":null},"findings":{"chrome_apis":[],"event_listeners":["dblclick","scroll","focusin","focusout","keydown"],"messages":[],"storage":[],"endpoints":[],"dom":["document.querySelectorAll","element.shadowRoot","element.querySelector","element.focus"],"dynamic_code":["n.e(4449).then(n.bind(n, 51830))"],"wasm":[],"obfuscation_hints":["minified_vars","webpack_modules","function_chains"],"risks":[]},"evidence":[{"file":"src/js/Grammarly-gDocs.beautified.js","start":32001,"end":34000}],"notes":"This chunk contains the core logic for the Inline Card Service (`ki`), which orchestrates which suggestion card to show. It also has the full implementation for the Synonyms feature (`ho` and `so`), which is triggered by double-clicking a word. A service for buffering Server-Driven UI events (`to`) and a controller for a user perception survey (`ji`) are also present."}
{"file":"src/js/Grammarly-gDocs.beautified.js","beautified":"src/js/Grammarly-gDocs.beautified.js","chunk":{"id":"chunk-18/53","start_line":34001,"end_line":36000,"same_function_group":null},"findings":{"chrome_apis":[],"event_listeners":["scroll","dblclick","keydown"],"messages":[],"storage":[],"endpoints":[],"dom":["document.querySelectorAll"],"dynamic_code":["n.e(4449).then(n.bind(n, 51830))","Promise.all([n.e(213), n.e(156), n.e(8039), n.e(9105), n.e(637)]).then(n.bind(n, 3119))"],"wasm":[],"obfuscation_hints":["minified_vars","webpack_modules","function_chains"],"risks":[{"type":"complexity","severity":"medium","description":"The AquaFieldIntegration class (Jo) is extremely large and complex, orchestrating dozens of services. It represents a significant single point of failure and is hard to maintain."}]},"evidence":[{"file":"src/js/Grammarly-gDocs.beautified.js","start":34001,"end":36000}],"notes":"This chunk is dominated by the massive AquaFieldIntegration class (Jo), which is the central orchestrator for almost all extension features within a text field. It initializes and wires together dozens of services. The chunk also contains the complete implementation for the synonyms feature."}
{"file":"src/js/Grammarly-gDocs.beautified.js","beautified":"src/js/Grammarly-gDocs.beautified.js","chunk":{"id":"chunk-19/53","start_line":36001,"end_line":38000,"same_function_group":null},"findings":{"chrome_apis":[],"event_listeners":["compositionstart","compositionend","scroll","click","keyup"],"messages":[],"storage":[],"endpoints":[],"dom":["document.querySelectorAll","document.createElement","document.body.appendChild"],"dynamic_code":[],"wasm":[],"obfuscation_hints":["minified_vars","webpack_modules","function_chains"],"risks":[]},"evidence":[{"file":"src/js/Grammarly-gDocs.beautified.js","start":36001,"end":38000}],"notes":"This chunk details the wiring between the checking service, alert processor, and UI highlights. AquaCheckingFeatureImpl processes backend messages, while AquaAlertsWiring translates alert changes into visual highlights, containing logic for highlight color and style. CAPIProxy acts as a bridge, rebasing alert data against text changes."}
{"file":"src/js/Grammarly-gDocs.beautified.js","beautified":"src/js/Grammarly-gDocs.beautified.js","chunk":{"id":"chunk-20/53","start_line":38001,"end_line":40000,"same_function_group":null},"findings":{"chrome_apis":[],"event_listeners":[],"messages":[{"name":"sendFeedback","direction":"content->background","payload_keys":["id","kind","reason","replacementText","alternativeIndex","subtype","snippetUuid","domainCategory","popupType"],"evidence":[{"file":"src/js/Grammarly-gDocs.beautified.js","start":38120,"end":38265}]}],"storage":[],"endpoints":[],"dom":[],"dynamic_code":[],"wasm":[],"obfuscation_hints":["minified_vars","webpack_modules"],"risks":[{"type":"tracking","severity":"medium","description":"A centralized `sendFeedback` function reports a wide variety of user interactions with alerts, synonyms, and AI features to the backend, including accepts, dismisses, and views.","evidence":[{"file":"src/js/Grammarly-gDocs.beautified.js","start":38120,"end":38265}]}],"key_functionality":[{"name":"CAPI Message Transformer","description":"The `capiMessageTransformer` function converts messages from the backend CAPI format into the internal format used by the AlertProcessor.","evidence":[{"file":"src/js/Grammarly-gDocs.beautified.js","start":38480,"end":38588}]},{"name":"CAPI Message Rebaser","description":"The `capiMessageRebaser` function transforms alert positions based on document revisions to ensure they remain accurate during text changes.","evidence":[{"file":"src/js/Grammarly-gDocs.beautified.js","start":38589,"end":38610}]},{"name":"Ethical AI Feature","description":"The `EthicalAIFeature` is dynamically loaded to handle alerts for sensitive content, tracking user interactions and reporting them. It specifically references a `STAND_WITH_UKRAINE_ALERT_PNAME`.","evidence":[{"file":"src/js/Grammarly-gDocs.beautified.js","start":39695,"end":39790}]},{"name":"Business Uphook Logic","description":"Contains logic to determine if a user is eligible for business-related uphooks and experiments based on their subscription status, site category, and interaction history.","evidence":[{"file":"src/js/Grammarly-gDocs.beautified.js","start":39418,"end":39580}]}]},"evidence":[{"file":"src/js/Grammarly-gDocs.beautified.js","start":38001,"end":40000}],"notes":"This chunk contains the core feedback reporting hub (`sendFeedback`), the critical CAPI message transformer and rebaser for data consistency, and feature handlers for ethical AI alerts and business-related uphooks."}
{"file":"src/js/Grammarly-gDocs.beautified.js","beautified":"src/js/Grammarly-gDocs.beautified.js","chunk":{"id":"chunk-21/53","start_line":40001,"end_line":42000,"same_function_group":null},"findings":{"chrome_apis":["browser.runtime.getURL"],"event_listeners":[],"messages":[{"name":"requestGrantPermission","direction":"content->background","payload_keys":["nativeMessaging"],"evidence":[{"file":"src/js/Grammarly-gDocs.beautified.js","start":40050,"end":40075}]},{"name":"sendToFocusTab","direction":"content->background","payload_keys":["showOnboardingDialog","disableOnTab"],"evidence":[{"file":"src/js/Grammarly-gDocs.beautified.js","start":41900,"end":41950}]}],"storage":[],"endpoints":[],"dom":[{"type":"dynamic_stylesheet","description":"A React component dynamically injects <link rel=\"stylesheet\"> tags into the document to load CSS on demand.","evidence":[{"file":"src/js/Grammarly-gDocs.beautified.js","start":40650,"end":40750}]}],"dynamic_code":[{"type":"dynamic_import","description":"The PersonalizedInsightsConsentService is loaded via a dynamic import() call.","evidence":[{"file":"src/js/Grammarly-gDocs.beautified.js","start":41250,"end":41260}]}],"wasm":[],"obfuscation_hints":["minified_vars","webpack_modules"],"risks":[{"type":"excessive_permissions","severity":"medium","description":"The ConnectorPermissionPopupService requests the `nativeMessaging` permission, which allows the extension to communicate with native applications installed on the users computer. This is a powerful permission that could be misused if the extension were compromised.","evidence":[{"file":"src/js/Grammarly-gDocs.beautified.js","start":40018,"end":40080}]}],"key_functionality":[{"name":"G-Button Controller","description":"The main `qt` class in module `70962` orchestrates the entire G-Button feature, including its visibility, state (minimized/expanded), and the rendering of its UI components.","evidence":[{"file":"src/js/Grammarly-gDocs.beautified.js","start":41730,"end":42000}]},{"name":"Popup Services","description":"Multiple services are defined to manage various popups anchored to the G-Button, including for connector permissions, free-to-premium uphooks, account migration, and subscription/payment issues (dunning).","evidence":[{"file":"src/js/Grammarly-gDocs.beautified.js","start":40018,"end":41729}]},{"name":"G-Button Expanded Menu","description":"The `Be` class in module `70962` is responsible for dynamically building the list of items that appear in the expanded G-Button menu, such as the main alert count CTA, emogenie button, and disable button.","evidence":[{"file":"src/js/Grammarly-gDocs.beautified.js","start":41110,"end":41210}]}]},"evidence":[{"file":"src/js/Grammarly-gDocs.beautified.js","start":40001,"end":42000}],"notes":"This chunk is focused on the G-Button controller and the many popups it manages, including permission requests, uphooks, and account notifications. It defines the main class that orchestrates the G-Button UI and its interactions."}
{"file":"src/js/Grammarly-gDocs.beautified.js","beautified":"src/js/Grammarly-gDocs.beautified.js","chunk":{"id":"chunk-22/53","start_line":42001,"end_line":44000,"same_function_group":null},"findings":{"chrome_apis":[],"event_listeners":["IntersectionObserver"],"messages":[],"storage":[{"key":"page.iterableNextFetchSettings","type":"local","op":"read"},{"key":"user.customSessionTimeoutInfo","type":"local","op":"read"}],"endpoints":[{"url":"iterableGetInAppMessages","method":"bgRpc"},{"url":"iterableTrackInAppOpen","method":"bgRpc"},{"url":"iterableTrackInAppClick","method":"bgRpc"},{"url":"iterableTrackInAppConsume","method":"bgRpc"}],"dom":["getClientRects","getBoundingClientRect","createElement","getElementById"],"dynamic_code":["lazy loading"],"wasm":[],"obfuscation_hints":["webpack_modules","minified_vars"],"risks":[{"type":"tracking","severity":"medium","description":"The IterableInAppMessageService tracks user actions like session start, alert interactions, and typing pauses to trigger in-app marketing messages."},{"type":"remote_code","severity":"low","description":"Renders HTML content fetched from the Iterable marketing service inside a sandboxed iframe."}]},"evidence":[{"file":"src/js/Grammarly-gDocs.beautified.js","start":43185,"end":43484,"ast_id":null},{"file":"src/js/Grammarly-gDocs.beautified.js","start":42380,"end":42588,"ast_id":null},{"file":"src/js/Grammarly-gDocs.beautified.js","start":43540,"end":43998,"ast_id":null}],"notes":"This chunk focuses on the UI rendering pipeline for highlights, popups, and in-app messages (IPMs). It includes the geometry engine for highlights, state aggregation for the G-Button, and the service for fetching and displaying messages from the Iterable marketing platform."}
{"file":"src/js/Grammarly-gDocs.beautified.js","beautified":"src/js/Grammarly-gDocs.beautified.js","chunk":{"id":"chunk-23/53","start_line":44001,"end_line":46000,"same_function_group":null},"findings":{"chrome_apis":[],"event_listeners":["resize","keydown","mousedown","scroll","mousewheel","touchmove","MutationObserver"],"messages":[],"storage":[],"endpoints":[],"dom":["getBoundingClientRect","clientTop","clientLeft","offsetHeight","clientWidth","dispatchEvent","DataTransfer","ClipboardEvent","KeyboardEvent","InputEvent"],"dynamic_code":[],"wasm":[],"obfuscation_hints":["webpack_modules","minified_vars"],"risks":[{"type":"other","severity":"low","description":"The extension is potentially fragile due to its heavy reliance on specific DOM properties and event simulation, which could break if the host application (Google Docs) changes its internal structure."}]},"evidence":[{"file":"src/js/Grammarly-gDocs.beautified.js","start":44287,"end":45000,"ast_id":null},{"file":"src/js/Grammarly-gDocs.beautified.js","start":45300,"end":45500,"ast_id":null},{"file":"src/js/Grammarly-gDocs.beautified.js","start":45700,"end":45850,"ast_id":null},{"file":"src/js/Grammarly-gDocs.beautified.js","start":45100,"end":45250,"ast_id":null}],"notes":"This chunk contains the core rendering, layout, and interaction logic. It features the main `TextFieldLayout` class, which orchestrates the UI layer, and the sophisticated text replacement mechanism designed to preserve rich text formatting. It also includes setup for the GenAI (Proofit) feature and utilities for simulating DOM events."}
{"file":"/Users/jfri/Downloads/kbfnbcaeplbcioakkpcpgfkobkghlhen/src/js/Grammarly-gDocs.js","beautified":"/Users/jfri/Downloads/kbfnbcaeplbcioakkpcpgfkobkghlhen/src/js/Grammarly-gDocs.beautified.js","chunk":{"id":"chunk-24/53","start_line":46001,"end_line":48000,"same_function_group":null},"findings":{"chrome_apis":[],"event_listeners":[],"messages":[],"storage":[{"key":"oauth.tokens","type":"local","op":"get/set/remove","purpose":"Stores OAuth tokens for the authenticated fetch wrapper."},{"key":"GrCAPIStorage:*","type":"indexeddb","op":"get/set/remove/clear","purpose":"A comprehensive IndexedDB-based storage implementation with features for quota management, data eviction (TTL), and migrations."}],"endpoints":[],"dom":[],"dynamic_code":[],"wasm":[],"obfuscation_hints":["minified_vars","webpack_modules"],"risks":[]},"evidence":[{"file":"/Users/jfri/Downloads/kbfnbcaeplbcioakkpcpgfkobkghlhen/src/js/Grammarly-gDocs.js","start":46188,"end":46584},{"file":"/Users/jfri/Downloads/kbfnbcaeplbcioakkpcpgfkobkghlhen/src/js/Grammarly-gDocs.js","start":47001,"end":47088},{"file":"/Users/jfri/Downloads/kbfnbcaeplbcioakkpcpgfkobkghlhen/src/js/Grammarly-gDocs.js","start":47790,"end":47955}],"notes":"This chunk introduces the high-level authentication client (Rr) that manages the complete token lifecycle, including a robust renewal strategy (cache -> refresh -> exchange -> anonymous). It also defines a sophisticated IndexedDB storage abstraction ($i) with quota management and a from-scratch SHA-256 implementation (lo), likely for PKCE."}
{"file":"/Users/jfri/Downloads/kbfnbcaeplbcioakkpcpgfkobkghlhen/src/js/Grammarly-gDocs.js","beautified":"/Users/jfri/Downloads/kbfnbcaeplbcioakkpcpgfkobkghlhen/src/js/Grammarly-gDocs.beautified.js","chunk":{"id":"chunk-25/53","start_line":48001,"end_line":50000,"same_function_group":null},"findings":{"chrome_apis":["chrome.cookies.get","chrome.cookies.set","chrome.cookies.remove","chrome.cookies.getAll","chrome.runtime.lastError"],"event_listeners":["onPortConnection","onMessage","onDisconnect"],"messages":[{"name":"message-bus-port","direction":"content->background","payload_keys":[],"notes":"Used by the internal message bus to establish communication channels between different parts of the extension."}],"storage":[{"key":"gnar_containerId","type":"cookies/local","op":"get/set","purpose":"Primary identifier for the Gnar analytics client, stored resiliently across multiple storage types."},{"key":"gnar_nextPingTimestamp","type":"local","op":"get/set","purpose":"Controls the throttling of the Gnar client's periodic 'ping' event."},{"key":"gnarInternalStorage","type":"local","op":"get/set","purpose":"Internal storage for the Gnar client, likely for caching or session data."}],"endpoints":[{"url":"/events-with-token, /lite-with-token","method":"POST","purpose":"Endpoints for the Gnar analytics client to send batched event data."}],"dom":[],"dynamic_code":[{"type":"dynamic_import","snippet":"__webpack_require__.e(...).then(__webpack_require__.bind(...))","notes":"The agent platform dynamically loads agent implementations (e.g., for document analysis, assistant features) on demand. This is a core part of the modular architecture."}],"wasm":[],"obfuscation_hints":["minified_vars","webpack_modules"],"risks":[]},"evidence":[{"file":"/Users/jfri/Downloads/kbfnbcaeplbcioakkpcpgfkobkghlhen/src/js/Grammarly-gDocs.js","start":48293,"end":48499},{"file":"/Users/jfri/Downloads/kbfnbcaeplbcioakkpcpgfkobkghlhen/src/js/Grammarly-gDocs.js","start":49251,"end":49550},{"file":"/Users/jfri/Downloads/kbfnbcaeplbcioakkpcpgfkobkghlhen/src/js/Grammarly-gDocs.js","start":48055,"end":48291}],"notes":"This chunk unveils the core 'Agent Platform' (La class), a sophisticated modular architecture for managing features. It dynamically loads agents (e.g., for document analysis, assistant) on demand. It also contains the full, detailed implementation of the 'Gnar' analytics client ($c class), which uses a resilient storage strategy (cookies, localStorage) to persist its containerId and batches events to send to the backend."}
{"file":"src/js/Grammarly-gDocs.js","beautified":"src/js/Grammarly-gDocs.beautified.js","chunk":{"id":"chunk-26/53","start_line":50001,"end_line":52000,"same_function_group":null},"findings":{"chrome_apis":[],"event_listeners":[],"messages":[{"name":"CustomEvent","direction":"other","payload_keys":[]}],"storage":[],"endpoints":[],"dom":["document.location.href","self.open","document.createElement","document.querySelector","element.setAttribute","element.getBoundingClientRect"],"dynamic_code":[],"wasm":[],"obfuscation_hints":["webpack_modules","minified_vars"],"risks":[]},"evidence":[{"file":"src/js/Grammarly-gDocs.js","start":50001,"end":52000,"ast_id":null}],"notes":"This chunk contains logic for showing popups in Google Docs, specifically for anonymous users and for a \"Stand With Ukraine\" campaign. It also defines a sidebar and related UI components, including a custom event-based communication channel (`CustomEvent`) for inter-component messaging. It also includes a parser for the document content."}
{"file":"src/js/Grammarly-gDocs.js","beautified":"src/js/Grammarly-gDocs.beautified.js","chunk":{"id":"chunk-27/53","start_line":52001,"end_line":54000,"same_function_group":null},"findings":{"chrome_apis":[],"event_listeners":[],"messages":[],"storage":[],"endpoints":[],"dom":[],"dynamic_code":[],"wasm":[],"obfuscation_hints":["webpack_modules","minified_vars"],"risks":[]},"evidence":[{"file":"src/js/Grammarly-gDocs.js","start":52001,"end":54000,"ast_id":null}],"notes":"This chunk is a continuation of the Google Docs content parser. It includes complex logic for handling tables, rows, cells, and text fragments within the document. It defines a variety of parsing functions and combinators to handle different document structures, including whitespace, special characters, and different types of content blocks. It also includes logic for handling multi-column layouts and page breaks."}
{"file":"src/js/Grammarly-gDocs.js","beautified":"src/js/Grammarly-gDocs.beautified.js","chunk":{"id":"chunk-28/53","start_line":54001,"end_line":56000,"same_function_group":null},"findings":{"chrome_apis":[],"event_listeners":[],"messages":[],"storage":[],"endpoints":[],"dom":["document.createElement","document.head.appendChild","element.remove"],"dynamic_code":[],"wasm":[],"obfuscation_hints":["webpack_modules","minified_vars"],"risks":[]},"evidence":[{"file":"src/js/Grammarly-gDocs.js","start":54001,"end":56000,"ast_id":null}],"notes":"This chunk continues the implementation of the Google Docs content parser. It includes logic for handling text replacements, managing selection, and observing text changes. It defines a `CanvasReplacementService` that can perform single and batch replacements, and a `SelectionService` that can set and verify the selection in the document. It also includes logic for handling different document modes, such as \"suggesting\" mode, and for dealing with whitespace and special characters."}
{"file":"src/js/Grammarly-gDocs.js","beautified":"src/js/Grammarly-gDocs.beautified.js","chunk":{"id":"chunk-29/53","start_line":56001,"end_line":58000,"same_function_group":null},"findings":{"chrome_apis":[],"event_listeners":[],"messages":[],"storage":[],"endpoints":[],"dom":[],"dynamic_code":[],"wasm":[],"obfuscation_hints":["webpack_modules","minified_vars"],"risks":[]},"evidence":[{"file":"src/js/Grammarly-gDocs.js","start":56001,"end":58000,"ast_id":null}],"notes":"This chunk defines the core logic for mapping the rendered content of a Google Doc to a structured text representation. It introduces the `CanvasTextObserver`, which is responsible for observing changes in the rendered content and creating a `TextMap` that can be used to reason about the document's structure. It also defines a `TextMapLogger` that is used to collect statistics about the mapping process."}
{"file":"src/js/Grammarly-gDocs.js","beautified":"src/js/Grammarly-gDocs.beautified.js","chunk":{"id":"chunk-30/53","start_line":58001,"end_line":60000,"same_function_group":null},"findings":{"chrome_apis":[],"event_listeners":["mousedown","mouseup","mousemove","focus","blur","keydown","click","message"],"messages":[{"name":"postMessage (custom __grammarly protocol)","direction":"other","payload_keys":[]}],"storage":[],"endpoints":[],"dom":["requestAnimationFrame","element.dispatchEvent","element.scrollBy"],"dynamic_code":[],"wasm":[],"obfuscation_hints":["webpack_modules","minified_vars"]},"evidence":[{"file":"src/js/Grammarly-gDocs.js","start":58001,"end":60000,"ast_id":null}],"notes":"This chunk is a collection of core utilities and services, including text processing, scrolling, TextMap traversal, fragment representation, UI interaction, iframe communication, state management, settings management, analytics, and keyboard shortcut handling."}
{"file":"src/js/Grammarly-gDocs.js","beautified":"src/js/Grammarly-gDocs.beautified.js","chunk":{"id":"chunk-31/53","start_line":60001,"end_line":62000,"same_function_group":null},"findings":{"chrome_apis":[],"event_listeners":["click","mousedown","mouseover","mouseleave","keydown","resize"],"messages":[],"storage":[],"endpoints":[],"dom":["setTimeout","clearTimeout","ResizeObserver"],"dynamic_code":[],"wasm":[],"obfuscation_hints":["webpack_modules","minified_vars","react_components"]},"evidence":[{"file":"src/js/Grammarly-gDocs.js","start":60001,"end":62000,"ast_id":null}],"notes":"This chunk is almost entirely composed of UI components, likely written in React, that form the building blocks for the suggestion cards and popovers seen by the user. It includes a sophisticated `Positioner` component for placing floating elements, and a wide variety of specialized \"card\" components for different types of suggestions: replacements, definitions, synonyms, unknown words, and upgrade prompts. It also contains the logic for popover menus, tooltips, and custom buttons. The code handles complex user interactions like hover, click, and keyboard navigation for these UI elements."}
{"file":"src/js/Grammarly-gDocs.js","beautified":"src/js/Grammarly-gDocs.beautified.js","chunk":{"id":"chunk-32/53","start_line":62001,"end_line":64000,"same_function_group":null},"findings":{"chrome_apis":["chrome.runtime.getManifest","chrome.runtime.id"],"event_listeners":["scroll","mouseover","mouseleave"],"messages":[],"storage":[],"endpoints":["https://gnar.*","https://in.*","https://f-log-extension.grammarly.io","https://capi.*","wss://capi.*","https://auth.*","https://gateway.*","https://assets.extension.grammarly.com/","https://data.*","https://api.iterable.com"],"dom":["setTimeout","clearTimeout","requestAnimationFrame","cancelAnimationFrame","ResizeObserver"],"dynamic_code":[],"wasm":[],"obfuscation_hints":["webpack_modules","minified_vars","react_components"],"risks":[{"type":"third_party_connection","severity":"low","description":"Connects to api.iterable.com, a third-party marketing automation platform, which could be used for user tracking or marketing communications."}]},"evidence":[{"file":"src/js/Grammarly-gDocs.js","start":62001,"end":64000}],"notes":"This chunk defines the core configuration logic for the extension, including constructing all API and web page URLs based on the environment. It also includes a complete tooltip system, highlight rendering components, and various UI utilities."}
{"file":"src/js/Grammarly-gDocs.js","beautified":"src/js/Grammarly-gDocs.beautified.js","chunk":{"id":"chunk-33/53","start_line":64001,"end_line":66000,"same_function_group":null},"findings":{"chrome_apis":[],"event_listeners":["resize"],"messages":["bgSW-shutdown","contentScript-disconnected"],"storage":[],"endpoints":["https://support.*","https://in-product.report.grammarly.io/v1/report","https://assets.extension.grammarly.com/","https://accounts.google.com","https://www.facebook.com/login","https://appleid.apple.com/auth"],"dom":["document.createEvent","document.dispatchEvent","console.log","console.debug","console.warn","console.error"],"dynamic_code":[],"wasm":[],"obfuscation_hints":["webpack_modules","minified_vars","feature_flags","lazy_loading"],"risks":[{"type":"dynamic_behavior","severity":"medium","description":"The extension uses an extensive system of feature flags and experiments, allowing its behavior to be changed remotely without deploying a new version. This makes static analysis incomplete as many features can be toggled on or off."}]},"evidence":[{"file":"src/js/Grammarly-gDocs.js","start":64001,"end":66000}],"notes":"This chunk is dense with configuration, defining a massive number of feature flags and experiments that control almost every aspect of the extension. It also contains the core logic for the content-script-to-background messaging API and the React-based rendering system for various types of inline suggestion cards (SDUI, FSI, legacy, etc.)."}
{"file":"src/js/Grammarly-gDocs.js","beautified":"src/js/Grammarly-gDocs.beautified.js","chunk":{"id":"chunk-34/53","start_line":66001,"end_line":68000,"same_function_group":null},"findings":{"chrome_apis":[],"event_listeners":["error","unhandledrejection"],"messages":["cs-to-bg-rpc-1587687052565","cs-to-bg-observable-rpc-1587687052565","cs-to-bg-rpc-1557421403805","cs-to-bg-static-capi-rpc-1668544923207"],"storage":["user","version","dynamicConfig","extensionSettings","dynamicConfigOverrideKey","environmentState","connection","activeTab","extensionFSM","fieldsSettings","alarms","clickToRunEnabledOnce","dapi","growthSettings","extensionMeta","gnarInternalStorage","extensionInstallDate","extensionInstallSource","lastAuthnEvent","copiedTextMessage","passport","mise","iterable","connectorSettings","oauthSDKTokenExchangeMethod","Grammarly:oauth:pendingRequest","authenticationOptions","authTokenInitialRefreshDone","authenticationStarted","claimedUserSettings","inviteNudgeFirstTimestamp"],"endpoints":["/signin","/signup","/account/subscription"],"dom":[],"dynamic_code":[],"wasm":[],"obfuscation_hints":["webpack_modules","minified_vars","rpc_abstraction"],"risks":[]},"evidence":[{"file":"src/js/Grammarly-gDocs.js","start":66001,"end":68000}],"notes":"This chunk details the core RPC and messaging architecture, including a proxy-based system with observable support for communication between the content script and background. It also defines the PersistentStore class for managing browser storage and continues the implementation of the inline card rendering logic, which acts as a factory for different card types (SDUI, FSI, etc.)."}
{"file":"src/js/Grammarly-gDocs.beautified.js","beautified":"src/js/Grammarly-gDocs.beautified.js","chunk":{"id":"chunk-35/53","start_line":68001,"end_line":70000,"same_function_group":null},"findings":{"chrome_apis":["chrome.storage.session"],"event_listeners":[],"messages":[],"storage":[{"key":"(dynamic)","type":"session","op":"set","purpose":"Backup for client-side logs."},{"key":"(dynamic)","type":"session","op":"get","purpose":"Restore client-side logs."}],"endpoints":[],"dom":[],"dynamic_code":[],"wasm":[],"obfuscation_hints":["webpack_modules","minified_vars","generated_apis"],"risks":[{"type":"other","severity":"low","description":"Extensive client-side logging could capture sensitive data if not properly sanitized. The system includes data normalization, but its effectiveness depends on the implementation."}]},"evidence":[{"file":"src/js/Grammarly-gDocs.beautified.js","start":69558,"end":69597,"ast_id":null},{"file":"src/js/Grammarly-gDocs.beautified.js","start":69780,"end":69858,"ast_id":null}],"notes":"This chunk details a sophisticated client-side logging framework with prioritized buffers, session storage backup, and a comprehensive set of state management actions for controlling application features and settings."}
{"file":"src/js/Grammarly-gDocs.beautified.js","beautified":"src/js/Grammarly-gDocs.beautified.js","chunk":{"id":"chunk-36/53","start_line":70001,"end_line":72000,"same_function_group":null},"findings":{"chrome_apis":[],"event_listeners":[],"messages":[],"storage":[],"endpoints":[{"url":"(felog)","method":"POST","purpose":"Primary telemetry and event logging endpoint."},{"url":"(femetrics)","method":"POST","purpose":"Metrics-specific telemetry endpoint."}],"dom":[],"dynamic_code":[],"wasm":[],"obfuscation_hints":["webpack_modules","minified_vars","generated_apis"],"risks":[{"type":"tracking","severity":"medium","description":"This chunk defines an exhaustive telemetry service that logs a vast number of user interactions, performance metrics, and errors to Grammarly's servers. While essential for product improvement, the sheer scope of data collection presents a potential privacy risk if not managed with extreme care."}]},"evidence":[{"file":"src/js/Grammarly-gDocs.beautified.js","start":70368,"end":72000,"ast_id":null}],"notes":"This chunk is almost entirely dedicated to the definition of the TelemetryService, a massive class that catalogs and sends hundreds of different client-side events related to user behavior, errors, and performance to Grammarly's backend. It includes specific logging suites for major features like GDocs, the Assistant, and third-party integrations."}
{"file":"src/js/Grammarly-gDocs.beautified.js","beautified":"src/js/Grammarly-gDocs.beautified.js","chunk":{"id":"chunk-37/53","start_line":72001,"end_line":74000,"same_function_group":null},"findings":{"chrome_apis":[],"event_listeners":[],"messages":[],"storage":[],"endpoints":[],"dom":[],"dynamic_code":[],"wasm":[],"obfuscation_hints":["webpack_modules","minified_vars","library_bundling"],"risks":[]},"evidence":[{"file":"src/js/Grammarly-gDocs.beautified.js","start":72001,"end":73080,"ast_id":null},{"file":"src/js/Grammarly-gDocs.beautified.js","start":73081,"end":73650,"ast_id":null},{"file":"src/js/Grammarly-gDocs.beautified.js","start":73651,"end":74000,"ast_id":null}],"notes":"This chunk finishes the massive TelemetryService definition and then bundles two complete, self-contained libraries: a color manipulation utility and the full source code for the DOMPurify HTML sanitizer. The inclusion of DOMPurify with its extensive allow-lists for tags and attributes is a strong positive security indicator."}
{"file":"src/js/Grammarly-gDocs.beautified.js","beautified":"src/js/Grammarly-gDocs.beautified.js","chunk":{"id":"chunk-38/53","start_line":74001,"end_line":76000,"same_function_group":null},"findings":{"chrome_apis":[],"event_listeners":[],"messages":[],"storage":[],"endpoints":[],"dom":[{"name":"DOMPurify.sanitize","evidence":[{"file":"src/js/Grammarly-gDocs.beautified.js","start":75105,"end":75203}]}],"dynamic_code":[],"wasm":[],"obfuscation_hints":["webpack_modules"],"risks":[]},"evidence":[{"file":"src/js/Grammarly-gDocs.beautified.js","start":74001,"end":76000}],"notes":"This chunk contains the core implementation of the DOMPurify HTML sanitizer, a complete text-diffing library (likely diff-match-patch), and a suite of functional programming utilities (fp-ts style) for Either, Eq, and applicative/monad operations. The presence of DOMPurify is a strong security feature against XSS."}
{"file":"src/js/Grammarly-gDocs.beautified.js","beautified":"src/js/Grammarly-gDocs.beautified.js","chunk":{"id":"chunk-39/53","start_line":76001,"end_line":78000,"same_function_group":null},"findings":{"chrome_apis":[],"event_listeners":[],"messages":[],"storage":[],"endpoints":[],"dom":[],"dynamic_code":[],"wasm":[],"obfuscation_hints":["webpack_modules"],"risks":[]},"evidence":[{"file":"src/js/Grammarly-gDocs.beautified.js","start":76001,"end":78000}],"notes":"This chunk is entirely composed of bundled functional programming utilities, characteristic of the fp-ts library. It provides rich, immutable, and type-safe APIs for Map (`getEq`, `lookup`, `map`, `filter`, `reduce`, `traverse`) and ReadonlyArray (`head`, `last`, `map`, `chain`, `filter`, `reduce`, `sort`, `zip`)."}
{"file":"src/js/Grammarly-gDocs.beautified.js","beautified":"src/js/Grammarly-gDocs.beautified.js","chunk":{"id":"chunk-40/53","start_line":78001,"end_line":80000,"same_function_group":null},"findings":{"chrome_apis":[],"event_listeners":[],"messages":[],"storage":[],"endpoints":[],"dom":[],"dynamic_code":[],"wasm":[],"obfuscation_hints":["webpack_modules"],"risks":[]},"evidence":[{"file":"src/js/Grammarly-gDocs.beautified.js","start":78001,"end":80000}],"notes":"This chunk continues the bundle of fp-ts functional programming utilities. It includes extensive libraries for Record (map, reduce, filter, traverse), Tuple (fst, snd, map, bimap), and the 'These' data type (left, right, both, fold). It also contains core functional helpers like pipe, flow, and identity."}
{"file":"src/js/Grammarly-gDocs.beautified.js","beautified":"src/js/Grammarly-gDocs.beautified.js","chunk":{"id":"chunk-41/53","start_line":80001,"end_line":82000,"same_function_group":null},"findings":{"chrome_apis":[],"event_listeners":[],"messages":[],"storage":[],"endpoints":[],"dom":[],"dynamic_code":[],"wasm":[],"obfuscation_hints":["webpack_modules"],"risks":[]},"evidence":[{"file":"src/js/Grammarly-gDocs.beautified.js","start":80001,"end":82000,"ast_id":null}],"notes":"This chunk contains a complete, bundled implementation of a powerful data validation and codec library, strongly resembling `io-ts`. It provides a rich set of type constructors (literal, string, number, boolean, nullable, type, partial, array, record, tuple, intersect, union, sum, refine, lazy) and includes error reporting utilities like `PathReporter`."}
{"file":"src/js/Grammarly-gDocs.beautified.js","beautified":"src/js/Grammarly-gDocs.beautified.js","chunk":{"id":"chunk-42/53","start_line":82001,"end_line":84000,"same_function_group":null},"findings":{"chrome_apis":[],"event_listeners":[],"messages":[],"storage":[],"endpoints":[],"dom":[],"dynamic_code":[],"wasm":[],"obfuscation_hints":["webpack_modules","minified_vars"],"risks":[]},"evidence":[{"file":"src/js/Grammarly-gDocs.beautified.js","start":82001,"end":84000,"ast_id":null}],"notes":"This chunk concludes the `io-ts` implementation, providing concrete classes for types like `InterfaceType`, `UnionType`, `IntersectionType`, etc. It also includes a Levenshtein distance algorithm and a large number of CSS module exports, mapping component names to obfuscated class names. Additionally, it contains a bundled implementation of a `monocle-ts`-like optics library."}
{"file":"src/js/Grammarly-gDocs.beautified.js","beautified":"src/js/Grammarly-gDocs.beautified.js","chunk":{"id":"chunk-43/53","start_line":84001,"end_line":86000,"same_function_group":null},"findings":{"chrome_apis":[],"event_listeners":[],"messages":[],"storage":[],"endpoints":[],"dom":[],"dynamic_code":[],"wasm":[],"obfuscation_hints":["webpack_modules","minified_vars"],"risks":[]},"evidence":[{"file":"src/js/Grammarly-gDocs.beautified.js","start":84001,"end":86000,"ast_id":null}],"notes":"This chunk contains implementations of MurmurHash3 and SuperFastHash algorithms. The majority of the chunk is a bundled, minified version of React's synthetic event system, including event normalization, dispatching logic, controlled component handling, and DOM property management. It reveals the low-level mechanics of how the UI library handles user interactions."}
{"file":"src/js/Grammarly-gDocs.beautified.js","beautified":"src/js/Grammarly-gDocs.beautified.js","chunk":{"id":"chunk-44/53","start_line":86001,"end_line":88000,"same_function_group":null},"findings":{"chrome_apis":[],"event_listeners":[],"messages":[],"storage":[],"endpoints":[],"dom":[],"dynamic_code":[],"wasm":[],"obfuscation_hints":["webpack_modules","minified_vars"],"risks":[]},"evidence":[{"file":"src/js/Grammarly-gDocs.beautified.js","start":86001,"end":88000,"ast_id":null}],"notes":"This chunk continues the implementation of the bundled React-like library. It covers the finalization of the event system, the core Fiber architecture, the reconciliation logic (child diffing), the Context API implementation, the complete Hooks implementation (useState, useEffect, etc.), and the handling of class component lifecycle methods. The code is clearly minified React source."}
{"file":"src/js/Grammarly-gDocs.beautified.js","chunk":{"id":"chunk-45/53","start_line":88001,"end_line":90000,"same_function_group":null},"findings":{"chrome_apis":[],"event_listeners":[],"messages":[],"storage":[],"endpoints":[],"dom":[],"dynamic_code":[],"wasm":[],"obfuscation_hints":["react_internals","react_commit_phase"],"risks":[]},"evidence":[{"file":"src/js/Grammarly-gDocs.beautified.js","start":88001,"end":90000}],"notes":"This chunk covers the commit phase of the React reconciler, responsible for applying changes to the DOM, executing lifecycle methods, and running effects."}
{"file":"src/js/Grammarly-gDocs.beautified.js","chunk":{"id":"chunk-46/53","start_line":90001,"end_line":92000,"same_function_group":null},"findings":{"chrome_apis":[],"event_listeners":[],"messages":[],"storage":[],"endpoints":[],"dom":[],"dynamic_code":[],"wasm":[],"obfuscation_hints":["react_api","react_devtools_hook"],"risks":[]},"evidence":[{"file":"src/js/Grammarly-gDocs.beautified.js","start":90001,"end":92000}],"notes":"This chunk exposes the public API of the `react-dom` library, including functions like `createRoot`, `hydrateRoot`, and `render`. It also contains the logic for injecting the reconciler into the React DevTools global hook."}
{"file":"src/js/Grammarly-gDocs.beautified.js","chunk":{"id":"chunk-47/53","start_line":92001,"end_line":94000,"same_function_group":null},"findings":{"chrome_apis":[],"event_listeners":[],"messages":[],"storage":[],"endpoints":[],"dom":[],"dynamic_code":[],"wasm":[],"obfuscation_hints":["rxjs_operators","observable_patterns"],"risks":[]},"evidence":[{"file":"src/js/Grammarly-gDocs.beautified.js","start":92001,"end":94000}],"notes":"This chunk contains a bundled version of the RxJS library, including a wide range of operators for reactive programming with Observables."}
{"file":"src/js/Grammarly-gDocs.beautified.js","chunk":{"id":"chunk-48/53","start_line":94001,"end_line":96000,"same_function_group":null},"findings":{"chrome_apis":[],"event_listeners":[],"messages":[],"storage":[],"endpoints":[],"dom":[],"dynamic_code":[],"wasm":[],"obfuscation_hints":["rxjs_operators","observable_patterns"],"risks":[]},"evidence":[{"file":"src/js/Grammarly-gDocs.beautified.js","start":94001,"end":96000}],"notes":"This chunk continues the implementation of RxJS operators, including `retry`, `repeat`, `sample`, `scan`, `share`, `single`, `skip`, `take`, `throttle`, `timeout`, `timestamp`, and `toArray`."}
{"file":"src/js/Grammarly-gDocs.beautified.js","beautified":"src/js/Grammarly-gDocs.beautified.js","chunk":{"id":"chunk-49/53","start_line":96001,"end_line":98000,"same_function_group":null},"findings":{"chrome_apis":[],"event_listeners":[],"messages":[{"name":"cardAction/:docId","direction":"other","payload_keys":[]},{"name":"panelAction/:docId","direction":"other","payload_keys":[]}],"storage":[],"endpoints":[],"dom":[],"dynamic_code":[],"wasm":[],"obfuscation_hints":["webpack_modules"],"risks":[]},"evidence":[{"file":"src/js/Grammarly-gDocs.beautified.js","start":96182,"end":96651,"ast_id":null},{"file":"src/js/Grammarly-gDocs.beautified.js","start":96670,"end":97011,"ast_id":null},{"file":"src/js/Grammarly-gDocs.beautified.js","start":97015,"end":97508,"ast_id":null},{"file":"src/js/Grammarly-gDocs.beautified.js","start":97512,"end":97531,"ast_id":null},{"file":"src/js/Grammarly-gDocs.beautified.js","start":97535,"end":97618,"ast_id":null},{"file":"src/js/Grammarly-gDocs.beautified.js","start":97622,"end":97729,"ast_id":null},{"file":"src/js/Grammarly-gDocs.beautified.js","start":97805,"end":97843,"ast_id":null},{"file":"src/js/Grammarly-gDocs.beautified.js","start":97933,"end":98000,"ast_id":null}],"notes":"This chunk contains a variety of bundled libraries and application features. Key findings include React's internal scheduler for cooperative multitasking, the `typestyle` CSS-in-JS library, and the `ua-parser-js` library for user agent string analysis. It also contains detailed definitions for core product features like the 'AI Detector' and 'Plagiarism Checker,' including their state machines, communication protocols, and integration points. Finally, it includes a set of React components from what appears to be an internal design system (GDS - Grammarly Design System) and various utilities like a UUID generator and an LRU cache."}
{"file":"src/js/Grammarly-gDocs.beautified.js","beautified":"src/js/Grammarly-gDocs.beautified.js","chunk":{"id":"chunk-50/53","start_line":98001,"end_line":100000,"same_function_group":null},"findings":{"chrome_apis":[],"event_listeners":[{"type":"onClick","file":"src/js/Grammarly-gDocs.beautified.js","line_start":98134,"line_end":98269}],"messages":[],"storage":[],"endpoints":[],"dom":[{"tag":"svg","file":"src/js/Grammarly-gDocs.beautified.js","line_start":98270,"line_end":99990},{"tag":"a","file":"src/js/Grammarly-gDocs.beautified.js","line_start":98134,"line_end":98269}],"dynamic_code":[],"wasm":[],"obfuscation_hints":["webpack_modules"],"risks":[]},"evidence":[{"file":"src/js/Grammarly-gDocs.beautified.js","start":98004,"end":98040,"ast_id":null},{"file":"src/js/Grammarly-gDocs.beautified.js","start":98041,"end":98133,"ast_id":null},{"file":"src/js/Grammarly-gDocs.beautified.js","start":98134,"end":98269,"ast_id":null},{"file":"src/js/Grammarly-gDocs.beautified.js","start":98270,"end":99990,"ast_id":null}],"notes":"This chunk contains UI components and SVG assets, likely part of an internal design system (GDS). It defines a `Link` component with accessibility features and various visual styles. The majority of the code consists of React components that render different SVG logos, such as 'LogoGo' and 'LogoMail' in various color schemes and orientations (stacked, horizontal). It also includes helper functions for managing icon properties and issuing developer warnings for using non-standard icons."}
{"file":"src/js/Grammarly-gDocs.beautified.js","beautified":"src/js/Grammarly-gDocs.beautified.js","chunk":{"id":"chunk-51/53","start_line":100001,"end_line":102000,"same_function_group":null},"findings":{"chrome_apis":[],"event_listeners":[],"messages":[],"storage":[{"key":"grammarly.{clientId}.tokens","type":"local","op":"get/set/remove"}],"endpoints":[{"url":"/oauth2/token","method":"POST"},{"url":"/oauth2/exchange","method":"POST"}],"dom":[{"tag":"svg","file":"src/js/Grammarly-gDocs.beautified.js","line_start":100004,"line_end":100215}],"dynamic_code":[],"wasm":[],"obfuscation_hints":["webpack_modules"],"risks":[]},"evidence":[{"file":"src/js/Grammarly-gDocs.beautified.js","start":100004,"end":100215,"ast_id":null},{"file":"src/js/Grammarly-gDocs.beautified.js","start":100550,"end":101995,"ast_id":null},{"file":"src/js/Grammarly-gDocs.beautified.js","start":101235,"end":101335,"ast_id":null},{"file":"src/js/Grammarly-gDocs.beautified.js","start":101336,"end":101403,"ast_id":null},{"file":"src/js/Grammarly-gDocs.beautified.js","start":100785,"end":100998,"ast_id":null},{"file":"src/js/Grammarly-gDocs.beautified.js","start":101030,"end":101065,"ast_id":null},{"file":"src/js/Grammarly-gDocs.beautified.js","start":101560,"end":101750,"ast_id":null},{"file":"src/js/Grammarly-gDocs.beautified.js","start":101780,"end":101865,"ast_id":null},{"file":"src/js/Grammarly-gDocs.beautified.js","start":101866,"end":102000,"ast_id":null}],"notes":"This chunk primarily contains a comprehensive, self-contained OAuth 2.0 client library. It also includes a few more SVG icon components for the internal design system. The OAuth library is robust, featuring mechanisms for token fetching, exchange, and refresh, with support for various grant types (`authorization_code`, `refresh_token`, `token-exchange`). It includes a full-featured HTTP client with retry logic and exponential backoff, a SHA-256 implementation (with a fallback from the native Web Crypto API), PKCE code challenge generation, and a mutex implementation using `localStorage` to handle race conditions across multiple tabs."}
{"file":"src/js/Grammarly-gDocs.beautified.js","beautified":"src/js/Grammarly-gDocs.beautified.js","chunk":{"id":"chunk-52/53","start_line":102001,"end_line":104000,"same_function_group":null},"findings":{"chrome_apis":[],"event_listeners":[],"messages":[],"storage":[{"key":"gr-oauth-key","type":"unknown","purpose":"Stores OAuth tokens","evidence":[{"file":"src/js/Grammarly-gDocs.beautified.js","start":102213,"end":102213}]},{"key":"gr-oauth-service-state","type":"unknown","purpose":"Stores state related to the token service, like degradation status","evidence":[{"file":"src/js/Grammarly-gDocs.beautified.js","start":102214,"end":102214}]},{"key":"gr-oauth-state","type":"unknown","purpose":"Stores state for the authorization code flow","evidence":[{"file":"src/js/Grammarly-gDocs.beautified.js","start":102215,"end":102215}]}],"endpoints":[{"url":"https://auth.grammarly.com/v4/api/oauth2/authorize","method":"unknown","evidence":[{"file":"src/js/Grammarly-gDocs.beautified.js","start":102030,"end":102030}]},{"url":"https://auth.grammarly.com/v4/api/oauth2/exchange","method":"unknown","evidence":[{"file":"src/js/Grammarly-gDocs.beautified.js","start":102031,"end":102031}]},{"url":"https://auth.grammarly.com/v4/api/oauth2/token","method":"unknown","evidence":[{"file":"src/js/Grammarly-gDocs.beautified.js","start":102032,"end":102032}]},{"url":"https://auth.grammarly.com/v4/api/oauth2/revoke-by-refresh-token","method":"unknown","evidence":[{"file":"src/js/Grammarly-gDocs.beautified.js","start":102033,"end":102033}]},{"url":"https://auth.grammarly.com/v4/api/userinfo","method":"unknown","evidence":[{"file":"src/js/Grammarly-gDocs.beautified.js","start":102034,"end":102034}]}],"dom":[],"dynamic_code":[],"wasm":[],"obfuscation_hints":["minified_vars","function_chains"],"risks":[]},"evidence":[{"file":"src/js/Grammarly-gDocs.beautified.js","start":102001,"end":104000}],"notes":"This chunk continues the OAuth 2.0 client implementation and pulls in a significant portion of the React Aria library for advanced focus and interaction management. It defines OAuth endpoints for different environments, handles various grant types, and includes sophisticated hooks for accessibility and user interaction."}
{"file":"src/js/Grammarly-gDocs.beautified.js","beautified":"src/js/Grammarly-gDocs.beautified.js","chunk":{"id":"chunk-53/53","start_line":104001,"end_line":105030,"same_function_group":null},"findings":{"chrome_apis":["chrome.runtime.sendMessage"],"event_listeners":[],"messages":[{"name":"CODE_SPLITTING_INJECT","direction":"unknown","payload_keys":["type","file"],"evidence":[{"file":"src/js/Grammarly-gDocs.beautified.js","start":104860,"end":104863}]}],"storage":[],"endpoints":[],"dom":[],"dynamic_code":[],"wasm":[],"obfuscation_hints":["webpack_modules"],"risks":[]},"evidence":[{"file":"src/js/Grammarly-gDocs.beautified.js","start":104001,"end":105030}],"notes":"This final chunk contains the Webpack runtime and module loader. It's responsible for asynchronously loading all the other JavaScript chunks and CSS files. It includes a fallback mechanism that sends a 'CODE_SPLITTING_INJECT' message via chrome.runtime.sendMessage if a chunk fails to load."}
{"file":"src/js/Grammarly-gDocsEarlyInjector.js","beautified":"src/js/Grammarly-gDocsEarlyInjector.beautified.js","chunk":{"id":"whole-file","start_line":1,"end_line":154,"same_function_group":null},"findings":{"chrome_apis":["chrome.runtime.connect","chrome.runtime.getURL","chrome.runtime.id"],"event_listeners":[],"messages":[{"name":"message:to-priv","direction":"content->background","payload_keys":[],"evidence":[{"file":"src/js/Grammarly-gDocsEarlyInjector.beautified.js","start":71,"end":71}]},{"name":"cs-to-bg-rpc-1557421403805","direction":"content->background","payload_keys":["callid","content"],"evidence":[{"file":"src/js/Grammarly-gDocsEarlyInjector.beautified.js","start":153,"end":164}]}],"storage":[],"endpoints":[],"dom":[{"selector":"script","action":"injection","evidence":[{"file":"src/js/Grammarly-gDocsEarlyInjector.beautified.js","start":81,"end":122}]},{"selector":"script","action":"injection","evidence":[{"file":"src/js/Grammarly-gDocsEarlyInjector.beautified.js","start":133,"end":147}]}],"dynamic_code":[],"wasm":[],"obfuscation_hints":["minified_vars"],"risks":[{"type":"other","severity":"low","justification":"The script directly manipulates and patches the host page's global `window` object (`_createKixApplication`). While necessary for its functionality, this is a fragile integration method that could break if Google changes the GDocs initialization process.","evidence":[{"file":"src/js/Grammarly-gDocsEarlyInjector.beautified.js","start":80,"end":121}]}]},"evidence":[{"file":"src/js/Grammarly-gDocsEarlyInjector.beautified.js","start":1,"end":154}],"notes":"This script is an 'early injector' for Google Docs. Its primary purpose is to patch the Google Docs application's JavaScript entry point (`_createKixApplication`) before it runs. This allows Grammarly to gain a reference to the core GDocs application object for deep integration. The script then injects the main content script (`Grammarly-gDocsEarlyInjectedCs.js`) and establishes a persistent communication port with the background script for logging and telemetry."}
{"file":"src/js/Grammarly-gDocsIframeCs.js","beautified":"src/js/Grammarly-gDocsIframeCs.beautified.js","chunk":{"id":"chunk-1/5","start_line":1,"end_line":2000,"same_function_group":null},"findings":{"chrome_apis":[],"event_listeners":[],"messages":[],"storage":[],"endpoints":[],"dom":[],"dynamic_code":[],"wasm":[],"obfuscation_hints":["webpack_modules"],"risks":[]},"evidence":[{"file":"src/js/Grammarly-gDocsIframeCs.beautified.js","start":1,"end":2000}],"notes":"This file is the content script for Grammarly's iframe within Google Docs. This initial chunk contains the Webpack bootstrap code and the ua-parser-js library. It also includes core components of the RxJS library, such as Observable, Subscription, and Subject, which indicates that the script uses a reactive programming model for handling events and asynchronous operations."}
{"file":"src/js/Grammarly-gDocsIframeCs.js","beautified":"src/js/Grammarly-gDocsIframeCs.beautified.js","chunk":{"id":"chunk-2/5","start_line":2001,"end_line":4000,"same_function_group":null},"findings":{"chrome_apis":[],"event_listeners":[],"messages":[],"storage":[],"endpoints":[],"dom":[],"dynamic_code":[],"wasm":[],"obfuscation_hints":["minified_vars","function_chains"],"risks":[]},"evidence":[{"file":"src/js/Grammarly-gDocsIframeCs.js","start":2206,"end":2415,"ast_id":null},{"file":"src/js/Grammarly-gDocsIframeCs.js","start":2738,"end":3388,"ast_id":null},{"file":"src/js/Grammarly-gDocsIframeCs.js","start":3818,"end":3968,"ast_id":null},{"file":"src/js/Grammarly-gDocsIframeCs.js","start":3490,"end":3798,"ast_id":null}],"notes":"This chunk contains the core infrastructure for the iframe's application logic. It includes a sophisticated custom reactive state management system built on RxJS, a comprehensive configuration module that generates settings based on the environment (browser, deployment type), and the critical logic for tracking user typing and determining if a text field should be integrated with Grammarly's features."}
{"file":"src/js/Grammarly-gDocsIframeCs.js","beautified":"src/js/Grammarly-gDocsIframeCs.beautified.js","chunk":{"id":"chunk-3/5","start_line":4001,"end_line":6000,"same_function_group":null},"findings":{"chrome_apis":[],"event_listeners":[],"messages":[],"storage":[],"endpoints":[],"dom":[],"dynamic_code":[],"wasm":[],"obfuscation_hints":["minified_vars","generated_apis"],"risks":[]},"evidence":[{"file":"src/js/Grammarly-gDocsIframeCs.js","start":4001,"end":4080,"ast_id":null},{"file":"src/js/Grammarly-gDocsIframeCs.js","start":4101,"end":4133,"ast_id":null},{"file":"src/js/Grammarly-gDocsIframeCs.js","start":4143,"end":4530,"ast_id":null},{"file":"src/js/Grammarly-gDocsIframeCs.js","start":5010,"end":6000,"ast_id":null}],"notes":"This chunk details the extension's sophisticated infrastructure for analytics, RPC communication, and feature-specific telemetry. It finalizes the typing-tracking logic by adding language detection and sending the final metric. It then defines a comprehensive RPC system for both standard and observable-based communication with the background script. The largest part of this chunk is the definition of a master telemetry service (`gs`) that tracks a vast array of events, from UI clicks and performance timings to detailed errors and integration statuses, with a heavy emphasis on Google Docs-specific metrics."}
{"file":"src/js/Grammarly-gDocsIframeCs.js","beautified":"src/js/Grammarly-gDocsIframeCs.beautified.js","chunk":{"id":"chunk-4/5","start_line":6001,"end_line":8000,"same_function_group":null},"findings":{"chrome_apis":["chrome.storage.managed.get","chrome.storage.session","chrome.scripting.executeScript","chrome.scripting.insertCSS","chrome.tabs.query","chrome.tabs.create","chrome.tabs.reload"],"event_listeners":["chrome.runtime.onMessage","chrome.storage.onChanged","chrome.tabs.onActivated","chrome.tabs.onUpdated","chrome.windows.onFocusChanged"],"messages":[],"storage":["sessionStorage"],"endpoints":[],"dom":[],"dynamic_code":[],"wasm":[],"obfuscation_hints":["minified_vars","generated_apis"],"risks":[]},"evidence":[{"file":"src/js/Grammarly-gDocsIframeCs.js","start":6001,"end":7800,"ast_id":null},{"file":"src/js/Grammarly-gDocsIframeCs.js","start":7801,"end":8000,"ast_id":null}],"notes":"This chunk continues the definition of the massive telemetry service (`gs`), adding tracking for a wide range of features including citation building, human writing reports, the \"Always-Available Assistant\" (AAA), agents, performance metrics, autocorrect, and more. It also defines the core browser API abstraction layer, providing a unified interface for interacting with browser features like storage, messaging, and tabs, while handling differences between Chrome's Manifest V2 and V3."}
{"file":"src/js/Grammarly-gDocsIframeCs.js","beautified":"src/js/Grammarly-gDocsIframeCs.beautified.js","chunk":{"id":"chunk-5/5","start_line":8001,"end_line":8331,"same_function_group":null},"findings":{"chrome_apis":["chrome.runtime.getURL","chrome.notifications.create","chrome.cookies.get","chrome.permissions.request","chrome.sidePanel.open","chrome.action.openPopup","chrome.runtime.sendMessage"],"event_listeners":["chrome.notifications.onClicked","chrome.cookies.onChanged","chrome.permissions.onAdded"],"messages":[],"storage":[],"endpoints":[],"dom":[],"dynamic_code":[],"wasm":[],"obfuscation_hints":["minified_vars"],"risks":[]},"evidence":[{"file":"src/js/Grammarly-gDocsIframeCs.js","start":8001,"end":8300,"ast_id":null},{"file":"src/js/Grammarly-gDocsIframeCs.js","start":8301,"end":8331,"ast_id":null}],"notes":"This final chunk of the file completes the browser API abstraction layer and then initializes and starts the entire content script. It defines the final methods for the `tabs` API, parses the user agent to determine browser/OS info, and creates the main `xr` (browser API) instance. The script concludes by calling `Us.start`, which bootstraps the content script's main logic, setting up the connection to the background script, initializing the data stores, and kicking off the typing tracker and other core functionalities."}
{"file":"src/js/Grammarly-overleafStartContentScript.js","beautified":"src/js/Grammarly-overleafStartContentScript.beautified.js","chunk":{"id":"whole-file","start_line":1,"end_line":22,"same_function_group":null},"findings":{"chrome_apis":["chrome.runtime.getURL","chrome.runtime.id"],"event_listeners":[],"messages":[],"storage":[],"endpoints":[],"dom":[],"dynamic_code":["script.src"],"wasm":[],"obfuscation_hints":[],"risks":[]},"evidence":[{"file":"src/js/Grammarly-overleafStartContentScript.js","start":1,"end":22,"ast_id":null}],"notes":"This script is a content script designed to run at `document_start` on Overleaf pages. Its sole purpose is to inject the `Grammarly-overleafInjectedScript.js` into the main world context of the page, allowing it to interact with the Overleaf editor's JavaScript environment."}
{"file":"src/js/Grammarly-overleafInjectedScript.js","beautified":"src/js/Grammarly-overleafInjectedScript.beautified.js","chunk":{"id":"whole-file","start_line":1,"end_line":21,"same_function_group":null},"findings":{"chrome_apis":[],"event_listeners":["UNSTABLE_editor:extensions","GrammarlyAssistantOverleafScrollEvent"],"messages":[],"storage":[],"endpoints":[],"dom":["document.querySelector"],"dynamic_code":[],"wasm":[],"obfuscation_hints":[],"risks":[]},"evidence":[{"file":"src/js/Grammarly-overleafInjectedScript.js","start":1,"end":21,"ast_id":null}],"notes":"This script is injected into the main world of Overleaf pages to directly interact with its CodeMirror editor instance. It listens for a custom `UNSTABLE_editor:extensions` event to gain access to the CodeMirror `EditorView` and then attaches a listener that, on every editor update, copies the entire document content into a `data-grammarly-text` attribute on the editor's DOM element. It also listens for a `GrammarlyAssistantOverleafScrollEvent` to programmatically scroll the editor."}
{"file":"src/js/Grammarly-popup.js","beautified":"src/js/Grammarly-popup.beautified.js","chunk":{"id":"chunk-1/26","start_line":1,"end_line":2000,"same_function_group":null},"findings":{"chrome_apis":[],"event_listeners":[],"messages":[],"storage":[],"endpoints":[],"dom":[],"dynamic_code":[],"wasm":[],"obfuscation_hints":["webpack_modules","minified_vars"],"risks":[]},"evidence":[{"file":"src/js/Grammarly-popup.js","start":1,"end":2000,"ast_id":null}],"notes":"This chunk contains the initial Webpack bootstrap and a large number of UI and utility modules. Key findings include a custom-built design system with a comprehensive color palette, numerous feature flags and experiment toggles for 'Cheetah' and 'AI Studio', modules for handling quill-delta like structures, and confirmation that the UI is built with React."}
{"file":"src/js/Grammarly-popup.js","beautified":"src/js/Grammarly-popup.beautified.js","chunk":{"id":"chunk-2/26","start_line":2001,"end_line":4000,"same_function_group":null},"findings":{"chrome_apis":[],"event_listeners":[],"messages":[],"storage":[],"endpoints":[],"dom":[],"dynamic_code":[],"wasm":[],"obfuscation_hints":["webpack_modules","minified_vars","api_client_patterns"],"risks":[]},"evidence":[{"file":"src/js/Grammarly-popup.js","start":2001,"end":2180},{"file":"src/js/Grammarly-popup.js","start":2181,"end":2230},{"file":"src/js/Grammarly-popup.js","start":2231,"end":2400},{"file":"src/js/Grammarly-popup.js","start":3201,"end":3400},{"file":"src/js/Grammarly-popup.js","start":3601,"end":3800}],"notes":"This chunk defines a large part of the UI framework, including React components like Dropdown, ErrorBoundary, Ripple, and Typography. It also defines a Tooltip system and a suite of custom React hooks (useElWatcher, useFocusTrap) for advanced DOM interaction and state management, confirming the use of Focal and a CSS-in-JS library."}
{"file":"src/js/Grammarly-popup.js","beautified":"src/js/Grammarly-popup.beautified.js","chunk":{"id":"chunk-3/26","start_line":4001,"end_line":6000,"same_function_group":null},"findings":{"chrome_apis":[],"event_listeners":[],"messages":[],"storage":[],"endpoints":[{"url":"/gates/get","method":"POST","context":"GatesService for feature flagging"},{"url":"/properties","method":"GET/POST","context":"PropertiesClient for user settings"},{"url":"/treatment/get","method":"POST","context":"TreatmentService for A/B testing"},{"url":"/treatment/log","method":"POST","context":"TreatmentService for A/B testing"}],"dom":[],"dynamic_code":[],"wasm":[],"obfuscation_hints":["typescript_generated_async","webpack_modules","api_client_patterns"],"risks":[]},"evidence":[{"file":"src/js/Grammarly-popup.js","start":4060,"end":4080},{"file":"src/js/Grammarly-popup.js","start":4288,"end":4308},{"file":"src/js/Grammarly-popup.js","start":4488,"end":4650},{"file":"src/js/Grammarly-popup.js","start":5701,"end":6000}],"notes":"This chunk defines backend service clients (Gates, Properties, Treatment) for feature flagging and A/B testing, a generic HttpClient, and a large part of the UI design system (colors, typography). It confirms the use of a reactive library (Focal) for state management."}
{"file":"src/js/Grammarly-popup.js","beautified":"src/js/Grammarly-popup.beautified.js","chunk":{"id":"chunk-4/26","start_line":6001,"end_line":8000,"same_function_group":null},"findings":{"chrome_apis":[],"event_listeners":[],"messages":[],"storage":[],"endpoints":[],"dom":[],"dynamic_code":[],"wasm":[],"obfuscation_hints":["webpack_modules","minified_vars","object_property_chaining"],"risks":[]},"evidence":[{"file":"src/js/Grammarly-popup.js","start":6001,"end":7500},{"file":"src/js/Grammarly-popup.js","start":7501,"end":8000}],"notes":"This chunk contains a massive, schema-driven UI content model (likely using io-ts) that defines the structure for all popup content (alerts, cards, buttons). It also defines a comprehensive logging framework with rate-limiting and performance metric collection (TimeSeries, Femetrics)."}
{"file":"src/js/Grammarly-popup.js","beautified":"src/js/Grammarly-popup.beautified.js","chunk":{"id":"chunk-5/26","start_line":8001,"end_line":10000,"same_function_group":null},"findings":{"chrome_apis":[],"event_listeners":[],"messages":[],"storage":[],"endpoints":[],"dom":[],"dynamic_code":[],"wasm":[],"obfuscation_hints":["webpack_modules","minified_vars","typescript_generated_enums"],"risks":[]},"evidence":[{"file":"src/js/Grammarly-popup.js","start":8001,"end":8500},{"file":"src/js/Grammarly-popup.js","start":8501,"end":9000},{"file":"src/js/Grammarly-popup.js","start":9001,"end":10000}],"notes":"This chunk continues the extensive UI content model schema and introduces a sophisticated, custom-built library for UI tree traversal and manipulation (map, filter, reduce, find). It also contains a vast number of enums for component properties like colors, sizes, and states, suggesting a highly structured, data-driven UI system."}
{"file":"src/js/Grammarly-popup.js","beautified":"src/js/Grammarly-popup.beautified.js","chunk":{"id":"chunk-6/26","start_line":10001,"end_line":12000,"same_function_group":null},"findings":{"chrome_apis":[],"event_listeners":[],"messages":[],"storage":[],"endpoints":[],"dom":[],"dynamic_code":[],"wasm":[],"obfuscation_hints":["webpack_modules","minified_vars","api_client_patterns"],"risks":[]},"evidence":[{"file":"src/js/Grammarly-popup.js","start":10001,"end":10250},{"file":"src/js/Grammarly-popup.js","start":10501,"end":10800},{"file":"src/js/Grammarly-popup.js","start":11201,"end":12000}],"notes":"This chunk finalizes the UI tree manipulation library with a root parser, defines a large color map for the design system, and contains a comprehensive registry of feature gates. It also includes clients for analytics (auth hooks, GITM) and settings management logic for major features like HWR, TouchTypist, and Knowledge Hub, along with the core RPC communication classes."}
{"file":"src/js/Grammarly-popup.beautified.js","beautified":"src/js/Grammarly-popup.beautified.js","chunk":{"id":"chunk-7/26","start_line":12001,"end_line":14000,"same_function_group":null},"findings":{"chrome_apis":[],"event_listeners":["scroll","keydown","visibilitychange","click"],"messages":[],"storage":[],"endpoints":[],"dom":[{"action":"observe","selector":"ResizeObserver"},{"action":"observe","selector":"MutationObserver"}],"dynamic_code":[],"wasm":[],"obfuscation_hints":["webpack_modules","minified_vars","generated_apis"],"risks":[]},"evidence":[{"file":"src/js/Grammarly-popup.beautified.js","start":12016,"end":12025,"ast_id":null},{"file":"src/js/Grammarly-popup.beautified.js","start":12534,"end":12540,"ast_id":null},{"file":"src/js/Grammarly-popup.beautified.js","start":13208,"end":13211,"ast_id":null},{"file":"src/js/Grammarly-popup.beautified.js","start":13882,"end":13886,"ast_id":null}],"notes":"This chunk contains the core React UI components for the popup, including a sophisticated positioning and tooltip system. It defines the main application logic, routing between settings, unsupported site, and auth views. State management is handled with RxJS. Contains numerous platform-specific checks for Safari/iOS/Chrome."}
{"file":"src/js/Grammarly-popup.beautified.js","beautified":"src/js/Grammarly-popup.beautified.js","chunk":{"id":"chunk-8/26","start_line":14001,"end_line":16000,"same_function_group":null},"findings":{"chrome_apis":["chrome.runtime.getURL","chrome.runtime.getPlatformInfo"],"event_listeners":[],"messages":[{"name":"tab-connected","direction":"other","payload_keys":[]},{"name":"update-window-size","direction":"other","payload_keys":[]}],"storage":[],"endpoints":[{"url":"https://gateway.grammarly.com/api/jira/tickets/create","method":"POST"}],"dom":[],"dynamic_code":[],"wasm":[],"obfuscation_hints":["webpack_modules","minified_vars","generated_apis"],"risks":[{"type":"pii_exfiltration","severity":"low","description":"A bug reporting feature sends detailed environment and user data (name, email) to an external Jira endpoint."}]},"evidence":[{"file":"src/js/Grammarly-popup.beautified.js","start":14100,"end":14100,"ast_id":null},{"file":"src/js/Grammarly-popup.beautified.js","start":15600,"end":15600,"ast_id":null},{"file":"src/js/Grammarly-popup.beautified.js","start":15304,"end":15304,"ast_id":null}],"notes":"This chunk contains the core initialization and rendering logic for the popup. It defines the main React component that routes between different views (settings, auth, etc.) and the bootstrap function that sets up all services and starts the app. It also includes a detailed debug menu and a bug reporting feature that sends data to a Jira endpoint."}
{"file":"/Users/jfri/Downloads/kbfnbcaeplbcioakkpcpgfkobkghlhen/src/js/Grammarly-popup.js","beautified":"/Users/jfri/Downloads/kbfnbcaeplbcioakkpcpgfkobkghlhen/src/js/Grammarly-popup.beautified.js","chunk":{"id":"chunk-9/26","start_line":16001,"end_line":18000,"same_function_group":null},"findings":{"chrome_apis":["chrome.runtime.getManifest","chrome.runtime.id","chrome.permissions.contains","chrome.permissions.request","chrome.runtime.connect","chrome.runtime.sendMessage"],"event_listeners":["runtime.onMessage","port.onMessage","port.onDisconnect","window.addEventListener"],"messages":[{"name":"message:to-priv","direction":"content->background","purpose":"Generic message passing from content script to background","evidence":[{"file":"/Users/jfri/Downloads/kbfnbcaeplbcioakkpcpgfkobkghlhen/src/js/Grammarly-popup.beautified.js","start":17315,"end":17315}]},{"name":"cs-bg-runtime-*","direction":"background->content","purpose":"Runtime messages from background to content script","evidence":[{"file":"/Users/jfri/Downloads/kbfnbcaeplbcioakkpcpgfkobkghlhen/src/js/Grammarly-popup.beautified.js","start":17408,"end":17408}]}],"storage":[],"endpoints":[{"url":"https://f-log-extension.grammarly.io","purpose":"Logging","evidence":[{"file":"/Users/jfri/Downloads/kbfnbcaeplbcioakkpcpgfkobkghlhen/src/js/Grammarly-popup.beautified.js","start":16318,"end":16318}]},{"url":"https://extension.femetrics.grammarly.io/batch/import","purpose":"Metrics","evidence":[{"file":"/Users/jfri/Downloads/kbfnbcaeplbcioakkpcpgfkobkghlhen/src/js/Grammarly-popup.beautified.js","start":16319,"end":16319}]},{"url":"https://gnar.grammarly.com","purpose":"Analytics","evidence":[{"file":"/Users/jfri/Downloads/kbfnbcaeplbcioakkpcpgfkobkghlhen/src/js/Grammarly-popup.beautified.js","start":16550,"end":16550}]},{"url":"https://in.grammarly.com/v1/events","purpose":"Analytics Ingestion","evidence":[{"file":"/Users/jfri/Downloads/kbfnbcaeplbcioakkpcpgfkobkghlhen/src/js/Grammarly-popup.beautified.js","start":16551,"end":16551}]},{"url":"https://capi.grammarly.com","purpose":"Core API","evidence":[{"file":"/Users/jfri/Downloads/kbfnbcaeplbcioakkpcpgfkobkghlhen/src/js/Grammarly-popup.beautified.js","start":16324,"end":16324}]},{"url":"wss://capi.grammarly.com/freews","purpose":"WebSocket for CAPI","evidence":[{"file":"/Users/jfri/Downloads/kbfnbcaeplbcioakkpcpgfkobkghlhen/src/js/Grammarly-popup.beautified.js","start":16768,"end":16768}]},{"url":"https://api.iterable.com","purpose":"In-app messaging and marketing","evidence":[{"file":"/Users/jfri/Downloads/kbfnbcaeplbcioakkpcpgfkobkghlhen/src/js/Grammarly-popup.beautified.js","start":16325,"end":16325}]},{"url":"https://auth.grammarly.com","purpose":"Authentication","evidence":[{"file":"/Users/jfri/Downloads/kbfnbcaeplbcioakkpcpgfkobkghlhen/src/js/Grammarly-popup.beautified.js","start":16758,"end":16761}]},{"url":"https://gateway.grammarly.com/*","purpose":"Various APIs","evidence":[{"file":"/Users/jfri/Downloads/kbfnbcaeplbcioakkpcpgfkobkghlhen/src/js/Grammarly-popup.beautified.js","start":16753,"end":16753}]},{"url":"https://config.extension.grammarly.com/dynamicConfig.json","purpose":"Remote configuration","evidence":[{"file":"/Users/jfri/Downloads/kbfnbcaeplbcioakkpcpgfkobkghlhen/src/js/Grammarly-popup.beautified.js","start":16800,"end":16800}]},{"url":"https://in-product.report.grammarly.io/v1/report","purpose":"Internal bug reporting","evidence":[{"file":"/Users/jfri/Downloads/kbfnbcaeplbcioakkpcpgfkobkghlhen/src/js/Grammarly-popup.beautified.js","start":16840,"end":16840}]}],"dom":[],"dynamic_code":[],"wasm":[],"obfuscation_hints":["webpack_modules","api_client_patterns"],"risks":[{"type":"remote_code","severity":"low","description":"The extension loads its dynamic configuration, including feature flags and experiment settings, from a remote endpoint. A compromise of this endpoint could alter the extension's behavior.","evidence":[{"file":"/Users/jfri/Downloads/kbfnbcaeplbcioakkpcpgfkobkghlhen/src/js/Grammarly-popup.beautified.js","start":16800,"end":16800}]},{"type":"pii_exfiltration","severity":"low","description":"An internal bug reporting feature sends reports to a Grammarly-controlled endpoint. If triggered by a non-employee, it could send diagnostic data.","evidence":[{"file":"/Users/jfri/Downloads/kbfnbcaeplbcioakkpcpgfkobkghlhen/src/js/Grammarly-popup.beautified.js","start":16840,"end":16840}]}]},"evidence":[{"file":"/Users/jfri/Downloads/kbfnbcaeplbcioakkpcpgfkobkghlhen/src/js/Grammarly-popup.beautified.js","start":16001,"end":18000}],"notes":"This chunk defines the core infrastructure for the extension, including environment-specific API configurations, authentication flows, extensive feature flagging, and inter-script messaging handlers."}
{"file":"/Users/jfri/Downloads/kbfnbcaeplbcioakkpcpgfkobkghlhen/src/js/Grammarly-popup.js","beautified":"/Users/jfri/Downloads/kbfnbcaeplbcioakkpcpgfkobkghlhen/src/js/Grammarly-popup.beautified.js","chunk":{"id":"chunk-10/26","start_line":18001,"end_line":20000,"same_function_group":null},"findings":{"chrome_apis":[],"event_listeners":["navigator.onLine"],"messages":[{"name":"cs-to-bg-rpc-1557421403805","direction":"content->background","purpose":"RPC channel for general API calls","evidence":[{"file":"/Users/jfri/Downloads/kbfnbcaeplbcioakkpcpgfkobkghlhen/src/js/Grammarly-popup.beautified.js","start":18103,"end":18103}]},{"name":"cs-to-bg-rpc-1587687052565","direction":"content->background","purpose":"RPC channel for legacy API calls","evidence":[{"file":"/Users/jfri/Downloads/kbfnbcaeplbcioakkpcpgfkobkghlhen/src/js/Grammarly-popup.beautified.js","start":18089,"end":18089}]},{"name":"cs-to-bg-static-capi-rpc-1668544923207","direction":"content->background","purpose":"RPC channel for static CAPI calls","evidence":[{"file":"/Users/jfri/Downloads/kbfnbcaeplbcioakkpcpgfkobkghlhen/src/js/Grammarly-popup.beautified.js","start":18113,"end":18113}]}],"storage":[{"key":"user","type":"local","purpose":"User session information","evidence":[{"file":"/Users/jfri/Downloads/kbfnbcaeplbcioakkpcpgfkobkghlhen/src/js/Grammarly-popup.beautified.js","start":18078,"end":18078}]},{"key":"extensionSettings","type":"local","purpose":"Stores all user-configurable settings","evidence":[{"file":"/Users/jfri/Downloads/kbfnbcaeplbcioakkpcpgfkobkghlhen/src/js/Grammarly-popup.beautified.js","start":18078,"end":18078}]},{"key":"dynamicConfig","type":"local","purpose":"Caches remotely-fetched feature flags and configuration","evidence":[{"file":"/Users/jfri/Downloads/kbfnbcaeplbcioakkpcpgfkobkghlhen/src/js/Grammarly-popup.beautified.js","start":18078,"end":18078}]},{"key":"activeTab","type":"local","purpose":"Information about the currently active browser tab","evidence":[{"file":"/Users/jfri/Downloads/kbfnbcaeplbcioakkpcpgfkobkghlhen/src/js/Grammarly-popup.beautified.js","start":18078,"end":18078}]}],"endpoints":[],"dom":[],"dynamic_code":[],"wasm":[],"obfuscation_hints":["webpack_modules","api_client_patterns"],"risks":[]},"evidence":[{"file":"/Users/jfri/Downloads/kbfnbcaeplbcioakkpcpgfkobkghlhen/src/js/Grammarly-popup.beautified.js","start":18001,"end":20000}],"notes":"This chunk contains the core infrastructure for state management (PersistentStore), RPC communication between scripts, and numerous action creators for modifying state. It also defines user classification utilities and the main telemetry service."}
{"file":"src/js/Grammarly-popup.js","beautified":"src/js/Grammarly-popup.beautified.js","chunk":{"id":"chunk-11/26","start_line":20001,"end_line":22000,"same_function_group":null},"findings":{"chrome_apis":[],"event_listeners":[],"messages":[],"storage":[],"endpoints":[{"url":"felog","purpose":"Event/error logging"},{"url":"femetrics","purpose":"Frontend metrics"},{"url":"gnar","purpose":"Analytics/tracking"},{"url":"iterable","purpose":"Marketing/IPM"},{"url":"mise","purpose":"Marketing/User engagement"}],"dom":[],"dynamic_code":[],"wasm":[],"obfuscation_hints":["minified_vars","function_chains"],"risks":[{"type":"tracking","severity":"high","description":"A centralized logging service with hundreds of methods captures a vast amount of user interaction data, performance metrics, errors, and feature usage across the entire application. This data is sent to multiple third-party analytics and marketing services."}]},"evidence":[{"file":"src/js/Grammarly-popup.js","start":20001,"end":22000,"ast_id":null}],"notes":"This chunk defines the extension's core Logger service, a massive object responsible for all telemetry, analytics, and error reporting. It logs events from every component (popup, sidePanel, gdocs, etc.) to multiple backends including felog, femetrics, gnar, and iterable. The granularity of logging points to extensive user tracking."}
{"file":"src/js/Grammarly-popup.js","beautified":"src/js/Grammarly-popup.beautified.js","chunk":{"id":"chunk-12/26","start_line":22001,"end_line":24000,"same_function_group":null},"findings":{"chrome_apis":[],"event_listeners":[],"messages":[],"storage":[],"endpoints":[],"dom":[],"dynamic_code":[],"wasm":[],"obfuscation_hints":["minified_vars","webpack_modules"],"risks":[{"type":"other","severity":"low","description":"The extension bundles the DOMPurify library. While this is a strong security measure against XSS, the extension's security is dependent on the specific version and configuration of the embedded library."}],"third_party_libs":["DOMPurify"]},"evidence":[{"file":"src/js/Grammarly-popup.js","start":23200,"end":23900,"ast_id":null}],"notes":"This chunk concludes the large Logger service and notably includes a full, embedded copy of the DOMPurify HTML sanitizer library (module 72314), indicating a focus on preventing XSS vulnerabilities. It also contains utilities for RPC call tracking, performance measurement, and text diffing."}
{"file":"src/js/Grammarly-popup.beautified.js","chunk":{"id":"chunk-13/26","start_line":24001,"end_line":26000,"same_function_group":null},"findings":{"chrome_apis":[],"event_listeners":[],"messages":[],"storage":[],"endpoints":[],"dom":[],"dynamic_code":[],"wasm":[],"obfuscation_hints":["webpack_modules","minified_vars"],"risks":[]},"evidence":[{"file":"src/js/Grammarly-popup.beautified.js","start":24001,"end":26000}],"notes":"This chunk contains the implementation of a text diffing algorithm (likely Diff-Match-Patch) and a large suite of functional programming utilities resembling the fp-ts library, including modules for Array, Either, Option, Eq, and Reader. This indicates a strong reliance on functional patterns for data manipulation and error handling."}
{"file":"src/js/Grammarly-popup.beautified.js","chunk":{"id":"chunk-14/26","start_line":26001,"end_line":28000,"same_function_group":null},"findings":{"chrome_apis":[],"event_listeners":[],"messages":[],"storage":[],"endpoints":[],"dom":[],"dynamic_code":[],"wasm":[],"obfuscation_hints":["webpack_modules","minified_vars"],"risks":[]},"evidence":[{"file":"src/js/Grammarly-popup.beautified.js","start":26001,"end":28000}],"notes":"This chunk contains extensive functional programming utilities for record/object manipulation (fp-ts style ReadonlyRecord) and a powerful runtime validation/decoding library that strongly resembles io-ts. This library is used to safely parse and validate data from untrusted sources, providing strong type guarantees and detailed error reporting."}
{"file":"src/js/Grammarly-popup.beautified.js","chunk":{"id":"chunk-15/26","start_line":28001,"end_line":30000,"same_function_group":null},"findings":{"chrome_apis":[],"event_listeners":[],"messages":[],"storage":[],"endpoints":[],"dom":[],"dynamic_code":[],"wasm":[],"obfuscation_hints":["webpack_modules","minified_vars"],"risks":[]},"evidence":[{"file":"src/js/Grammarly-popup.beautified.js","start":28001,"end":30000}],"notes":"This chunk concludes the io-ts-like validation library and begins the core implementation of react-dom. It includes React's error decoder, extensive DOM property configurations, definitions for all React symbols (e.g., react.element), and the value tracking logic for controlled components."}
{"file":"src/js/Grammarly-popup.beautified.js","beautified":"src/js/Grammarly-popup.beautified.js","chunk":{"id":"chunk-16/26","start_line":30001,"end_line":32000,"same_function_group":"react-dom"},"findings":{"chrome_apis":[],"event_listeners":[],"messages":[],"storage":[],"endpoints":[],"dom":[],"dynamic_code":[],"wasm":[],"obfuscation_hints":["minified_vars","generated_apis"],"risks":[]},"evidence":[{"file":"src/js/Grammarly-popup.beautified.js","start":30001,"end":32000}],"notes":"This chunk continues the implementation of the react-dom library (module 95340). It details the sophisticated synthetic event system, logic for controlled components, the hydration process for attaching to existing HTML, and the core reconciliation (diffing) algorithm. Key internal functions like `gi` (the reconciler) and various event handling and dispatching functions are present."}
{"file":"src/js/Grammarly-popup.beautified.js","beautified":"src/js/Grammarly-popup.beautified.js","chunk":{"id":"chunk-17/26","start_line":32001,"end_line":34000,"same_function_group":"react-dom"},"findings":{"chrome_apis":[],"event_listeners":[],"messages":[],"storage":[],"endpoints":[],"dom":[],"dynamic_code":[],"wasm":[],"obfuscation_hints":["minified_vars","generated_apis"],"risks":[]},"evidence":[{"file":"src/js/Grammarly-popup.beautified.js","start":32001,"end":34000}],"notes":"This chunk contains the core of react-dom's commit phase. It includes the main work loop for walking the finished Fiber tree, applying DOM mutations (updates, insertions, deletions), and invoking component lifecycle methods and hooks (useEffect, useLayoutEffect). It also contains the error handling logic for the render/commit phases and continued implementation of Suspense."}
{"file":"src/js/Grammarly-popup.js","beautified":"src/js/Grammarly-popup.beautified.js","chunk":{"id":"chunk-18/26","start_line":34001,"end_line":36000,"same_function_group":null},"findings":{"chrome_apis":[],"event_listeners":[],"messages":[],"storage":[],"endpoints":[],"dom":[],"dynamic_code":[],"wasm":[],"obfuscation_hints":["minified_vars","webpack_modules"],"risks":[]},"evidence":[{"file":"src/js/Grammarly-popup.js","start":34001,"end":36000}],"notes":"This chunk contains the core of the React scheduler and the main work loop. It includes the main entry points for ReactDOM.render, the fiber reconciliation logic (`beginWork`), the commit logic (`commitRoot`), and the central scheduler loop that drives the entire rendering process. It also contains React's internal error handling for the render phase."}
{"file":"src/js/Grammarly-popup.js","beautified":"src/js/Grammarly-popup.beautified.js","chunk":{"id":"chunk-19/26","start_line":36001,"end_line":38000,"same_function_group":null},"findings":{"chrome_apis":[],"event_listeners":["transitionend","resize","DOMSubtreeModified"],"messages":[],"storage":[],"endpoints":[],"dom":["clientWidth","clientHeight","getComputedStyle","getBBox","querySelectorAll"],"dynamic_code":[],"wasm":[],"obfuscation_hints":["minified_vars","webpack_modules"],"risks":[]},"evidence":[{"file":"src/js/Grammarly-popup.js","start":36001,"end":38000}],"notes":"This chunk contains a comprehensive ResizeObserver polyfill. It uses MutationObserver, transitionend events, and legacy DOM events to detect element size changes. It includes logic for accurately measuring both HTML and SVG elements and uses requestAnimationFrame for performance. The presence of numerous rxjs modules indicates it's a dependency."}
{"file":"src/js/Grammarly-popup.js","beautified":"src/js/Grammarly-popup.beautified.js","chunk":{"id":"chunk-20/26","start_line":38001,"end_line":40000,"same_function_group":null},"findings":{"chrome_apis":[],"event_listeners":[],"messages":[],"storage":[],"endpoints":[],"dom":["document.createElement(\"style\")","document.head.appendChild"],"dynamic_code":[],"wasm":[],"obfuscation_hints":["webpack_modules"],"risks":[{"type":"fingerprinting","severity":"medium","description":"UAParser.js (module 87998) is used to parse the User-Agent string, gathering detailed information about the user's browser, engine, OS, CPU, and device. This can be used for fingerprinting."}]},"evidence":[{"file":"src/js/Grammarly-popup.beautified.js","start":39788,"end":39792},{"file":"src/js/Grammarly-popup.beautified.js","start":39201,"end":39718}]}
{"file":"src/js/Grammarly-popup.js","beautified":"src/js/Grammarly-popup.beautified.js","chunk":{"id":"chunk-21/26","start_line":40001,"end_line":42000,"same_function_group":null},"findings":{"chrome_apis":[],"event_listeners":["scroll","resize","focus","blur","keydown","mouseenter","mouseleave","mousedown","click"],"messages":[],"storage":[],"endpoints":[],"dom":["document.createElement(\"div\")","document.body.appendChild"],"dynamic_code":[],"wasm":[],"obfuscation_hints":["webpack_modules"],"risks":[]},"evidence":[{"file":"src/js/Grammarly-popup.beautified.js","start":41490,"end":41680}]}
{"file":"src/js/Grammarly-popup.js","beautified":"src/js/Grammarly-popup.beautified.js","chunk":{"id":"chunk-22/26","start_line":42001,"end_line":44000,"same_function_group":null},"findings":{"chrome_apis":[],"event_listeners":[],"messages":[],"storage":[],"endpoints":[],"dom":["ownerDocument","getRootNode","parentNode","host","assignedSlot","children","shadowRoot","getClientRects","getBoundingClientRect","matchMedia","getComputedStyle"],"dynamic_code":[],"wasm":[],"obfuscation_hints":["webpack_modules","minified_vars","private_fields"],"risks":[{"type":"fingerprinting","severity":"low","description":"The code contains functions to sniff the user agent, platform, and vendor, which can be used for browser fingerprinting.","evidence":[{"file":"src/js/Grammarly-popup.js","start":42018,"end":42070}]}]},"evidence":[{"file":"src/js/Grammarly-popup.js","start":42001,"end":44000,"ast_id":null}],"notes":"This chunk contains a large part of Grammarly's proprietary UI component library (GDS), including components for layout, typography, buttons, and loaders. It also includes utility libraries for focus management (resembling 'tabbable'), DOM manipulation, accessibility (live announcer), and environment sniffing."}
{"file":"src/js/Grammarly-popup.beautified.js","beautified":"src/js/Grammarly-popup.beautified.js","chunk":{"id":"chunk-23/26","start_line":44001,"end_line":46001,"same_function_group":null},"findings":{"chrome_apis":[],"event_listeners":[],"messages":[],"storage":[],"endpoints":[],"dom":[],"dynamic_code":[],"wasm":[],"obfuscation_hints":["webpack_modules","minified_vars"],"risks":[]},"evidence":[{"file":"src/js/Grammarly-popup.beautified.js","start":44001,"end":46001}],"notes":"This chunk contains a large collection of SVG logo components for brands like Grammarly, Superhuman, and Coda, all part of the Grammarly Design System (GDS). It acts as a brand asset library within the extension."}
{"file":"src/js/Grammarly-popup.beautified.js","beautified":"src/js/Grammarly-popup.beautified.js","chunk":{"id":"chunk-24/26","start_line":46001,"end_line":48001,"same_function_group":null},"findings":{"chrome_apis":[],"event_listeners":["matchMedia.addEventListener"],"messages":[],"storage":[],"endpoints":["https://capi[...]/api/configuration/cheetah/v1/settings","https://goldengate[...]/configuration/cheetah/v1/institution/settings"],"dom":[],"dynamic_code":[],"wasm":[],"obfuscation_hints":["webpack_modules","minified_vars"],"risks":[]},"evidence":[{"file":"src/js/Grammarly-popup.beautified.js","start":46001,"end":48001}],"notes":"This chunk defines API service clients for managing 'Cheetah' (generative AI) settings, along with various GDS UI utilities, React hooks for focus management and accessibility, and a set of interface icons."}
{"file":"/Users/jfri/Downloads/kbfnbcaeplbcioakkpcpgfkobkghlhen/src/js/Grammarly-popup.beautified.js","beautified":"/Users/jfri/Downloads/kbfnbcaeplbcioakkpcpgfkobkghlhen/src/js/Grammarly-popup.beautified.js","chunk":{"id":"chunk-25/26","start_line":48001,"end_line":50000,"same_function_group":null},"findings":{"chrome_apis":[],"event_listeners":["keydown","keyup","pointerdown","mousedown","focus","blur","focusout","focusin","touch","scroll"],"messages":[],"storage":[],"endpoints":[],"dom_sinks":[],"dynamic_code":[],"wasm":[],"obfuscation_hints":["webpack_modules","minified_vars"],"risks":[]},"evidence":[{"file":"/Users/jfri/Downloads/kbfnbcaeplbcioakkpcpgfkobkghlhen/src/js/Grammarly-popup.beautified.js","start":48001,"end":50000}],"notes":"This chunk contains a sophisticated set of low-level UI framework modules, likely based on react-aria, for handling events, focus management, and accessible components. No application-specific logic is present."}
{"file":"/Users/jfri/Downloads/kbfnbcaeplbcioakkpcpgfkobkghlhen/src/js/Grammarly-popup.beautified.js","beautified":"/Users/jfri/Downloads/kbfnbcaeplbcioakkpcpgfkobkghlhen/src/js/Grammarly-popup.beautified.js","chunk":{"id":"chunk-26/26","start_line":50001,"end_line":50282,"same_function_group":null},"findings":{"chrome_apis":["chrome.runtime.connect","chrome.runtime.sendMessage","chrome.runtime.onMessage","chrome.runtime.getURL","chrome.runtime.reload","chrome.runtime.setUninstallURL","chrome.storage.local","chrome.storage.managed","chrome.storage.session","chrome.storage.onChanged","chrome.action","chrome.browserAction","chrome.scripting.executeScript","chrome.tabs.executeScript","chrome.scripting.insertCSS","chrome.tabs.insertCSS","chrome.tabs.create","chrome.tabs.update","chrome.tabs.query","chrome.tabs.reload","chrome.tabs.remove","chrome.tabs.onUpdated","chrome.tabs.onRemoved","chrome.tabs.onActivated","chrome.windows.onFocusChanged","chrome.notifications.create","chrome.notifications.clear","chrome.cookies.get","chrome.cookies.set","chrome.cookies.remove","chrome.cookies.getAll","chrome.cookies.onChanged","chrome.permissions.getAll","chrome.permissions.request","chrome.permissions.contains","chrome.permissions.onAdded","chrome.permissions.onRemoved","chrome.i18n.detectLanguage","chrome.i18n.getUILanguage","chrome.i18n.getAcceptLanguages","chrome.identity","chrome.management.uninstallSelf","chrome.sidePanel.open","chrome.runtime.connectNative","self.indexedDB"],"event_listeners":["chrome.runtime.onMessage","chrome.storage.onChanged","chrome.tabs.onUpdated","chrome.tabs.onRemoved","chrome.tabs.onActivated","chrome.windows.onFocusChanged","chrome.cookies.onChanged","chrome.permissions.onAdded","chrome.permissions.onRemoved","chrome.notifications.onClicked","chrome.notifications.onButtonClicked","chrome.notifications.onClosed"],"messages":[{"name":"CODE_SPLITTING_INJECT","direction":"other","payload_keys":[]}],"storage":["local","managed","session","cookies","indexedDB"],"endpoints":[],"dom_sinks":[],"dynamic_code":[],"wasm":[],"obfuscation_hints":["webpack_bootstrap","facade_pattern"],"risks":[{"type":"high_privilege","severity":"high","description":"This script orchestrates the use of a vast number of powerful Chrome APIs."},{"type":"native_messaging","severity":"high","description":"The use of `connectNative` indicates communication with a native application on the user's machine, which is a high-privilege operation that bypasses the browser sandbox."}]},"evidence":[{"file":"/Users/jfri/Downloads/kbfnbcaeplbcioakkpcpgfkobkghlhen/src/js/Grammarly-popup.beautified.js","start":50001,"end":50282}],"notes":"This final chunk serves as the main entry point for the popup, defining a comprehensive facade around the chrome.* API and bootstrapping the application."}

{
  "metadata": {
    "name": "Grammarly: AI Writing Assistant and Grammar Checker App",
    "version": "14.1259.0",
    "manifest_version": 3,
    "description": "Improve your writing with all-in-one assistanceâ€”including generative AI, grammar check, and more.",
    "evidence": [{"file": "manifest.json", "start": 1, "end": 400}]
  },
  "permissions": {
    "api_permissions": ["scripting", "sidePanel", "tabs", "notifications", "cookies", "identity", "storage"],
    "host_permissions": ["http://*/*", "https://*/*"],
    "optional_permissions": ["nativeMessaging", "clipboardRead"],
    "evidence": [{"file": "manifest.json", "start": 1, "end": 400}]
  },
  "components": {
    "background": {
      "files": ["sw.js"],
      "apis": ["chrome.runtime", "chrome.storage", "chrome.tabs", "chrome.notifications", "chrome.cookies", "chrome.identity"],
      "listeners": ["onInstalled", "onMessage", "onStartup", "onAlarm"],
      "evidence": [{"file": "manifest.json", "start": 1, "end": 400}]
    },
    "content_scripts": [
      {"files": ["src/js/Grammarly-check.js"], "apis": ["chrome.runtime", "chrome.storage"], "listeners": ["onMessage"], "evidence": [{"file": "manifest.json", "start": 1, "end": 400}]},
      {"files": ["src/js/Grammarly-gDocs.js"], "apis": ["chrome.runtime", "chrome.storage", "chrome.tabs"], "listeners": ["onMessage"], "evidence": [{"file": "manifest.json", "start": 1, "end": 400}]},
      {"files": ["src/js/Grammarly-gDocsIframeCs.js"], "apis": ["chrome.runtime"], "listeners": ["onMessage"], "evidence": [{"file": "manifest.json", "start": 1, "end": 400}]}
    ],
    "injected_scripts": [
      {"files": ["src/js/Grammarly-gDocsEarlyInjector.js"], "apis": ["chrome.runtime"], "listeners": [], "evidence": [{"file": "manifest.json", "start": 1, "end": 400}]},
      {"files": ["src/js/Grammarly-overleafStartContentScript.js"], "apis": ["chrome.runtime"], "listeners": [], "evidence": [{"file": "manifest.json", "start": 1, "end": 400}]}
    ],
    "ui": [
      {"files": ["src/popup.html", "src/sidePanel.html"], "apis": [], "listeners": [], "evidence": [{"file": "manifest.json", "start": 1, "end": 400}]}
    ],
    "web_accessible_resources": ["src/fonts/*.woff", "src/fonts/*.woff2", "src/images/*.png", "src/images/*.svg", "src/images/*.jpg", "src/images/*.gif", "src/images/*.webp", "src/js/*.js", "src/css/*.css", "src/icon/toolbar/*.png", "src/icon/toolbar/superhuman_go/*.png", "src/icon/app/*.png", "src/gOS-sandbox.html", "src/inkwell/index.html", "src/inkwell/assets/*.js"],
    "evidence": [{"file": "manifest.json", "start": 1, "end": 400}]
  },
  "network": {
    "endpoints": [
  {
    "url": "https://capi<env>/api/configuration/cheetah/v1/settings",
    "purpose": "Configuration settings API",
    "methods": ["GET", "POST"],
    "headers": [],
    "evidence": [{"file": "src/js/Grammarly-bg.js", "start": 50001, "end": 52000}]
  },
  {
    "url": "https://goldengate<env>/configuration/cheetah/v1/institution/settings",
    "purpose": "Institution configuration settings",
    "methods": ["GET", "POST"],
    "headers": [],
    "evidence": [{"file": "src/js/Grammarly-bg.js", "start": 50001, "end": 52000}]
  },
  {
    "url": "https://gateway.grammarly.com/authorship/v1/",
    "purpose": "Authorship API",
    "methods": ["POST"],
    "headers": [],
    "evidence": [{"file": "src/js/Grammarly-bg.js", "start": 50001, "end": 52000}]
  },
  {
    "url": "https://f-log-inkwell.grammarly.io/batch/log",
    "purpose": "Batch logging endpoint",
    "methods": ["POST"],
    "headers": [],
    "evidence": [{"file": "src/js/Grammarly-bg.js", "start": 54001, "end": 56000}]
  },
  {
    "url": "https://goldengate<env>/knowledge-hub/v1/institution",
    "purpose": "Institution knowledge hub API",
    "methods": ["GET", "POST", "PATCH", "DELETE"],
    "headers": [],
    "evidence": [{"file": "src/js/Grammarly-bg.js", "start": 56001, "end": 58000}]
  },
  {
    "url": "https://goldengate<env>/settings-registry/v1",
    "purpose": "Settings registry API",
    "methods": ["GET", "POST", "PUT", "PATCH", "DELETE"],
    "headers": [],
    "evidence": [{"file": "src/js/Grammarly-bg.js", "start": 56001, "end": 58000}]
  },
  {
    "url": "https://superhuman.com",
    "purpose": "Superhuman integration",
    "methods": ["GET"],
    "headers": [],
    "evidence": [{"file": "src/js/Grammarly-bg.js", "start": 60001, "end": 62000}]
  },
  {
    "url": "https://pp-sh.io",
    "purpose": "Superhuman staging environment",
    "methods": ["GET"],
    "headers": [],
    "evidence": [{"file": "src/js/Grammarly-bg.js", "start": 60001, "end": 62000}]
  },
  {
    "url": "https://staging-superhuman.com",
    "purpose": "Superhuman staging",
    "methods": ["GET"],
    "headers": [],
    "evidence": [{"file": "src/js/Grammarly-bg.js", "start": 60001, "end": 62000}]
  },
  {
    "url": "https://coda.io",
    "purpose": "Coda integration",
    "methods": ["GET"],
    "headers": [],
    "evidence": [{"file": "src/js/Grammarly-bg.js", "start": 62001, "end": 64000}]
  },
  {
    "url": "https://staging.coda.io",
    "purpose": "Coda staging environment",
    "methods": ["GET"],
    "headers": [],
    "evidence": [{"file": "src/js/Grammarly-bg.js", "start": 62001, "end": 64000}]
  },
  {
    "url": "https://head.coda.io",
    "purpose": "Coda head environment",
    "methods": ["GET"],
    "headers": [],
    "evidence": [{"file": "src/js/Grammarly-bg.js", "start": 62001, "end": 64000}]
  },
  {
    "url": "https://dev.coda.io:8080",
    "purpose": "Coda development environment",
    "methods": ["GET"],
    "headers": [],
    "evidence": [{"file": "src/js/Grammarly-bg.js", "start": 62001, "end": 64000}]
  },
  {
    "url": "https://coda.grammarly.com",
    "purpose": "Grammarly Coda integration",
    "methods": ["GET"],
    "headers": [],
    "evidence": [{"file": "src/js/Grammarly-bg.js", "start": 62001, "end": 64000}]
  },
  {
    "url": "https://coda.ppgr.io",
    "purpose": "Coda staging integration",
    "methods": ["GET"],
    "headers": [],
    "evidence": [{"file": "src/js/Grammarly-bg.js", "start": 62001, "end": 64000}]
  },
  {
    "url": "https://coda.qagr.io",
    "purpose": "Coda QA integration",
    "methods": ["GET"],
    "headers": [],
    "evidence": [{"file": "src/js/Grammarly-bg.js", "start": 62001, "end": 64000}]
  },
  {
    "url": "https://coda-local.ppgr.io:8080",
    "purpose": "Coda local development",
    "methods": ["GET"],
    "headers": [],
    "evidence": [{"file": "src/js/Grammarly-bg.js", "start": 62001, "end": 64000}]
  },
  {
    "url": "https://data.${n}",
    "purpose": "Data API endpoint (dynamic domain)",
    "methods": [],
    "headers": [],
    "evidence": [{"file": "src/js/Grammarly-check.js", "start": 2001, "end": 4000}]
  },
  {
    "url": "https://auth.${n}/v3",
    "purpose": "Authentication API v3 (dynamic domain)",
    "methods": [],
    "headers": [],
    "evidence": [{"file": "src/js/Grammarly-check.js", "start": 2001, "end": 4000}]
  },
  {
    "url": "https://auth.${n}/v4",
    "purpose": "Authentication API v4 (dynamic domain)",
    "methods": [],
    "headers": [],
    "evidence": [{"file": "src/js/Grammarly-check.js", "start": 2001, "end": 4000}]
  },
  {
    "url": "https://auth.${n}/v5",
    "purpose": "Authentication API v5 (dynamic domain)",
    "methods": [],
    "headers": [],
    "evidence": [{"file": "src/js/Grammarly-check.js", "start": 2001, "end": 4000}]
  },
  {
    "url": "https://capi.${n}/api/configuration/cheetah/v1/settings",
    "purpose": "Configuration API (dynamic domain)",
    "methods": [],
    "headers": [],
    "evidence": [{"file": "src/js/Grammarly-check.js", "start": 2001, "end": 4000}]
  },
  {
    "url": "https://gateway.${n}/skills",
    "purpose": "Skills API (dynamic domain)",
    "methods": [],
    "headers": [],
    "evidence": [{"file": "src/js/Grammarly-check.js", "start": 2001, "end": 4000}]
  },
  {
    "url": "https://capi.${n}",
    "purpose": "CAPI endpoint (dynamic domain)",
    "methods": [],
    "headers": [],
    "evidence": [{"file": "src/js/Grammarly-check.js", "start": 2001, "end": 4000}]
  },
  {
    "url": "https://coda.${n}",
    "purpose": "Coda integration (dynamic domain)",
    "methods": [],
    "headers": [],
    "evidence": [{"file": "src/js/Grammarly-check.js", "start": 2001, "end": 4000}]
  },
  {
    "url": "wss://capi.${n}/freews",
    "purpose": "WebSocket for free tier (dynamic domain)",
    "methods": [],
    "headers": [],
    "evidence": [{"file": "src/js/Grammarly-check.js", "start": 2001, "end": 4000}]
  },
  {
    "url": "wss://capi.${n}/gdocs",
    "purpose": "WebSocket for Google Docs (dynamic domain)",
    "methods": [],
    "headers": [],
    "evidence": [{"file": "src/js/Grammarly-check.js", "start": 2001, "end": 4000}]
  },
  {
    "url": "https://dox.${n}/documents",
    "purpose": "Documents API (dynamic domain)",
    "methods": [],
    "headers": [],
    "evidence": [{"file": "src/js/Grammarly-check.js", "start": 2001, "end": 4000}]
  },
  {
    "url": "https://gateway.${n}/passport/api/v1/passport",
    "purpose": "Passport API (dynamic domain)",
    "methods": [],
    "headers": [],
    "evidence": [{"file": "src/js/Grammarly-check.js", "start": 2001, "end": 4000}]
  },
  {
    "url": "https://gateway.${n}/snippets/v1/snippets",
    "purpose": "Snippets API (dynamic domain)",
    "methods": [],
    "headers": [],
    "evidence": [{"file": "src/js/Grammarly-check.js", "start": 2001, "end": 4000}]
  },
  {
    "url": "https://gateway.${n}/knowledge-hub/v1/institution",
    "purpose": "Knowledge hub API (dynamic domain)",
    "methods": [],
    "headers": [],
    "evidence": [{"file": "src/js/Grammarly-check.js", "start": 2001, "end": 4000}]
  },
  {
    "url": "https://gateway.${n}/settings-registry/v1",
    "purpose": "Settings registry (dynamic domain)",
    "methods": [],
    "headers": [],
    "evidence": [{"file": "src/js/Grammarly-check.js", "start": 2001, "end": 4000}]
  },
  {
    "url": "https://gateway.${n}/institution/api/institution/admin",
    "purpose": "Institution admin API (dynamic domain)",
    "methods": [],
    "headers": [],
    "evidence": [{"file": "src/js/Grammarly-check.js", "start": 2001, "end": 4000}]
  },
  {
    "url": "https://subscription.${n}/api/v1",
    "purpose": "Subscription API (dynamic domain)",
    "methods": [],
    "headers": [],
    "evidence": [{"file": "src/js/Grammarly-check.js", "start": 2001, "end": 4000}]
  },
  {
    "url": "https://support.${n}/hc/en-us/requests/new#/",
    "purpose": "Support request form (dynamic domain)",
    "methods": [],
    "headers": [],
    "evidence": [{"file": "src/js/Grammarly-check.js", "start": 2001, "end": 4000}]
  },
  {
    "url": "https://in-product.report.grammarly.io/v1/report",
    "purpose": "In-product reporting",
    "methods": [],
    "headers": [],
    "evidence": [{"file": "src/js/Grammarly-check.js", "start": 2001, "end": 4000}]
  },
  {
    "url": "https://superhuman.com/superhuman-go-intro",
    "purpose": "Superhuman Go introduction page",
    "methods": [],
    "headers": [],
    "evidence": [{"file": "src/js/Grammarly-check.js", "start": 2001, "end": 4000}]
  },
  {
    "url": "https://superhuman.com/superhuman-go-intro?genesisLaunch=true",
    "purpose": "Superhuman Go genesis launch page",
    "methods": [],
    "headers": [],
    "evidence": [{"file": "src/js/Grammarly-check.js", "start": 2001, "end": 4000}]
  },
  {
    "url": "https://accounts.google.com",
    "purpose": "Google OAuth authentication",
    "methods": [],
    "headers": [],
    "evidence": [{"file": "src/js/Grammarly-check.js", "start": 2001, "end": 4000}]
  },
  {
    "url": "https://www.facebook.com/login",
    "purpose": "Facebook OAuth authentication",
    "methods": [],
    "headers": [],
    "evidence": [{"file": "src/js/Grammarly-check.js", "start": 2001, "end": 4000}]
  },
  {
    "url": "https://appleid.apple.com/auth",
    "purpose": "Apple ID OAuth authentication",
    "methods": [],
    "headers": [],
    "evidence": [{"file": "src/js/Grammarly-check.js", "start": 2001, "end": 4000}]
  },
  {
    "url": "https://auth.grammarly.com/v4/api/oauth2/token",
    "purpose": "OAuth2 token endpoint",
    "methods": ["POST"],
    "headers": [],
    "evidence": [{"file": "src/js/Grammarly-check.js", "start": 12001, "end": 14000}]
  },
  {
    "url": "https://auth.grammarly.com/v4/api/userinfo",
    "purpose": "User information endpoint",
    "methods": ["POST"],
    "headers": [],
    "evidence": [{"file": "src/js/Grammarly-check.js", "start": 12001, "end": 14000}]
  },
  {
    "url": "https://auth.grammarly.com/v4/api/oauth2/authorize",
    "purpose": "OAuth2 authorization endpoint",
    "methods": ["GET"],
    "headers": [],
    "evidence": [{"file": "src/js/Grammarly-gDocs.js", "start": 102001, "end": 104000}]
  },
  {
    "url": "https://auth.grammarly.com/v4/api/oauth2/token",
    "purpose": "OAuth2 token endpoint",
    "methods": ["POST"],
    "headers": [],
    "evidence": [{"file": "src/js/Grammarly-gDocs.js", "start": 102001, "end": 104000}]
  },
  {
    "url": "https://auth.grammarly.com/v4/api/oauth2/exchange",
    "purpose": "OAuth2 token exchange",
    "methods": ["POST"],
    "headers": [],
    "evidence": [{"file": "src/js/Grammarly-gDocs.js", "start": 102001, "end": 104000}]
  },
  {
    "url": "https://auth.grammarly.com/v4/api/revoke-by-refresh-token",
    "purpose": "Revoke refresh token",
    "methods": ["POST"],
    "headers": [],
    "evidence": [{"file": "src/js/Grammarly-gDocs.js", "start": 102001, "end": 104000}]
  },
  {
    "url": "https://auth.grammarly.com/v4/api/userinfo",
    "purpose": "User information endpoint",
    "methods": ["POST"],
    "headers": [],
    "evidence": [{"file": "src/js/Grammarly-gDocs.js", "start": 102001, "end": 104000}]
  }
]
  },
  "messaging": {
    "channels": [
  {
    "name": "external:changed-plan",
    "direction": "other",
    "payload_schema": {},
    "evidence": [{"file": "src/js/Grammarly-bg.js", "start": 60001, "end": 62000}]
  },
  {
    "name": "message:to-priv",
    "direction": "content->background",
    "payload_schema": {
      "type": "string",
      "callid": "string",
      "content": "any"
    },
    "evidence": [{"file": "src/js/Grammarly-check.js", "start": 12001, "end": 14000}]
  },
  {
    "name": "message-bus-port",
    "direction": "content->background",
    "payload_schema": {
      "type": "string",
      "callid": "string",
      "content": "any"
    },
    "evidence": [{"file": "src/js/Grammarly-check.js", "start": 12001, "end": 14000}]
  },
  {
    "name": "cs-bg-runtime-<extId>",
    "direction": "background->content",
    "payload_schema": {
      "data": "any"
    },
    "evidence": [{"file": "src/js/Grammarly-check.js", "start": 12001, "end": 14000}]
  },
  {
    "name": "cs-to-bg-rpc-1557421403805",
    "direction": "content->background",
    "payload_schema": {
      "tracking/RPC": "any",
      "sendFelogEvent": "any",
      "sendToFemetrics": "any"
    },
    "evidence": [{"file": "src/js/Grammarly-gDocsEarlyInjector.js", "start": 1, "end": 2000}]
  }
]
  },
  "storage": {
    "keys": [
  {
    "key": "assistantOnboarding_*",
    "type": "local",
    "purpose": "Assistant onboarding state",
    "retention": "",
    "evidence": [{"file": "src/js/Grammarly-bg.js", "start": 50001, "end": 52000}]
  },
  {
    "key": "user",
    "type": "local",
    "purpose": "User profile and settings",
    "retention": "",
    "evidence": [{"file": "src/js/Grammarly-bg.js", "start": 60001, "end": 62000}]
  },
  {
    "key": "extensionSettings",
    "type": "local",
    "purpose": "Extension configuration",
    "retention": "",
    "evidence": [{"file": "src/js/Grammarly-bg.js", "start": 60001, "end": 62000}]
  },
  {
    "key": "duration_service_availability_metrics_db_v1",
    "type": "indexeddb",
    "purpose": "Service availability metrics",
    "retention": "",
    "evidence": [{"file": "src/js/Grammarly-bg.js", "start": 56001, "end": 58000}]
  },
  {
    "key": "blocklistConfigMetadata",
    "type": "local",
    "purpose": "Store blocklist config metadata",
    "retention": "",
    "evidence": [{"file": "src/js/Grammarly-bg.js", "start": 80001, "end": 82000}]
  },
  {
    "key": "oauth.tokens",
    "type": "session",
    "purpose": "OAuth token storage",
    "retention": "",
    "evidence": [{"file": "src/js/Grammarly-check.js", "start": 12001, "end": 14000}]
  },
  {
    "key": "extensionDictionaryEvent",
    "type": "local",
    "purpose": "Dictionary event tracking",
    "retention": "",
    "evidence": [{"file": "src/js/Grammarly-check.js", "start": 12001, "end": 14000}]
  },
  {
    "key": "oauth.tokens",
    "type": "session",
    "purpose": "OAuth token storage",
    "retention": "",
    "evidence": [{"file": "src/js/Grammarly-check.js", "start": 14001, "end": 14264}]
  },
  {
    "key": "extensionDictionaryEvent",
    "type": "local",
    "purpose": "Dictionary event tracking",
    "retention": "",
    "evidence": [{"file": "src/js/Grammarly-check.js", "start": 14001, "end": 14264}]
  },
  {
    "key": "gdocs_peak_collabs_dismissed",
    "type": "local",
    "purpose": "UI state for Google Docs",
    "retention": "",
    "evidence": [{"file": "src/js/Grammarly.js", "start": 40001, "end": 42000}]
  },
  {
    "key": "gr-oauth-key",
    "type": "local",
    "purpose": "OAuth token storage",
    "retention": "",
    "evidence": [{"file": "src/js/Grammarly-gDocs.js", "start": 102001, "end": 104000}]
  },
  {
    "key": "oauth.tokens",
    "type": "local",
    "purpose": "OAuth token storage",
    "retention": "",
    "evidence": [{"file": "src/js/Grammarly-gDocs.js", "start": 102001, "end": 104000}]
  }
]
  },
  "workflows": [
    {
      "name": "User Interaction Workflow",
      "triggers": ["UI interaction (popup, side panel)", "content script activation"],
      "steps": ["UI requests extension state from background", "background and content scripts communicate via chrome.runtime messaging", "content scripts and background read/write storage keys", "background and content scripts call remote endpoints"],
      "apis": ["chrome.runtime", "chrome.storage"],
      "messages": ["background", "content-script"],
      "endpoints": ["https://f-log-inkwell.grammarly.io"],
      "storage_keys": ["sessionId", "userId", "settings"],
      "evidence": [{"file": "src/js/Grammarly-bg.beautified.js", "start": 46001, "end": 48000}]
    }
  ],
  "privacy": {
    "data_categories": ["sessionId", "userId", "settings", "document highlights", "feedback", "alert states", "telemetry events"],
    "purposes": ["session tracking", "user identification", "settings storage", "telemetry aggregation", "document feedback"],
    "minimization": "Only necessary data for extension operation is stored; telemetry is opt-in and privacy-gated.",
    "consent": "User consent is required for telemetry and sensitive data processing.",
    "retention": "Session data is retained for the session; userId and settings are persistent.",
    "third_parties": [
      {"name": "Iterable", "purpose": "In-app messaging and telemetry", "evidence": [{"file": "src/js/Grammarly-bg.beautified.js", "start": 74001, "end": 76000}]},
      {"name": "Databricks", "purpose": "Metrics reporting", "evidence": [{"file": "src/js/Grammarly-bg.beautified.js", "start": 78001, "end": 80000}]},
      {"name": "Amazon S3", "purpose": "File upload", "evidence": [{"file": "src/js/Grammarly-bg.beautified.js", "start": 78001, "end": 80000}]}
    ],
    "policy_compliance": "Complies with Chrome Web Store privacy requirements, GDPR, and CCPA.",
    "evidence": [{"file": "manifest.json", "start": 1, "end": 400}]
  },
  "risks": [
    {"type": "tracking", "severity": "medium", "justification": "SessionId and userId enable persistent tracking; must be protected from unauthorized access.", "evidence": [{"file": "src/js/Grammarly-bg.beautified.js", "start": 48001, "end": 50000}]},
    {"type": "pii_exfiltration", "severity": "medium", "justification": "Telemetry endpoints aggregate user actions and document context; risk of behavioral profiling.", "evidence": [{"file": "src/js/Grammarly-gDocs.beautified.js", "start": 10001, "end": 12000}]},
    {"type": "insecure_storage", "severity": "medium", "justification": "Settings and userId must be validated and sanitized to prevent leakage.", "evidence": [{"file": "src/js/Grammarly-gDocs.beautified.js", "start": 20001, "end": 22000}]},
    {"type": "excessive_permissions", "severity": "low", "justification": "Extension requests broad host permissions and optional nativeMessaging/clipboardRead.", "evidence": [{"file": "manifest.json", "start": 1, "end": 400}]}
  ],
  "code_signals": {
    "chrome_api_calls": ["chrome.runtime", "chrome.storage", "chrome.tabs", "chrome.notifications", "chrome.cookies", "chrome.identity"],
    "event_listeners": ["onInstalled", "onMessage", "onStartup", "onAlarm"],
    "dynamic_code": [],
    "wasm_modules": [],
    "third_party_libs": ["UAParser", "TypeStyle", "core-js", "RxJS", "React"]
  }
}

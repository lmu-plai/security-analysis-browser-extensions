{"file":"h0.js","beautified":"h0.beautified.js","chunk":{"id":"chunk-1/73","start_line":1,"end_line":2000,"same_function_group":null},"findings":{"chrome_apis":[],"event_listeners":[],"messages":[],"storage":[],"endpoints":[],"dom":[],"dynamic_code":[],"wasm":[],"obfuscation_hints":["webpack_modules","minified_vars"],"risks":[]},"evidence":[{"file":"h0.js","start":1,"end":2000,"ast_id":null}],"notes":"Webpack module loader and bootstrap code. This is a common way to organize and bundle JavaScript code, but also a form of obfuscation."}
{"file":"h0.js","beautified":"h0.beautified.js","chunk":{"id":"chunk-2/73","start_line":2001,"end_line":4000,"same_function_group":null},"findings":{"chrome_apis":[],"event_listeners":[],"messages":[],"storage":[],"endpoints":[{"url":"https://www.dsw.com/api/v1/coupons/claim","method":"POST"},{"url":"https://www.dsw.com/api/v1/cart/details","method":"GET"},{"url":"https://cdn.joinhoney.com/dummy-store/api/","method":"GET"},{"url":"https://www.expedia.com/Checkout/applyCoupon","method":"POST"},{"url":"https://www.expedia.com/Checkout/removeCoupon","method":"POST"},{"url":"https://www.fitflop.com/us/en/cart/coupon","method":"POST"},{"url":"https://www.fitflop.com/us/en/cart/coupon","method":"DELETE"},{"url":"https://www.forever21.com/on/demandware.store/Sites-forever21-Site/en_US/Cart-AddCoupon","method":"POST"},{"url":"https://www.forever21.com/on/demandware.store/Sites-forever21-Site/en_US/Cart-RemoveCouponLineItem","method":"GET"},{"url":"https://secure-www.gap.com/shopping-bag-xapi/apply-bag-promo/","method":"POST"},{"url":"https://www2.hm.com/en_ca/checkout/redeemVoucher","method":"POST"},{"url":"https://www2.hm.com/en_ca/checkout/releaseVoucher","method":"GET"},{"url":"https://www.hammacher.com/shoppingcart/applypromocode","method":"POST"},{"url":"https://www.homedepot.com/mcc-checkout/v2/promo/add","method":"POST"},{"url":"https://www.homedepot.com/mcc-checkout/v2/promo/delete/","method":"POST"},{"url":"https://order-api.jcpenney.com/order-api/v1/accounts/{ACCOUNT_ID}/draft-order/adjustment/discounts","method":"POST"},{"url":"https://order-api.jcpenney.com/order-api/v1/accounts/{ACCOUNT_ID}/draft-order","method":"GET"},{"url":"https://order-api.jcpenney.com/order-api/v1/accounts/{ACCOUNT_ID}/draft-order/adjustment/discounts/{ADJUSTMENT_ID}","method":"DELETE"},{"url":"https://www.jcrew.com/checkout-api/graphql","method":"POST"},{"url":"https://www.kohls.com/cnc/applyCoupons","method":"POST"},{"url":"https://www.loft.com/cws/cart/claimCoupon.jsp","method":"POST"},{"url":"https://www.loft.com/cws/cart/removeCoupon.jsp","method":"POST"},{"url":"https://www.macys.com/my-bag/{BAGGUID}/promo","method":"PUT"},{"url":"https://www.officedepot.com/async/cart/getCartInfo.do","method":"GET"},{"url":"https://www.officedepot.com/async/cart/addCoupon.do","method":"POST"},{"url":"https://www.officedepot.com/async/cart/removeCoupon.do","method":"POST"},{"url":"https://secure-oldnavy.gap.com/shopping-bag-xapi/apply-bag-promo/","method":"POST"},{"url":"https://www.orbitz.com/Checkout/applyCoupon","method":"POST"},{"url":"https://www.orbitz.com/Checkout/removeCoupon","method":"POST"},{"url":"https://www.papajohns.com/order/validate-promo","method":"GET"},{"url":"https://www.papajohns.com/order/apply-promo/","method":"GET"},{"url":"https://www.papajohns.com/order/view-cart","method":"GET"},{"url":"https://www.prettylittlething.fr/pltmobile/coupon/couponPost/","method":"POST"},{"url":"https://checkout.prettylittlething.fr/checkout-api/coupon/set","method":"POST"},{"url":"https://checkout.prettylittlething.fr/checkout-api/coupon","method":"POST"},{"url":"https://www.prettylittlething.com/pltmobile/coupon/couponPost/","method":"POST"},{"url":"https://checkout.prettylittlething.com/checkout-api/coupon/set","method":"POST"},{"url":"https://checkout.prettylittlething.com/checkout-api/coupon","method":"POST"},{"url":"https://www.puritan.com/shoppingcart/applyCoupon","method":"POST"},{"url":"https://www.saksfifthavenue.com/cart-coupon-add","method":"GET"},{"url":"https://www.sephora.com/api/shopping-cart/basket/promotions","method":"POST"},{"url":"https://www.sephora.com/api/shopping-cart/baskets/current/promotions","method":"DELETE"},{"url":"https://{shopify_domain}/wallets/unstable/checkouts/{checkout_token}.json","method":"PATCH"},{"url":"https://www.shutterstock.com/papi/orders/{orderId}","method":"PATCH"},{"url":"https://www.shutterstock.com/papi/orders/{orderId}","method":"GET"}],"dom":[],"dynamic_code":[],"wasm":[],"obfuscation_hints":["webpack_modules","minified_vars","object_property_chaining"],"risks":[{"type":"tracking","severity":"medium","description":"Sends user coupon application attempts to various retailers."},{"type":"pii_exfiltration","severity":"low","description":"Some scripts may use session or account identifiers from cookies in network requests."}]},"evidence":[{"file":"h0.js","start":2001,"end":4000}],"notes":"This chunk contains numerous DAC (Direct Apply Coupon) modules for various retailers. These modules define the logic for automatically applying coupons by making AJAX requests to retailer-specific API endpoints. They contain hardcoded URLs and logic for parsing responses and updating the UI."}
{"file":"h0.js","beautified":"h0.beautified.js","chunk":{"id":"chunk-3/73","start_line":4001,"end_line":6000,"same_function_group":null},"findings":{"chrome_apis":[],"event_listeners":[],"messages":[],"storage":[],"endpoints":[{"url":"https://www.staples.com/cc/api/checkout/default/coupon","method":"POST"},{"url":"https://tjmaxx.tjx.com/store/checkout/cart.jsp","method":"POST"},{"url":"https://www.vitacost.com/Checkout/ShoppingCart.aspx","method":"POST"},{"url":"https://www.wish.com/api/promo-code/apply","method":"POST"},{"url":"https://www.worldmarket.com/on/demandware.store/Sites-World_Market-Site/en_US/Cart-ApplyCoupon","method":"GET"},{"url":"https://www.worldmarket.com/on/demandware.store/Sites-World_Market-Site/en_US/Cart-RemoveCouponLineItem","method":"GET"},{"url":"https://v.joinhoney.com/recipe/stores/{E}","method":"GET"}],"dom":[],"dynamic_code":[],"wasm":[],"obfuscation_hints":["webpack_modules","minified_vars","object_property_chaining"],"risks":[{"type":"tracking","severity":"medium","description":"Continues to send user coupon application attempts to various retailers."}]},"evidence":[{"file":"h0.js","start":4001,"end":6000}],"notes":"This chunk contains more DAC modules for retailers (Staples, TJ Maxx, Wish, etc.). It also includes core framework code, including an `IntegrationRunner` for executing store-specific scripts ('VIMs' or 'recipes') and a 'mixin' system (`interpretMixin`) for abstracting web page interactions like clicks and form submissions. An endpoint to fetch recipes from `v.joinhoney.com` is identified."}
{"file":"h0.js","beautified":"h0.beautified.js","chunk":{"id":"chunk-4/73","start_line":6001,"end_line":8000,"same_function_group":null},"findings":{"chrome_apis":[],"event_listeners":[],"messages":[],"storage":["localStorage","sessionStorage"],"endpoints":[],"dom":[],"dynamic_code":["eval"],"wasm":[],"obfuscation_hints":["webpack_modules","minified_vars","object_property_chaining"],"risks":[]},"evidence":[{"file":"h0.js","start":6001,"end":8000}],"notes":"This chunk contains the implementation of the JavaScript interpreter that runs the VIM/recipe scripts. It defines a `we` class (likely 'WebExtension' or similar) that acts as a sandboxed JS environment. It includes methods for creating scopes, handling primitives and objects, getting/setting properties, and throwing exceptions. It also polyfills or provides sandboxed versions of many standard browser APIs like `console`, `JSON`, `Math`, `localStorage`, `sessionStorage`, `setTimeout`, `clearTimeout`, `request`, and various text and URL utilities. The presence of `eval` (or a custom implementation of it) is central to its operation."}
{"file":"h0.js","beautified":"h0.beautified.js","chunk":{"id":"chunk-5/73","start_line":8001,"end_line":10000,"same_function_group":null},"findings":{"chrome_apis":[],"event_listeners":[],"messages":[],"storage":[],"endpoints":[],"dom":[],"dynamic_code":[],"wasm":[],"obfuscation_hints":["minified_vars","webpack_modules"],"risks":[{"type":"remote_code","severity":"high","description":"This chunk continues the implementation of a custom JavaScript interpreter that executes remotely fetched code. It includes sandboxed versions of standard JavaScript objects (Array, Boolean, Date, Error, Function, Number, Object, RegExp, String, Symbol) to control the execution environment."}]},"evidence":[{"file":"h0.js","start":8001,"end":10000}],"notes":"This chunk contains sandboxed implementations of standard JavaScript built-in objects (Array, Boolean, Date, Error, etc.) for the custom interpreter. This is a core part of the remote code execution sandbox."}
{"file":"h0.js","beautified":"h0.beautified.js","chunk":{"id":"chunk-6/73","start_line":10001,"end_line":12000,"same_function_group":null},"findings":{"chrome_apis":[],"event_listeners":[],"messages":[],"storage":[],"endpoints":[],"dom":[],"dynamic_code":[],"wasm":[],"obfuscation_hints":["minified_vars","webpack_modules"],"risks":[]},"evidence":[{"file":"h0.js","start":10001,"end":12000}],"notes":"This chunk contains a bundled version of the Cheerio library, a server-side implementation of jQuery. This suggests the service worker performs complex HTML parsing and manipulation, likely on content fetched from web pages."}
{"file":"h0.js","beautified":"h0.beautified.js","chunk":{"id":"chunk-7/73","start_line":12001,"end_line":14000,"same_function_group":null},"findings":{"chrome_apis":[],"event_listeners":[],"messages":[],"storage":[],"endpoints":[],"dom":[],"dynamic_code":[],"wasm":[],"obfuscation_hints":["webpack_modules"],"risks":[{"type":"other","severity":"low","description":"Bundled CryptoJS library suggests client-side cryptographic operations. The purpose is unclear but could range from securing data to fingerprinting."}],"third_party_libs":["CryptoJS"]},"evidence":[{"file":"h0.js","start":12001,"end":14000}],"notes":"Discovered a bundled version of the CryptoJS library. This includes a comprehensive suite of cryptographic functions: MD5, SHA-1/2/3, AES, DES, Rabbit, RC4, PBKDF2, and various block cipher modes and padding schemes. This indicates the extension performs client-side cryptography."}
{"file":"h0.js","beautified":"h0.beautified.js","chunk":{"id":"chunk-8/73","start_line":14001,"end_line":16000,"same_function_group":null},"findings":{"chrome_apis":[],"event_listeners":[],"messages":[],"storage":[],"endpoints":[],"dom":[],"dynamic_code":[],"wasm":[],"obfuscation_hints":["webpack_modules"],"risks":[],"third_party_libs":["css-select","domhandler","dom-serializer","domelementtype","htmlparser2"]},"evidence":[{"file":"h0.js","start":14001,"end":16000}],"notes":"This chunk contains bundled versions of 'css-select', 'domhandler', 'dom-serializer', 'domelementtype', and parts of 'htmlparser2'. These libraries provide CSS selector querying and DOM manipulation capabilities, and are likely dependencies of the Cheerio library found in a previous chunk. This confirms the service worker's ability to perform complex HTML parsing and querying."}
{"file":"h0.js","beautified":"h0.beautified.js","chunk":{"id":"chunk-9/73","start_line":16001,"end_line":18000,"same_function_group":null},"findings":{"chrome_apis":[],"event_listeners":[],"messages":[],"storage":[],"endpoints":[],"dom":[],"dynamic_code":[],"wasm":[],"obfuscation_hints":["webpack_modules"],"risks":[]},"evidence":[{"file":"h0.js","start":16001,"end":18000}],"notes":"This chunk contains a bundled version of the 'parse5' HTML parsing library. It includes the main Parser class, OpenElementsStack, ActiveFormattingElementsList, and various helper modules for tokenization and error handling. This confirms the extension's capability to perform complex, spec-compliant HTML parsing from strings within the service worker."}
{"file":"h0.js","beautified":"h0.beautified.js","chunk":{"id":"chunk-10/73","start_line":18001,"end_line":20000,"same_function_group":null},"findings":{"chrome_apis":[],"event_listeners":[],"messages":[],"storage":[],"endpoints":[],"dom":[],"dynamic_code":[],"wasm":[],"obfuscation_hints":["webpack_modules"],"risks":[]},"evidence":[{"file":"h0.js","start":18001,"end":20000}],"notes":"This chunk continues the bundled 'parse5' library. It includes the core Tokenizer class, which contains the entire HTML state machine for converting a string into tokens. It also includes the Serializer class for converting a parsed AST back into an HTML string. This confirms the extension has a complete, round-trip HTML processing capability."}
{"file":"h0.js","beautified":"h0.beautified.js","chunk":{"id":"chunk-11/73","start_line":20001,"end_line":22000,"same_function_group":null},"findings":{"chrome_apis":[],"event_listeners":[],"messages":[],"storage":["localStorage","chrome.storage"],"endpoints":[{"url":"https://cdn.honey.io/experiments/extension-experiment.json","purpose":"Fetches A/B testing and feature flag configurations"},{"url":"https://history.paypal.com/targeting/set-plugin?src=honey","purpose":"Sends a periodic heartbeat for tracking"}],"dom":[],"dynamic_code":[],"wasm":[],"obfuscation_hints":["webpack_modules","minified_vars","api_client_patterns"],"risks":[{"type":"tracking","severity":"low","description":"Sends a periodic heartbeat to history.paypal.com, which could be used for user activity tracking."},{"type":"remote_code","severity":"medium","description":"The extension uses a remote A/B testing framework to dynamically alter its behavior based on configurations fetched from a CDN. This allows for remote control over features."}]},"evidence":[{"file":"h0.js","start":20001,"end":22000}],"notes":"This chunk contains bundled libraries: Superagent (HTTP client), uuid (UUID generation), semver (version comparison), and a comprehensive A/B testing/feature flagging framework. It fetches experiment configs from cdn.honey.io and sends a heartbeat to history.paypal.com."}
{"file":"h0.js","beautified":"h0.beautified.js","chunk":{"id":"chunk-12/73","start_line":22001,"end_line":24000,"same_function_group":null},"findings":{"chrome_apis":["chrome.storage"],"event_listeners":[],"messages":[],"storage":["localStorage","chrome.storage"],"endpoints":[{"url":"https://cdn.honey.io/images/findsavings/coiny-dash-config.json","purpose":"Fetches configuration for a feature named 'coiny-dash'."},{"url":"https://cdn.honey.io/standdown-rules.json","purpose":"Fetches rules for the 'stand down' mechanism, which dynamically disables the extension on certain sites."},{"url":"https://s.joinhoney.com/evs","purpose":"Endpoint for sending batched analytics/event data."},{"url":"https://s.joinhoney.com/ext_obs","purpose":"Endpoint for sending product observation analytics."},{"url":"https://s.joinhoney.com/pr","purpose":"Another endpoint for sending product-related analytics."},{"url":"https://o.honey.io/store/","purpose":"Base URL for constructing affiliate tagging links."}],"dom":[],"dynamic_code":[],"wasm":[],"obfuscation_hints":["webpack_modules","minified_vars","api_client_patterns"],"risks":[{"type":"tracking","severity":"medium","description":"A comprehensive analytics dispatcher sends batched event data, including product observations and exceptions, to s.joinhoney.com. It also has a heartbeat to PayPal servers."},{"type":"remote_code","severity":"high","description":"The 'stand down' framework fetches rules from a remote CDN to dynamically disable the extension. This, combined with the VIM parser for executing remote scripts, represents a significant remote control capability over the extension's behavior."}]},"evidence":[{"file":"h0.js","start":22001,"end":24000}],"notes":"This chunk contains a rich set of core functionalities: a 'stand down' framework for dynamically disabling the extension, a comprehensive analytics dispatcher (sdata), the affiliate tagging engine, a store data repository, and a custom parser ('VIM') for securely executing remote scripts."}
{"file":"h0.js","beautified":"h0.beautified.js","chunk":{"id":"chunk-13/73","start_line":24001,"end_line":26000,"same_function_group":null},"findings":{"chrome_apis":[],"event_listeners":[],"messages":[],"storage":[],"endpoints":[],"dom":[],"dynamic_code":[],"wasm":[],"obfuscation_hints":["library_bundling","webpack_modules"],"risks":[{"type":"other","severity":"low","description":"Bundles older, cryptographically weak algorithms like MD5 and RC4, which could be risky if used for sensitive data."}]},"evidence":[{"file":"h0.beautified.js","start":24001,"end":26000}],"notes":"This chunk is entirely composed of the bundled CryptoJS library. It includes implementations for a vast array of cryptographic algorithms: AES, Blowfish, Rabbit, RC4, MD5, SHA1, SHA256, SHA3, SHA512, RIPEMD160. It also includes various cipher modes (CBC, CFB, CTR, ECB, OFB), padding schemes (Pkcs7, AnsiX923), and key derivation functions (EvpKDF, PBKDF2). This confirms the extension has a comprehensive crypto suite at its disposal."}
{"file":"h0.js","beautified":"h0.beautified.js","chunk":{"id":"chunk-14/73","start_line":26001,"end_line":28000,"same_function_group":null},"findings":{"chrome_apis":[],"event_listeners":[],"messages":[],"storage":[],"endpoints":[],"dom":[],"dynamic_code":["acorn"],"wasm":[],"obfuscation_hints":["webpack_modules"],"risks":[{"type":"other","severity":"low","description":"Bundles a full JavaScript parser (acorn), which allows for powerful runtime analysis of other scripts."}]},"evidence":[{"file":"h0.js","start":26001,"end":28000}],"notes":"This chunk continues the bundled libraries. It includes the end of the CryptoJS bundle (DES, TripleDES), the 'debug' library, 'json-stable-stringify', 'regenerator-runtime', and most notably, the 'acorn' JavaScript parser."}
{"file":"h0.js","beautified":"h0.beautified.js","chunk":{"id":"chunk-15/73","start_line":28001,"end_line":30000,"same_function_group":null},"findings":{"chrome_apis":[],"event_listeners":[],"messages":[],"storage":[],"endpoints":[],"dom":[],"dynamic_code":[],"wasm":[],"obfuscation_hints":["webpack_modules"],"risks":[]},"evidence":[{"file":"h0.js","start":28001,"end":30000}],"notes":"This chunk contains the remainder of the 'acorn' JavaScript parser and the beginning of a large, bundled utility library, likely Underscore.js or Lodash, providing numerous helper functions for data manipulation."}
{"file":"h0.js","beautified":"h0.beautified.js","chunk":{"id":"chunk-16/73","start_line":30001,"end_line":32000,"same_function_group":null},"findings":{"chrome_apis":[],"event_listeners":[],"messages":[],"storage":[],"endpoints":[],"dom":[],"dynamic_code":[],"wasm":[],"obfuscation_hints":["minified_vars","function_chains"],"risks":[{"type":"other","severity":"low","description":"Contains a large registry and the minified source code for numerous VIM automation recipes (e.g., addProductsToCart, cartProductPageFetcher, checkoutInfo, pageDetector) that are dynamically executed. This represents a significant pre-packaged capability to interact with e-commerce sites."}]},"evidence":[{"file":"h0.js","start":30987,"end":32000,"ast_id":null}],"notes":"This chunk contains the source code for many core VIM automation recipes, stored as minified strings within the 'ot' object. It also includes the 'Ke' object, which acts as a central registry for these recipes, mapping names like 'addProductsToCart' to their templates and parameters. This confirms the extension ships with a large, pre-compiled library of automation scripts."}
{"file":"h0.js","beautified":"h0.beautified.js","chunk":{"id":"chunk-17/73","start_line":32001,"end_line":34000,"same_function_group":null},"findings":{"chrome_apis":[],"event_listeners":[],"messages":[],"storage":[],"endpoints":[],"dom":[],"dynamic_code":[],"wasm":[],"obfuscation_hints":["minified_vars","webpack_modules","function_chains"],"risks":[]},"evidence":[{"file":"h0.js","start":32001,"end":33800,"ast_id":null},{"file":"h0.js","start":33801,"end":34000,"ast_id":null}],"notes":"This chunk contains two main components: a large, bundled utility library resembling Underscore.js/Lodash, and the 'VimGenerator' module. The VimGenerator is responsible for orchestrating the VIM automation system by preparing parameters and generating the final executable script from templates. The end of the chunk also marks the beginning of the bundled Sentry SDK for error reporting."}
{"file":"h0.js","beautified":"h0.beautified.js","chunk":{"id":"chunk-18/73","start_line":34001,"end_line":36000,"same_function_group":null},"findings":{"chrome_apis":[],"event_listeners":[],"messages":[],"storage":[],"endpoints":[],"dom":[],"dynamic_code":[],"wasm":[],"obfuscation_hints":["webpack_modules"],"risks":[],"third_party_libraries":["Sentry SDK"]},"evidence":[{"file":"h0.js","start":34001,"end":36000}],"notes":"This chunk contains a large part of the bundled Sentry SDK, responsible for error reporting and performance monitoring. Key functionalities include data normalization, envelope creation, instrumentation of browser APIs (console, DOM events, fetch, XHR), a full performance tracing (APM) implementation with spans and transactions, sampling logic, and the core Sentry client for processing and sending events."}
{"file":"h0.js","beautified":"h0.beautified.js","chunk":{"id":"chunk-19/73","start_line":36001,"end_line":38000,"same_function_group":null},"findings":{"chrome_apis":[],"event_listeners":[],"messages":[],"storage":[],"endpoints":[],"dom":[],"dynamic_code":[],"wasm":[],"obfuscation_hints":["webpack_modules"],"risks":[],"third_party_libraries":["Sentry SDK", "rrweb"]},"evidence":[{"file":"h0.js","start":36001,"end":38000}],"notes":"This chunk continues the Sentry SDK bundle and then transitions into a large, bundled version of the 'rrweb' library. 'rrweb' is a powerful open-source tool for 'session replay,' which records all user interactions and DOM changes and can replay them like a video. This is a significant finding, indicating the extension has the capability to record and visually reproduce user sessions."}
{"file":"h0.js","beautified":"h0.beautified.js","chunk":{"id":"chunk-20/73","start_line":38001,"end_line":40000,"same_function_group":null},"findings":{"chrome_apis":[],"event_listeners":[],"messages":[],"storage":[],"endpoints":[],"dom":[],"dynamic_code":[],"wasm":[],"obfuscation_hints":["webpack_modules"],"risks":[],"third_party_libraries":["rrweb"]},"evidence":[{"file":"h0.js","start":38001,"end":40000}],"notes":"This chunk is a continuation of the bundled 'rrweb' session replay library. It contains the core logic for observing and recording DOM mutations, user interactions (mouse movements, clicks, scrolls, inputs), and other browser events. Key components include the 'MutationObserver' setup, event listeners for various interactions, and the logic for processing and emitting these events in a serializable format. The code also includes advanced features like Shadow DOM traversal, iframe management, and stylesheet tracking."}
{"file":"h0.js","beautified":"h0.beautified.js","chunk":{"id":"chunk-21/73","start_line":40001,"end_line":42000,"same_function_group":null},"findings":{"chrome_apis":[],"event_listeners":[],"messages":[],"storage":["sessionStorage"],"endpoints":[],"dom":[],"dynamic_code":["new Worker(URL.createObjectURL(new Blob([ua])))"],"wasm":[],"obfuscation_hints":["webpack_modules","minified_vars"],"risks":[{"type":"pii_exfiltration","severity":"high","description":"The code contains a full implementation of Sentry Replay, which records user sessions, including DOM content and user interactions. While there are privacy controls, the capability to capture sensitive information is present."}],"third_party_libraries":["pako","Sentry Replay"]},"evidence":[{"file":"h0.js","start":40001,"end":42000}],"notes":"This chunk contains a bundled version of the 'pako' (zlib) compression library and the core of Sentry's Session Replay functionality. It details the entire lifecycle of a replay, including session management with sampling and expiration, a Web Worker for data compression, extensive privacy controls for masking and blocking content, and deep integration with Sentry's error and performance monitoring. It captures performance metrics, breadcrumbs, and network requests as part of the replay."}
{"file":"h0.js","beautified":"h0.beautified.js","chunk":{"id":"chunk-22/73","start_line":42001,"end_line":44000,"same_function_group":null},"findings":{"chrome_apis":[],"event_listeners":["visibilitychange","blur","focus","keydown","click"],"messages":[],"storage":[],"endpoints":[],"dom":[],"dynamic_code":[],"wasm":[],"obfuscation_hints":["webpack_modules","minified_vars"],"risks":[],"third_party_libraries":["Sentry Tracing","Sentry Browser Profiling"]},"evidence":[{"file":"h0.js","start":42001,"end":44000}],"notes":"This chunk contains the Sentry Browser Tracing and Profiling integrations. The BrowserTracing integration automatically instruments page loads, navigations, and resource loads (fetch/XHR) to create performance traces. It also captures Web Vitals (LCP, FID, CLS) and Long Tasks. The BrowserProfiling integration adds CPU profiling capabilities, capturing detailed function call stacks to identify performance bottlenecks in JavaScript execution. It uses the experimental `window.Profiler` API."}
{"file":"h0.js","beautified":"h0.beautified.js","chunk":{"id":"chunk-23/73","start_line":44001,"end_line":46000,"same_function_group":null},"findings":{"chrome_apis":[],"event_listeners":[],"messages":[],"storage":[],"endpoints":[],"dom":[],"dynamic_code":[],"wasm":[],"obfuscation_hints":["webpack_modules","minified_vars"],"risks":[],"third_party_libs":["accounting.js","base64-js","bluebird"]},"evidence":[{"file":"h0.js","start":44001,"end":46000}],"notes":"This chunk contains the end of the Sentry SDK's utility functions and the beginning of bundled third-party libraries. Key findings include: Sentry helper modules for object normalization, promise polyfills, and high-resolution timing. Bundled libraries identified are 'accounting.js' for number/currency formatting, 'base64-js' for Base64 encoding, and the start of the 'bluebird' promise library."}
{"file":"h0.js","beautified":"h0.beautified.js","chunk":{"id":"chunk-24/73","start_line":46001,"end_line":48000,"same_function_group":"bluebird"},"findings":{"chrome_apis":[],"event_listeners":[],"messages":[],"storage":[],"endpoints":[],"dom":[],"dynamic_code":[],"wasm":[],"obfuscation_hints":["webpack_modules","minified_vars"],"risks":[],"third_party_libs":["bluebird"]},"evidence":[{"file":"h0.js","start":46001,"end":48000}],"notes":"This chunk is a continuation of the bundled 'bluebird' promise library (v3.7.2). It contains the core promise implementation, including methods like .then(), .catch(), .finally(), .all(), .race(), .map(), .reduce(), and the robust error handling and debuggability features Bluebird is known for, such as long stack traces and cancellation."}
{"file":"h0.js","beautified":"h0.beautified.js","chunk":{"id":"chunk-25/73","start_line":48001,"end_line":50000,"same_function_group":null},"findings":{"chrome_apis":[],"event_listeners":[],"messages":[],"storage":[],"endpoints":[],"dom":[],"dynamic_code":[],"wasm":[],"obfuscation_hints":["webpack_modules"],"risks":[],"libraries":["buffer","crypto-js"]},"evidence":[{"file":"h0.js","start":48002,"end":49985,"ast_id":null}],"notes":"This chunk contains a polyfill for the Node.js 'buffer' module and a large part of the CryptoJS library. The buffer polyfill provides methods for handling binary data. The CryptoJS library includes algorithms for encryption (AES), hashing (MD5, SHA1, SHA256, etc.), and key derivation (PBKDF2)."}
{"file":"h0.js","beautified":"h0.beautified.js","chunk":{"id":"chunk-26/73","start_line":50001,"end_line":52000,"same_function_group":null},"findings":{"chrome_apis":[],"event_listeners":[],"messages":[],"storage":[],"endpoints":[],"dom":[],"dynamic_code":[],"wasm":[],"obfuscation_hints":["webpack_modules"],"risks":[],"libraries":["crypto-js","debug","dayjs","css-what"]},"evidence":[{"file":"h0.js","start":50002,"end":51999,"ast_id":null}],"notes":"This chunk continues the CryptoJS library, including DES and TripleDES ciphers. It also contains the 'debug' utility for namespaced logging, localization files for 'day.js' (de, fr), and the 'css-what' library for parsing CSS selectors."}
{"file":"h0.js","beautified":"h0.beautified.js","chunk":{"id":"chunk-27/73","start_line":52001,"end_line":54000,"same_function_group":null},"findings":{"chrome_apis":[],"event_listeners":[],"messages":[],"storage":[],"endpoints":[],"dom":[],"dynamic_code":[],"wasm":[],"obfuscation_hints":["webpack_modules"],"risks":[]},"evidence":[],"notes":"This chunk contains the source code for the `dom-serializer`, `domhandler`, and `domutils` libraries, which are part of the `htmlparser2` ecosystem. It also includes the `entities` library for HTML/XML entity encoding and decoding. These are likely used by Cheerio for HTML parsing and manipulation."}
{"file":"h0.js","beautified":"h0.beautified.js","chunk":{"id":"chunk-28/73","start_line":54001,"end_line":56000,"same_function_group":null},"findings":{"chrome_apis":[],"event_listeners":[],"messages":[],"storage":[],"endpoints":[],"dom":[],"dynamic_code":[],"wasm":[],"obfuscation_hints":["webpack_modules"],"risks":[]},"evidence":[],"notes":"This chunk contains the continuation of the `entities` library, providing comprehensive HTML entity encoding and decoding. It also includes the source for `fast-json-stable-stringify` for consistent JSON serialization, `eventemitter3` for event handling, and `node-htmlencode`."}
{"file":"h0.js","beautified":"h0.beautified.js","chunk":{"id":"chunk-29/73","start_line":56001,"end_line":58000,"same_function_group":null},"findings":{"chrome_apis":[],"event_listeners":[],"messages":[],"storage":[],"endpoints":[],"dom":[],"dynamic_code":[],"wasm":[],"obfuscation_hints":["webpack_modules"],"risks":[]},"evidence":[{"file":"h0.beautified.js","start":56001,"end":58000}],"notes":"This chunk contains the source code for the 'htmlparser2' library, a fast and forgiving HTML/XML parser. It includes the main Parser and Tokenizer classes. The end of the chunk contains the start of the jQuery library."}
{"file":"h0.js","beautified":"h0.beautified.js","chunk":{"id":"chunk-30/73","start_line":58001,"end_line":60000,"same_function_group":null},"findings":{"chrome_apis":[],"event_listeners":[],"messages":[],"storage":[],"endpoints":[],"dom":[],"dynamic_code":[],"wasm":[],"obfuscation_hints":["webpack_modules"],"risks":[]},"evidence":[{"file":"h0.beautified.js","start":58001,"end":60000}],"notes":"This chunk continues the source code for the jQuery library, version 3.7.1. It includes modules for event handling, DOM manipulation (show, hide, toggle), and the beginning of the CSS and animation modules."}
{"file":"h0.js","beautified":"h0.beautified.js","chunk":{"id":"chunk-31/73","start_line":60001,"end_line":62000,"same_function_group":null},"findings":{"chrome_apis":[],"event_listeners":[],"messages":[],"storage":[],"endpoints":[],"dom":[],"dynamic_code":[],"wasm":[],"obfuscation_hints":["webpack_modules"],"risks":[]},"third_party_libs":[{"name":"Lodash","version":"~4.17.21","evidence":[{"file":"h0.beautified.js","start":60100,"end":62000}]},{"name":"custom JSON parser/stringifier","evidence":[{"file":"h0.beautified.js","start":60001,"end":60100}]}],"notes":"This chunk contains the end of a custom JSON parser and the beginning of a large, bundled version of the Lodash utility library. The presence of Lodash indicates heavy use of utility functions for data manipulation throughout the extension."}
{"file":"h0.js","beautified":"h0.beautified.js","chunk":{"id":"chunk-32/73","start_line":62001,"end_line":64000,"same_function_group":null},"findings":{"chrome_apis":[],"event_listeners":[],"messages":[],"storage":[],"endpoints":[],"dom":[],"dynamic_code":[],"wasm":[],"obfuscation_hints":["webpack_modules"],"risks":[]},"third_party_libs":[{"name":"Lodash","version":"~4.17.21","evidence":[{"file":"h0.beautified.js","start":62001,"end":64000}]}],"notes":"This chunk is a continuation of the bundled Lodash library. It contains core components like internal cache implementations (ListCache, MapCache, SetCache), the deep cloning logic, and numerous type-checking and utility functions."}
{"file":"h0.js","beautified":"h0.beautified.js","chunk":{"id":"chunk-33/73","start_line":64001,"end_line":66000,"same_function_group":null},"findings":{"chrome_apis":[],"event_listeners":[],"messages":[],"storage":[],"endpoints":[],"dom":[],"dynamic_code":[],"wasm":[],"obfuscation_hints":["webpack_modules"],"risks":[]},"evidence":[{"file":"h0.js","start":64001,"end":66000}],"notes":"This chunk contains the end of the Lodash library (v4.17.21), including the setup for chaining and method aliases. It is followed by several other bundled libraries: `long.js` for 64-bit integers, an MD5 hashing implementation, the `ms` time conversion utility, `node-cache` for in-memory caching, and an `nth-check` CSS selector parser."}
{"file":"h0.js","beautified":"h0.beautified.js","chunk":{"id":"chunk-34/73","start_line":66001,"end_line":68000,"same_function_group":null},"findings":{"chrome_apis":[],"event_listeners":[],"messages":[],"storage":[],"endpoints":[],"dom":[],"dynamic_code":[],"wasm":[],"obfuscation_hints":["webpack_modules"],"risks":[]},"evidence":[],"notes":"This chunk contains several bundled npm packages: 'object-inspect' (or similar), 'object-keys' polyfill, 'is-arguments', 'opossum' (a circuit breaker library), 'psl' (Public Suffix List for domain parsing), 'srcset' (for parsing image source sets), and the core of 'PostCSS' (a CSS parser)."}
{"file":"h0.js","beautified":"h0.beautified.js","chunk":{"id":"chunk-35/73","start_line":68001,"end_line":70000,"same_function_group":null},"findings":{"chrome_apis":[],"event_listeners":[],"messages":[],"storage":[],"endpoints":[],"dom":[],"dynamic_code":[],"wasm":[],"obfuscation_hints":["webpack_modules"],"risks":[]},"evidence":[],"notes":"This chunk contains the rest of the PostCSS library, a full CSS parser and transformer. It also includes 'regexp-tree' and 'regexp-dfa' for advanced regular expression parsing and execution, suggesting complex pattern matching capabilities."}
{"file":"h0.js","beautified":"h0.beautified.js","chunk":{"id":"chunk-36/73","start_line":70001,"end_line":72000,"same_function_group":null},"findings":{"chrome_apis":[],"event_listeners":[],"messages":[],"storage":[],"endpoints":[],"dom":[],"dynamic_code":[],"wasm":[],"obfuscation_hints":["webpack_modules"],"risks":[]},"evidence":[{"file":"/Users/jfri/private/affiliateDetector/honey-versions/honey-17.1.1-bmnlcjabgnpnenekpadlanbbkooimhnj/h0.beautified.js","start":70001,"end":72000}],"notes":"This chunk contains the core parser and a large suite of optimizer plugins for the 'regexp-tree' library. This provides the extension with the ability to parse, analyze, and rewrite regular expressions. Key modules include the main parser (91196), the optimizer entry point (42945), and numerous transformation plugins for merging, deduplicating, and simplifying regex patterns (e.g., 93600, 8970, 50187)."}
{"file":"h0.js","beautified":"h0.beautified.js","chunk":{"id":"chunk-37/73","start_line":72001,"end_line":74000,"same_function_group":null},"findings":{"chrome_apis":[],"event_listeners":[],"messages":[],"storage":[],"endpoints":[],"dom":[],"dynamic_code":[],"wasm":[],"obfuscation_hints":["webpack_modules"],"risks":[]},"evidence":[{"file":"/Users/jfri/private/affiliateDetector/honey-versions/honey-17.1.1-bmnlcjabgnpnenekpadlanbbkooimhnj/h0.beautified.js","start":72001,"end":74000}],"notes":"This chunk contains the rest of the 'regexp-tree' parser implementation from module 91196. It includes the large, generated parser state tables and lexer rules. It also includes module 42312, which defines a 'Path' class for AST traversal and manipulation, similar to Babel's NodePath."}
{"file":"h0.js","beautified":"h0.beautified.js","chunk":{"id":"chunk-38/73","start_line":74001,"end_line":76000,"same_function_group":null},"findings":{"chrome_apis":[],"event_listeners":[],"messages":[],"storage":[],"endpoints":[],"dom":[],"dynamic_code":[],"wasm":[],"obfuscation_hints":["webpack_modules"],"risks":[{"type":"security","severity":"low","description":"Contains a ReDoS (Regular Expression Denial of Service) vulnerability scanner (modules 95907, 91014) to analyze regex patterns. This is a defensive feature."}],"libraries":["regexp-tree","semver","lru-cache"]},"evidence":[{"file":"/Users/jfri/private/affiliateDetector/honey-versions/honey-17.1.1-bmnlcjabgnpnenekpadlanbbkooimhnj/h0.beautified.js","start":74380,"end":74507,"ast_id":"module-34146"},{"file":"/Users/jfri/private/affiliateDetector/honey-versions/honey-17.1.1-bmnlcjabgnpnenekpadlanbbkooimhnj/h0.beautified.js","start":75138,"end":75248,"ast_id":"module-95907"},{"file":"/Users/jfri/private/affiliateDetector/honey-versions/honey-17.1.1-bmnlcjabgnpnenekpadlanbbkooimhnj/h0.beautified.js","start":75595,"end":76977,"ast_id":"semver-modules"}],"notes":"This chunk contains the core of the 'regexp-tree' library, including its main entry point (34146), traversal engine (91927), and transformation utilities (80315, 82843). It also includes a ReDoS (Regular Expression Denial of Service) vulnerability scanner (95907, 91014) and a full 'semver' implementation for version string manipulation."}
{"file":"h0.js","beautified":"h0.beautified.js","chunk":{"id":"chunk-39/73","start_line":76001,"end_line":78000,"same_function_group":null},"findings":{"chrome_apis":[],"event_listeners":[],"messages":[],"storage":[],"endpoints":[],"dom":[],"dynamic_code":[],"wasm":[],"obfuscation_hints":["webpack_modules"],"risks":[],"libraries":["semver","url","punycode","qs","tslib"]},"evidence":[{"file":"/Users/jfri/private/affiliateDetector/honey-versions/honey-17.1.1-bmnlcjabgnpnenekpadlanbbkooimhnj/h0.beautified.js","start":76001,"end":77040,"ast_id":"semver-modules-continued"},{"file":"/Users/jfri/private/affiliateDetector/honey-versions/honey-17.1.1-bmnlcjabgnpnenekpadlanbbkooimhnj/h0.beautified.js","start":77933,"end":78532,"ast_id":"url-modules"},{"file":"/Users/jfri/private/affiliateDetector/honey-versions/honey-17.1.1-bmnlcjabgnpnenekpadlanbbkooimhnj/h0.beautified.js","start":78533,"end":78988,"ast_id":"punycode-module"},{"file":"/Users/jfri/private/affiliateDetector/honey-versions/honey-17.1.1-bmnlcjabgnpnenekpadlanbbkooimhnj/h0.beautified.js","start":78989,"end":79780,"ast_id":"qs-modules"},{"file":"/Users/jfri/private/affiliateDetector/honey-versions/honey-17.1.1-bmnlcjabgnpnenekpadlanbbkooimhnj/h0.beautified.js","start":77699,"end":77932,"ast_id":"tslib-module"}],"notes":"This chunk continues the bundled libraries from the previous one. It contains the remainder of the 'semver' library, a full 'url' parsing and formatting library (including 'punycode' for international domain names and 'qs' for query string manipulation), and the 'tslib' helpers for TypeScript."}
{"file":"h0.js","beautified":"h0.beautified.js","chunk":{"id":"chunk-40/73","start_line":78001,"end_line":80000,"same_function_group":null},"findings":{"chrome_apis":["chrome.runtime.onConnect","chrome.webRequest.onErrorOccurred"],"event_listeners":[{"event":"chrome.runtime.onConnect","handler":"(e) => { if ('adbbp:cs' !== e.name) ... }","evidence":[{"file":"h0.beautified.js","start":79201,"end":79209}]},{"event":"chrome.webRequest.onErrorOccurred","handler":"S (function S(e))","evidence":[{"file":"h0.beautified.js","start":79999,"end":80003}]},{"event":"acorns:action","handler":"(e, t) => { ... }","evidence":[{"file":"h0.beautified.js","start":78969,"end":78973}]},{"event":"adbBp:action","handler":"(t, r) => { ... }","evidence":[{"file":"h0.beautified.js","start":79981,"end":79981}]}],"messages":[{"name":"acorns:action","direction":"unknown","payload_keys":["storeId","type"],"evidence":[{"file":"h0.beautified.js","start":78969,"end":78973}]},{"name":"adbbp:cs","direction":"content->background","evidence":[{"file":"h0.beautified.js","start":79201,"end":79201}]},{"name":"adbBp:action","direction":"unknown","payload_keys":["action"],"evidence":[{"file":"h0.beautified.js","start":79981,"end":79981}]}],"storage":[{"key":"bg-acorns","type":"local","purpose":"Cache for dynamically fetched 'acorn' modules.","evidence":[{"file":"h0.beautified.js","start":78557,"end":78557}]},{"key":"adbBp:activeContexts","type":"local","purpose":"Stores active ad-block-bypass communication contexts.","evidence":[{"file":"h0.beautified.js","start":79257,"end":79257}]},{"key":"bg-adb-tabs","type":"local","purpose":"Cache for ad-blocker related tab state.","evidence":[{"file":"h0.beautified.js","start":79710,"end":79710}]}],"endpoints":[{"url":"https://d.joinhoney.com/v2/stores/modules/list","method":"GET","purpose":"Fetch list of available 'acorn' modules.","evidence":[{"file":"h0.beautified.js","start":78570,"end":78570}]},{"url":"https://d.joinhoney.com/v2/stores/module/:type/:storeId","method":"GET","purpose":"Fetch a specific 'acorn' module.","evidence":[{"file":"h0.beautified.js","start":78593,"end":78595}]}],"dynamic_code":[{"type":"atob","evidence":[{"file":"h0.beautified.js","start":78600,"end":78600}]}],"obfuscation_hints":["regenerator-runtime"],"risks":[{"type":"tracking","severity":"medium","description":"Detects ad blockers by monitoring failed requests to known tracking/affiliate domains and sends an analytics event ('ext200201') to report the presence of an ad blocker.","evidence":[{"file":"h0.beautified.js","start":79858,"end":79979}]}]},"evidence":[{"file":"h0.beautified.js","start":78001,"end":80000}],"notes":"This chunk contains a dynamic module loader ('acorns') and a sophisticated ad-block detection/bypass system. The 'acorns' system fetches and caches store-specific, base64-encoded modules from a remote server. The ad-block bypass system listens for failed web requests to affiliate/tracking domains (e.g., cj.com, doubleclick.net) and reports ad blocker presence via analytics. It also communicates with a content script over a port named 'adbbp:cs'."}
{"file":"h0.js","beautified":"h0.beautified.js","chunk":{"id":"chunk-41/73","start_line":80001,"end_line":82000,"same_function_group":null},"findings":{"chrome_apis":["chrome.alarms.onAlarm.addListener","chrome.alarms.clear","chrome.alarms.create","chrome.alarms.get","chrome.webRequest.onBeforeRedirect"],"event_listeners":[{"event":"utils:action","handler":"(e, t) => { ... }","evidence":[{"file":"h0.beautified.js","start":80101,"end":80101}]},{"event":"page:load","handler":"(e, t, r) => { ... }","evidence":[{"file":"h0.beautified.js","start":81486,"end":81486}]},{"event":"affManager:tag","handler":"(t, r) => { ... }","evidence":[{"file":"h0.beautified.js","start":80068,"end":80068}]}],"messages":[{"name":"utils:action","direction":"unknown","payload_keys":["action","data"],"evidence":[{"file":"h0.beautified.js","start":80101,"end":80101}]},{"name":"affManager:tag","direction":"unknown","payload_keys":["storeId","tabId","type","targetUrl","options"],"evidence":[{"file":"h0.beautified.js","start":80068,"end":80068}]}],"storage":[{"key":"checkoutStoresRawConfig","type":"local","purpose":"Caches raw configuration for stores supporting Honey's checkout features.","evidence":[{"file":"h0.beautified.js","start":81880,"end":81880}]}],"endpoints":[{"url":"https://cdn-checkout.joinhoney.com/honey-checkout/stores.json","method":"GET","purpose":"Fetches configuration for stores that support Honey's checkout features.","evidence":[{"file":"h0.beautified.js","start":81900,"end":81900}]}],"obfuscation_hints":["regenerator-runtime","custom_regex_polyfill"],"risks":[]},"evidence":[{"file":"h0.beautified.js","start":80001,"end":82000}],"notes":"This chunk contains several modules wrapping Chrome APIs and managing extension features. Key modules include an affiliate manager that handles offer activation and tagging, a browser action controller for the toolbar icon, a wrapper for the chrome.alarms API, and a configuration loader for Honey's checkout feature. It also includes a custom polyfill for RegExp named groups."}
{"file":"h0.js","beautified":"h0.beautified.js","chunk":{"id":"chunk-42/73","start_line":82001,"end_line":84000,"same_function_group":null},"findings":{"chrome_apis":["chrome.cookies.set","chrome.cookies.get","chrome.cookies.remove","chrome.cookies.getAll","chrome.tabs.executeScript"],"event_listeners":[{"event":"honey-checkout","handler":"(t, r) => { ... }","evidence":[{"file":"h0.beautified.js","start":83586,"end":83586}]}],"messages":[{"name":"honey-checkout","direction":"iframe->background","payload_keys":["action","data"],"evidence":[{"file":"h0.beautified.js","start":83586,"end":83586}]}],"storage":[{"key":"checkoutDevToolsEnabled","type":"local","purpose":"Flag to enable developer tools for the checkout feature.","evidence":[{"file":"h0.beautified.js","start":83200,"end":83200}]},{"key":"checkoutIFrameOriginUrl","type":"local","purpose":"Stores the URL for the checkout iframe, potentially overridden for development.","evidence":[{"file":"h0.beautified.js","start":83200,"end":83200}]},{"key":"checkoutStoreConfigOverwrites","type":"local","purpose":"Developer overrides for store configurations related to checkout.","evidence":[{"file":"h0.beautified.js","start":83200,"end":83200}]}],"endpoints":[{"url":"https://cdn-checkout.joinhoney.com/honey-checkout/version_config.json","method":"GET","purpose":"Fetches a configuration file to determine the correct version of the checkout app to use.","evidence":[{"file":"h0.beautified.js","start":83030,"end":83030}]},{"url":"https://cdn-checkout-staging.joinhoney.com/honey-checkout/branches/branches.json","method":"GET","purpose":"Fetches available development branches for the checkout feature.","evidence":[{"file":"h0.beautified.js","start":83700,"end":83700}]}],"obfuscation_hints":["regenerator-runtime"],"risks":[]},"evidence":[{"file":"h0.beautified.js","start":82001,"end":84000}],"notes":"This chunk is heavily focused on the 'Honey Checkout' feature. It includes logic for fetching checkout configurations, versioning, and handling communication from the checkout iframe. A central message listener for 'honey-checkout' handles a wide range of actions, including GraphQL queries, fetching data, and managing settings. It also contains a complete wrapper for the chrome.cookies API."}
{"file":"h0.js","beautified":"h0.beautified.js","chunk":{"id":"chunk-43/73","start_line":84001,"end_line":86000,"same_function_group":null},"findings":{"chrome_apis":["chrome.cookies.remove","chrome.cookies.getAll","chrome.cookies.set","chrome.runtime.onMessage","chrome.runtime.onInstalled","chrome.runtime.setUninstallURL","chrome.tabs.get"],"event_listeners":["runtime.onMessage.addListener","runtime.onInstalled.addListener"],"messages":[{"name":"cookies:cs","direction":"content->background","payload_keys":["type","url","name","value","domain","path","secure","httpOnly","expirationDate","storeId"],"purpose":"Provides a cookie management service to content scripts."},{"name":"device:heart","direction":"other","payload_keys":["action","data"],"purpose":"Triggers device heartbeat events."},{"name":"device:action","direction":"other","payload_keys":["action","data","key","value","options"],"purpose":"Acts as a router for various device-related actions like getting IDs or settings."}],"storage":[{"key":"device:deviceId","type":"local","op":"get/set","purpose":"Stores the unique device identifier."},{"key":"user:device-id","type":"local","op":"get","purpose":"Legacy key for the unique device identifier."},{"key":"device:lastHeartbeat","type":"local","op":"get","purpose":"Timestamp of the last activity heartbeat."},{"key":"device:firstTime","type":"local","op":"get/set/del","purpose":"Flag for first-time installation."},{"key":"device:firstTimeFS","type":"local","op":"get/set/del","purpose":"Flag for first-time use of a feature (FS)."},{"key":"device:firstTimeHG","type":"local","op":"get/set/del","purpose":"Flag for first-time use of a feature (HG)."},{"key":"device:firstTimeFSHG","type":"local","op":"get/set/del","purpose":"Flag for first-time use of a feature (FSHG)."},{"key":"device:firstTimeLaunchpad","type":"local","op":"get/set/del","purpose":"Flag for first-time use of the Launchpad feature."},{"key":"device:pendingInstallReport","type":"local","op":"get/set/del","purpose":"Stores install report data if the initial send fails, for retry."},{"key":"device:pendingUpdateReport","type":"local","op":"get/set/del","purpose":"Stores update report data if the initial send fails, for retry."}],"endpoints":[{"url":"https://d.joinhoney.com/extusers/install","method":"POST","purpose":"Reports new extension installations."}],"dynamic_code":[],"wasm":[],"obfuscation_hints":["minified_vars","function_chains"],"risks":[]},"evidence":[{"file":"h0.beautified.js","start":84068,"end":84120,"ast_id":null,"note":"onMessage listener for 'cookies:cs'"},{"file":"h0.beautified.js","start":84800,"end":84850,"ast_id":null,"note":"Dormant user check and heartbeat event ext000004"},{"file":"h0.beautified.js","start":85008,"end":85180,"ast_id":null,"note":"onMessage listener for 'device:action' router"},{"file":"h0.beautified.js","start":85480,"end":85650,"ast_id":null,"note":"Device ID retrieval logic from storage and cookies"},{"file":"h0.beautified.js","start":85468,"end":85472,"ast_id":null,"note":"Definition of honeyExtDeviceId cookie properties"},{"file":"h0.beautified.js","start":85900,"end":85950,"ast_id":null,"note":"onInstalled listener for handling install/update events"},{"file":"h0.beautified.js","start":85800,"end":85880,"ast_id":null,"note":"POST request to report new installations"}]}
{"file":"h0.js","beautified":"h0.beautified.js","chunk":{"id":"chunk-44/73","start_line":86001,"end_line":88000,"same_function_group":null},"findings":{"chrome_apis":["chrome.alarms.create","chrome.alarms.addListener"],"event_listeners":["page:load","alarms.onAlarm"],"messages":[{"name":"user:session:started","direction":"background->all","payload_keys":["sessionId"],"purpose":"Notifies other parts of the extension that a new user session has begun."}],"storage":[{"key":"device:settings","type":"local","op":"get/set","purpose":"Stores a general-purpose object for various device-level settings."},{"key":"ssd:ckalive","type":"session","op":"get/set","purpose":"Caches the result of the 'ck/alive' blocklist check."},{"key":"ssd:rules","type":"session","op":"get/set","purpose":"Caches the downloaded SSD ruleset from the CDN."},{"key":"ssd:lastBuild","type":"session","op":"get/set","purpose":"Timestamp of the last time the SSD parameters were calculated."},{"key":"ssd:lastParameters","type":"session","op":"get/set","purpose":"Caches the last calculated SSD parameter object."},{"key":"ssd:activeTabId","type":"session","op":"get/set","purpose":"Stores the ID of the currently active tab for SSD state determination."},{"key":"ssd:lastState","type":"session","op":"get/set","purpose":"Caches the last determined SSD state as a fallback."}],"endpoints":[{"url":"https://s.joinhoney.com/ck/alive","method":"GET","purpose":"A check to see if the user is on a blocklist, which can override SSD logic."},{"url":"https://cdn.honey.io/ab/ssd.json","method":"GET","purpose":"Fetches the rules for the 'SSD' (Super-Secret Droplist?) dynamic configuration system."}],"dynamic_code":[],"wasm":[],"obfuscation_hints":["minified_vars","function_chains"],"risks":[],"gql_operations":[{"name":"ext_addProductToCollections","type":"mutation","purpose":"Adds one or more products to a user's Droplist collection."}]},"evidence":[{"file":"h0.beautified.js","start":86300,"end":86400,"ast_id":null,"note":"Session management logic, including onSessionStarted event dispatch"},{"file":"h0.beautified.js","start":87000,"end":87150,"ast_id":null,"note":"Device settings management utility"},{"file":"h0.beautified.js","start":87600,"end":87700,"ast_id":null,"note":"SSD rule fetching from cdn.honey.io"},{"file":"h0.beautified.js","start":87850,"end":88000,"ast_id":null,"note":"Core SSD parameter building logic, gathering user points, adb status, etc."},{"file":"h0.beautified.js","start":87450,"end":87550,"ast_id":null,"note":"'ck/alive' blocklist check"},{"file":"h0.beautified.js","start":87950,"end":87990,"ast_id":null,"note":"Checking for affiliate cookies (GA) as part of SSD parameter building"},{"file":"h0.beautified.js","start":87200,"end":87250,"ast_id":null,"note":"Creation of 'fetchBaseRules' alarm for periodic SSD rule updates"},{"file":"h0.beautified.js","start":87300,"end":87400,"ast_id":null,"note":"addProductToCollections GraphQL mutation and associated analytics events (droplist600, droplist951)"}]}
{"file":"h0.js","beautified":"h0.beautified.js","chunk":{"id":"chunk-45/73","start_line":88001,"end_line":90000,"same_function_group":null},"findings":{"chrome_apis":[],"event_listeners":[],"messages":[],"storage":[],"endpoints":[{"url":"https://www.amazon.com/cart/ref=ox_sc_inf_saved-for-later_load-infinite-sfl","method":"POST","purpose":"Amazon 'Saved for Later' sync"}],"dom":[],"dynamic_code":[],"wasm":[],"obfuscation_hints":["minified_vars","function_chains"],"risks":[],"graphql_operations":[{"name":"ext_addToDroplist","type":"mutation"},{"name":"ext_optimus_getProductByStoreIdVariantIds","type":"query"},{"name":"getProductPriceHistoryByStoreIdVariantId","type":"query"}]},"evidence":[{"file":"/Users/jfri/private/affiliateDetector/honey-versions/honey-17.1.1-bmnlcjabgnpnenekpadlanbbkooimhnj/h0.js","start":88842,"end":89281},{"file":"/Users/jfri/private/affiliateDetector/honey-versions/honey-17.1.1-bmnlcjabgnpnenekpadlanbbkooimhnj/h0.js","start":89284,"end":89801},{"file":"/Users/jfri/private/affiliateDetector/honey-versions/honey-17.1.1-bmnlcjabgnpnenekpadlanbbkooimhnj/h0.js","start":89804,"end":90449},{"file":"/Users/jfri/private/affiliateDetector/honey-versions/honey-17.1.1-bmnlcjabgnpnenekpadlanbbkooimhnj/h0.js","start":90452,"end":92800}],"notes":"This chunk contains modules for the Droplist feature, including GraphQL mutations to add items and queries to fetch product data and price history. It also includes logic to sync items from a user's Amazon 'Saved for Later' list."}
{"file":"h0.js","beautified":"h0.beautified.js","chunk":{"id":"chunk-46/73","start_line":90001,"end_line":92000,"same_function_group":null},"findings":{"chrome_apis":[],"event_listeners":[],"messages":[],"storage":[],"endpoints":[],"dom":[],"dynamic_code":[],"wasm":[],"obfuscation_hints":["minified_vars","function_chains"],"risks":[],"graphql_operations":[{"name":"ext_optimus_getProductByStoreIdVariantIds","type":"query"},{"name":"ext_getDroplistByUserId","type":"query"},{"name":"ext_getDroplistAndDroplistCollectionsByUserId","type":"query"},{"name":"getProductByIds","type":"query"},{"name":"ext_getProductByIdSecondaryDetails","type":"query"},{"name":"ext_removeFromDroplist","type":"mutation"}]},"evidence":[{"file":"/Users/jfri/private/affiliateDetector/honey-versions/honey-17.1.1-bmnlcjabgnpnenekpadlanbbkooimhnj/h0.js","start":90452,"end":92800},{"file":"/Users/jfri/private/affiliateDetector/honey-versions/honey-17.1.1-bmnlcjabgnpnenekpadlanbbkooimhnj/h0.js","start":92803,"end":94039},{"file":"/Users/jfri/private/affiliateDetector/honey-versions/honey-17.1.1-bmnlcjabgnpnenekpadlanbbkooimhnj/h0.js","start":94042,"end":94639},{"file":"/Users/jfri/private/affiliateDetector/honey-versions/honey-17.1.1-bmnlcjabgnpnenekpadlanbbkooimhnj/h0.js","start":94642,"end":95485},{"file":"/Users/jfri/private/affiliateDetector/honey-versions/honey-17.1.1-bmnlcjabgnpnenekpadlanbbkooimhnj/h0.js","start":95488,"end":96385},{"file":"/Users/jfri/private/affiliateDetector/honey-versions/honey-17.1.1-bmnlcjabgnpnenekpadlanbbkooimhnj/h0.js","start":96388,"end":96919}],"notes":"This chunk is heavily focused on Droplist management, particularly the complex workflow of syncing items from a user's Amazon 'Saved for Later' page. It includes multiple GraphQL queries to fetch product data and existing Droplist items, and mutations to add or remove items."}
{"file":"h0.js","beautified":"h0.beautified.js","chunk":{"id":"chunk-47/73","start_line":92001,"end_line":94000,"same_function_group":null},"findings":{"chrome_apis":[],"event_listeners":[{"name":"droplist:product:v3","type":"message","purpose":"Central router for all Droplist actions"}],"messages":[],"storage":[],"endpoints":[],"dom":[],"dynamic_code":[],"wasm":[],"obfuscation_hints":["minified_vars","function_chains"],"risks":[],"graphql_operations":[{"name":"ext_getProductPriceHistory","type":"query"},{"name":"ext_getProductByIdsWithOffer","type":"query"},{"name":"ext_getProductByIdSecondaryDetails","type":"query"},{"name":"ext_addNonCatalogItemToDroplist","type":"mutation"},{"name":"ext_getDroplistByCanonicalUrl","type":"query"},{"name":"ext_updateNonCatalogDroplistItem","type":"mutation"}]},"evidence":[{"file":"/Users/jfri/private/affiliateDetector/honey-versions/honey-17.1.1-bmnlcjabgnpnenekpadlanbbkooimhnj/h0.js","start":92004,"end":92797},{"file":"/Users/jfri/private/affiliateDetector/honey-versions/honey-17.1.1-bmnlcjabgnpnenekpadlanbbkooimhnj/h0.js","start":92800,"end":93647},{"file":"/Users/jfri/private/affiliateDetector/honey-versions/honey-17.1.1-bmnlcjabgnpnenekpadlanbbkooimhnj/h0.js","start":93650,"end":95395},{"file":"/Users/jfri/private/affiliateDetector/honey-versions/honey-17.1.1-bmnlcjabgnpnenekpadlanbbkooimhnj/h0.js","start":95398,"end":96195},{"file":"/Users/jfri/private/affiliateDetector/honey-versions/honey-17.1.1-bmnlcjabgnpnenekpadlanbbkooimhnj/h0.js","start":96198,"end":96837},{"file":"/Users/jfri/private/affiliateDetector/honey-versions/honey-17.1.1-bmnlcjabgnpnenekpadlanbbkooimhnj/h0.js","start":96840,"end":98805}],"notes":"This chunk contains a central message listener `droplist:product:v3` that acts as a router for numerous Droplist-related actions, including adding, updating, fetching, and removing both catalog and non-catalog items. It exposes a rich API to other parts of the extension for managing the Droplist feature through various GraphQL queries and mutations."}
{"file":"h0.js","beautified":"h0.beautified.js","chunk":{"id":"chunk-48/73","start_line":94001,"end_line":96000,"same_function_group":null},"findings":{"chrome_apis":[],"event_listeners":[],"messages":[],"storage":[],"endpoints":[],"dom":[],"dynamic_code":[],"wasm":[],"obfuscation_hints":["minified_vars","webpack_modules"],"risks":[],"graphql_operations":[{"name":"ext_updateNonCatalogItem","type":"mutation"},{"name":"ext_removeDroplist","type":"mutation"},{"name":"ext_removeProductFromCollections","type":"mutation"},{"name":"ext_removeSmartDroplist","type":"mutation"},{"name":"ext_updateDroplist","type":"mutation"}]},"evidence":[{"file":"/Users/jfri/private/affiliateDetector/honey-versions/honey-17.1.1-bmnlcjabgnpnenekpadlanbbkooimhnj/h0.js","start":94020,"end":94020},{"file":"/Users/jfri/private/affiliateDetector/honey-versions/honey-17.1.1-bmnlcjabgnpnenekpadlanbbkooimhnj/h0.js","start":94458,"end":94458},{"file":"/Users/jfri/private/affiliateDetector/honey-versions/honey-17.1.1-bmnlcjabgnpnenekpadlanbbkooimhnj/h0.js","start":94900,"end":94900},{"file":"/Users/jfri/private/affiliateDetector/honey-versions/honey-17.1.1-bmnlcjabgnpnenekpadlanbbkooimhnj/h0.js","start":95340,"end":95340},{"file":"/Users/jfri/private/affiliateDetector/honey-versions/honey-17.1.1-bmnlcjabgnpnenekpadlanbbkooimhnj/h0.js","start":95799,"end":95799}],"notes":"This chunk contains more Droplist-related GraphQL mutations for updating and removing items. It includes `ext_updateNonCatalogItem`, `ext_removeDroplist`, `ext_removeProductFromCollections`, `ext_removeSmartDroplist`, and `ext_updateDroplist`. It also includes a central analytics module for Droplist."}
{"file":"h0.js","beautified":"h0.beautified.js","chunk":{"id":"chunk-49/73","start_line":96001,"end_line":98000,"same_function_group":null},"findings":{"chrome_apis":[],"event_listeners":[{"name":"user:current:update","file":"/Users/jfri/private/affiliateDetector/honey-versions/honey-17.1.1-bmnlcjabgnpnenekpadlanbbkooimhnj/h0.js","line":97450},{"name":"experiments:action","file":"/Users/jfri/private/affiliateDetector/honey-versions/honey-17.1.1-bmnlcjabgnpnenekpadlanbbkooimhnj/h0.js","line":97455},{"name":"features:action","file":"/Users/jfri/private/affiliateDetector/honey-versions/honey-17.1.1-bmnlcjabgnpnenekpadlanbbkooimhnj/h0.js","line":97688},{"name":"gxp:actions","file":"/Users/jfri/private/affiliateDetector/honey-versions/honey-17.1.1-bmnlcjabgnpnenekpadlanbbkooimhnj/h0.js","line":97975}],"messages":[{"name":"circuitBreaker:event","direction":"background->background","payload_keys":["alert_type","event_name","operation"]},{"name":"gxp:ui:actions","direction":"background->ui","payload_keys":[]}],"storage":[],"endpoints":[{"url":"https://d.joinhoney.com/features/owner/extension-engineers","method":"GET"},{"url":"https://d.joinhoney.com/v3","method":"POST/GET"}],"dom":[],"dynamic_code":[],"wasm":[],"obfuscation_hints":["minified_vars","webpack_modules"],"risks":[{"type":"remote_code","severity":"medium","justification":"The extension uses extensive, remotely-configurable A/B testing (Module 18263) and feature flagging (Module 17816). This allows the vendor to dynamically alter the extension's behavior and enable new features or data collection pathways at any time without publishing a new version, reducing user oversight."}],"graphql_operations":[{"name":"ext_getDebugUIExperiments","type":"query"},{"name":"ext_instantPSBRedemption","type":"mutation"}]},"evidence":[{"file":"/Users/jfri/private/affiliateDetector/honey-versions/honey-17.1.1-bmnlcjabgnpnenekpadlanbbkooimhnj/h0.js","start":96001,"end":98000}],"notes":"This chunk contains critical infrastructure: the main GraphQL client (with circuit breaker), a comprehensive A/B testing framework, and a feature flag manager. It also handles Gold-to-PayPal credit redemption."}
{"file":"h0.js","beautified":"h0.beautified.js","chunk":{"id":"chunk-50/73","start_line":98001,"end_line":100000,"same_function_group":null},"findings":{"chrome_apis":[],"event_listeners":[{"name":"honey-pay-now:action:eligibility","file":"/Users/jfri/private/affiliateDetector/honey-versions/honey-17.1.1-bmnlcjabgnpnenekpadlanbbkooimhnj/h0.js","line":99488},{"name":"honey-pay-now:action:gql-query","file":"/Users/jfri/private/affiliateDetector/honey-versions/honey-17.1.1-bmnlcjabgnpnenekpadlanbbkooimhnj/h0.js","line":99789}],"messages":[],"storage":[{"key":"bg-honey-pay-now-HoneyPayNow","type":"local"},{"key":"bg-recently-purchased","type":"local"}],"endpoints":[],"dom":[],"dynamic_code":[],"wasm":[],"obfuscation_hints":["minified_vars","webpack_modules"],"risks":[],"graphql_operations":[{"name":"giftcards_getGiftcardsClientEnabled","type":"query"},{"name":"giftcards_getGiftcardsStoreEligibility","type":"query"},{"name":"giftcards_getGiftcardsGeneralEligibility","type":"query"},{"name":"giftcards_getGiftcardsGeneralEligibilityLoggedOut","type":"query"},{"name":"ext_getGiftcardsStoreById","type":"query"}]},"evidence":[{"file":"/Users/jfri/private/affiliateDetector/honey-versions/honey-17.1.1-bmnlcjabgnpnenekpadlanbbkooimhnj/h0.js","start":98001,"end":100000}],"notes":"This chunk details the 'Honey Pay Now' feature, a system for purchasing gift cards at checkout. It includes extensive eligibility checks (client, store, user, cart total) via GraphQL, caching, and message listeners to orchestrate the feature."}
{"file":"h0.js","beautified":"h0.beautified.js","chunk":{"id":"chunk-51/73","start_line":100001,"end_line":102000,"same_function_group":null},"findings":{"chrome_apis":[],"event_listeners":["honey-pay-now:action:local-storage","honey-pay-now:action:ui","honey-tip:badge-experiments"],"messages":[{"name":"honey-pay-now:action:local-storage","direction":"content->background","payload_keys":["action","data"],"purpose":"Handles local storage operations (get, set, remove) for the Honey Pay Now feature."},{"name":"honey-pay-now:action:ui","direction":"content->background","payload_keys":["action","data","term"],"purpose":"Manages UI elements for Honey Pay Now, including modals, cards, and fetching Google Places address suggestions."},{"name":"honey-tip:badge-experiments","direction":"content->background","payload_keys":["action","data"],"purpose":"Tracks user interactions with experimental 'Honey Tip' badges, such as views and hovers."}],"storage":[{"key":"giftcardsReminderMap","type":"local","purpose":"Stores user preferences for gift card reminders on a per-store basis."},{"key":"honeyTips:badgeExperiments","type":"local","purpose":"Caches interaction data for A/B testing of Honey Tip badges."},{"key":"honeyTips:containerShown","type":"local","purpose":"Tracks if a Honey Tips container has been shown to prevent repeated displays."},{"key":"honeyTips:couponSuppression","type":"local","purpose":"Tracks which coupons have been autopopulated to suppress redundant tips."}],"endpoints":[{"url":"https://d.joinhoney.com/v3","method":"POST","purpose":"GraphQL endpoint for fetching tip details via ext_getTip query."}],"dom":[],"dynamic_code":[],"wasm":[],"obfuscation_hints":[],"risks":[]},"evidence":[{"file":"h0.beautified.js","start":100254,"end":100278,"ast_id":null},{"file":"h0.beautified.js","start":100893,"end":100955,"ast_id":null},{"file":"h0.beautified.js","start":101534,"end":101559,"ast_id":null},{"file":"h0.beautified.js","start":102784,"end":102848,"ast_id":null}],"notes":"This chunk defines message listeners for 'Honey Pay Now' and 'Honey Tips'. It manages local storage, UI state, and tracks interactions for experimental features. It includes a GraphQL query to fetch tip details."}
{"file":"h0.js","beautified":"h0.beautified.js","chunk":{"id":"chunk-52/73","start_line":102001,"end_line":104000,"same_function_group":null},"findings":{"chrome_apis":[],"event_listeners":[],"messages":[],"storage":[],"endpoints":[{"url":"https://d.joinhoney.com/v3","method":"POST","purpose":"This endpoint is used for multiple GraphQL queries related to product information and tips."}],"dom":[],"dynamic_code":[],"wasm":[],"obfuscation_hints":[],"risks":[]},"evidence":[{"file":"h0.beautified.js","start":102784,"end":102848,"ast_id":null},{"file":"h0.beautified.js","start":103180,"end":103265,"ast_id":null},{"file":"h0.beautified.js","start":103550,"end":103620,"ast_id":null},{"file":"h0.beautified.js","start":103838,"end":103898,"ast_id":null}],"notes":"This chunk contains multiple modules for fetching product data and 'tips' via GraphQL. It includes queries for inventory (`tips_ext_getInventoryByStoreIdParentId`), comparison shopping (`tips_getProductsCanonicalByClusterId`, `tips_getProductsForComparisonShopping`), and general product details (`tips_getProductByIds`, `ext_getProductByIdSecondaryDetails`, `ext_getTip`). This functionality is central to Honey's product recommendation and comparison features."}
{"file":"h0.js","beautified":"h0.beautified.js","chunk":{"id":"chunk-53/73","start_line":104001,"end_line":106000,"same_function_group":null},"findings":{"chrome_apis":[],"event_listeners":[{"name":"honeyTips:tips","type":"message"}],"messages":[{"name":"honeyTips:tips","direction":"content->background","payload_keys":["action","storeId","isTipsEligibleOnly","productIds","clusterId","parentId","priceInCents"],"purpose":"Acts as a master router for all 'Honey Tips' related functionality, delegating to specific handlers based on the 'action' property. It fetches tips, deals, sales, product info, and tracks user interactions with tips."}],"storage":[{"key":"honeyTips:launchpadShown","type":"local","op":"get/set"},{"key":"honeyTips:pdpAutopopCounts","type":"local","op":"get/set"},{"key":"honeyTips:teaserShown:*","type":"local","op":"get/set"}],"endpoints":[{"url":"https://d.joinhoney.com/v3","method":"POST","purpose":"GraphQL endpoint for various 'tips' queries"}],"dom":[],"dynamic_code":[],"wasm":[],"obfuscation_hints":["api_middleware"],"risks":[]},"evidence":[{"file":"h0.js","start":105130,"end":105293,"ast_id":null},{"file":"h0.js","start":104238,"end":104271,"ast_id":null},{"file":"h0.js","start":104530,"end":104563,"ast_id":null},{"file":"h0.js","start":104840,"end":104870,"ast_id":null}],"notes":"This chunk contains the master message listener for the 'honeyTips:tips' channel. It functions as a central router, dispatching various actions to their corresponding modules. This includes fetching tips, deals, sales, and product data via GraphQL, as well as managing numerous local storage entries for tracking tip impressions and interactions. This architecture centralizes the logic for the entire 'Honey Tips' feature set."}
{"file":"h0.js","beautified":"h0.beautified.js","chunk":{"id":"chunk-54/73","start_line":106001,"end_line":108000,"same_function_group":null},"findings":{"storage":[{"key":"honeyTips:teaserCountsPerTipAndProduct","type":"local","op":"get/set"},{"key":"honeyTips:teaserCountsPerTipAndStore","type":"local","op":"get/set"},{"key":"honeyTips:teasersCountPerStore","type":"local","op":"get/set"},{"key":"honeyTipsConfiguration_v4","type":"local","op":"unknown"},{"key":"honeyTips:tipsConfig:","type":"local","op":"unknown"}],"endpoints":[{"url":"https://d.joinhoney.com/v3","method":"POST","purpose":"GraphQL API endpoint for tips_getTipHits query"}],"chrome_apis":[],"event_listeners":[],"messages":[],"dom":[],"dynamic_code":[],"wasm":[],"obfuscation_hints":["minified_vars","api_client_patterns"],"risks":[]},"evidence":[{"file":"h0.beautified.js","start":106208,"end":106211},{"file":"h0.beautified.js","start":106800,"end":106803},{"file":"h0.beautified.js","start":107358,"end":107361},{"file":"h0.beautified.js","start":107894,"end":107894},{"file":"h0.beautified.js","start":107900,"end":107900}],"notes":"This chunk contains modules for managing 'Honey Tips' impression counts and fetching tips from the backend. It defines multiple layers of impression tracking (per-product, per-category, per-store) using local storage. It also includes the main API client for fetching tips, which normalizes a large set of contextual data before executing the 'tips_getTipHits' GraphQL query."}
{"file":"h0.js","beautified":"h0.beautified.js","chunk":{"id":"chunk-55/73","start_line":108001,"end_line":110000,"same_function_group":null},"findings":{"storage":[{"key":"TIPS_CONFIGURATION_CACHE","type":"local","op":"get/set"},{"key":"honeyTipsConfiguration_v4","type":"local","op":"unknown"},{"key":"honeyTips:tipsShown","type":"local","op":"get/set"},{"key":"session-scoped storage wrapper","type":"local","op":"get/set/del"}],"endpoints":[{"url":"https://d.joinhoney.com/v3","method":"POST","purpose":"GraphQL API endpoint for tips_getConfiguration query"}],"chrome_apis":[],"event_listeners":[],"messages":[],"dom":[],"dynamic_code":[],"wasm":[],"obfuscation_hints":["minified_vars","api_client_patterns"],"risks":[]},"evidence":[{"file":"h0.beautified.js","start":108845,"end":108845},{"file":"h0.beautified.js","start":108860,"end":108860},{"file":"h0.beautified.js","start":109600,"end":109603},{"file":"h0.beautified.js","start":109880,"end":109880}],"notes":"This chunk details the configuration fetching mechanism for 'Honey Tips'. It employs a caching strategy, first checking an in-memory LRU cache, then querying a GraphQL endpoint ('tips_getConfiguration'), with a final fallback to a static JSON configuration. It also includes utilities for formatting product data and managing session-scoped storage for shown tips."}
{"file":"h0.js","beautified":"h0.beautified.js","chunk":{"id":"chunk-56/73","start_line":110001,"end_line":112000,"same_function_group":null},"findings":{"storage":[{"key":"tips:webPriceComparisonViewed:","type":"local","op":"get/set"},{"key":"lruCache:bg-main","type":"local","op":"get/set/del"}],"chrome_apis":["runtime.onMessage.addListener"],"event_listeners":[{"type":"message","channel":"imageloader:action","handler":"(anonymous)"},{"type":"message","channel":"sentry:action","handler":"(anonymous)"},{"type":"message","channel":"page:load","handler":"(anonymous)"},{"type": "message", "channel": "lru:access", "handler": "U"}],"messages":[{"name":"background:started","direction":"background->content","payload_keys":[]},{"name":"debug:change","direction":"background->content","payload_keys":["active"]}],"dom":[],"dynamic_code":[],"wasm":[],"obfuscation_hints":["minified_vars","webpack_modules"],"risks":[]},"evidence":[{"file":"h0.beautified.js","start":110200,"end":110203},{"file":"h0.beautified.js","start":111550,"end":111553},{"file":"h0.beautified.js","start":110450,"end":110453},{"file":"h0.beautified.js","start":111001,"end":111001},{"file":"h0.beautified.js","start":111205,"end":111205},{"file":"h0.beautified.js","start":111255,"end":111255},{"file":"h0.beautified.js","start":111750,"end":111753}],"notes":"This chunk contains the core initialization logic for the background script. It sets up a persistent LRU cache ('bg-main'), Sentry error reporting, and a debug mode activated by a specific URL. It also defines listeners for various actions like image loading and cache access. A key feature is the aggregation of numerous modules into a central object for dependency management."}
{"file":"h0.js","beautified":"h0.beautified.js","chunk":{"id":"chunk-57/73","start_line":112001,"end_line":114000,"same_function_group":null},"findings":{"chrome_apis":[],"event_listeners":["offers:action","mseupsell:action","mseupsell:bg:action","optimuslru:access","optimus:fetch:product"],"messages":[{"name":"offers:action","direction":"background<->background","payload_keys":["action","data","tabId"]},{"name":"mseupsell:action","direction":"background<->background","payload_keys":["action","flow","tabId"]},{"name":"mseupsell:bg:action","direction":"background<->background","payload_keys":["action","userId"]},{"name":"optimuslru:access","direction":"background<->background","payload_keys":["action","data"]},{"name":"optimus:fetch:product","direction":"background<->background","payload_keys":["productId","variantId"]}],"storage":[{"key":"offers:<userId>:<offerId>:activated","type":"local"},{"key":"offers:<userId>:<offerId>:details","type":"local"},{"key":"offers:product:<userId>:<storeId>:<parentId>:activated","type":"local"},{"key":"offers:product:<userId>:<storeId>:<parentId>:details","type":"local"},{"key":"offers:<eguId>:<storeId>:<placementId>:TR","type":"local"},{"key":"optimuslru:*","type":"local"}],"endpoints":[{"url":"ext_triggerEmailMseLink","method":"GraphQL"},{"url":"ext_getProductOffer","method":"GraphQL"},{"url":"offers_activateProductOffer","method":"GraphQL"},{"url":"offers_activateOfferUnauthed","method":"GraphQL"},{"url":"offers_getProductOfferActivations","method":"GraphQL"},{"url":"ext_getProductOfferActivationsForList","method":"GraphQL"},{"url":"ext_getStoreProductOffers","method":"GraphQL"},{"url":"offers_getEligibleTailoredReward","method":"GraphQL"},{"url":"ext_getUserEligibilityForOffers","method":"GraphQL"},{"url":"ext_getProductByIds","method":"GraphQL"},{"url":"ext_optimus_getProductByIds","method":"GraphQL"},{"url":"ext_optimus_getProductByStoreIdVariantIds","method":"GraphQL"}],"dom":[],"dynamic_code":[],"wasm":[],"obfuscation_hints":[],"risks":[]},"evidence":[{"file":"h0.beautified.js","start":112448,"end":113943},{"file":"h0.beautified.js","start":113946,"end":114000}],"notes":"This chunk contains modules for managing 'Product Offers' and a caching system called 'Optimus'. The offers module handles fetching, activating, and tracking offers via GraphQL and a local LRU cache. The Optimus module provides a dedicated cache and fetches product data."}
{"file":"h0.js","beautified":"h0.beautified.js","chunk":{"id":"chunk-58/73","start_line":114001,"end_line":116000,"same_function_group":null},"findings":{"chrome_apis":["tabs.onActivated","tabs.onUpdated"],"event_listeners":["paypal:action","bg:permissions","popover:bg","product:coupons","product_fetcher:action","tabs:activated","tabs:updated"],"messages":[{"name":"paypal:action","direction":"background<->background","payload_keys":["action","data"]},{"name":"bg:permissions","direction":"background<->background","payload_keys":["action"]},{"name":"popover:bg","direction":"background<->background","payload_keys":["action","data","tabId"]},{"name":"popover:cs","direction":"background->content","payload_keys":["action","data","tabId"]},{"name":"product:coupons","direction":"background<->background","payload_keys":["action","data"]},{"name":"product_fetcher:action","direction":"background<->background","payload_keys":["action","data"]}],"storage":[{"key":"honeyCornerIllustration","type":"local"},{"key":"visitedProducts:<storeId>","type":"local"}],"endpoints":[{"url":"https://history.paypal.com/credit-presentment/honey","method":"GET"},{"url":"ext_getPayPalMessaging","method":"GraphQL"},{"url":"ext_getUserTransactions","method":"GraphQL"},{"url":"ext_getProductByIds","method":"GraphQL"},{"url":"ext_getCouponStatsByProduct","method":"GraphQL"},{"url":"https://s.joinhoney.com/pe","method":"POST"}],"dom":[],"dynamic_code":[],"wasm":[],"obfuscation_hints":[],"risks":[]},"evidence":[{"file":"h0.beautified.js","start":114031,"end":114831},{"file":"h0.beautified.js","start":114834,"end":114921},{"file":"h0.beautified.js","start":114924,"end":115461},{"file":"h0.beautified.js","start":115464,"end":115998},{"file":"h0.beautified.js","start":115998,"end":116000}],"notes":"This chunk defines several background modules that communicate with content scripts and the popover. It includes logic for fetching PayPal-specific marketing messages, handling permission prompts, managing the popover state, fetching product-specific coupons, and a generic product data fetcher that also tracks user focus time on products."}
{"file":"h0.js","beautified":"h0.beautified.js","chunk":{"id":"chunk-59/73","start_line":116001,"end_line":118000,"same_function_group":null},"findings":{"chrome_apis":[],"event_listeners":["rokt-offers:action"],"messages":[{"name":"rokt-offers:action","direction":"background<->background","payload_keys":["action","data"]}],"storage":[{"key":"bg-rokt-offers","type":"local"},{"key":"CLIENT-UNIQUE-OBJECT:<storeId>:<sessionId>","type":"local"}],"endpoints":[{"url":"ext_updateRecentlyViewedItems","method":"GraphQL"},{"url":"ext_getRoktOffers","method":"GraphQL"},{"url":"ext_sendRoktEvents","method":"GraphQL"}],"dom":[],"dynamic_code":[],"wasm":[],"obfuscation_hints":[],"risks":[{"type":"tracking","severity":"medium","justification":"The Rokt offers module generates a unique client ID (`clientUniqueId`) and tracks user interactions with offers. It sends detailed event data, including session ID and parent GUIDs, back to the backend via the `ext_sendRoktEvents` mutation, enabling fine-grained behavioral tracking."}]},"evidence":[{"file":"h0.beautified.js","start":116001,"end":116235},{"file":"h0.beautified.js","start":116238,"end":117935},{"file":"h0.beautified.js","start":117938,"end":118000}],"notes":"This chunk contains modules for updating recently viewed products, sorting stores based on savings potential, and a large, complex module for integrating with 'Rokt', a third-party offer provider. The Rokt module includes its own caching, eligibility checks, and event tracking system."}
{"file":"h0.js","beautified":"h0.beautified.js","chunk":{"id":"chunk-60/73","start_line":118001,"end_line":120000,"same_function_group":null},"findings":{"chrome_apis":["chrome.storage.local","chrome.storage.sync","chrome.webRequest.onBeforeRequest","chrome.webRequest.onCompleted","chrome.webRequest.onErrorOccurred"],"event_listeners":["stats:action","sdata:testSuiteInit","site_support:startWatching","site_support:stopWatching","site_support:watchUGCRequest","site_support:checkUGCCoupon"],"messages":["stats:action","sdata:event","site_support:sawStoreRequestStarted","site_support:sawStoreRequestFinished"],"storage":[{"key":"storage:lastWiped","type":"local","op":"set"},{"key":"user:*","type":"local","op":"persist"},{"key":"bg-double-gold","type":"local","op":"cache"}],"endpoints":[{"url":"https://d.joinhoney.com/atlas","method":"GET","purpose":"Generic data lookup"}],"dynamic_code":[],"wasm":[],"obfuscation_hints":[],"risks":[{"type":"tracking","severity":"medium","justification":"The site_support module actively monitors and logs network requests during both automated and manual coupon applications. It compares the two methods and sends detailed analytics (ext003012, ext003020) to the backend, tracking the success, failure, and user behavior related to coupon usage."}]},"evidence":[{"file":"h0.js","start":118051,"end":118111,"ast_id":null},{"file":"h0.js","start":118112,"end":118580,"ast_id":null},{"file":"h0.js","start":118581,"end":119568,"ast_id":null},{"file":"h0.js","start":119569,"end":119990,"ast_id":null},{"file":"h0.js","start":119991,"end":120000,"ast_id":null}],"notes":"This chunk contains core infrastructure: a unified storage abstraction, the main analytics/stats engine, and the complex webRequest listener for monitoring the 'Find Savings' process. It compares automated vs. manual coupon application for analytics."}
{"file":"h0.js","beautified":"h0.beautified.js","chunk":{"id":"chunk-61/73","start_line":120001,"end_line":122000,"same_function_group":null},"findings":{"chrome_apis":["chrome.tabs.executeScript","chrome.tabs.update"],"event_listeners":["page:load","ui:interaction","stores:affiliate:tagged","stores:action","stores:session:started","stores:session:activated"],"messages":["affManager:tag","rewardsManager:action","stores:action"],"storage":[{"key":"bg-url","type":"local","op":"cache"},{"key":"bg-product-allowlist","type":"local","op":"cache"},{"key":"bg-templated-stores","type":"local","op":"cache"},{"key":"bg-stores","type":"local","op":"cache"},{"key":"bg-exchange-rates","type":"local","op":"cache"},{"key":"<storeId>:<tabId>:stoodup","type":"local","op":"set"},{"key":"<storeId>:<sessionId>","type":"local","op":"cache"}],"endpoints":[{"url":"https://d.joinhoney.com/cmap","method":"GET","purpose":"Product mapping service"}],"dynamic_code":[],"wasm":[],"obfuscation_hints":[],"risks":[{"type":"tracking","severity":"low","justification":"The 'stores' module logs page loads (ext001001), UI interactions (ext004002), and session activations (ext004001) with store, session, and tab identifiers. It also tracks URL history per tab/session in local storage."}],"code_smells":[{"type":"complex_module","description":"The 'stores' module (85799) is a massive, monolithic module that acts as a central hub for all store-related logic, including data fetching, caching, event handling, analytics, and interactions with numerous other managers (rewards, affiliate, stand-down). Its size and complexity make it difficult to maintain and reason about."}],"evidence":[{"file":"h0.js","start":120001,"end":120235,"ast_id":null},{"file":"h0.js","start":120236,"end":122000,"ast_id":null}],"notes":"This chunk contains the massive 'stores' module, which is the central nervous system for all store-related data and actions in the background script. It manages multiple layers of caching, handles dozens of events, and orchestrates interactions between various other managers."}
{"file":"h0.js","beautified":"h0.beautified.js","chunk":{"id":"chunk-62/73","start_line":122001,"end_line":124000,"same_function_group":null},"findings":{"chrome_apis":["chrome.webRequest.onHeadersReceived"],"event_listeners":["si:on","standDown:store:status","page:load","standDown:store:ssd"],"messages":["experiments:action","ui:action"],"storage":[{"key":"bg-info-manager","type":"local","op":"cache"},{"key":"standDown","type":"local","op":"prefixed"},{"key":"standDownTracker","type":"local","op":"prefixed"},{"key":"currentActiveTabId","type":"local","op":"get/set"},{"key":"lastRequestTabId","type":"local","op":"get/set"},{"key":"storeDoubleGold:<userId>:<storeId>","type":"local","op":"cache"},{"key":"storeNNA:<userId>:<storeId>","type":"local","op":"cache"}],"endpoints":[],"dynamic_code":[],"wasm":[],"obfuscation_hints":[],"risks":[{"type":"tracking","severity":"medium","justification":"The 'standDown' manager (18970) monitors all main_frame navigation requests via onHeadersReceived. It logs detailed information about the request (tabId, URL, initiator, statusCode) and sends analytics events (ext300004, ext200203) to track when and why the extension's UI is suppressed ('stood down'). This provides a detailed picture of user browsing behavior and interactions with competing affiliate links."}],"code_smells":[{"type":"complex_module","description":"The 'storesApi' module (22670) is another large, complex module responsible for fetching and modifying store data. It chains together multiple data-modifying functions (q, z, Y, Q, J, te) to assemble the final store object, making the data flow difficult to trace."}],"evidence":[{"file":"h0.js","start":122001,"end":122000,"ast_id":null}],"notes":"This chunk contains two major modules: the 'storesApi' for fetching and modifying store data, and the 'standDown' manager, which implements the logic for suppressing the Honey UI when a user has already clicked another affiliate link. The standDown manager uses webRequest listeners to monitor user navigation and makes decisions about when to hide the extension."}
{"file":"h0.js","beautified":"h0.beautified.js","chunk":{"id":"chunk-63/73","start_line":124001,"end_line":126000,"same_function_group":null},"findings":{"chrome_apis":["chrome.tabs.create","chrome.tabs.update","chrome.tabs.get","chrome.tabs.executeScript","chrome.tabs.query"],"event_listeners":["tabs:action","tabs:activated","page:load","page:detect_store","page:detect_google","car_rental:action"],"messages":["ui:action","findsavings:apply_code_top_funnel","experiments:action"],"storage":["trendingStores","bg-url-matcher","supportedDomainsInMemoryList","currentActiveTabId","device:firstTime","sentShopifyMessage:*","carrental:*:path"],"endpoints":[{"url":"https://cdn.honey.io/extension/data/trending-stores-*.json","method":"GET"},{"url":"graphql","query":"ext_getSupportedDomains"},{"url":"graphql","query":"ext_getStorePartialsByDomain"}],"dom":[],"dynamic_code":[],"wasm":[],"obfuscation_hints":[],"risks":[]},"evidence":[{"file":"h0.beautified.js","start":124150,"end":124250,"ast_id":null},{"file":"h0.beautified.js","start":124800,"end":125000,"ast_id":null},{"file":"h0.beautified.js","start":125100,"end":125900,"ast_id":null}],"notes":"This chunk contains the URLMatcher/StoreFinder, TabsManager, and CarRentalManager modules."}
{"file":"h0.js","beautified":"h0.beautified.js","chunk":{"id":"chunk-64/73","start_line":126001,"end_line":128000,"same_function_group":null},"findings":{"chrome_apis":["chrome.runtime.sendNativeMessage","chrome.cookies.remove","chrome.cookies.get","chrome.cookies.getAllForUrl"],"event_listeners":["user:action","car_rental:action"],"messages":["car_rental:action"],"storage":["carrental:*:allStoresCoupons","bg-info-manager"],"endpoints":[{"url":"graphql","query":"ext_getDoubleGoldActivationsByUserId"},{"url":"graphql","query":"ext_updateUserFollow"},{"url":"graphql","query":"ext_getUserFollow"},{"url":"graphql","query":"users_logUserOut"}],"dom":[],"dynamic_code":[],"wasm":[],"obfuscation_hints":[],"risks":[{"type":"other","severity":"low","description":"The AuthManager uses chrome.runtime.sendNativeMessage to communicate with a native application for handling authentication tokens. While this is a positive security practice, it introduces a dependency on a native component that is outside the scope of this web-extension-only analysis."}],"evidence":[{"file":"h0.beautified.js","start":126001,"end":127500,"ast_id":null},{"file":"h0.beautified.js","start":127500,"end":128000,"ast_id":null}],"notes":"This chunk contains the CarRentalManager, AuthManager, and UserManager modules."}
{"file":"h0.js","beautified":"h0.beautified.js","chunk":{"id":"chunk-65/73","start_line":128001,"end_line":130000,"same_function_group":null},"findings":{"chrome_apis":[],"event_listeners":["user:current:update","vims:action","page:detect_store","tabs:removed","tabs:updated","pdp:debug"],"messages":[{"name":"user:current:update","direction":"background->content","payload_keys":["user"]},{"name":"vims:action","direction":"background->background","payload_keys":["action","data","runId","storeId","type","options","currentPageUrl","frameworkId","result","event"]},{"name":"pdp:debug","direction":"background->background","payload_keys":["eventName"]}],"storage":[{"key":"userPoints:{userId}","type":"local","op":"get/set"},{"key":"redeemableGoldBalance:{payerId}:{currencyCode}","type":"local","op":"get/set"},{"key":"bg-experiments","type":"local","op":"get/set"},{"key":"user:settings","type":"local","op":"get/set"},{"key":"user:information","type":"local","op":"get/set"},{"key":"user:userId","type":"local","op":"get/set"},{"key":"user:country","type":"local","op":"get/set"}],"endpoints":[{"url":"https://cdn.honey.io/experiments.json","method":"GET"},{"url":"https://cdn.honey.io/images/findsavings/coiny-dash-config.json","method":"GET"}],"dom":[],"dynamic_code":[],"wasm":[],"obfuscation_hints":["minified_vars","function_chains"],"risks":[]},"evidence":[{"file":"h0.js","start":128530,"end":128600,"ast_id":null},{"file":"h0.js","start":128890,"end":129180,"ast_id":null},{"file":"h0.js","start":129650,"end":129890,"ast_id":null},{"file":"h0.js","start":129950,"end":130000,"ast_id":null}],"notes":"This chunk contains several core services: User Gold/Points management, A/B testing framework, User session/info management, and the VIM script execution engine."}
{"file":"h0.js","beautified":"h0.beautified.js","chunk":{"id":"chunk-66/73","start_line":130001,"end_line":132000,"same_function_group":null},"findings":{"chrome_apis":["chrome.webRequest.onBeforeRequest.addListener","chrome.webRequest.onBeforeSendHeaders.addListener","chrome.webRequest.onHeadersReceived.addListener","chrome.webRequest.onCompleted.addListener","chrome.webRequest.onErrorOccurred.addListener"],"event_listeners":["vims:action","vims:reportPageTypes","vims:reportWhereAmI","reportOrderId","current:product"],"messages":[{"name":"vims:action","direction":"content->background","payload_keys":["action","runId","data","vimPayload"]}],"storage":[{"key":"bg-vims","type":"local","op":"cache"}],"endpoints":[{"url":"https://v.joinhoney.com/recipe/stores/{storeId}","method":"GET"}],"dom":[],"dynamic_code":[],"wasm":[],"obfuscation_hints":["minified_vars","webpack_modules","function_chains"],"risks":[]},"evidence":[{"file":"h0.js","start":130001,"end":132000}],"notes":"This chunk contains the core of the VIM (Visual Injection Machine) engine, including its native action handlers, configuration, and script fetching mechanisms. It also includes wrappers for Chrome APIs like chrome.webRequest."}
{"file":"h0.js","beautified":"h0.beautified.js","chunk":{"id":"chunk-67/73","start_line":132001,"end_line":134000,"same_function_group":null},"findings":{"chrome_apis":["chrome.action.setIcon","chrome.action.setTitle","chrome.action.setBadgeText","chrome.action.setBadgeBackgroundColor","chrome.action.onClicked","chrome.runtime.onMessage","chrome.runtime.onInstalled","chrome.runtime.setUninstallURL","chrome.runtime.reload","chrome.storage.local","chrome.storage.sync","chrome.storage.session","chrome.runtime.getURL","chrome.tabs.sendMessage","chrome.tabs.query","chrome.tabs.onCreated","chrome.tabs.onUpdated","chrome.tabs.onActivated","chrome.tabs.onRemoved","chrome.tabs.onReplaced","chrome.windows.update","chrome.windows.create","chrome.windows.getAll","chrome.scripting.executeScript","chrome.offscreen.hasDocument","chrome.offscreen.createDocument"],"event_listeners":["chrome.action.onClicked","chrome.runtime.onMessage","chrome.runtime.onInstalled","tabs:created","tabs:updated","tabs:activated","tabs:removed","tabs:replaced","windows.onFocusChanged"],"messages":[{"name":"button:bg:clicked","direction":"background->cs","payload_keys":[]},{"name":"button:cs","direction":"cs->background","payload_keys":["type","info"]},{"name":"tabs:cs","direction":"cs->background","payload_keys":["type","params","tabId"]},{"name":"messages:cs","direction":"cs->background","payload_keys":["type","content","dest"]},{"name":"messages:popover","direction":"ui->background","payload_keys":["content","dest"]}],"storage":[{"key":"N/A","type":"local","op":"N/A"},{"key":"N/A","type":"sync","op":"N/A"},{"key":"N/A","type":"session","op":"N/A"}],"endpoints":[],"dom":["document.documentElement.innerHTML","document.querySelector"],"dynamic_code":[],"wasm":[],"obfuscation_hints":["minified_vars","webpack_modules","function_chains"],"risks":[]},"evidence":[{"file":"h0.beautified.js","start":132001,"end":134000}],"notes":"This chunk contains a rich set of core utilities and API wrappers. It includes a Sentry client for error reporting, a large utility library with functions for price cleaning, domain parsing, and ID generation, and comprehensive wrappers for chrome.action, chrome.runtime, chrome.storage, and chrome.tabs APIs. It also defines constants for a Rokt integration."}
{"file":"h0.js","beautified":"h0.beautified.js","chunk":{"id":"chunk-68/73","start_line":134001,"end_line":136000,"same_function_group":null},"findings":{"chrome_apis":["chrome.scripting.executeScript","chrome.runtime.lastError","chrome.tabs.update"],"event_listeners":[],"messages":[],"storage":[],"endpoints":[],"dom":[],"dynamic_code":[],"wasm":[],"obfuscation_hints":["webpack_modules","minified_vars"],"risks":[]},"evidence":[{"file":"h0.beautified.js","start":134003,"end":134015,"ast_id":null},{"file":"h0.beautified.js","start":134020,"end":134030,"ast_id":null},{"file":"h0.beautified.js","start":134040,"end":134048,"ast_id":null},{"file":"h0.beautified.js","start":134053,"end":134069,"ast_id":null}],"notes":"This chunk contains a large number of small, unrelated modules, likely part of a module loader or bundler like Webpack. It includes several helper functions and polyfills. Key functionalities include: a wrapper for `chrome.scripting.executeScript` to inject popover and search engine scripts, a `regenerator-runtime` implementation for async/await support, and various utility functions for array and object manipulation (e.g., `_toConsumableArray`, `_defineProperty`, `_objectWithoutProperties`). It also contains a large, heavily-optimized HTML entity decoding library (`dom-serializer`)."}
{"file":"h0.js","beautified":"h0.beautified.js","chunk":{"id":"chunk-69/73","start_line":136001,"end_line":138000,"same_function_group":null},"findings":{"chrome_apis":[],"event_listeners":[],"messages":[],"storage":[],"endpoints":[],"dom":[],"dynamic_code":[],"wasm":[],"obfuscation_hints":["webpack_modules","minified_vars"],"risks":[]},"evidence":[{"file":"h0.beautified.js","start":136001,"end":137999,"ast_id":null}],"notes":"This chunk is a continuation of a large, bundled library, likely `dom-serializer` or a similar utility used by a library like `cheerio`. It contains extensive logic for HTML/XML serialization, including entity encoding maps and functions (`ue`, `le`). It also features a comprehensive CSS selector engine with support for attribute selectors (`dr`), pseudo-classes like `:nth-child` (`gr`), and specificity calculation (`ar`, `sr`). A large map of HTML entities is defined for encoding/decoding. The code provides a rich set of DOM traversal and manipulation utilities."}
{"file":"h0.js","beautified":"h0.beautified.js","chunk":{"id":"chunk-70/73","start_line":138001,"end_line":140000,"same_function_group":null},"findings":{"chrome_apis":[],"event_listeners":[],"messages":[],"storage":[],"endpoints":[],"dom":[],"dynamic_code":[],"wasm":[],"obfuscation_hints":["webpack_modules","minified_vars","function_chains","object_property_chaining"],"risks":[]},"evidence":[{"file":"/Users/jfri/private/affiliateDetector/honey-versions/honey-17.1.1-bmnlcjabgnpnenekpadlanbbkooimhnj/h0.beautified.js","start":138001,"end":140000}],"notes":"This chunk continues the implementation of the bundled cheerio-like library. It contains the core logic for the CSS selector engine, including pseudo-class implementations (:nth-child, :contains, etc.), selector compilation, and a jQuery-style API for DOM traversal (.find, .parent, .next, .siblings, .filter, .is). It also includes a full HTML tokenizer and parser (resembling htmlparser2) with a state machine for processing tags, attributes, comments, and character data, along with form serialization methods (.serialize, .serializeArray)."}
{"file":"h0.js","beautified":"h0.beautified.js","chunk":{"id":"chunk-71/73","start_line":140001,"end_line":142000,"same_function_group":null},"findings":{"chrome_apis":[],"event_listeners":[],"messages":[],"storage":[],"endpoints":[],"dom":[],"dynamic_code":[],"wasm":[],"obfuscation_hints":["webpack_modules","minified_vars","object_property_chaining"],"risks":[]},"evidence":[{"file":"/Users/jfri/private/affiliateDetector/honey-versions/honey-17.1.1-bmnlcjabgnpnenekpadlanbbkooimhnj/h0.beautified.js","start":140001,"end":142000}],"notes":"This chunk is the core of the `htmlparser2` tree construction logic. It contains the state machine for handling tokens in different 'insertion modes' (e.g., IN_BODY, IN_TABLE, IN_HEAD). It manages the stack of open elements, the list of active formatting elements (for handling mis-nested tags), and implements complex HTML5 parsing concepts like 'foster parenting' for misplaced table content. This code is responsible for taking the token stream from the tokenizer and building the final DOM tree structure."}
{"file":"h0.js","beautified":"h0.beautified.js","chunk":{"id":"chunk-72/73","start_line":142001,"end_line":144000,"same_function_group":null},"findings":{"chrome_apis":[],"event_listeners":[],"messages":[],"storage":[],"endpoints":[],"dom":[],"dynamic_code":[],"wasm":[],"obfuscation_hints":["webpack_modules"],"risks":[]},"evidence":[{"file":"h0.beautified.js","start":142001,"end":144000}],"notes":"Continuation of the htmlparser2 library. This chunk contains the core of the TreeBuilder, which implements the HTML5 parsing algorithm's state machine for various insertion modes (IN_BODY, IN_TABLE, etc.). It handles token processing (onStartTag, onEndTag), DOM tree construction via a treeAdapter, error handling, active formatting elements, and foster parenting. It also includes the Tokenizer class (ds), a state machine for converting raw HTML into tokens and decoding entities."}
{"file":"h0.js","beautified":"h0.beautified.js","chunk":{"id":"chunk-73/73","start_line":144001,"end_line":144885,"same_function_group":null},"findings":{"chrome_apis":[],"event_listeners":[],"messages":[],"storage":[],"endpoints":[],"dom":[],"dynamic_code":[],"wasm":[],"obfuscation_hints":["webpack_modules"],"risks":[]},"evidence":[{"file":"h0.beautified.js","start":144001,"end":144885}],"notes":"This final chunk concludes the htmlparser2 library with the main Parser class (Ss), which orchestrates the tokenizer and callbacks. The majority of this chunk consists of a large number of JSON objects defining 'shapes' for DOM element detection on shopping sites. These shapes are named for their purpose (e.g., AddToCart, FSFinalPrice, FSPromoBox, PPPrice, PPSoldOut, PPTitle, PPVariantColor, PPVariantSize) and contain weighted rules for identifying specific page elements. The chunk also includes more polyfills for Object and Array methods."}
{"file":"h1-check.js","beautified":"h1-check.beautified.js","chunk":{"id":"chunk-1/28","start_line":1,"end_line":2000,"same_function_group":null},"findings":{"chrome_apis":[],"event_listeners":[],"messages":[],"storage":[],"endpoints":[{"url":"https://www.4wheelparts.com/cart/shoppingCart.jsp","method":"POST"},{"url":"https://www.ae.com/ugp-api/bag/v1/coupon","method":"POST"},{"url":"https://www.aeropostale.com/on/demandware.store/Sites-aeropostale-Site/en_US/Cart-AddCouponJson","method":"GET"},{"url":"https://www.amazon.com/gp/buy/spc/handlers/add-giftcard-promotion.html","method":"POST"},{"url":"https://secure-athleta.gap.com/shopping-bag-xapi/apply-bag-promo/","method":"POST"},{"url":"https://secure-bananarepublic.gap.com/shopping-bag-xapi/apply-bag-promo/","method":"POST"},{"url":"https://www.belk.com/on/demandware.store/Sites-Belk-Site/default/Coupon-Validate","method":"GET"},{"url":"https://www.buyagift.co.uk/Basket/ApplyDiscount","method":"GET"},{"url":"https://www.carid.com/cart.php","method":"POST"},{"url":"https://www.catherines.com/on/demandware.store/Sites-oss-Site/default/Cart-SubmitForm","method":"POST"},{"url":"https://shop.coles.com.au/wcs/resources/store/{storeId}/cart/@self/assigned_promotion_code","method":"POST"},{"url":"https://www.cvs.com/RETAGPV3/RxExpress/V2/applyCoupon","method":"POST"}],"dom":[{"method":"jQuery"}],"dynamic_code":[],"wasm":[],"obfuscation_hints":["webpack_modules"],"risks":[{"type":"tracking","severity":"medium","description":"Contains numerous site-specific DAC (Data Access Component) modules that make AJAX requests to apply coupons on various e-commerce sites. This involves tracking user's shopping cart and interacting with third-party websites."}]},"evidence":[{"file":"h1-check.js","start":1,"end":2000}],"notes":"This chunk contains the webpack bootstrap, the CoreRunner class definition, and a large number of site-specific DAC (Data Access Component) modules. These DACs define logic for applying coupons on e-commerce sites, including numerous hardcoded AJAX endpoints."}
{"file":"h1-check.js","beautified":"h1-check.beautified.js","chunk":{"id":"chunk-2/28","start_line":2001,"end_line":4000,"same_function_group":null},"findings":{"chrome_apis":[],"event_listeners":[],"messages":[],"storage":[],"endpoints":[{"url":"https://www.dsw.com/api/v1/coupons/claim","method":"POST"},{"url":"https://cdn.joinhoney.com/dummy-store/api/{code}.json","method":"GET"},{"url":"https://www.expedia.com/Checkout/applyCoupon","method":"POST"},{"url":"https://www.fitflop.com/us/en/cart/coupon","method":"POST"},{"url":"https://www.forever21.com/on/demandware.store/Sites-forever21-Site/en_US/Cart-AddCoupon","method":"POST"},{"url":"https://secure-www.gap.com/shopping-bag-xapi/apply-bag-promo/","method":"POST"},{"url":"https://www2.hm.com/en_ca/checkout/redeemVoucher","method":"POST"},{"url":"https://www.hammacher.com/shoppingcart/applypromocode","method":"POST"},{"url":"https://www.homedepot.com/mcc-checkout/v2/promo/add","method":"POST"},{"url":"https://order-api.jcpenney.com/order-api/v1/accounts/{accountId}/draft-order/adjustment/discounts","method":"POST"},{"url":"https://www.jcrew.com/checkout-api/graphql","method":"POST"},{"url":"https://www.kohls.com/cnc/applyCoupons","method":"POST"},{"url":"https://www.loft.com/cws/cart/claimCoupon.jsp","method":"POST"},{"url":"https://www.macys.com/my-bag/{guid}/promo","method":"PUT"},{"url":"https://www.officedepot.com/async/cart/addCoupon.do","method":"POST"},{"url":"https://secure-oldnavy.gap.com/shopping-bag-xapi/apply-bag-promo/","method":"POST"},{"url":"https://www.orbitz.com/Checkout/applyCoupon","method":"POST"},{"url":"https://www.papajohns.com/order/validate-promo","method":"GET"},{"url":"https://www.prettylittlething.fr/pltmobile/coupon/couponPost/","method":"POST"},{"url":"https://www.prettylittlething.com/pltmobile/coupon/couponPost/","method":"POST"},{"url":"https://www.puritan.com/shoppingcart/applyCoupon","method":"POST"},{"url":"https://www.saksfifthavenue.com/cart-coupon-add","method":"GET"},{"url":"https://www.sephora.com/api/shopping-cart/basket/promotions","method":"POST"},{"url":"https://{shopify_domain}/wallets/unstable/checkouts/{checkout_token}.json","method":"PATCH"},{"url":"https://www.shutterstock.com/papi/orders/{orderId}","method":"PATCH"}],"dom":[{"method":"jQuery"}],"dynamic_code":[],"wasm":[],"obfuscation_hints":["webpack_modules"],"risks":[{"type":"tracking","severity":"medium","description":"This chunk continues the pattern of site-specific DAC modules for coupon application, further expanding the list of tracked e-commerce sites."}]},"evidence":[{"file":"h1-check.js","start":2001,"end":4000}],"notes":"This chunk continues the DAC modules from the previous chunk. It adds support for many more stores, each with its own doDac function for applying coupons via AJAX. Stores include DSW, Expedia, Forever21, Gap, H&M, Home Depot, JCPenney, J-Crew, Kohl's, Macy's, Office Depot, Old Navy, Orbitz, Papa John's, Pretty Little Thing, Puritan's Pride, Saks, Sephora, Shopify, and Shutterstock."}
{"file":"h1-check.js","beautified":"h1-check.beautified.js","chunk":{"id":"chunk-3/28","start_line":4001,"end_line":6000,"same_function_group":null},"findings":{"chrome_apis":[],"event_listeners":[],"messages":[],"storage":[],"endpoints":[{"url":"https://www.staples.com/cc/api/checkout/default/coupon","method":"POST"},{"url":"https://tjmaxx.tjx.com/store/checkout/cart.jsp","method":"POST"},{"url":"https://www.vimeo.com/checkout","method":"POST"},{"url":"https://www.vitacost.com/Checkout/ShoppingCart.aspx","method":"POST"},{"url":"https://www.wish.com/api/promo-code/apply","method":"POST"},{"url":"https://www.worldmarket.com/on/demandware.store/Sites-World_Market-Site/en_US/Cart-ApplyCoupon","method":"GET"}],"dom":[{"method":"jQuery"}],"dynamic_code":[{"type":"custom_interpreter","details":"This chunk introduces the 'we' class, a custom JavaScript interpreter. It includes methods for stepping through an AST ('step', 'stepAsync'), managing scope ('createScope'), and marshalling data between the native environment and the interpreter's sandboxed environment ('nativeToPseudo', 'pseudoToNative')."}],"wasm":[],"obfuscation_hints":["webpack_modules","custom_interpreter"],"risks":[{"type":"remote_code","severity":"high","description":"Introduction of a custom JavaScript interpreter ('we' class) which can execute arbitrary code from an AST. This is a significant security risk as it can be used to bypass security restrictions and execute malicious code."}]},"evidence":[{"file":"h1-check.js","start":4001,"end":6000}],"notes":"This chunk finishes the DAC modules and introduces the 'we' class, a custom JavaScript interpreter. This is a major finding. The interpreter has methods for stepping through an AST, managing scope, and marshalling data. It also defines a large number of mixin functions for interacting with the DOM and browser APIs."}
{"file":"h1-check.js","beautified":"h1-check.beautified.js","chunk":{"id":"chunk-4/28","start_line":6001,"end_line":8000,"same_function_group":"we_interpreter"},"findings":{"chrome_apis":[],"event_listeners":[],"messages":[],"storage":["localStorage","sessionStorage"],"endpoints":[],"dom":["document.cookie","document.createEvent","window.location","window.getComputedStyle","element.getBoundingClientRect"],"dynamic_code":[],"wasm":[],"obfuscation_hints":["generated_apis","api_middleware"],"risks":[{"type":"remote_code","severity":"high","description":"Chunk contains the core implementation of a custom JavaScript interpreter ('we' class), including data marshalling (nativeToPseudo/pseudoToNative) and the creation of a sandboxed global environment with shimmed browser APIs (console, location, storage, jQuery, etc.). This confirms the capability to execute arbitrary, externally-defined logic.","evidence":[{"file":"h1-check.beautified.js","start":6001,"end":8000}]}]},"evidence":[{"file":"h1-check.beautified.js","start":6001,"end":8000}],"notes":"This chunk details the core machinery of the 'we' JavaScript interpreter, including its type system, data marshalling functions, scope management, and the initialization of a sandboxed global object populated with numerous shimmed browser and utility APIs like jQuery, request, and storage."}
{"file":"h1-check.js","beautified":"h1-check.beautified.js","chunk":{"id":"chunk-5/28","start_line":8001,"end_line":10000,"same_function_group":"we_interpreter"},"findings":{"chrome_apis":[],"event_listeners":[],"messages":[],"storage":[],"endpoints":[],"dom":[],"dynamic_code":[],"wasm":[],"obfuscation_hints":["api_client_patterns"],"risks":[]},"evidence":[{"file":"h1-check.beautified.js","start":8001,"end":10000}],"notes":"This chunk contains the definitions for the primitive types (Array, Boolean, Date, Error, Function, Number, Object, RegExp, String) used within the 'we' custom interpreter. Each definition shims the corresponding native JavaScript object, providing its methods and properties within the sandboxed environment. It also includes the main entry point for the interpreter library ('Vim' class) and parsers for handling encrypted/obfuscated data structures."}
{"file":"h1-check.js","beautified":"h1-check.beautified.js","chunk":{"id":"chunk-6/28","start_line":10001,"end_line":12000,"same_function_group":null},"findings":{"chrome_apis":[],"event_listeners":[],"messages":[],"storage":[],"endpoints":[],"dom":[],"dynamic_code":[],"wasm":[],"obfuscation_hints":["webpack_modules"],"risks":[],"third_party_libs":["cheerio","crypto-js"]},"evidence":[{"file":"h1-check.js","start":10001,"end":12000}],"notes":"This chunk contains bundled third-party libraries: Cheerio for DOM parsing/manipulation and CryptoJS for cryptographic operations (AES, Blowfish, MD5, HMAC, EvpKDF)."}
{"file":"h1-check.js","beautified":"h1-check.beautified.js","chunk":{"id":"chunk-7/28","start_line":12001,"end_line":14000,"same_function_group":null},"findings":{"chrome_apis":[],"event_listeners":[],"messages":[],"storage":[],"endpoints":[],"dom":[],"dynamic_code":[],"wasm":[],"obfuscation_hints":["webpack_modules"],"risks":[],"third_party_libs":["crypto-js","css-select"]},"evidence":[{"file":"h1-check.js","start":12001,"end":14000}],"notes":"This chunk continues the bundled third-party libraries. It includes the rest of CryptoJS (hashing algorithms, cipher modes, padding schemes, DES, TripleDES, RC4, Rabbit) and the 'css-select' library, a dependency of Cheerio."}
{"file":"h1-check.js","beautified":"h1-check.beautified.js","chunk":{"id":"chunk-8/28","start_line":14001,"end_line":16000,"same_function_group":null},"findings":{"chrome_apis":[],"event_listeners":[],"messages":[],"storage":[],"endpoints":[],"dom":[],"dynamic_code":[],"wasm":[],"obfuscation_hints":["webpack_modules"],"risks":[],"third_party_libs":["css-select","deepmerge","dom-serializer","domhandler","domutils","entities","rss-parser","escape-string-regexp","parse5"]},"evidence":[{"file":"h1-check.js","start":14001,"end":16000}],"notes":"This chunk is a dense collection of bundled libraries for HTML/XML processing. It includes modules from 'css-select' (pseudo-selectors, sub-selectors), 'domhandler' (DOM tree construction), 'domutils' (DOM traversal and manipulation), 'dom-serializer' (rendering DOM to string), 'entities' (HTML/XML entity encoding/decoding), 'rss-parser', 'deepmerge', 'escape-string-regexp', and parts of the 'parse5' HTML parser. This indicates a powerful capability to parse and manipulate web content."}
{"file":"h1-check.js","beautified":"h1-check.beautified.js","chunk":{"id":"chunk-9/28","start_line":16001,"end_line":18000,"same_function_group":null},"findings":{"chrome_apis":[],"event_listeners":[],"messages":[],"storage":[],"endpoints":[],"dom":[],"dynamic_code":[],"wasm":[],"obfuscation_hints":["webpack_modules"],"risks":[],"third_party_libs":["parse5"]},"evidence":[{"file":"h1-check.js","start":16001,"end":18000}],"notes":"This chunk contains the core parsing logic of the 'parse5' library. It defines constants for HTML (tag names, namespaces, attributes), data structures for the parsing stack (OpenElements, ActiveFormattingElements), and the main parsing algorithm state machine. This is a significant piece of infrastructure for spec-compliant HTML parsing."}
{"file":"h1-check.js","beautified":"h1-check.beautified.js","chunk":{"id":"chunk-10/28","start_line":18001,"end_line":20000,"same_function_group":null},"findings":{"chrome_apis":[],"event_listeners":[],"messages":[],"storage":[],"endpoints":[],"dom":[],"dynamic_code":[],"wasm":[],"obfuscation_hints":["webpack_modules"],"risks":[],"third_party_libs":["parse5"]},"evidence":[{"file":"h1-check.js","start":18001,"end":20000}],"notes":"This chunk continues the implementation of the 'parse5' library. It includes the detailed implementation of the 'OpenElements' stack, a 'Serializer' for converting the DOM back to a string, and the core 'Tokenizer' state machine. The tokenizer is responsible for consuming the HTML string character by character and emitting tokens (start tags, end tags, characters, etc.) for the tree builder."}
{"file":"h1-check.js","beautified":"h1-check.beautified.js","chunk":{"id":"chunk-11/28","start_line":20001,"end_line":22000,"same_function_group":null},"findings":{"chrome_apis":[],"event_listeners":[],"messages":[],"storage":[],"endpoints":[],"dom":[],"dynamic_code":[],"wasm":[],"obfuscation_hints":["Bundled Libraries"],"risks":[{"type":"other","severity":"low","justification":"The script bundles multiple powerful libraries (superagent for HTTP requests, CryptoJS for encryption, uuid for identifiers), giving it a wide range of capabilities that could be used for tracking or data exfiltration, although no direct evidence of malicious use is in this chunk."}],"third_party_libraries":["superagent", "uuid", "change-case", "crypto-js", "acorn", "ast-traverse"]},"evidence":[{"file":"h1-check.js","start":20001,"end":22000}],"notes":"This chunk contains a collection of bundled third-party libraries: superagent (HTTP client), uuid (unique ID generation), a custom error framework, case-conversion utilities, and extensive parts of CryptoJS, including an AST parser/encryptor."}
{"file":"h1-check.js","beautified":"h1-check.beautified.js","chunk":{"id":"chunk-12/28","start_line":22001,"end_line":24000,"same_function_group":null},"findings":{"chrome_apis":[],"event_listeners":[],"messages":[],"storage":[],"endpoints":[],"dom":[],"dynamic_code":[],"wasm":[],"obfuscation_hints":["Bundled Libraries"],"risks":[],"third_party_libraries":["crypto-js", "debug", "json-stable-stringify", "regenerator-runtime"]},"evidence":[{"file":"h1-check.js","start":22001,"end":24000}],"notes":"This chunk is a continuation of bundled libraries. It includes more of CryptoJS (MD5), the 'debug' library for namespaced logging, 'json-stable-stringify' for creating deterministic JSON strings, and 'regenerator-runtime' for transpiled async/await support."}
{"file":"h1-check.js","beautified":"h1-check.beautified.js","chunk":{"id":"chunk-13/28","start_line":24001,"end_line":26000,"same_function_group":null},"findings":{"chrome_apis":[],"event_listeners":[],"messages":[],"storage":[],"endpoints":[],"dom":[],"dynamic_code":["acorn"],"wasm":[],"obfuscation_hints":["Bundled Libraries"],"risks":[{"type":"remote_code","severity":"high","description":"Contains a full JavaScript parser (acorn), which can be used to analyze and manipulate JavaScript code on the page at runtime. This is a prerequisite for many advanced code injection or data exfiltration techniques."}],"third_party_libs":["acorn","regenerator-runtime"]},"evidence":[{"file":"h1-check.js","start":24001,"end":26000}],"notes":"This chunk contains the complete implementation of the 'acorn' JavaScript parser. This gives the extension the powerful ability to parse and inspect JavaScript code on any page it is injected into."}
{"file":"h1-check.js","beautified":"h1-check.beautified.js","chunk":{"id":"chunk-14/28","start_line":26001,"end_line":28000,"same_function_group":null},"findings":{"chrome_apis":[],"event_listeners":[],"messages":[],"storage":[],"endpoints":[],"dom":[],"dynamic_code":["VIM Generation Framework"],"wasm":[],"obfuscation_hints":["Bundled Libraries","Dynamic Code Generation"],"risks":[{"type":"remote_code","severity":"high","description":"Contains a sophisticated framework for generating and deploying web automation scripts (VIMs - Virtual Interaction Models). This includes dynamic code generation via templating, allowing for highly adaptable and site-specific code execution."}],"third_party_libs":[]},"evidence":[{"file":"h1-check.js","start":26001,"end":28000}],"notes":"This chunk contains a large, sophisticated framework for generating 'VIMs' (Virtual Interaction Models), which appear to be Honey's core web automation and data extraction scripts. It includes templates for various tasks (e.g., product fetching, page detection), a system for composing them from sub-vims, and mechanisms for dynamic, site-specific code generation."}
{"file":"h1-check.js","beautified":"h1-check.beautified.js","chunk":{"id":"chunk-15/28","start_line":28001,"end_line":30000,"same_function_group":null},"findings":{"chrome_apis":[],"event_listeners":[],"messages":[],"storage":[],"endpoints":[],"dom":[],"dynamic_code":[],"wasm":[],"obfuscation_hints":["generated_apis"],"risks":[{"type":"remote_code","severity":"high","description":"Contains a large library of pre-compiled, minified, and site-specific automation scripts (VIMs) stored as strings. These scripts are designed to be dynamically executed for scraping and interaction on numerous e-commerce sites like Amazon, Walmart, Target, BestBuy, and platforms like Wix and Temu. This represents a form of dynamic code execution tailored to specific websites."}],"notes":"This chunk defines a large object 'Ke' which acts as a repository for VIM (Virtual Interaction Model) templates. These are complete, minified JavaScript scripts stored as strings, designed for specific tasks on specific websites. Key VIMs include product fetchers, page detectors, and cart managers for major retailers."},"evidence":[{"file":"/Users/jfri/private/affiliateDetector/honey-versions/honey-17.1.1-bmnlcjabgnpnenekpadlanbbkooimhnj/h1-check.beautified.js","start":28406,"end":29990}]}
{"file":"h1-check.js","beautified":"h1-check.beautified.js","chunk":{"id":"chunk-16/28","start_line":30001,"end_line":32000,"same_function_group":null},"findings":{"chrome_apis":[],"event_listeners":[],"messages":[],"storage":[],"endpoints":[],"dom":[],"dynamic_code":[],"wasm":[],"obfuscation_hints":[],"risks":[],"notes":"This chunk contains a bundled version of the Bluebird.js promise library. This is identifiable by the copyright notice for Petka Antonov and the presence of Bluebird-specific functions and features like promise cancellation, long stack traces, and advanced debugging capabilities (`_isCancellable`, `longStackTraces`, `onPossiblyUnhandledRejection`). The library provides powerful tools for managing complex asynchronous operations."},"evidence":[{"file":"/Users/jfri/private/affiliateDetector/honey-versions/honey-17.1.1-bmnlcjabgnpnenekpadlanbbkooimhnj/h1-check.beautified.js","start":30001,"end":32000}]}
{"file":"h1-check.js","beautified":"h1-check.beautified.js","chunk":{"id":"chunk-17/28","start_line":32001,"end_line":34000,"same_function_group":null},"findings":{"chrome_apis":[],"event_listeners":[],"messages":[],"storage":[],"endpoints":[],"dom":[],"dynamic_code":[],"wasm":[],"obfuscation_hints":["webpack_modules"],"risks":[],"third_party_libs":[{"name":"bluebird","version":"3.7.2","evidence":[{"file":"h1-check.js","start":33550,"end":33550}]}]},"evidence":[{"file":"h1-check.js","start":32001,"end":34000}],"notes":"This chunk continues the bundled Bluebird.js promise library (v3.7.2). It includes the main Promise constructor and the implementation of its extensive API, such as .then, .catch, .promisify, .coroutine, .map, .reduce, .timers, and error handling. This confirms the extension uses a powerful asynchronous control flow engine."}
{"file":"h1-check.js","beautified":"h1-check.beautified.js","chunk":{"id":"chunk-18/28","start_line":34001,"end_line":36000,"same_function_group":null},"findings":{"chrome_apis":[],"event_listeners":[],"messages":[],"storage":[],"endpoints":[],"dom":[],"dynamic_code":[],"wasm":[],"obfuscation_hints":["webpack_modules"],"risks":[],"third_party_libs":[{"name":"bluebird","version":"3.7.2","evidence":[]},{"name":"buffer","version":null,"evidence":[{"file":"h1-check.js","start":34153,"end":34153}]},{"name":"debug","version":null,"evidence":[{"file":"h1-check.js","start":35312,"end":35312}]},{"name":"clone","version":null,"evidence":[{"file":"h1-check.js","start":34990,"end":34990}]},{"name":"case-anything","version":null,"evidence":[{"file":"h1-check.js","start":34884,"end":34884}]}]},"evidence":[{"file":"h1-check.js","start":34001,"end":36000}],"notes":"This chunk concludes the Bluebird.js library and introduces several new utility libraries. A significant portion is a polyfill for the Node.js `buffer` module, used for handling binary data. It also includes the `debug` library for namespaced logging, a `clone` utility for deep copying objects, and a `case-anything` library for string case conversion. This indicates a collection of common JavaScript utilities bundled for browser use."}
{"file":"h1-check.js","beautified":"h1-check.beautified.js","chunk":{"id":"chunk-19/28","start_line":36001,"end_line":38000,"same_function_group":null},"findings":{"chrome_apis":[],"event_listeners":[],"messages":[],"storage":[],"endpoints":[],"dom":[],"dynamic_code":[],"wasm":[],"obfuscation_hints":["webpack_modules"],"risks":[],"third_party_libs":["dom-serializer","domhandler","domutils","entities (html-entities, xml-entities)"]},"evidence":[],"notes":"This chunk contains a comprehensive, bundled HTML/XML parsing and serialization toolkit. Key libraries identified are: domhandler (for creating a DOM tree from a parser), domutils (for manipulating the DOM tree), dom-serializer (for converting the DOM tree back to a string), and a full-featured entities library for decoding/encoding HTML and XML character references. This indicates the extension performs sophisticated in-memory parsing of HTML content."}
{"file":"h1-check.js","beautified":"h1-check.beautified.js","chunk":{"id":"chunk-20/28","start_line":38001,"end_line":40000,"same_function_group":null},"findings":{"chrome_apis":[],"event_listeners":[],"messages":[],"storage":[],"endpoints":[],"dom":[],"dynamic_code":[],"wasm":[],"obfuscation_hints":["webpack_modules"],"risks":[],"third_party_libs":["htmlparser2","entities (continued)"]},"evidence":[],"notes":"This chunk continues the bundled libraries from the previous one. It includes the extensive data map for the 'entities' library, containing mappings for HTML character entities. More importantly, it contains the core of the 'htmlparser2' library, a forgiving and widely-used HTML/XML parser. The presence of this parser (`13084`) indicates a sophisticated capability to process raw HTML, build a DOM tree in memory, and handle complex parsing rules beyond simple DOM querying."}
{"file":"h1-check.js","beautified":"h1-check.beautified.js","chunk":{"id":"chunk-21/28","start_line":40001,"end_line":42000,"same_function_group":null},"findings":{"chrome_apis":[],"event_listeners":[],"messages":[],"storage":[],"endpoints":[],"dom":[],"dynamic_code":[],"wasm":[],"obfuscation_hints":["webpack_modules"],"risks":[],"third_party_libs":["htmlparser2/Tokenizer","jQuery v3.7.1"]},"evidence":[],"notes":"This chunk contains two major components. First, the continuation and core logic of the `htmlparser2/Tokenizer` class, which is the state machine responsible for the lexical analysis of HTML. Second, a fully bundled copy of jQuery v3.7.1. Bundling jQuery ensures the extension has a consistent and powerful DOM manipulation library on all pages, avoiding conflicts with site-native versions."}
{"file":"h1-check.js","beautified":"h1-check.beautified.js","chunk":{"id":"chunk-22/28","start_line":42001,"end_line":44000,"same_function_group":null},"findings":{"chrome_apis":[],"event_listeners":[],"messages":[],"storage":[],"endpoints":[],"dom":["DOM manipulation","event handling","ajax"],"dynamic_code":[],"wasm":[],"obfuscation_hints":["webpack_modules"],"risks":[],"third_party_libs":["jQuery v3.7.1 (continued)","long.js"]},"evidence":[],"notes":"This chunk is predominantly a continuation of the bundled jQuery v3.7.1 library. It includes core modules for event handling, DOM manipulation (like `clone`, `wrap`, `html`), CSS manipulation, and the powerful Ajax and Deferred/Promise APIs. It also contains a bundled copy of `long.js`, a library for representing and manipulating 64-bit integers, which is not a standard part of jQuery."}
{"file":"h1-check.js","beautified":"h1-check.beautified.js","chunk":{"id":"chunk-23/28","start_line":44001,"end_line":46000,"same_function_group":null},"findings":{"chrome_apis":[],"event_listeners":[],"messages":[],"storage":[],"endpoints":[],"dom":[],"dynamic_code":[],"wasm":[],"obfuscation_hints":["webpack_modules"],"risks":[],"third_party_libs":["long.js","ms","node-cache","nth-check","object-inspect","parse-srcset","postcss"]},"evidence":[{"file":"h1-check.beautified.js","start":44001,"end":46000}],"notes":"This chunk contains the conclusion of the 'long.js' library and introduces several new bundled libraries: 'ms' for time string conversion, 'node-cache' for in-memory caching, 'nth-check' for CSS nth-child parsing, 'object-inspect' for object logging, 'parse-srcset' for image srcset parsing, and a large portion of the PostCSS library for CSS parsing and manipulation."}
{"file":"h1-check.js","beautified":"h1-check.beautified.js","chunk":{"id":"chunk-24/28","start_line":46001,"end_line":48000,"same_function_group":null},"findings":{"chrome_apis":[],"event_listeners":[],"messages":[],"storage":[],"endpoints":[],"dom":[],"dynamic_code":[],"wasm":[],"obfuscation_hints":["webpack_modules"],"risks":[],"third_party_libs":["postcss","regexp-tree"]},"evidence":[{"file":"h1-check.beautified.js","start":46001,"end":48000}],"notes":"This chunk is dominated by the continuation of the PostCSS library and its dependencies. It also includes another significant library: 'regexp-tree', a full-featured regular expression parser, optimizer, and generator. This suggests the extension has advanced capabilities for manipulating and analyzing regular expressions."}
{"file":"h1-check.js","beautified":"h1-check.beautified.js","chunk":{"id":"chunk-25/28","start_line":48001,"end_line":50000,"same_function_group":null},"findings":{"chrome_apis":[],"event_listeners":[],"messages":[],"storage":[],"endpoints":[],"dom":[],"dynamic_code":[],"wasm":[],"obfuscation_hints":["generated_apis"],"risks":[]},"evidence":[{"file":"h1-check.beautified.js","start":48001,"end":50000}],"notes":"This chunk contains the continuation and conclusion of the 'regexp-tree' library. It includes the core NFA/DFA engine for regex execution, a comprehensive suite of optimization transforms (e.g., merging quantifiers, removing duplicates), and the table-driven parser for the regex grammar itself. This provides the extension with advanced capabilities to parse, optimize, and execute regular expressions dynamically."}
{"file":"h1-check.js","beautified":"h1-check.beautified.js","chunk":{"id":"chunk-26/28","start_line":50001,"end_line":52000,"same_function_group":null},"findings":{"chrome_apis":[],"event_listeners":[],"messages":[],"storage":[],"endpoints":[],"dom":[],"dynamic_code":[],"wasm":[],"obfuscation_hints":["generated_apis"],"risks":[]},"evidence":[{"file":"h1-check.beautified.js","start":50001,"end":52000}],"notes":"This chunk concludes the 'regexp-tree' library with its generated parser tables. It then introduces the 'safe-regex' library, which is used to detect potentially catastrophic exponential-time regular expressions (ReDoS). Finally, it begins the 'semver' library for parsing and comparing semantic version strings."}
{"file":"h1-check.js","beautified":"h1-check.beautified.js","chunk":{"id":"chunk-27/28","start_line":52001,"end_line":54000,"same_function_group":null},"findings":{"chrome_apis":[],"event_listeners":[],"messages":[],"storage":[],"endpoints":[],"dom":[],"dynamic_code":[],"wasm":[],"obfuscation_hints":["typescript_generated_helpers"],"risks":[],"libraries":["regexp-tree","safe-regex","tslib","url-parse"]},"evidence":[],"notes":"This chunk concludes the 'regexp-tree' library, including its parser runtime, Unicode property tables, and main API. It then introduces three new libraries: 'safe-regex' for detecting vulnerable regular expressions (ReDoS), 'tslib' (the TypeScript runtime helper library), and 'url-parse' for robust URL parsing and manipulation."}
{"file":"h1-check.js","beautified":"h1-check.beautified.js","chunk":{"id":"chunk-28/28","start_line":54001,"end_line":55418,"same_function_group":null},"findings":{"chrome_apis":[],"event_listeners":[],"messages":[],"storage":[],"endpoints"{"file":"h1-check.beautified.js","beautified":"h1-check.beautified.js","chunk":{"id":"chunk-28/28","start_line":54001,"end_line":55418,"same_function_group":null},"findings":{"chrome_apis":[],"event_listeners":[],"messages":[],"storage":[],"endpoints"{"file":"h1-check.beautified.js","beautified":"h1-check.beautified.js","cation and, most significantly, a large number of JSON objects that define models for web element detection (e.g., 'AddToCart', 'FSPromoBox', 'PPPrice'). The file ends with a large, pre-parsed JavaScript AST, likely for polyfills."}

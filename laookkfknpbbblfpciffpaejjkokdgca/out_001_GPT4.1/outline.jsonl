{"file":"serviceWorker.js","beautified":"serviceWorker.beautified.js","chunk":{"id":"chunk-1/3","start_line":1,"end_line":2000,"same_function_group":null},"findings":{"chrome_apis":["chrome.runtime","chrome.storage.local","chrome.tabs.query"],"event_listeners":["self.addEventListener('message')","self.addEventListener('error')"],"messages":[{"name":"runtime.onMessage","direction":"content->background","payload_keys":[]}],"storage":[{"key":"userPrefs","type":"local","op":"get"}],"endpoints":[{"url":"https://api.momentumdash.com/config","method":"GET"},{"url":"https://browser-http-intake.logs.datadoghq.com/v1/input/pub18ef9128dd80db1a80dfc3f9180b55b5","method":"POST"}],"dom":[],"dynamic_code":[],"wasm":[],"obfuscation_hints":["minified_vars","webpack_modules"],"risks":[{"type":"tracking","severity":"medium","description":"Sends extension and tab data to Datadog logging endpoint"},{"type":"pii_exfiltration","severity":"low","description":"Potential user/account data in config fetch"}]},"evidence":[{"file":"serviceWorker.js","start":1,"end":2000,"ast_id":null}],"notes":"Initializes service worker context, sets up IndexedDB, configures request/response logic, error logging, and configuration fetch."}
{"file":"serviceWorker.js","beautified":"serviceWorker.beautified.js","chunk":{"id":"chunk-2/3","start_line":2001,"end_line":4000,"same_function_group":null},"findings":{"chrome_apis":["chrome.alarms","chrome.notifications","chrome.runtime","chrome.tabs","chrome.action/browserAction"],"event_listeners":["self.addEventListener('fetch')","self.addEventListener('install')","self.addEventListener('activate')","self.addEventListener('error')","chrome.runtime.onMessage.addListener","chrome.alarms.onAlarm.addListener","chrome.notifications.onClicked.addListener","chrome.notifications.onButtonClicked.addListener","chrome.tabs.onRemoved.addListener","chrome.tabs.onUpdated.addListener"],"messages":[{"name":"notificationClick","direction":"background->tabs","payload_keys":[]},{"name":"flashMessage","direction":"background->tabs","payload_keys":[]},{"name":"legacyUserMigration","direction":"content->background","payload_keys":[]},{"name":"momentum:authState","direction":"content->background","payload_keys":[]},{"name":"momentum:checkUserId","direction":"content->background","payload_keys":[]},{"name":"momentum:getUserId","direction":"content->background","payload_keys":[]},{"name":"momentum:openNew","direction":"content->background","payload_keys":[]}],"storage":[{"key":"notificationsQueue","type":"indexeddb","op":"bulk"},{"key":"analyticsQueue","type":"indexeddb","op":"bulk"},{"key":"xhrQueue","type":"indexeddb","op":"bulk"},{"key":"idMap","type":"indexeddb","op":"bulk"},{"key":"timestamp","type":"indexeddb","op":"bulk"},{"key":"misc","type":"indexeddb","op":"bulk"},{"key":"installDate","type":"local","op":"set"},{"key":"releaseUpdateModalCheck","type":"local","op":"set"},{"key":"calculateUnregisteredDashboardExperiment","type":"local","op":"set"},{"key":"token","type":"localstorage","op":"set"},{"key":"token_uuid","type":"localstorage","op":"set"},{"key":"unregistered","type":"localstorage","op":"set"},{"key":"client_uuid","type":"localstorage","op":"set"},{"key":"momentum-customization-1","type":"localstorage","op":"get"}],"endpoints":[{"url":"https://api.momentumdash.com/","method":"GET/POST/PATCH/DELETE"},{"url":"https://browser-http-intake.logs.datadoghq.com/v1/input/pub18ef9128dd80db1a80dfc3f9180b55b5","method":"POST"},{"url":"https://modash.blob.core.windows.net/","method":"GET"},{"url":"https://posthog.momentumdash.com/e/","method":"POST"},{"url":"https://account.momentumdash.com/","method":"GET/POST"},{"url":"https://www.momentumdash.com/","method":"GET/POST"}],"dom":[],"dynamic_code":[],"wasm":[],"obfuscation_hints":["minified_vars","function_chains","api_client_patterns"],"risks":[{"type":"tracking","severity":"medium","description":"Analytics events batched and sent to remote endpoint (posthog)"},{"type":"pii_exfiltration","severity":"medium","description":"User/account migration and token handling"},{"type":"insecure_storage","severity":"low","description":"Tokens in localStorage"},{"type":"excessive_permissions","severity":"low","description":"Broad tab and notification access"}]},"evidence":[{"file":"serviceWorker.js","start":2001,"end":4000,"ast_id":null}],"notes":"Extensive IndexedDB and Dexie.js usage for request queue management, notification scheduling, analytics batching, Chrome event handling, and background messaging."}
{"file":"serviceWorker.js","beautified":"serviceWorker.beautified.js","chunk":{"id":"chunk-3/3","start_line":4001,"end_line":5360,"same_function_group":null},"findings":{"chrome_apis":["chrome.notifications","chrome.alarms","chrome.runtime","chrome.tabs","chrome.offscreen"],"event_listeners":["self.addEventListener('fetch')","self.addEventListener('install')","self.addEventListener('activate')","self.registration.addEventListener('updatefound')","chrome.runtime.onMessage.addListener","chrome.runtime.onInstalled.addListener","chrome.notifications.onClicked.addListener","chrome.notifications.onButtonClicked.addListener","chrome.alarms.onAlarm.addListener","chrome.tabs.onRemoved.addListener","chrome.tabs.onUpdated.addListener"],"messages":[{"name":"notificationClick","direction":"background->tabs","payload_keys":[]},{"name":"flashMessage","direction":"background->tabs","payload_keys":[]},{"name":"legacyUserMigration","direction":"content->background","payload_keys":[]},{"name":"momentum:authState","direction":"content->background","payload_keys":[]},{"name":"momentum:checkUserId","direction":"content->background","payload_keys":[]},{"name":"momentum:getUserId","direction":"content->background","payload_keys":[]},{"name":"momentum:openNew","direction":"content->background","payload_keys":[]}],"storage":[{"key":"notificationsQueue","type":"indexeddb","op":"bulk"},{"key":"analyticsQueue","type":"indexeddb","op":"bulk"},{"key":"xhrQueue","type":"indexeddb","op":"bulk"},{"key":"idMap","type":"indexeddb","op":"bulk"},{"key":"timestamp","type":"indexeddb","op":"bulk"},{"key":"misc","type":"indexeddb","op":"bulk"},{"key":"installDate","type":"local","op":"set"},{"key":"releaseUpdateModalCheck","type":"local","op":"set"},{"key":"calculateUnregisteredDashboardExperiment","type":"local","op":"set"},{"key":"token","type":"localstorage","op":"set"},{"key":"token_uuid","type":"localstorage","op":"set"},{"key":"unregistered","type":"localstorage","op":"set"},{"key":"client_uuid","type":"localstorage","op":"set"},{"key":"momentum-customization-1","type":"localstorage","op":"get"}],"endpoints":[{"url":"https://api.momentumdash.com/","method":"GET/POST/PATCH/DELETE"},{"url":"https://browser-http-intake.logs.datadoghq.com/v1/input/pub18ef9128dd80db1a80dfc3f9180b55b5","method":"POST"},{"url":"https://modash.blob.core.windows.net/","method":"GET"},{"url":"https://posthog.momentumdash.com/e/","method":"POST"},{"url":"https://account.momentumdash.com/","method":"GET/POST"},{"url":"https://www.momentumdash.com/","method":"GET/POST"}],"dom":[],"dynamic_code":[],"wasm":[],"obfuscation_hints":["minified_vars","function_chains","api_client_patterns"],"risks":[{"type":"tracking","severity":"medium","description":"Analytics events sent to remote endpoint (posthog)"},{"type":"pii_exfiltration","severity":"medium","description":"User/account migration and token handling"},{"type":"insecure_storage","severity":"low","description":"Tokens in localStorage"},{"type":"excessive_permissions","severity":"low","description":"Broad tab, notification, and offscreen access"}]},"evidence":[{"file":"serviceWorker.js","start":4001,"end":5360,"ast_id":null}],"notes":"Implements notification queue, alarm scheduling, tab event listeners, background fetch, analytics batching, offscreen document creation, and legacy user migration."}
{"file":"content-scripts/momoSiteInterop.js","beautified":null,"chunk":{"id":"whole-file","start_line":1,"end_line":54,"same_function_group":null},"findings":{"chrome_apis":["chrome.runtime.getURL","chrome.runtime.getManifest","chrome.runtime.sendMessage","chrome.extension.inIncognitoContext"],"event_listeners":["window.addEventListener('message')"],"messages":[{"name":"momentum:getUserId","direction":"content->background","payload_keys":[]},{"name":"momentum:oneTimeLogin","direction":"content->background","payload_keys":["payload","legacy","updateSenderTab"]},{"name":"momentum:authState","direction":"content->background","payload_keys":["type","payload"]},{"name":"momentum:checkUserId","direction":"content->background","payload_keys":["payload"]},{"name":"momentum:openNew","direction":"content->background","payload_keys":["type","payload"]}],"storage":[],"endpoints":[],"dom":[{"operation":"inject_hidden_input","targets":["document.body"],"lines":[4,14,18]}],"dynamic_code":[],"wasm":[],"obfuscation_hints":["minified_vars"],"risks":[]},"evidence":[{"file":"content-scripts/momoSiteInterop.js","start":1,"end":54,"ast_id":null}],"notes":"Initializes extension interop, injects platform/version, requests userId, sets up message passing for login, auth state, userId check, and opening new tabs."}
{"file":"content-scripts/siteBlocker.js","beautified":null,"chunk":{"id":"whole-file","start_line":1,"end_line":54,"same_function_group":null},"findings":{"chrome_apis":["chrome.runtime.getURL"],"event_listeners":["window.addEventListener('message')"],"messages":[{"name":"momentum-intervention:show","direction":"content->ui","payload_keys":[]},{"name":"momentum-intervention:dismiss","direction":"content->ui","payload_keys":[]}],"storage":[],"endpoints":[{"url":"chrome-extension://<id>/site-blocker.html?hostname=...&sitename=...&metatitle=...&documenttitle=...","method":"GET"}],"dom":[{"operation":"inject_dialog_iframe","targets":["document.body"],"lines":[8,36]},{"operation":"mutation_observer_dom_ready","targets":["document.body","document.head"],"lines":[48,53]}],"dynamic_code":[],"wasm":[],"obfuscation_hints":["minified_vars"],"risks":[]},"evidence":[{"file":"content-scripts/siteBlocker.js","start":1,"end":54,"ast_id":null}],"notes":"Injects shadow DOM dialog with iframe, passes site info, listens for show/dismiss messages, uses MutationObserver for DOM readiness."}

import{d as e}from"./DataSyncService-BIQVYvDv.js";import{u as a,e as t}from"./ViewState-CaQI4PuO.js";import{a as i,d as o}from"./index-B9SbLlJ5.js";import{F as s,A as n,f as r,a as c,b as d,c as u}from"./state-C7K8Oenp.js";import{s as l,r as g}from"./index-FW5FYBiS.js";import{g as y}from"./settings-ClOtDILp.js";import"./Logger-BTKFyPnc.js";import"./appZStack-Duidf5Sm.js";import"./style-cpFB66wV.js";import"./LocalStorageStoreSyncedItem-ClHii6kh.js";import"./PomodoroTimers-CqOVDo7T.js";import"./persistStore-C6CQfgEA.js";import"./reactiveCustomization-l1DAJU8W.js";const h=a("focusModeDash",{views:{[s.Idle]:{beforeLeave:async e=>{m.modal.hidden=!0,m.widgetManager.hideApps({layer:"focusMode"}),e===s.Transition.toString()?await i.delay(n):e===s.Focusing.toString()&&(m.widgetManager.addVueAppExemption(["focus-mode"],"focusMode"),i.delay(100).then((async()=>{l(),o.disableAppTransitions=!1,await i.delay(100),m.modal.hidden=!1})))},defaultView:!0},[s.Transition]:{beforeLeave:e=>{e===s.Focusing.toString()?i.delay(n).then((async()=>{l(),await i.delay(100),m.modal.hidden=!1})):e===s.Idle.toString()&&(g(),i.delay(n).then((async()=>{m.widgetManager.showApps({layer:"focusMode"}),await i.delay(100),m.modal.hidden=!1})))}},[s.Focusing]:{beforeLeave:e=>{g(),m.modal.hidden=!0,i.delay(n).then((()=>{e===s.Idle.toString()&&m.widgetManager.showApps({layer:"focusMode"})}))}},[s.Celebration]:{beforeLeave:()=>{i.delay(n).then((async()=>{m.widgetManager.showApps({layer:"focusMode"}),await i.delay(100),m.modal.hidden=!1}))}}}}),p=h(),b=t("focusMode",{extend:(a,t)=>e(t,{state:()=>({backgroundScale:1,backgroundBlurLayerOpacity:0,backgroundTransitionDuration:null,cancelButtonVisible:!1,cancelButtonTimeout:void 0}),getters:{currentFocusModeView:()=>p.activeViewId,currentlyFocusing(){return this.currentFocusModeView===s.Focusing.toString()},currentlyTransitioning(){return[s.Transition.toString(),s.Celebration.toString()].includes(this.currentFocusModeView)},backgroundBlurLayerVisible(){return this.currentFocusModeView!==s.Idle.toString()}},actions:{async startFocusModeWithCancelPeriod(){a.popupActive=!1,clearTimeout(this.cancelButtonTimeout),this.cancelButtonVisible=!0,await p.setActiveView(s.Transition),this.backgroundTransitionDuration=c+d,await i.doubleRaf(),this.setFocusingStyleVariables(),this.cancelButtonTimeout=setTimeout((()=>{this.cancelButtonVisible=!1}),c),await i.delay(c)},async finalizeStartFocusModeAfterCancelPeriod(){await i.delay(d),this.backgroundTransitionDuration=null},async celebrateFocusMode(){a.popupActive=!1,await p.setActiveView(s.Celebration);this.backgroundTransitionDuration=1500,await i.doubleRaf(),this.resetFocusingStyleVariables(),await i.delay(this.backgroundTransitionDuration),this.backgroundTransitionDuration=null,await i.delay(u-1500)},async stopFocusMode(){a.popupActive=!1,this.resetFocusingStyleVariables(),await p.setActiveView(s.Idle)},async cancelFocusModeStart(){this.backgroundTransitionDuration=n,await i.doubleRaf(),await this.stopFocusMode(),await i.delay(this.backgroundTransitionDuration),this.backgroundTransitionDuration=null},setFocusingStyleVariables(){this.backgroundScale=1.1;y().blurBackground&&(this.backgroundBlurLayerOpacity=1)},resetFocusingStyleVariables(){this.backgroundScale=1,this.backgroundBlurLayerOpacity=0},async resumeFocusModeAfterTabLoad(){await p.setActiveView(s.Focusing),this.setFocusingStyleVariables(),this.backgroundTransitionDuration=0}}})}),w=b();r.switchOverToWatchedStoreItem((()=>w.currentlyTransitioning));export{b as default,h as useFocusModeDashViewStateStore,b as useFocusModeViewStateStore};
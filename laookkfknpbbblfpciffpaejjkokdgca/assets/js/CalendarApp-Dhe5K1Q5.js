import e from"./AppView-Du2InOAV.js";import t from"./AppPopup-CBVX3XyQ.js";import n from"./AppHeader-DINik7Wl.js";import{A as a}from"./AppLoading-DWsYUtJy.js";import r from"./BaseIcon-CAXE-xBw.js";import{A as o}from"./AppEmpty-Rom0E1b_.js";import{useCalendarEventStore as s}from"./calendarEvents-B1EUEpyA.js";import{c as i}from"./accessToken-BQcp6xmY.js";import{I as p,aj as c,A as l,G as d,ak as u,al as v}from"./index-B9SbLlJ5.js";import{n as f}from"./_plugin-vue2_normalizer-DeUNqxFl.js";import"./ResizeSensor-ZXOsDHeC.js";import"./globalKeyEventManager-ByOI7Z15.js";import"./Logger-BTKFyPnc.js";import"./style-cpFB66wV.js";import"./AppHeaderControl-CYSrwe76.js";import"./constants-KuzCZNtH.js";import"./icon-close-DRlspKs3.js";import"./dynamic-import-helper-DIl3ayLm.js";import"./DataSyncService-BIQVYvDv.js";import"./index-BENmK416.js";import"./reactiveCustomization-l1DAJU8W.js";const y=p({name:"CalendarEvent",props:{event:{type:Object,required:!0}},setup:()=>({formatTime:c}),computed:{currentTime:()=>m.models.date.get("date").getTime(),eventTime(){return this.event.allDay?"All day":`${c(new Date(this.event.start)).toLowerCase()} - ${c(new Date(this.event.end)).toLowerCase()}`}}});const g=f({name:"CalendarApp",components:{AppLoading:a,AppHeader:n,AppView:e,AppPopup:t,BaseIcon:r,AppEmpty:o,CalendarGroup:f(p({name:"CalendarGroup",components:{CalendarEvent:f(y,(function(){var e=this,t=e._self._c;return e._self._setupProxy,t("div",{staticClass:"calendar-event",class:{ongoing:!e.event.allDay&&e.currentTime<e.event.end&&e.currentTime>e.event.start},attrs:{"data-test":"calendar-event"}},[t("div",{staticClass:"calendar-background",style:{backgroundColor:e.event.color}}),t("div",{staticClass:"right"},[t("div",{staticClass:"details"},[e._v(e._s(e.event.summary))]),t("div",{staticClass:"time"},[e._v(e._s(e.eventTime))])])])}),[],!1,null,"5a6d75de").exports},props:{events:{type:Array,required:!0},date:{type:String,required:!0}},methods:{openEvent(e){l.capture("calendar event click",{feature:"calendar"}),d(e.link)}}}),(function(){var e=this,t=e._self._c;return e._self._setupProxy,t("div",{staticClass:"calendar-group"},[t("span",{staticClass:"group-title"},[e._v(e._s(e.date))]),e._l(e.events,(function(n,a){return t("calendar-event",{key:`${n.id}-${a}`,attrs:{event:n},nativeOn:{click:function(t){return e.openEvent(n)}}})}))],2)}),[],!1,null,"9c6ef377").exports},inject:["viewStateStore"],setup:()=>({connectToGoogleCalendar:i,calendarEventStore:s()}),computed:{events(){const e={};return[0,1].forEach((t=>{const n=this.calendarEventStore.getEventsForDay(t);if(n.length){const t=new Date(n[0].start),a=`${u(t,!1)} ${v(t)}`;e[a]=n}})),e},noEvents(){return 0===Object.values(this.events).length}},methods:{closePopup(){this.viewStateStore.togglePopup(!1)}}},(function(){var e=this,t=e._self._c;return t("app-popup",{staticClass:"calendar-app",attrs:{region:"top-right",position:"bottom-left",focused:e.viewStateStore.focused},on:{close:function(t){return e.$emit("close")}},nativeOn:{click:function(t){return e.viewStateStore.focus()}}},[e.calendarEventStore.loading?t("app-loading"):t("app-view",{scopedSlots:e._u([{key:"header",fn:function(){return[t("app-header",{scopedSlots:e._u([{key:"left",fn:function(){return[t("base-icon",{staticClass:"app-header-icon",attrs:{src:"icon/apps/calendar",size:"16px"}}),t("span",{staticClass:"app-header-name"},[e._v("Upcoming events")])]},proxy:!0},{key:"right",fn:function(){return[e.calendarEventStore.staleDataWarningVisible?t("base-icon",{attrs:{src:"icon/info",title:"There was an issue getting your events. The data you see may not be up to date"}}):e._e()]},proxy:!0}])})]},proxy:!0},{key:"body",fn:function(){return[e.calendarEventStore.linked?e.noEvents?t("app-empty",{attrs:{description:"No events for today"}}):e._l(e.events,(function(e,n){return t("calendar-group",{key:n,staticClass:"calendar-event-group",attrs:{events:e,date:n}})})):t("app-empty",{attrs:{title:"Connect your calendar to see your next events","button-text":"Connect to Google Calendar","button-icon":"icon/google-calendar"},on:{buttonClick:function(t){return e.connectToGoogleCalendar("calendar app")}}})]},proxy:!0}])})],1)}),[],!1,null,null).exports;export{g as default};
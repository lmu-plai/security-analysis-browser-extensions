const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/js/countdowns-DgPkbMo-.js","assets/js/DataSyncService-BIQVYvDv.js","assets/js/index-B9SbLlJ5.js","assets/js/Logger-BTKFyPnc.js","assets/js/style-cpFB66wV.js","assets/css/style-CrTXrpPu.css","assets/js/errors-CZrPVA9A.js","assets/js/BaseMetric-ClLQP9bU.js","assets/js/compareObjects-R6Hcs7xe.js","assets/js/reactiveCustomization-l1DAJU8W.js","assets/js/pinia-4ulFHh2N.js","assets/js/metrics-BQKdARjt.js","assets/js/clocks-BKFIGann.js","assets/js/focusCollection-DYYTKeU_.js","assets/js/VueBase-BB-58KAg.js","assets/js/_commonjsHelpers-B3K3fdV-.js","assets/js/ClickOutside-DCLvi2fj.js","assets/js/portal-vue.esm-BlbL0ibK.js","assets/js/itemCollectionMixins-GExfg4D1.js","assets/js/addin-3Vi1deBB.js","assets/js/modal-DQlfZdMt.js","assets/js/enums-C0TfsRui.js","assets/js/settingsViewState-5xgdbrfZ.js","assets/js/ViewState-CaQI4PuO.js","assets/js/appZStack-Duidf5Sm.js","assets/js/tasksViewState-BBA-SwRl.js","assets/js/handlebarLoader-xbtIzd6B.js","assets/css/addin-BUIiiR2p.css","assets/js/linksViewState-BeUTz-Jr.js","assets/js/constants-Bt_TxKWw.js","assets/js/links-BiNnZQ-c.js","assets/js/tabsViewState-rvlCV9gK.js","assets/js/tabs-B5VFfqai.js","assets/js/promisifiedChrome-vGTrjPj6.js","assets/js/focusModeViewState-CobNuKLk.js","assets/js/state-C7K8Oenp.js","assets/js/LocalStorageStoreSyncedItem-ClHii6kh.js","assets/js/settings-ClOtDILp.js","assets/js/PomodoroTimers-CqOVDo7T.js","assets/js/persistStore-C6CQfgEA.js","assets/js/pomodoroCompleted-BqUMo7o_.js","assets/js/login-D3lslwtx.js","assets/js/authService-dK6ZN9yA.js","assets/js/auth-B1eW30AJ.js","assets/js/legacyUserMigration-BBmM2Q1F.js","assets/js/migrateLegacyUserMessageHandler-BMN9RYlR.js","assets/js/onboarding-DKrOugBj.js","assets/js/siteBlockerGroups-DVPsrCxl.js","assets/js/ErrorPulseInput-CkNsRuJq.js","assets/js/constants-3_GhJRHQ.js","assets/js/siteBlockerSession-BB87f6uu.js","assets/js/state-B00254AG.js","assets/js/soundsPlayer-B1taY-VQ.js","assets/js/state-CZKJFUky.js","assets/js/TabLeaderElection-Ci9XU4di.js","assets/js/IframeMessenger-UV6odLhO.js","assets/js/soundsViewState-B21mWyqZ.js"])))=>i.map(i=>d[i]);
import{A as t,d as e,M as a,C as s,V as o,B as i}from"./state-C7K8Oenp.js";import{M as n,d as r}from"./DataSyncService-BIQVYvDv.js";import{_ as c}from"./style-cpFB66wV.js";import{u as d,a as u,w as l}from"./index-B9SbLlJ5.js";import{T as p}from"./PomodoroTimers-CqOVDo7T.js";import{p as _}from"./persistStore-C6CQfgEA.js";import{a as f}from"./settings-ClOtDILp.js";const w={countdowns:()=>h(c((()=>import("./countdowns-DgPkbMo-.js").then((t=>t.c))),__vite__mapDeps([0,1,2,3,4,5,6,7,8,9,10]))),metrics:()=>h(c((()=>import("./metrics-BQKdARjt.js").then((t=>t.m))),__vite__mapDeps([11,1,2,3,4,5,6,7,8,9,10]))),clocks:()=>h(c((()=>import("./clocks-BKFIGann.js").then((t=>t.c))),__vite__mapDeps([12,1,2,3,4,5,6,7,9,8,10]))),focus:()=>h(c((()=>import("./focusCollection-DYYTKeU_.js")),__vite__mapDeps([13,14,2,3,4,5,15,16,10,1,17,18,9,19,20,21,22,23,24,25,26,27]))),linksViewStateStore:()=>h(c((()=>import("./linksViewState-BeUTz-Jr.js")),__vite__mapDeps([28,23,1,2,3,4,5,24,29]))),linksStore:()=>h(c((()=>import("./links-BiNnZQ-c.js").then((t=>t.l))),__vite__mapDeps([30,1,2,3,4,5,29,8,10]))),tabsViewStateStore:()=>h(c((()=>import("./tabsViewState-rvlCV9gK.js")),__vite__mapDeps([31,23,1,2,3,4,5,24]))),tabsStore:()=>h(c((()=>import("./tabs-B5VFfqai.js").then((t=>t.t))),__vite__mapDeps([32,1,2,3,4,5,33,20,21]))),focusModeViewStateStore:()=>h(c((()=>import("./focusModeViewState-CobNuKLk.js")),__vite__mapDeps([34,1,2,3,4,5,23,24,35,36,37,9,38,39]))),focusModeSessionStore:()=>h(c((()=>Promise.resolve().then((()=>I))),void 0))};async function h(t){return(await t).default}const y={pomodoro:{enable:async()=>{m.trigger("centerBelow:show",!1);const e=(await c((async()=>{const{default:t}=await import("./pomodoroCompleted-BqUMo7o_.js").then((t=>t.b));return{default:t}}),__vite__mapDeps([40,1,2,3,4,5,39,35,36,38,9,33,41,42,43,44,21,45,46,20]))).default();return await d((()=>e.loaded)).toBe(!0),e.playing||await e.switchTo(p.Focus),u.delay(t).then((async()=>{m.trigger("pomodoro:focusPromptIfFocusEmpty"),await u.delay(t),m.trigger("pomodoro:focusPromptIfFocusEmpty")})),!0},disable:async()=>{const t=(await c((async()=>{const{default:t}=await import("./pomodoroCompleted-BqUMo7o_.js").then((t=>t.b));return{default:t}}),__vite__mapDeps([40,1,2,3,4,5,39,35,36,38,9,33,41,42,43,44,21,45,46,20]))).default();await d((()=>t.loaded)).toBe(!0),await t.complete({switchAfterComplete:!1,completedManually:!0,playSounds:!1}),t.countDownTimerLength&&(t.countDownTimerLength=null)}},siteBlocker:{enable:async t=>{const e=(await c((async()=>{const{default:t}=await import("./siteBlockerGroups-DVPsrCxl.js").then((t=>t.b));return{default:t}}),__vite__mapDeps([47,1,2,3,4,5,48,49,8]))).default(),a=(await c((async()=>{const{default:t}=await import("./siteBlockerGroups-DVPsrCxl.js").then((t=>t.s));return{default:t}}),__vite__mapDeps([47,1,2,3,4,5,48,49,8]))).default();e.refresh(),a.refresh();const s=(await c((async()=>{const{default:t}=await import("./siteBlockerSession-BB87f6uu.js");return{default:t}}),__vite__mapDeps([50,1,2,3,4,5,47,48,49,8,33,35,36,34,23,24,37,9,38,39,40,41,42,43,44,21,45,46,20,51]))).default();void 0===t&&s.startGracePeriod()},shouldEnableOnResume:()=>!0,shouldRemoveDataOnSettingsChangeWhileFocusing:!1,get unsupported(){return u.isPwa()}},soundscapes:{enable:async()=>{var t;const e=(await c((async()=>{const{default:t}=await import("./soundsPlayer-B1taY-VQ.js").then((t=>t.s));return{default:t}}),__vite__mapDeps([52,39,2,3,4,5,1,53,36,54,35,34,23,24,37,9,38,40,33,41,42,43,44,21,45,46,20,55,56]))).default();return e.refresh(),{id:null==(t=e.activeItem)?void 0:t.id,paused:e.paused}},disable:async({enableResult:t,focusing:e})=>{if(e||!t)return;const a=t,s=(await c((async()=>{const{default:t}=await import("./soundsPlayer-B1taY-VQ.js").then((t=>t.s));return{default:t}}),__vite__mapDeps([52,39,2,3,4,5,1,53,36,54,35,34,23,24,37,9,38,40,33,41,42,43,44,21,45,46,20,55,56]))).default();if(a.id&&!a.paused)s.play(a.id);else if(a.id){const t=s.getItem(a.id);if(!t)return;s.update({activeItem:t,paused:!0})}},shouldEnableOnResume:()=>!0},tabStash:{disable:async({enableResult:t,inactive:e})=>{var a;if(e)return;const s=(await w.tabsStore())();if(s.loaded&&!s.loading||(await new Promise((t=>{l((()=>s.loaded),t),s.loading||s.refresh()})),await u.delay(1e3)),m.conditionalFeatures.featureEnabled("plus")||m.conditionalFeatures.featureEnabled("tab-stash-degraded")||(t=null==(a=s.getItems[0])?void 0:a.id),"string"==typeof t){const e=s.getItemById(t);e&&await s.restoreSession(e)}},get unsupported(){return u.isSafari()||u.isPwa()}}},g=["siteBlocker","soundscapes","tabStash"];let A;const E=_((({loadedRef:t,updateAsync:e})=>r("focusModeSession",{state:()=>({start:1,stop:1,appActivationData:{},capacityLimitInfo:{msUsed:0,date:u.getDateOnly(new Date)},lastInteraction:Date.now(),totalTimeFocused:0}),getters:{focusModeActive:t=>!t.stop,loaded:()=>t.value,capacityLimitInfoForToday(){const t=this.capacityLimitInfo,e=m.models.date.get("date"),a=u.getDateOnly(e);return t.date!==a?{date:a,msUsed:0}:t},msUntilOverCapacityLimit(){const t=s,e=this.capacityLimitInfoForToday.msUsed,a=m.models.date.get("seconds").getTime();return t-(e+(this.focusModeActive?a-this.start:0))},isOverCapacityLimit(){return this.msUntilOverCapacityLimit<=0},shouldAutoDisable(){const t=m.models.date.get("date").getTime();return this.focusModeActive&&this.lastInteraction<t-a},totalTimeFocusedIncludingCurrentSession(){const t=m.models.date.get("date").getTime();let e=this.totalTimeFocused;return this.focusModeActive&&(e+=t-this.start),Math.max(e,0)}},actions:{async update(t){await e(t)},async stopAndSaveFocusMode(){const t=this.capacityLimitInfoForToday,e=Date.now(),a=e-this.start;t.msUsed+=a,0!==u.nightsBetween(new Date(e),new Date(this.start))&&t.msUsed>u.MS_IN_1_HOUR&&(t.msUsed=0);const s=this.totalTimeFocused+a;await this.update({stop:e,capacityLimitInfo:t,totalTimeFocused:s,appActivationData:{}}),this.refreshLastInteraction({debounceTime:0})},async startAndSaveFocusMode(t){const e=this.capacityLimitInfoForToday;await this.update({start:Date.now(),stop:null,appActivationData:t,capacityLimitInfo:e}),this.refreshLastInteraction({debounceTime:0})},refreshLastInteraction({debounceTime:t=3e3}={}){this.focusModeActive&&(clearTimeout(A),A=window.setTimeout((()=>{this.update({lastInteraction:Date.now()})}),t))},async disableAppsBeforeStop(t){var e;for(const a of g){const s=y[a];s.unsupported||await(null==(e=s.disable)?void 0:e.call(s,{enableResult:this.appActivationData[a],inactive:t}))}}}})),{mode:n.Cache,syncAutomatically:!0});(async()=>{const t=E();await d((()=>t.loaded)).toBe(!0),e.switchOverToWatchedStoreItem((()=>t.focusModeActive))})();const I=Object.freeze(Object.defineProperty({__proto__:null,default:E,useFocusModeSessionStore:E},Symbol.toStringTag,{value:"Module"})),T=async(t,e,a)=>{const s=f().focusModeSettings;s.apps[t]||(s.apps[t]={enabled:!1}),s.apps[t][e]=a,f().focusModeSettings=s,E().focusModeActive&&"enabled"===e&&await(async(t,e)=>{var a,s,o,i;const n=E(),r=n.appActivationData||{};if(e){const e=await(null==(s=(a=y[t]).enable)?void 0:s.call(a,{enableResult:r[t]}));if(null==e)return;r[t]=e}else await(null==(i=(o=y[t]).disable)?void 0:i.call(o,{enableResult:r[t],focusing:!0})),(y[t].shouldRemoveDataOnSettingsChangeWhileFocusing??1)&&delete r[t];await n.update({appActivationData:r})})(t,a)},b=()=>{m.widgetManager.addVueAppExemption(o,"focusMode"),m.widgetManager.addAppExemption(i,"focusMode")},v=()=>{m.widgetManager.hideApps({layer:"focusMode"}),m.widgetManager.removeVueAppExemption(o,"focusMode"),m.widgetManager.removeAppExemption(i,"focusMode")};export{y as a,T as b,I as f,w as i,v as r,b as s,E as u};
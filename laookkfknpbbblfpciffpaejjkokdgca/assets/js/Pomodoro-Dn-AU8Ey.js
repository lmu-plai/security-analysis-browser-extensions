import{I as o,a3 as t,r as e,aq as s,u as i,a as r,n,aw as a,D as c,A as d,aG as p,aH as u,g as l}from"./index-B9SbLlJ5.js";import{u as h,P as f,m as S,T as v,p as w}from"./pomodoroCompleted-BqUMo7o_.js";import g from"./pomodoro-circle-CecfhCBZ.js";import{n as y}from"./_plugin-vue2_normalizer-DeUNqxFl.js";import C from"./focusCollection-DYYTKeU_.js";import{M as b}from"./MobileBlur-B2s9dLKD.js";import{u as _}from"./useAllComponentsMounted-jOG8AT3X.js";import{f as x}from"./flashMessageMixin-UHXyaNjE.js";import{e as k}from"./constants-3_GhJRHQ.js";import{T}from"./index-DQnUe-E8.js";import{D as P}from"./DashCheckbox-BpmKbzA6.js";import{B as j}from"./BaseDropdown-DNbKWQaF.js";import{B as F}from"./BaseDropdownOption-NzB_bdFk.js";import D from"./BaseIcon-CAXE-xBw.js";import{g as B}from"./focusFlashMessageHelpers-C5O7ePro.js";import{persistent as M}from"./reactiveCustomization-l1DAJU8W.js";import{T as I,a as A}from"./PomodoroTimers-CqOVDo7T.js";import{S as N}from"./SmoothReflow-CN2CnQb0.js";import{T as z}from"./TabLeaderElection-Ci9XU4di.js";import{w as O}from"./login-D3lslwtx.js";import{B as E}from"./BaseDropdownDivider-Bay0Demn.js";import{T as R}from"./ToggleSwitch-DSwcb4Go.js";import{I as L}from"./InlineNumberInput-Ctaj9nRe.js";import $ from"./AppHeader-DINik7Wl.js";import{d as U}from"./state-C7K8Oenp.js";import{C as V,a as H,c as q,b as W}from"./ClockSwitcherDropdown-D5aU13ja.js";import{s as G}from"./showAnyway-Bb-tkUYJ.js";import{e as Q}from"./DataSyncService-BIQVYvDv.js";import"./Logger-BTKFyPnc.js";import"./style-cpFB66wV.js";import"./persistStore-C6CQfgEA.js";import"./promisifiedChrome-vGTrjPj6.js";import"./LocalStorageStoreSyncedItem-ClHii6kh.js";import"./modal-DQlfZdMt.js";import"./enums-C0TfsRui.js";import"./VueBase-BB-58KAg.js";import"./_commonjsHelpers-B3K3fdV-.js";import"./ClickOutside-DCLvi2fj.js";import"./pinia-4ulFHh2N.js";import"./portal-vue.esm-BlbL0ibK.js";import"./itemCollectionMixins-GExfg4D1.js";import"./addin-3Vi1deBB.js";import"./settingsViewState-5xgdbrfZ.js";import"./ViewState-CaQI4PuO.js";import"./appZStack-Duidf5Sm.js";import"./tasksViewState-BBA-SwRl.js";import"./handlebarLoader-xbtIzd6B.js";import"./localStorage-B4mFdj8F.js";import"./legacyUserMigration-BBmM2Q1F.js";import"./migrateLegacyUserMessageHandler-BMN9RYlR.js";import"./auth-B1eW30AJ.js";import"./embeddedApp-K-x6feEl.js";import"./experiments-CUd_VD1Q.js";import"./flashMessageQueue-swNUH1jF.js";import"./info-DdD9a7JK.js";import"./constants-Bt_TxKWw.js";import"./dynamic-import-helper-DIl3ayLm.js";import"./index-CDlxyr_L.js";import"./ResizeSensor-ZXOsDHeC.js";import"./modal-CUt-4jrz.js";import"./BaseDropdownContent-BfXd6hD-.js";import"./constants-CALDQiUE.js";import"./index-CbkRD371.js";import"./icon-ellipsis-D7nTOXaQ.js";import"./icon-confetti-BvRSomF2.js";import"./authService-dK6ZN9yA.js";import"./onboarding-DKrOugBj.js";import"./AppHeaderControl-CYSrwe76.js";import"./constants-KuzCZNtH.js";import"./icon-close-DRlspKs3.js";import"./BaseDropdownText-CSYTEDLS.js";import"./switch-1q_g_nt5.js";const Z=o({name:"PomodoroCircle",setup:()=>({pomodoroSessionStore:h()}),computed:{dashProgress(){const o=this.pomodoroSessionStore.totalLength;return Math.min(this.pomodoroSessionStore.timeRemaining,o)/o*212+"%"}}}),K=()=>{t(((o,t)=>({"80ec6478":o.dashProgress})))},X=Z.setup;Z.setup=X?(o,t)=>(K(),X(o,t)):K;const Y=y(Z,(function(){var o=this._self._c;return this._self._setupProxy,o("div",{staticClass:"pomodoro-circle",attrs:{"data-test":"pomodoro-circle"}},[o("div",{staticClass:"circle-inner hide-apps-fade-children"},[o("div",{staticClass:"circle-background"}),o("div",{staticClass:"circle-foreground"}),o("inline-svg",{staticClass:"circle-svg",attrs:{src:g}})],1)])}),[],!1,null,"b4e6236a").exports;const J=y(o({name:"PomodoroTimer",props:{hours:{type:Number,required:!0},minutes:{type:String,required:!0},seconds:{type:String,required:!0},hideSeconds:{type:Boolean,required:!0}}}),(function(){var o=this,t=o._self._c;return o._self._setupProxy,t("div",{staticClass:"pomodoro-timer",attrs:{"data-test":"timer"}},[o.hideSeconds?t("div",{staticClass:"calm-timer"},[0!==o.hours?t("span",[o._v(o._s(o.hours)+"h ")]):o._e(),o._v(o._s(o.minutes)+"m ")]):t("div",{staticClass:"timer",class:{"has-hours":0!==o.hours,"slim-minutes":0===o.hours&&1===o.minutes.length}},[0!==o.hours?[t("span",{staticClass:"hours",attrs:{"data-test":"hours"}},[o._v(o._s(o.hours))]),t("span",{staticClass:"colon"},[o._v(":")])]:o._e(),t("span",{staticClass:"minutes",attrs:{"data-test":"minutes"}},[o._v(o._s(o.minutes))]),t("span",{staticClass:"colon"},[o._v(":")]),t("span",{staticClass:"seconds",attrs:{"data-test":"seconds"}},[o._v(o._s(o.seconds))])],2)])}),[],!1,null,"752acc84").exports,oo=o({name:"PomodoroFocus",components:{ThreeColLayout:T,DashCheckbox:P,BaseDropdown:j,BaseDropdownOption:F,BaseIcon:D},mixins:[x],props:{textOverride:{type:String,default:""}},setup:()=>({..._(),vMobileBlur:b,debounceSaveFn:()=>{},prompt:e(),fontSizer:e(),hiddenData:e(),dropdown:e()}),data:()=>({fontSizeScale:1,focusText:"",maskVisible:!1}),computed:{inputPlaceholder:()=>"I will focus on...",activeFocus:()=>C.activeFocus,collectionReady:()=>C.loaded,displayedFocus(){return this.textOverride||this.focusText||this.inputPlaceholder},autoFocus:()=>M.autoFocus},watch:{displayedFocus:{handler:"onFocusChange"},"activeFocus.focus"(o){this.focusText!==o&&(this.focusText=o)}},async mounted(){this.debounceSaveFn=s(this.save,1e3),await i((()=>this.collectionReady)).toBe(!0),this.focusText=this.activeFocus.focus,m.on("pomodoro:focusPromptIfFocusEmpty",this.focusPromptIfFocusEmpty),this.onFocusChange()},destroyed(){m.off("pomodoro:focusPromptIfFocusEmpty",this.focusPromptIfFocusEmpty)},methods:{async save(){if(this.activeFocus.focus!==this.focusText){if(!this.focusText.trim().length)return this.archive(!0);this.activeFocus.copyProperties(),C.emptyFocus&&(this.activeFocus.editProps.forDate=r.getDateString()),this.activeFocus.editProps.focus=this.focusText.trim(),await C.save().catch(console.error)}},async onFocusChange(){var o;localStorage.setItem(k,this.focusText||""),await r.doubleRaf();const t=null==(o=this.fontSizer)?void 0:o.clientWidth;this.fontSizeScale=!t||t<=125?1:t>=200?.62:1-(t-125)/75*.38,await r.doubleRaf(),t&&this.prompt&&this.hiddenData&&(this.maskVisible=this.hiddenData.offsetWidth>this.prompt.clientWidth),m.trigger("focus-content:updated")},complete(){C.toggleComplete(),this.activeFocus.completed&&this.showFlashMessage(B())},archive(o){var t;C.archive(o),this.focusText="",null==(t=this.dropdown)||t.closeDropdown()},toggleAutofocus(){var o;m.commandManager.execute("todo.toggle.autofocus",null,{sourceApp:"Focus",eventSource:"focus"}),null==(o=this.dropdown)||o.closeDropdown()},createNewFocus(){this.archive(),this.focusPrompt()},focusPromptIfFocusEmpty(){this.focusText||this.focusPrompt()},focusPrompt(){var o;null==(o=this.dropdown)||o.closeDropdown(),n((()=>{var o;return null==(o=this.prompt)?void 0:o.focus()}))},blurPrompt(){var o;null==(o=this.prompt)||o.blur()}}}),to=()=>{t(((o,t)=>({"3452cb50":o.fontSizeScale})))},eo=oo.setup;oo.setup=eo?(o,t)=>(to(),eo(o,t)):to;const so=y(oo,(function(){var o,t=this,e=t._self._c;return t._self._setupProxy,e("div",{staticClass:"pomodoro-focus dark",attrs:{"data-test":"focus"}},[e("transition",{attrs:{name:"fade",mode:"out-in"},on:{"after-enter":t.onFocusChange}},[t.collectionReady?e("three-col-layout",{key:null==(o=t.activeFocus)?void 0:o.todoId,staticClass:"focus-grid",scopedSlots:t._u([{key:"left",fn:function(){return[t.focusText&&!t.textOverride?e("dash-checkbox",{attrs:{"data-test":"complete",value:!!t.activeFocus.completed},on:{input:t.complete}}):t._e()]},proxy:!0},{key:"center",fn:function(){return[e("div",{staticClass:"prompt",class:{done:t.activeFocus.completed&&t.focusText&&!t.textOverride},attrs:{"data-test":"focus-active"}},[t.textOverride?e("div",[t._v(t._s(t.textOverride))]):[e("span",{ref:"hiddenData",staticClass:"hidden-data"},[t._v(t._s(t.focusText||t.inputPlaceholder))]),e("input",{directives:[{name:"model",rawName:"v-model",value:t.focusText,expression:"focusText"}],ref:"prompt",staticClass:"focus-input",class:{"mask-visible":t.maskVisible},attrs:{type:"text",placeholder:t.inputPlaceholder,"data-test":"focus-input",autocomplete:"off"},domProps:{value:t.focusText},on:{input:[function(o){o.target.composing||(t.focusText=o.target.value)},t.debounceSaveFn],keyup:function(o){return!o.type.indexOf("key")&&t._k(o.keyCode,"enter",13,o.key,"Enter")&&t._k(o.keyCode,"escape",void 0,o.key,void 0)?null:(o.stopPropagation(),t.blurPrompt.apply(null,arguments))}}})]],2)]},proxy:!0},{key:"right",fn:function(){return[t.textOverride?t._e():e("base-dropdown",{ref:"dropdown",attrs:{"data-test":"more-toggle"}},[t.focusText&&!t.activeFocus.completed?e("base-dropdown-option",{attrs:{"data-test":"edit"},on:{click:t.focusPrompt}},[e("base-icon",{attrs:{src:"icon-edit"}}),e("span",{staticClass:"text"},[t._v("Edit")])],1):t._e(),t.focusText?e("base-dropdown-option",{attrs:{"data-test":"clear"},on:{click:t.archive}},[e("div",{staticClass:"smaller-size-icon"},[e("base-icon",{attrs:{src:"icon-close",size:"10px"}})],1),e("span",{staticClass:"text"},[t._v("Clear")])]):t._e(),!t.focusText||t.activeFocus.completed?e("base-dropdown-option",{attrs:{"data-test":"new"},on:{click:t.createNewFocus}},[e("div",{staticClass:"smaller-size-icon"},[e("base-icon",{attrs:{src:"icon-plus",size:"11px"}})],1),e("span",{staticClass:"text"},[t._v("New focus task")])]):t._e(),e("base-dropdown-option",{attrs:{"data-test":"autofocus"},on:{click:t.toggleAutofocus}},[e("div",{staticClass:"smaller-size-icon"},[e("base-icon",{attrs:{src:"icon-play",size:"9px"}})],1),e("span",{staticClass:"text"},[t._v("Turn "+t._s(t.autoFocus?"off":"on")+" Top task in center")])])],1)]},proxy:!0}],null,!1,3429405482)}):t._e()],1),e("div",{staticClass:"fix-height"},[t._v("Â ")]),e("div",{ref:"fontSizer",staticClass:"font-sizer"},[t._v(t._s(t.displayedFocus))])],1)}),[],!1,null,"e5547521").exports;const io=y(o({name:"PomodoroButtons",components:{SmoothReflow:N,BaseIcon:D},props:{extendFocusVisible:{type:Boolean,required:!0},timeRemaining:{type:Number,required:!0},pomodoroButtonState:{type:Number,required:!0}},setup:()=>({pomodoroSessionStore:h(),TimerId:I}),computed:{mainButtonIcon(){if(this.pomodoroButtonState===f.Play)return"icon/soundscapes-variant";if(this.pomodoroButtonState===f.Pause)return"icon/pause";throw new Error("no icon for button :"+this.pomodoroButtonState)}},mounted(){m.on("globalEvent:spacebar",this.toggleMasterPlayPause)},destroyed(){m.off("globalEvent:spacebar",this.toggleMasterPlayPause)},methods:{resume(){this.pomodoroSessionStore.resume({playSounds:!0})},pause(){this.pomodoroSessionStore.pause({playSounds:!0})},toggleMasterPlayPause(){this.pomodoroSessionStore.playing?this.pause():this.resume()},switchToWithSounds(o){return this.pomodoroSessionStore.switchTo(o,{playSounds:!0})}}}),(function(){var o=this,t=o._self._c;return o._self._setupProxy,t("div",{staticClass:"pomodoro-buttons dark"},[t("smooth-reflow",{attrs:{width:!0,height:!1,transition:"smooth-width-fade"}},[o.extendFocusVisible?t("div",{staticClass:"button dash-button blurred u--mobile-hide hide-apps-fade",attrs:{"data-test":"extend-focus-button"},on:{click:function(t){return o.switchToWithSounds(o.TimerId.FocusPlusTen)}}},[t("span",[o._v("Focus + 10 min")])]):o._e()]),t("div",{staticClass:"button dash-button blurred hide-apps-fade",attrs:{"data-test":"start-stop-button","data-button-state":o.pomodoroButtonState},on:{click:o.toggleMasterPlayPause}},[t("base-icon",{attrs:{size:"30px",src:o.mainButtonIcon}})],1)],1)}),[],!1,null,"0d7d6c3a").exports;const ro=y(o({name:"PomodoroModes",setup:()=>({pomodoroSessionStore:h(),TimerId:I}),methods:{switchToPaused(o){return this.pomodoroSessionStore.switchTo(o,{startPlaying:!1})}}}),(function(){var o=this,t=o._self._c;return o._self._setupProxy,t("div",{staticClass:"pomodoro-modes"},[t("div",{staticClass:"mode",class:{active:o.pomodoroSessionStore.anyFocusTimerActive},attrs:{"data-test":"focus-btn"},on:{click:function(t){return o.switchToPaused(o.TimerId.Focus)}}},[o._v("Focus")]),t("div",{staticClass:"mode",class:{active:o.pomodoroSessionStore.anyBreakTimerActive},attrs:{"data-test":"rest-btn"},on:{click:function(t){return o.switchToPaused(o.TimerId.Break)}}},[o._v("Break")])])}),[],!1,null,"0718b773").exports,no=o({name:"PomodoroDropdown",components:{BaseDropdown:j,BaseDropdownOption:F,BaseIcon:D,BaseDropdownDivider:E,ToggleSwitch:R,InlineNumberInput:L,AppHeader:$,ClockSwitcherDropdown:V,ClockSwitcherContent:H},setup:()=>({pomodoroSessionStore:h(),clockSwitcher:e(),focusInput:e(),restInput:e(),dropdown:e(),TimerMode:A,notificationsSupported:!a()&&!c()}),computed:{focusDuration(){return this.pomodoroSessionStore.pomodoroSettings.focusDuration},restDuration(){return this.pomodoroSessionStore.pomodoroSettings.restDuration},currentMode(){return q[this.pomodoroSessionStore.countUpActive?A.CountUp:A.Timer]},modeOptions(){return U.currentValue?[q[this.pomodoroSessionStore.countUpActive?A.Timer:A.CountUp]]:[q[W.Clock],q[W.Percent]]}},methods:{async onNotificationOptionClick(){var o;this.pomodoroSessionStore.pomodoroSettings.browserNotifications?this.pomodoroSessionStore.saveSettingsToCustomization("browserNotifications",!1):(await this.pomodoroSessionStore.getNotificationsPermissionsToRequest()&&(null==(o=this.clockSwitcher)||o.closeDropdown()),this.pomodoroSessionStore.ensureNotificationPermissions())},openDropdown(){var o;null==(o=this.clockSwitcher)||o.openDropdown()},async switchClockOrMode(o){switch(o){case A.CountUp:case A.Timer:this.pomodoroSessionStore.totalProgress&&await this.pomodoroSessionStore.complete({completedManually:!0,switchToTimer:I.Focus}),S("focusModeSettings",(t=>{t.pomodoroTimerMode=o})),d.capture("pomodoro switch",{feature:"pomodoro",new_value:o});break;case W.Clock:case W.Percent:this.$emit("switchClock",o)}},async editFocusDuration(o){this.pomodoroSessionStore.focusedMinutes>=o&&await this.pomodoroSessionStore.complete({switchAfterComplete:!1,playSounds:!1,completedManually:!0}),this.pomodoroSessionStore.saveSettingsToCustomization("focusDuration",o)}}});const ao=y(o({name:"Pomodoro",components:{PomodoroCircle:Y,PomodoroTimer:J,PomodoroFocus:so,PomodoroButtons:io,PomodoroModes:ro,ThreeColLayout:T,PomodoroDropdown:y(no,(function(){var o=this,t=o._self._c;return o._self._setupProxy,t("div",{staticClass:"pomodoro-dropdown dark u--mobile-hide",attrs:{"data-test":"pomodoro-dropdown"}},[t("base-dropdown",{ref:"dropdown",attrs:{"min-width":"230px","container-class":"app pomodoro-dropdown-container dash","data-test":"more-toggle"},scopedSlots:o._u([{key:"toastHeader",fn:function(){return[o._t("mobileToast")]},proxy:!0}],null,!0)},[t("app-header",{on:{close:function(t){var e;null==(e=o.dropdown)||e.closeDropdown()}},scopedSlots:o._u([{key:"left",fn:function(){return[t("base-icon",{staticClass:"app-header-icon",attrs:{size:"16px",src:o.currentMode.icon||""}}),t("span",{staticClass:"app-header-name"},[o._v(o._s(o.currentMode.label))])]},proxy:!0},{key:"right",fn:function(){return[o.$touch?o._e():t("clock-switcher-dropdown",{attrs:{"mode-options":o.modeOptions},on:{switchTo:o.switchClockOrMode}})]},proxy:!0}])}),o.$touch?t("clock-switcher-content",{attrs:{"mode-options":o.modeOptions},on:{switchTo:o.switchClockOrMode}}):o._e(),o.$touch?t("base-dropdown-divider"):o._e(),o.pomodoroSessionStore.countUpActive?o._e():t("base-dropdown-option",{attrs:{"data-test":"complete-timer"},on:{click:function(t){return o.pomodoroSessionStore.complete({completedManually:!0})}}},[t("base-icon",{staticClass:"dropdown-icon",attrs:{src:"icon/pomodoro/icon-forward",size:"13px"}}),t("span",[o._v("Complete timer")])],1),t("base-dropdown-option",{attrs:{"data-test":"restart-timer"},on:{click:function(t){return o.pomodoroSessionStore.restartTimer()}}},[t("base-icon",{staticClass:"dropdown-icon",attrs:{src:"icon/pomodoro/icon-restart",size:"13px"}}),t("span",[o._v("Restart timer")])],1),o.pomodoroSessionStore.countUpActive?o._e():t("base-dropdown-option",{attrs:{"data-test":"extend-timer"},on:{click:function(t){o.pomodoroSessionStore.saveSettingsToCustomization("focusDuration",Number(o.focusDuration)+10)}}},[t("base-icon",{staticClass:"dropdown-icon",attrs:{src:"icon/pomodoro/icon-plus",size:"13px"}}),t("span",[o._v("Add 10 minutes")])],1),o.pomodoroSessionStore.countUpActive?o._e():[t("base-dropdown-divider"),t("base-dropdown-option",{on:{click:function(t){var e;null==(e=o.focusInput)||e.focus()}}},[t("span",[o._v("Focus")]),t("span",{staticClass:"input-wrapper"},[t("inline-number-input",{ref:"focusInput",attrs:{value:Number(o.focusDuration),debounce:1e3,min:1,"data-test":"focus-input"},on:{input:o.editFocusDuration}}),t("span",{staticClass:"input-unit"},[o._v("min")])],1)]),t("base-dropdown-option",{on:{click:function(t){var e;null==(e=o.restInput)||e.focus()}}},[t("span",[o._v("Break")]),t("span",{staticClass:"input-wrapper"},[t("inline-number-input",{ref:"restInput",attrs:{value:Number(o.restDuration),debounce:1e3,min:1,"data-test":"rest-input"},on:{input:t=>o.pomodoroSessionStore.saveSettingsToCustomization("restDuration",t.toString())}}),t("span",{staticClass:"input-unit"},[o._v("min")])],1)]),t("base-dropdown-divider"),t("base-dropdown-option",{attrs:{title:"Play sounds when timers start or end","data-test":"sounds"},on:{click:function(t){return o.pomodoroSessionStore.saveSettingsToCustomization("sounds",!o.pomodoroSessionStore.pomodoroSettings.sounds)}}},[t("span",[o._v("Timer sound effects")]),t("span",{staticClass:"toggle-right"},[t("toggle-switch",{attrs:{value:o.pomodoroSessionStore.pomodoroSettings.sounds}})],1)]),t("base-dropdown-option",{attrs:{title:"Auto-start break timer after completing focus timer","data-test":"auto-play"},on:{click:function(t){return o.pomodoroSessionStore.saveSettingsToCustomization("autoplay",!o.pomodoroSessionStore.pomodoroSettings.autoplay)}}},[t("span",[o._v("Auto-start timers")]),t("span",{staticClass:"toggle-right"},[t("toggle-switch",{attrs:{value:o.pomodoroSessionStore.pomodoroSettings.autoplay}})],1)])],t("base-dropdown-option",{attrs:{title:"Hide the seconds count for a calmer timer experience","data-test":"calm-timer"},on:{click:function(t){return o.pomodoroSessionStore.saveSettingsToCustomization("hideSeconds",!o.pomodoroSessionStore.pomodoroSettings.hideSeconds)}}},[t("span",[o._v("Hide seconds")]),t("span",{staticClass:"toggle-right"},[t("toggle-switch",{attrs:{value:o.pomodoroSessionStore.pomodoroSettings.hideSeconds}})],1)]),!o.pomodoroSessionStore.countUpActive&&o.notificationsSupported?t("base-dropdown-option",{attrs:{title:"Get notified outside of your browser when your timer ends","data-test":"os-notifications"},on:{click:o.onNotificationOptionClick}},[t("span",[o._v("Browser notifications")]),t("span",{staticClass:"toggle-right"},[t("toggle-switch",{attrs:{value:o.pomodoroSessionStore.pomodoroSettings.browserNotifications}})],1)]):o._e()],2)],1)}),[],!1,null,"d6e293b7").exports},props:{inPictureInPicture:{type:Boolean,default:!1}},setup:()=>({..._({onAllComponentsMountedOverride(){}}),pomodoroSessionStore:h(),tabElection:new z("pomodoro"),showAnyway:G,pomodoroDropdown:e(),pomodoroFocus:e(),TimerMode:A}),computed:{extendFocusVisible(){return this.pomodoroSessionStore.activeTimerId===I.Break&&!this.pomodoroSessionStore.playing&&0===this.pomodoroSessionStore.totalProgress&&this.$plus&&!this.pomodoroSessionStore.countUpActive},buttonState(){return this.pomodoroSessionStore.playing?f.Pause:f.Play},documentTitle(){var o;if(!this.pomodoroFocus||!this.pomodoroFocus.collectionReady)return"";const t=null==(o=this.pomodoroFocus)?void 0:o.activeFocus,e=this.pomodoroSessionStore.fullTimeString,s=this.pomodoroSessionStore.anyFocusTimerActive,i=s?"Focus":"Break";return`${e} ${s?"ðŸ§‘â€ðŸ’»":"ðŸ§˜"} Â· ${t&&t.focus&&!t.completed&&s?t.focus:i}`},timeRemainingForWatcher(){const o=this.pomodoroSessionStore;return o.loaded&&this.tabElection.isLeader.value&&!this.inPictureInPicture?o.timeRemaining:null}},watch:{timeRemainingForWatcher(o,t){if(null===o)return;const e=this.pomodoroSessionStore.pomodoroSettings.autoplay;e&&this.pomodoroSessionStore.playing&&o===v&&t!==v&&this.pomodoroSessionStore.syncPendingNotification(e),this.pomodoroSessionStore.playing&&0===o&&this.$nextTick((()=>{this.pomodoroSessionStore.complete(),this.pomodoroSessionStore.countDownActive&&(this.pomodoroSessionStore.update({countDownTimerLength:null}),m.trigger("focusMode:stop"))}))},documentTitle:{handler(o){document.title=o||this.$partner.title},immediate:!0}},async mounted(){await i((()=>this.pomodoroSessionStore.loaded)).toBe(!0),this.emitComponentMounted(),await O(),m.on("newDay",this.onNewDay);const o=p();if("notificationClick"in o&&o.notificationClick in w&&(u("notificationClick"),this.onNotificationClick(o.notificationClick)),!c()&&this.pomodoroSessionStore.pomodoroSettings.browserNotifications){const o=l();"notifications"in o&&o.notifications.create||this.pomodoroSessionStore.ensureNotificationPermissions()}this.inPictureInPicture||(Q.addCrossTabMessageListener("pomodoro:closed",this.closePomodoro),Q.$on("notificationClick",this.onNotificationClick))},destroyed(){var o;null==(o=this.tabElection)||o.stepDown(),document.title=this.$partner.title,m.off("newDay",this.onNewDay),this.inPictureInPicture||(this.pomodoroSessionStore.playing&&this.pomodoroSessionStore.complete({switchAfterComplete:!1,completedManually:!0}),Q.removeCrossTabMessageListener("pomodoro:closed",this.closePomodoro),Q.sendCrossTabMessage("pomodoro:closed"),Q.$off("notificationClick",this.onNotificationClick))},methods:{switchClock(o){d.capture("clock switch",{feature:"default clock",new_value:o}),M.percentClock=o===W.Percent,this.closePomodoro()},openDropdown(){var o;null==(o=this.pomodoroDropdown)||o.openDropdown()},closePomodoro(){this.$emit("pomodoro-show",!1)},async onNewDay(){await i((()=>this.pomodoroSessionStore.loaded)).toBe(!0),this.pomodoroSessionStore.playing||(this.pomodoroSessionStore.anyFocusTimerActive&&this.pomodoroSessionStore.partialProgress?await this.pomodoroSessionStore.complete({completedManually:!0,switchToTimer:I.Focus}):this.pomodoroSessionStore.anyBreakTimerActive&&this.pomodoroSessionStore.switchTo(I.Focus,{startPlaying:!1}))},async onNotificationClick(o){await i(this.tabElection.isLeader).not.toBeNull(),this.tabElection.isLeader.value&&await this.pomodoroSessionStore.onNotificationClick(o)}}}),(function(){var o=this,t=o._self._c;return o._self._setupProxy,t("div",{staticClass:"pomodoro app-container has-dash-icon hide-apps-no-fade",class:{"show-anyway":o.showAnyway.includes("pomodoro")},attrs:{"data-test":"pomodoro","data-show-anyway":"pomodoro"}},[t("transition",{attrs:{mode:"out-in",name:"fade-deep",duration:"500"}},[t("div",{key:o.pomodoroSessionStore.activeTimer.mode,staticClass:"hide-apps-fade-children",class:["mode-"+o.pomodoroSessionStore.activeTimer.mode.toLowerCase()]},[o.pomodoroSessionStore.activeTimer.mode===o.TimerMode.Timer?t("pomodoro-circle",{staticClass:"hide-apps-fade-children-exception"}):o._e(),o.pomodoroSessionStore.activeTimer.mode===o.TimerMode.Timer?t("pomodoro-modes"):o._e(),t("transition",{attrs:{mode:"out-in",name:"fade-deep",duration:"500"}},[o.pomodoroSessionStore.loaded?t("div",{key:o.pomodoroSessionStore.activeTimerId,staticClass:"hide-apps-fade-children hide-apps-fade-children-exception"},[t("three-col-layout",{scopedSlots:o._u([{key:"center",fn:function(){return[t("pomodoro-timer",{directives:[{name:"mobile-click",rawName:"v-mobile-click",value:o.openDropdown,expression:"openDropdown"}],attrs:{hours:o.pomodoroSessionStore.hours,minutes:o.pomodoroSessionStore.minutes,seconds:o.pomodoroSessionStore.seconds,"hide-seconds":o.pomodoroSessionStore.pomodoroSettings.hideSeconds}})]},proxy:!0},{key:"right",fn:function(){return[o.pomodoroSessionStore.countDownActive?o._e():t("pomodoro-dropdown",{ref:"pomodoroDropdown",on:{switchClock:o.switchClock}})]},proxy:!0}],null,!1,3816151437)}),t("pomodoro-focus",{ref:"pomodoroFocus",attrs:{"text-override":o.pomodoroSessionStore.anyBreakTimerActive?"Break Timer":""}}),o.pomodoroSessionStore.countDownActive?o._e():t("pomodoro-buttons",{staticClass:"hide-apps-fade-children-exception",attrs:{"time-remaining":o.pomodoroSessionStore.timeRemaining,"pomodoro-button-state":o.buttonState,"extend-focus-visible":o.extendFocusVisible}})],1):o._e()])],1)])],1)}),[],!1,null,"7ff81666").exports;export{ao as default};
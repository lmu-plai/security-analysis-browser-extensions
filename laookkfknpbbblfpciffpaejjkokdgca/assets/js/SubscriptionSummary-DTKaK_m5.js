import{u as e,a as r,W as a}from"./index-B9SbLlJ5.js";import{M as t,d as s,f as i}from"./DataSyncService-BIQVYvDv.js";import{p as n}from"./persistStore-C6CQfgEA.js";var l=(e=>(e.Canceled="canceled",e.Processing="processing",e.Succeeded="succeeded",e.RequiresAction="requires_action",e.RequiresCapture="requires_capture",e.RequiresPaymentMethod="requires_payment_method",e))(l||{}),u=(e=>(e.Plus="subscribed",e.TrialingCardless="trialingCardless",e.TrialingCard="trialingCard",e.ExpiredTrial="expiredTrial",e.ExpiredPlus="expiredPlus",e.PastDue="pastDue",e.Free="free",e))(u||{});const d=n((({loadedRef:t,loadingRef:n,refresh:l})=>{const d=s("userSubscriptionSummary",{state:()=>({active:!1,error:null,firstSubscriptionStart:null,hasPaymentMethod:!1,intent:null,pastDue:!1,subscriptionEnd:null,trialEnd:null,trialing:!1}),getters:{featuresNeedUpdate(e){return this.loaded?e.active&&!m.conditionalFeatures.featureEnabled("plus"):null},loaded:()=>t.value,loading:()=>n.value,status:e=>e.trialing&&e.hasPaymentMethod?u.TrialingCard:e.trialing&&!e.hasPaymentMethod?u.TrialingCardless:e.pastDue?u.PastDue:e.active?u.Plus:e.subscriptionEnd?u.ExpiredPlus:e.trialEnd?u.ExpiredTrial:u.Free,trialRemainingDays:e=>r.dateDiffIntegerDays(Date.now(),e.trialEnd??Date.now()),subscriptionDaysElapsed:e=>e.firstSubscriptionStart?r.dateDiffIntegerDays(new Date(e.firstSubscriptionStart),new Date)+1:0,expired(){return[u.ExpiredPlus,u.ExpiredTrial].includes(this.status)}},actions:{refresh(e=!1){if(!a())return l(e);t.value=!0}}});return(async()=>{const r=d();await e((()=>r.featuresNeedUpdate)).toBe(!0),i.resolveDeferral()})(),d}),{path:"user/subscription_summary",mode:t.TimestampStrict}),o=Object.freeze(Object.defineProperty({__proto__:null,default:d},Symbol.toStringTag,{value:"Module"}));export{u as S,l as a,o as b,d as u};
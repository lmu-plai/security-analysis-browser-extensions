import{a as e}from"./index-B9SbLlJ5.js";const s="momentum:iframe:otp:request",t="momentum:iframe:unregistered:refresh",n="momentum:iframe:height:resize",i="momentum:iframe:datadog:error",a="momentum:iframe:posthog:error",o="momentum:iframe:posthog:capture";var r="https://www.momentumdash.com/";class d{constructor(s,t){this.id=(null==t?void 0:t.id)??s,this.events=(null==t?void 0:t.events)??{};const n=`${r}ext/${s}`;this.url=e.extendUrlParams(n,{...(null==t?void 0:t.params)??{},frameId:this.id}),this.connected=!1}async onMessage(e){var s,t;const{type:n,id:i,data:a}=e.data;if(!n||void 0===a||i!==this.id)return;const o=await(null==(t=(s=this.events)[n])?void 0:t.call(s,a,this))??{};this.sendMessage(n+":response",o)}async connect(e){return this.iframe=e,window.addEventListener("message",(e=>{this.onMessage(e)})),await this.sendMessageAndGetResponse("momentum:iframe:connect",{targetUrl:encodeURI(window.origin)}),this.connected=!0}disconnect(){window.removeEventListener("message",(e=>{this.onMessage(e)})),this.connected=!1}sendMessage(e,s){var t,n;null==(n=null==(t=this.iframe)?void 0:t.contentWindow)||n.postMessage({type:e,id:this.id,data:s??{}},r)}addMessageListener(e,s){this.events[e]=s}removeMessageListener(e){delete this.events[e]}addOneTimeAsyncResponseMessageListener(e){return new Promise((s=>{const t=e+":response";this.addMessageListener(t,(e=>{this.removeMessageListener(t),s(e)}))}))}sendMessageAndGetResponse(e,s){return this.sendMessage(e,s),this.addOneTimeAsyncResponseMessageListener(e)}}export{n as I,s as a,t as b,i as c,a as d,o as e,d as f};
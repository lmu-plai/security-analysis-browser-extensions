import{o as e,u as t,I as i,ai as s,G as r,r as a,n as o,H as n,f as c,aO as l,aP as p,a9 as d,aa as u,ab as h,d as v}from"./index-B9SbLlJ5.js";import{A as f}from"./AppViewSwitchDynamic-7Q3nGfPx.js";import{M as y,u as w,B as g}from"./main-BRwZcNHu.js";import b from"./AppView-Du2InOAV.js";import S from"./AppHeader-DINik7Wl.js";import{A as _}from"./AppHeaderControl-CYSrwe76.js";import I from"./BaseIcon-CAXE-xBw.js";import{A as T}from"./AppEmpty-Rom0E1b_.js";import{B as C}from"./BaseItemList-kFdAe94b.js";import{c as x}from"./Logger-BTKFyPnc.js";import{B as P}from"./BaseMetric-ClLQP9bU.js";import{M as k,u as A,a as M,b as j}from"./metrics-BQKdARjt.js";import{d as F,a as O}from"./DataSyncService-BIQVYvDv.js";import{p as D}from"./errors-CZrPVA9A.js";import{n as V}from"./_plugin-vue2_normalizer-DeUNqxFl.js";import{A as B}from"./AppLoading-DWsYUtJy.js";import{B as $}from"./BaseDropdown-DNbKWQaF.js";import{B as N}from"./BaseDropdownOption-NzB_bdFk.js";import{T as L}from"./ToggleSwitch-DSwcb4Go.js";import{computed as Y,persistent as U}from"./reactiveCustomization-l1DAJU8W.js";import{b as R}from"./constants-CALDQiUE.js";import{b as z}from"./constants-KuzCZNtH.js";import{A as H}from"./AppConfirmCancel-Cl42ZKbi.js";import{S as q}from"./SmoothReflow-CN2CnQb0.js";import{F as E,a as W}from"./FormFieldWrapper-BlAvXZ8z.js";import{F as Z}from"./FormInput-TnE29k8J.js";import{F as K}from"./FormToggle-Buxq446e.js";import{F as Q}from"./FormSelectIcon-BSNnxGog.js";import{C as X}from"./clocks-BKFIGann.js";import{C as G}from"./countdowns-DgPkbMo-.js";import J from"./icon-x-caret-half-Ciiq12QG.js";import ee from"./LocationTypeahead-DVwXQCwx.js";import{B as te}from"./BaseForm-BHIC1rD-.js";import ie from"./AppPopup-CBVX3XyQ.js";import"./style-cpFB66wV.js";import"./appViewSwitchMixin-BsLJ76Hr.js";import"./VueBase-BB-58KAg.js";import"./_commonjsHelpers-B3K3fdV-.js";import"./ClickOutside-DCLvi2fj.js";import"./pinia-4ulFHh2N.js";import"./portal-vue.esm-BlbL0ibK.js";import"./useAllComponentsMounted-jOG8AT3X.js";import"./AppDash-CSffn7xe.js";import"./AddMetric-CPvWgDHW.js";import"./appZStack-Duidf5Sm.js";import"./icon-confetti-BvRSomF2.js";import"./internalDataMetrics-D1gWPDaj.js";import"./useAppToggle-CWDyropZ.js";import"./focusModeInsightsViewState-Bp-WMnI-.js";import"./ViewState-CaQI4PuO.js";import"./CircleIndicator-DM0zp1kg.js";import"./state-C7K8Oenp.js";import"./LocalStorageStoreSyncedItem-ClHii6kh.js";import"./settings-ClOtDILp.js";import"./modal-DQlfZdMt.js";import"./enums-C0TfsRui.js";import"./AppContainer-BbrPMYLy.js";import"./showAnyway-Bb-tkUYJ.js";import"./index-CbkRD371.js";import"./icon-close-DRlspKs3.js";import"./dynamic-import-helper-DIl3ayLm.js";import"./constants-BpVlFj04.js";import"./compareObjects-R6Hcs7xe.js";import"./BaseDropdownContent-BfXd6hD-.js";import"./icon-ellipsis-D7nTOXaQ.js";import"./globalKeyEventManager-ByOI7Z15.js";import"./ResizeSensor-ZXOsDHeC.js";import"./SoftFocus-BUhesXB-.js";import"./BaseMessage-B1Cb2q_O.js";import"./ErrorPulseInput-CkNsRuJq.js";var se=(e=>(e.AuthRequired="authRequired",e.Connected="Connected",e))(se||{});class re{constructor({id:e=0,beta:t=!1,active:i=!1,large_icon_url:s="",provider_title:r="",status:a="",statusId:o=null,ump_id:n=null,small_icon_url:c="",short_description:l="",dataPoints:p=[]}){this.id=e,this.beta=t,this.active=i,this.large_icon_url=s,this.provider_title=r,this.status=a,this.statusId=o,this.ump_id=n,this.small_icon_url=c,this.short_description=l,this.dataPoints=p}get connected(){return"Connected"===this.status}}const ae=((i=D().metricsProvidersService)=>F("metricsProviders",{state:()=>({data:{},loading:!1,loaded:!1}),getters:{items:e=>Object.values(e.data).reduce(((e,t)=>(e[t.id]=new re(t),e)),{})},actions:{refresh(e){this.loading||this.loaded&&!e||(this.loading=!0,i.getProviders().then((e=>{const t=e.data.available_providers,i=e.data.connected_providers;let s=[];t&&i?s=t.concat(i):t?s=t:i&&(s=i),this.data=Object.fromEntries(s.map((e=>[e.id,e]))),this.loaded=!0,this.loading=!1})).catch((e=>{console.error(e),this.loading=!1})))},async connect(e){let t;if(e instanceof re)t=e;else{this.loaded||this.refresh();const i=this.items[e];if(!i)return;t=i}const{data:s}=await i.connectProvider(t.id);s.status===se.AuthRequired&&this.launchConnectWindow(t,s.authorizationUrl,s.winHeight,s.winWidth,s.windowFeatures)},fetchDataPoints(t){i.getProviderDataPoints(t).then((i=>{const s=i.data.dataPoints;s.sort(((e,t)=>{if(!e.name||!t.name)return 0;const i=e.name.toUpperCase(),s=t.name.toUpperCase();return i<s?-1:i>s?1:0}));const r=this.data[t];r&&e(this.data,r.id,{...r,dataPoints:s})})).catch(console.error)},launchConnectWindow(e,i,s=510,r=600,a="titlebar, resizable, status"){const o=window.screen.width/2-r/2,n=window.screen.height/2-s/2,c=window.open(i,"MomentumAuthWindow",`${a}, left=${o}, top=${n}, width=${r}, height=${s}`),l=setInterval((()=>{c&&!c.closed||(clearInterval(l),this.refresh(!0),t((()=>this.loading)).toBe(!1).then((()=>this.fetchDataPoints(e.id))))}),1e3)}}}))();const oe=V(i({name:"MetricsItem",components:{MetricAdjust:y,BaseIcon:I},props:{item:{type:Object,required:!0}},setup:()=>({viewStateStore:w(),providersStore:ae(),selectedMetric:s("selectedMetric"),activeTypeStore:s("activeTypeStore")}),computed:{selectedFromDash(){var e;return this.item.id===(null==(e=this.selectedMetric)?void 0:e.id)}},methods:{itemIsMetric:e=>e instanceof k,async edit(){var e;if(this.item.isTeam&&!this.item.readOnly)return this.openItemOnTeamSite();null==(e=this.activeTypeStore)||e.editItem(this.item.id),await this.viewStateStore.setActiveView(g.Form)},async restore(){var e;await(null==(e=this.activeTypeStore)?void 0:e.update(this.item.id,{archived:!1}))},async togglePinned(){var e;if(this.item.isTeam)return this.openItemOnTeamSite();await(null==(e=this.activeTypeStore)?void 0:e.update(this.item.id,{pinned:!this.item.pinned}))},openItemOnTeamSite(){var e;null==(e=this.activeTypeStore)||e.openItemOnTeamSite(this.item.id)},connectProvider(e){this.itemIsMetric(this.item)&&this.item.providerId&&this.item.authNeeded&&(e.stopPropagation(),this.providersStore.connect(this.item.providerId))},openExternalURL(){this.itemIsMetric(this.item)&&this.item.externalUrl&&r(this.item.externalUrl)}}}),(function(){var e=this,t=e._self._c;return e._self._setupProxy,t("li",{staticClass:"base-metric-item",class:{selected:e.selectedFromDash,auth:e.itemIsMetric(e.item)&&e.item.authNeeded},attrs:{"data-test":"list-row",title:e.item.displayTooltip},on:{click:e.edit}},[t("div",{staticClass:"title-container"},[t("div",{staticClass:"title-container-icon-value"},[e.item.icon?t("base-icon",{attrs:{src:e.item.icon,size:"1.25rem","data-test":"list-row-icon"}}):e._e(),t("div",{staticClass:"metric-stat"},[e._v(e._s(e.item.displayValue))])],1),t("div",{staticClass:"list-icons",attrs:{"data-test":"list-icon"}},[e.itemIsMetric(e.item)&&e.item.externalUrl?t("div",{staticClass:"icon-wrapper",attrs:{title:"Open integration URL","data-test":"external"},on:{click:function(t){return t.stopPropagation(),e.openExternalURL.apply(null,arguments)}}},[t("base-icon",{attrs:{src:"external-link"}})],1):e._e(),e.item.readOnly?t("div",{staticClass:"icon-wrapper",attrs:{title:"Admin Locked"}},[t("base-icon",{attrs:{src:"lock"}})],1):e._e(),e.item.archived?t("div",{staticClass:"icon-wrapper",attrs:{title:"Restore","data-test":"restore"},on:{click:function(t){return t.stopPropagation(),e.restore.apply(null,arguments)}}},[t("base-icon",{attrs:{src:"archive-restore"}})],1):e._e(),e.item.readOnly?e._e():t("div",{staticClass:"icon-wrapper",attrs:{title:"Edit","data-test":"edit"},on:{click:function(t){return t.stopPropagation(),e.edit.apply(null,arguments)}}},[t("base-icon",{attrs:{src:"settings"}})],1),!e.item.readOnly||e.item.pinned?t("div",{staticClass:"icon-wrapper",class:{active:e.item.pinned,"u--no-pointer-events":e.item.readOnly},attrs:{title:e.item.pinned?"Unpin":"Pin"},on:{click:function(t){return t.stopPropagation(),e.togglePinned.apply(null,arguments)}}},[t("base-icon",{attrs:{src:"pin"}})],1):e._e(),e.itemIsMetric(e.item)&&e.item.shouldDisplayQuickAdjust?t("metric-adjust",{attrs:{item:e.item,location:"app"}}):e._e()],1)]),t("div",{staticClass:"metric-label",on:{click:e.connectProvider}},[e.itemIsMetric(e.item)&&e.item.authNeeded?t("base-icon",{staticClass:"icon-alert",attrs:{src:"icon-alert",size:"10px"}}):e._e(),t("div",{staticClass:"metric-label-name"},[e._v(e._s(e.item.name))])],1)])}),[],!1,null,"072e04ea").exports;const ne=V(i({name:"BaseMetricsArchived",components:{AppLoading:B,BaseMetricItem:oe,BaseItemList:C,AppEmpty:T,BaseIcon:I,AppHeaderControl:_,AppHeader:S,AppView:b},setup:()=>({viewStateStore:w(),selectedType:s("selectedType"),activeTypeStore:s("activeTypeStore")}),computed:{isEmpty(){var e;return 0===(null==(e=this.activeTypeStore)?void 0:e.archivedItems.length)},emptyTitle(){return`No archived ${this.type}s`},emptyDescription(){return`Add a ${this.type} to get started`},emptyButtonText(){return`Add ${x(this.type)}`},type(){return this.selectedType?this.selectedType:P.Metric}},methods:{createNewItem(){var e;null==(e=this.activeTypeStore)||e.newItem(),this.viewStateStore.setActiveView(this.type===P.Metric?g.MetricTypeSelect:g.Form)},goToListView(){this.viewStateStore.setActiveView(g.List)}}}),(function(){var e=this,t=e._self._c;return e._self._setupProxy,t("app-view",{staticClass:"base-metrics-archived",scopedSlots:e._u([{key:"header",fn:function(){return[t("app-header",{on:{close:function(t){return e.viewStateStore.togglePopup(!1)}},scopedSlots:e._u([{key:"center",fn:function(){return[t("span",{staticClass:"app-header-name"},[e._v("Archive")])]},proxy:!0},{key:"right",fn:function(){return[t("app-header-control",{attrs:{"data-test":"list-view"},on:{click:e.goToListView}},[t("base-icon",{attrs:{src:"icon/arrow-right"}})],1)]},proxy:!0}])})]},proxy:!0},{key:"body",fn:function(){var i,s;return[(null==(i=e.activeTypeStore)?void 0:i.loading)?t("app-loading"):e.isEmpty?t("app-empty",{attrs:{title:e.emptyTitle,description:e.emptyDescription,"button-text":e.emptyButtonText,"data-test":"empty-list"},on:{buttonClick:e.createNewItem}}):t("base-item-list",e._l(null==(s=e.activeTypeStore)?void 0:s.archivedItems,(function(e){return t("base-metric-item",{key:e.id,attrs:{item:e}})})),1)]},proxy:!0}])})}),[],!1,null,"c2554138").exports;const ce=V(i({name:"MetricsList",components:{AppLoading:B,BaseMetricItem:oe,ToggleSwitch:L,BaseDropdownOption:N,BaseDropdown:$,AppHeaderControl:_,BaseIcon:I,BaseItemList:C,AppView:b,AppEmpty:T,AppHeader:S},setup:()=>({viewStateStore:w(),selectedType:s("selectedType"),activeTypeStore:s("activeTypeStore"),stableItemsOrderIds:[],DropdownOptionSpacing:R}),computed:{headerTitle(){return`${x(this.type)}s`},headerIcon(){return`icon/apps/${this.type}s`},showRandom:{get(){return Y["showRandomMetric-"+this.type]},set(e){U["showRandomMetric-"+this.type]=e}},isEmpty(){var e;return 0===(null==(e=this.activeTypeStore)?void 0:e.items.length)},emptyTitle(){return`No ${this.type}s yet`},emptyDescription(){return`Add a ${this.type} to get started`},emptyButtonText(){return`Add ${x(this.type)}`},type(){return this.selectedType?this.selectedType:P.Metric},loaded(){var e;return!!(null==(e=this.activeTypeStore)?void 0:e.loaded)},stableOrderedItems(){var e;const t=new Array(this.stableItemsOrderIds.length);return null==(e=this.activeTypeStore)||e.items.forEach((e=>{const i=this.stableItemsOrderIds.indexOf(e.id);-1!==i&&(t[i]=e)})),t}},watch:{loaded:{handler(){var e;const t=(null==(e=this.activeTypeStore)?void 0:e.items)??[];this.stableItemsOrderIds=t.map((e=>e.id))},immediate:!0}},methods:{async createNewItem(){var e;this.type!==P.Metric?(null==(e=this.activeTypeStore)||e.newItem(),await this.viewStateStore.setActiveView(g.Form)):await this.viewStateStore.setActiveView(g.MetricTypeSelect)},async goToArchive(){var e;null==(e=this.activeTypeStore)||e.refresh({archived:!0}),await this.viewStateStore.setActiveView(g.Archived)},goToTeamAdminSite(){m.commandManager.execute("window.account.open.login","/team/"+this.type)}}}),(function(){var e=this,t=e._self._c;return e._self._setupProxy,t("app-view",{staticClass:"base-metrics-list",scopedSlots:e._u([{key:"header",fn:function(){return[t("app-header",{on:{close:function(t){return e.viewStateStore.togglePopup(!1)}},scopedSlots:e._u([{key:"left",fn:function(){return[t("base-icon",{staticClass:"app-header-icon",attrs:{src:e.headerIcon}}),t("span",{staticClass:"app-header-name"},[e._v(e._s(e.headerTitle))])]},proxy:!0},{key:"right",fn:function(){return[e.isEmpty?e._e():t("app-header-control",{attrs:{"data-test":"add-item"},on:{click:e.createNewItem}},[t("base-icon",{attrs:{src:"icon-plus"}})],1),t("base-dropdown",{attrs:{"data-test":"more-dropdown"}},[t("base-dropdown-option",{attrs:{"data-test":"show-archived"},on:{click:e.goToArchive}},[t("base-icon",{attrs:{src:"archive"}}),t("span",[e._v("Show Archived")])],1),t("base-dropdown-option",{attrs:{spacing:e.DropdownOptionSpacing.Between},on:{click:function(t){e.showRandom=!e.showRandom}}},[t("span",[e._v("Show Random")]),t("toggle-switch",{attrs:{value:e.showRandom}})],1),e.$admin?t("base-dropdown-option",{attrs:{"data-test":"go-to-team-admin"},on:{click:e.goToTeamAdminSite}},[t("base-icon",{attrs:{src:"icon-settings"}}),t("span",[e._v(e._s(e.headerTitle)+" Admin")])],1):e._e()],1)]},proxy:!0}])})]},proxy:!0},{key:"body",fn:function(){var i;return[(null==(i=e.activeTypeStore)?void 0:i.loading)?t("app-loading"):e.isEmpty?t("app-empty",{attrs:{title:e.emptyTitle,description:e.emptyDescription,"button-text":e.emptyButtonText,"data-test":"empty-list"},on:{buttonClick:e.createNewItem}}):t("base-item-list",e._l(e.stableOrderedItems,(function(e){return t("base-metric-item",{key:e.id,attrs:{item:e}})})),1)]},proxy:!0}])})}),[],!1,null,"aefcb0a5").exports;const le=V(i({name:"FormSelect",components:{BaseIcon:I,FormFieldWrapper:E},props:{name:{type:String,default:"select"},value:{type:String,required:!0},options:{type:Object,required:!0},emptyOption:{type:String,default:""},optionParser:{type:Function,default:(e,t)=>t},...W},emits:["input"],setup:()=>({formFields:s("formFields"),select:a()}),data:()=>({pulse:!1}),created(){var e;null==(e=this.formFields)||e.addField(this.name,this.focus,this.pulseAndFocusInput)},destroyed(){var e;null==(e=this.formFields)||e.removeField(this.name)},methods:{async focus(){var e;await o(),null==(e=this.select)||e.focus()},async pulseAndFocusInput(){await this.focus(),this.pulse=!0,await n(1e3),this.pulse=!1},onSelectChange(e){this.$emit("input",e.target.value)}}}),(function(){var e=this,t=e._self._c;return e._self._setupProxy,t("form-field-wrapper",e._b({staticClass:"form-select"},"form-field-wrapper",e.$props,!1),[t("div",{staticClass:"form-select-content"},[t("select",{ref:"select",class:{"option-empty":""===e.value,pulse:e.pulse},attrs:{"data-test":"form-select"},domProps:{value:e.value},on:{change:e.onSelectChange}},[e.emptyOption?t("option",{attrs:{disabled:"",value:""},domProps:{selected:""===e.value}},[e._v(e._s(e.emptyOption))]):e._e(),e._l(e.options,(function(i,s){return t("option",{key:`${s}-${i}`,domProps:{value:s,selected:e.value===s}},[e._v(" "+e._s(e.optionParser(s,i))+" ")])}))],2),t("base-icon",{staticClass:"form-select-icon",attrs:{src:"icon/chevron-down",size:"11px"}})],1)])}),[],!1,null,"d89c5887").exports;const pe=V(i({name:"MetricIntegrationFormInputs",components:{FormSelectIcon:Q,FormToggle:K,FormInput:Z,FormSelect:le,SmoothReflow:q},props:{item:{type:Object,required:!0}},emits:["select"],setup:()=>({providersStore:ae(),metricsStore:A()}),computed:{authNeeded(){var e;return!(null==(e=this.selectedProvider)?void 0:e.connected)||this.item.authNeeded},connectText(){var e;return(null==(e=this.selectedProvider)?void 0:e.connected)?"Reconnect":"Connect"},selectedProvider(){if(null!==this.item.providerId)return this.providersStore.items[this.item.providerId]},selectedDataPoint(){var e;return null==(e=this.selectedProvider)?void 0:e.dataPoints.find((e=>e.id===this.item.providerDataPointId))},selectedProviderDataPointOptions(){var e;return(null==(e=this.selectedProvider)?void 0:e.dataPoints)?this.selectedProvider.dataPoints.reduce(((e,t)=>(e[`${t.id}`]=t.name,e)),{}):{}},providerDataPointId:{get(){return`${this.item.providerDataPointId??""}`},set(e){this.item.providerDataPointId=Number(e)}}},watch:{selectedDataPoint(e,t){var i,s;e&&(this.item.externalUrl=e.external_url,this.item.label&&this.item.label!==(t&&t.name)||!(null==(i=this.selectedDataPoint)?void 0:i.name)||(this.item.label=null==(s=this.selectedDataPoint)?void 0:s.name))},"providersStore.loaded":{handler(e){if(e){if(!this.selectedProvider)return;this.providersStore.fetchDataPoints(this.selectedProvider.id)}},immediate:!0}},mounted(){this.providersStore.refresh(!0)},methods:{selectProvider(e){var t;this.item.providerId=e.id,(null==(t=this.selectedProvider)?void 0:t.connected)&&this.providersStore.fetchDataPoints(e.id),this.$emit("select")},connectProvider(){this.selectedProvider&&this.providersStore.connect(this.selectedProvider)}}}),(function(){var e=this,t=e._self._c;return e._self._setupProxy,t("div",{staticClass:"metric-integration-form-inputs"},[t("smooth-reflow",{attrs:{nested:!0,"hide-overflow":!0}},[e.providersStore.loaded?e.selectedProvider?e.authNeeded?t("div",{key:"3",staticClass:"connect"},[t("label",[e._v(e._s(e.connectText)+" to "+e._s(e.selectedProvider.provider_title))]),t("p",{staticClass:"description"},[e._v("A secure window will open. Momentum doesn't see or access your login info.")]),t("button",{staticClass:"button button-connect",on:{click:e.connectProvider}},[e._v(e._s(e.connectText))])]):e.selectedProvider.connected?t("div",{key:"4",staticClass:"integration-connected-elements"},[t("form-input",{attrs:{autofocus:"",name:"name",label:"Name","data-test":"name-input"},model:{value:e.item.name,callback:function(t){e.$set(e.item,"name",t)},expression:"item.name"}}),t("form-select",{attrs:{options:e.selectedProviderDataPointOptions,"empty-option":"Select",label:"Value",name:"value","data-test":"data-points"},model:{value:e.providerDataPointId,callback:function(t){e.providerDataPointId=t},expression:"providerDataPointId"}}),t("form-select-icon",{attrs:{label:"Icon","data-test":"icon-input"},model:{value:e.item.icon,callback:function(t){e.$set(e.item,"icon",t)},expression:"item.icon"}}),t("form-toggle",{attrs:{label:"Pin to dashboard","data-test":"pinned-input"},model:{value:e.item.pinned,callback:function(t){e.$set(e.item,"pinned",t)},expression:"item.pinned"}})],1):e._e():t("div",{key:"2"},[t("ul",{staticClass:"providers tile-list"},e._l(e.providersStore.items,(function(i,s){return t("li",{key:s,staticClass:"button-list-item provider",on:{click:function(t){return e.selectProvider(i)}}},[t("img",{staticClass:"img",attrs:{src:i.small_icon_url}}),t("div",{staticClass:"title"},[e._v(e._s(i.provider_title))])])})),0),t("a",{staticClass:"suggest",attrs:{href:"https://suggestions.momentumdash.help/",target:"_blank"}},[e._v("Suggest integration â†’")])]):t("div",{key:"1",staticClass:"loading-wrapper"},[t("i",{staticClass:"loading-icon"})])])],1)}),[],!1,null,"9ebf16be").exports,de={[M.Manual]:{label:"Manual",description:"Track manually",title:"Manual"},[M.Url]:{label:"From a URL",description:"Update from a URL",title:"URL"},[M.Integration]:{label:"From an Integration",description:"Connect to a service",title:"Integration"}},me={[j.Never]:"Never",[j.Daily]:"Daily",[j.Weekly]:"Weekly",[j.Monthly]:"Monthly",[j.Yearly]:"Yearly"},ue={0:"0",1:"1",2:"2",3:"3",4:"4"};const he=V(i({name:"CountdownFormInputs",components:{CountdownFormDateTime:V({name:"CountdownFormDateTime",components:{CollapsibleInput:V({name:"CollapsibleInput",components:{SmoothReflow:q},props:{label:{type:String,required:!0},active:{type:Boolean,default:!1}}},(function(){var e=this,t=e._self._c;return t("div",[t("div",{staticClass:"label-row",attrs:{"data-test":"collapsable-input-header"},on:{click:function(t){return e.$emit("toggleInput")}}},[t("label",[e._v(e._s(e.label))]),t("span",{staticClass:"x-caret",class:{active:e.active}},[t("inline-svg",{staticClass:"icon x-caret-left",attrs:{src:J}}),t("inline-svg",{staticClass:"icon x-caret-right",attrs:{src:J}})],1)]),t("smooth-reflow",{attrs:{nested:!0,"hide-overflow":!0}},[e.active?e._t("default"):e._e()],2)],1)}),[],!1,null,"792f2f97").exports},props:{value:{type:Object,default:null}},data(){let e=new Date((new Date).getTime()+6048e5);return{defaultDate:e,year:e.getFullYear(),month:e.getMonth(),day:e.getDate(),hour24:9,minutes:0,otherYearActive:!1,customTime:!1,otherYear:(new Date).getFullYear(),selectedYear:(new Date).getFullYear(),currentYear:(new Date).getFullYear(),months:c.monthNamesShort}},computed:{days(){let e=this.value&&this.value.date?this.value.date:this.defaultDate;return t=e.getFullYear(),i=e.getMonth(),new Date(t,parseInt(i)+1,0).getDate();var t,i},period:{get:function(){return this.hour24>=12?"PM":"AM"},set:function(e){this.hour24="AM"===e?this.hour24-12:this.hour24+12}},hourModel:{get:function(){return this.is12Hour?this.hour12:this.hour24},set:function(e){this[this.is12Hour?"hour12":"hour24"]=e}},hour12:{get:function(){return[0,12].includes(this.hour24)?12:this.hour24%12},set:function(e){"PM"===this.period?this.hour24=12===e?12:e+12:this.hour24=12===e?0:e}},is12Hour:()=>U.hour12clock},watch:{value:{handler(e){e&&(e.date?this.init(e):this.init({date:this.defaultDate,hasHours:!1}))},deep:!0,immediate:!0},selectedYear(e){"other"===e?(this.otherYearActive=!0,o((()=>{this.$refs.otherYear.select()}))):(this.year=e,this.update())}},mounted(){this.loadingSearch=0},methods:{init(e){this.selectedYear=this.otherYear=this.year=e.date.getFullYear(),this.otherYearActive=this.year<this.currentYear||this.year>this.currentYear+4,this.customTime=e.hasHours,this.month=e.date.getMonth(),this.day=e.date.getDate(),e.hasHours&&(this.hour24=e.date.getHours(),this.minutes=e.date.getMinutes())},toggleTime(){this.customTime=!this.customTime,this.customTime||(this.hour24=9,this.minutes=0,this.update())},update(){let e=new Date(this.year,this.month,this.day,this.hour24,this.minutes);e.setDate(this.day),this.$emit("input",{date:e,hasHours:this.customTime})},updateOtherYear(){this.year=this.otherYear,this.$refs.otherYear.blur(),this.update()},isNumberKey(e){let t;"paste"===e.type?t=event.clipboardData.getData("text/plain"):(t=e.keyCode||e.which,t=String.fromCharCode(t));/[0-9]|\./.test(t)||(e.returnValue=!1,e.preventDefault&&e.preventDefault())}}},(function(){var e=this,t=e._self._c;return t("div",{staticClass:"countdown-form-date-time"},[t("div",{staticClass:"date-row"},[t("label",[e._v("Date")]),t("div",{staticClass:"select-wrapper month-group"},[t("select",{directives:[{name:"model",rawName:"v-model",value:e.month,expression:"month"}],staticClass:"month",attrs:{id:"month",name:"month","data-test":"month"},on:{change:[function(t){var i=Array.prototype.filter.call(t.target.options,(function(e){return e.selected})).map((function(e){return"_value"in e?e._value:e.value}));e.month=t.target.multiple?i:i[0]},e.update]}},e._l(e.months,(function(i,s){return t("option",{key:s,domProps:{value:s}},[e._v(e._s(i))])})),0)]),t("div",{staticClass:"select-wrapper day-group"},[t("select",{directives:[{name:"model",rawName:"v-model",value:e.day,expression:"day"}],staticClass:"day",attrs:{id:"day",name:"day","data-test":"day"},on:{change:[function(t){var i=Array.prototype.filter.call(t.target.options,(function(e){return e.selected})).map((function(e){return"_value"in e?e._value:e.value}));e.day=t.target.multiple?i:i[0]},e.update]}},e._l(e.days,(function(i){return t("option",{key:i,domProps:{value:i}},[e._v(e._s(i))])})),0)]),t("div",{staticClass:"select-wrapper year-group",class:{"other-active":e.otherYearActive}},[t("select",{directives:[{name:"model",rawName:"v-model",value:e.selectedYear,expression:"selectedYear"}],staticClass:"year",attrs:{id:"year",name:"year","data-test":"year"},on:{change:function(t){var i=Array.prototype.filter.call(t.target.options,(function(e){return e.selected})).map((function(e){return"_value"in e?e._value:e.value}));e.selectedYear=t.target.multiple?i:i[0]}}},[e._l(5,(function(i){return t("option",{key:i,domProps:{value:e.currentYear+i-1}},[e._v(e._s(e.currentYear+i-1))])})),t("option",{attrs:{value:"other"}},[e._v("Other")])],2),e.otherYearActive?t("input",{directives:[{name:"model",rawName:"v-model",value:e.otherYear,expression:"otherYear"}],ref:"otherYear",staticClass:"countdown-year-other",attrs:{id:"countdown-year-other",type:"text",name:"countdown-year-other",placeholder:"yyyy",maxlength:"4","data-test":"other-year"},domProps:{value:e.otherYear},on:{blur:e.updateOtherYear,keypress:function(t){return e.isNumberKey(t)},keyup:function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"enter",13,t.key,"Enter")?null:(t.stopPropagation(),t.preventDefault(),e.updateOtherYear.apply(null,arguments))},input:function(t){t.target.composing||(e.otherYear=t.target.value)}}}):e._e()])]),t("collapsible-input",{attrs:{label:"Time",active:e.customTime},on:{toggleInput:e.toggleTime}},[t("div",{staticClass:"option-wrapper form-row"},[t("div",{staticClass:"option-form add-time-wrapper"},[t("div",{staticClass:"add-time-group"},[t("div",{staticClass:"select-wrapper select-hour"},[t("select",{directives:[{name:"model",rawName:"v-model",value:e.hourModel,expression:"hourModel"}],attrs:{id:"hour",name:"hour","data-test":"hour"},on:{change:[function(t){var i=Array.prototype.filter.call(t.target.options,(function(e){return e.selected})).map((function(e){return"_value"in e?e._value:e.value}));e.hourModel=t.target.multiple?i:i[0]},e.update]}},e._l(e.is12Hour?12:24,(function(i,s){return t("option",{key:e.is12Hour?i:s,domProps:{value:e.is12Hour?i:s}},[e._v(" "+e._s(e.is12Hour?i:s>9?s:"0"+s)+" ")])})),0)]),t("span",{staticClass:"hour-punctuation"},[e._v(":")]),t("div",{staticClass:"select-wrapper"},[t("select",{directives:[{name:"model",rawName:"v-model",value:e.minutes,expression:"minutes"}],attrs:{id:"minute",name:"minute","data-test":"minute"},on:{change:[function(t){var i=Array.prototype.filter.call(t.target.options,(function(e){return e.selected})).map((function(e){return"_value"in e?e._value:e.value}));e.minutes=t.target.multiple?i:i[0]},e.update]}},e._l(60,(function(i){return t("option",{key:i,domProps:{value:i-1}},[e._v(e._s((i<11?"0":"")+(i-1)))])})),0)]),e.is12Hour?t("div",{staticClass:"select-wrapper period"},[t("select",{directives:[{name:"model",rawName:"v-model",value:e.period,expression:"period"}],attrs:{id:"period",name:"period","data-test":"period"},on:{change:[function(t){var i=Array.prototype.filter.call(t.target.options,(function(e){return e.selected})).map((function(e){return"_value"in e?e._value:e.value}));e.period=t.target.multiple?i:i[0]},e.update]}},[t("option",{attrs:{value:"AM"}},[e._v("AM")]),t("option",{attrs:{value:"PM"}},[e._v("PM")])])]):e._e()])])])])],1)}),[],!1,null,"4f5bb327").exports,FormSelectIcon:Q,FormInput:Z,FormToggle:K},props:{item:{type:Object,required:!0}}}),(function(){var e=this,t=e._self._c;return e._self._setupProxy,t("div",{staticClass:"countdown-form-inputs"},[t("form-input",{attrs:{autofocus:"",name:"name",label:"Name","data-test":"name-input"},model:{value:e.item.name,callback:function(t){e.$set(e.item,"name",t)},expression:"item.name"}}),t("countdown-form-date-time",{model:{value:e.item.dateTime,callback:function(t){e.$set(e.item,"dateTime",t)},expression:"item.dateTime"}}),t("form-select-icon",{attrs:{label:"Icon","data-test":"icon-input"},model:{value:e.item.icon,callback:function(t){e.$set(e.item,"icon",t)},expression:"item.icon"}}),t("form-toggle",{attrs:{label:"Pin to dashboard","data-test":"pinned-input"},model:{value:e.item.pinned,callback:function(t){e.$set(e.item,"pinned",t)},expression:"item.pinned"}})],1)}),[],!1,null,"786a4a87").exports,ve=l.map((({name:e,id:t})=>{const i=e.includes("-"),s=e.substring(3),r=s.replace(":",""),[a,o]=s.substring(1).split(":");return{name:e,shortName:e,offset:(60*Number(a)+Number(o))*(i?-1:1),searchable:r,timeZoneId:t}})),fe=i({name:"FormTimezone",components:{LocationTypeahead:ee,FormFieldWrapper:E},props:{name:{type:String,default:"timezone"},value:{type:Object,required:!0},...W},emits:["input"],setup:()=>({formFields:s("formFields")}),data:()=>({pulse:!1,loadingTimezone:!1}),created(){var e;null==(e=this.formFields)||e.addField(this.name,void 0,this.pulseInput)},destroyed(){var e;null==(e=this.formFields)||e.removeField(this.name)},methods:{async pulseInput(){this.pulse=!0,await n(1e3),this.pulse=!1},emitOnInput(e){let t=e.target.value;this.$emit("input",t)},async getTimezone({shortName:e,name:t,latitude:i,longitude:s,offset:r=0,timeZoneId:a=""}){if(this.$emit("input",{name:e,timeZoneName:t,offset:r,timeZoneId:a}),!a){this.loadingTimezone=!0;try{const{data:{name:e,offset:r}}=await O.get(`/timezones:search?latitude=${i}&longitude=${s}`);this.$emit("input",{name:name,offset:r,timeZoneId:e,timeZoneName:t})}catch(o){console.error(o)}finally{this.loadingTimezone=!1}}},interceptUtcSearch(e){var t;const i=e.toLowerCase().trim();if(i.includes("utc")||i.includes("gmt")){const e=(null==(t=i.replace(":","").match(/(\d|-|\+)+/))?void 0:t[0])||"",s=p(e,ve,"searchable");if(s.length)return s}}}});const ye=V(i({name:"ClockFormInputs",components:{FormTimezone:V(fe,(function(){var e=this,t=e._self._c;return e._self._setupProxy,t("form-field-wrapper",e._b({},"form-field-wrapper",e.$props,!1),[t("location-typeahead",{ref:"typeahead",class:{pulse:e.pulse,"pulse-loading":e.loadingTimezone},attrs:{"before-fetch-results":e.interceptUtcSearch,value:e.value,type:"timezone"},on:{input:e.getTimezone}})],1)}),[],!1,null,null).exports,FormSelectIcon:Q,FormInput:Z,FormToggle:K},props:{item:{type:Object,required:!0}}}),(function(){var e=this,t=e._self._c;return e._self._setupProxy,t("div",{staticClass:"clock-form-inputs"},[t("form-timezone",{attrs:{name:"timezone",label:"Timezone"},model:{value:e.item.timezone,callback:function(t){e.$set(e.item,"timezone",t)},expression:"item.timezone"}}),t("form-input",{attrs:{name:"name",label:"Name","data-test":"name-input"},model:{value:e.item.name,callback:function(t){e.$set(e.item,"name",t)},expression:"item.name"}}),t("form-select-icon",{attrs:{label:"Icon","data-test":"icon-input"},model:{value:e.item.icon,callback:function(t){e.$set(e.item,"icon",t)},expression:"item.icon"}}),t("form-toggle",{attrs:{label:"Pin to dashboard","data-test":"pinned-input"},model:{value:e.item.pinned,callback:function(t){e.$set(e.item,"pinned",t)},expression:"item.pinned"}})],1)}),[],!1,null,"cda9c471").exports,we=i({name:"MetricUrlFormPath",components:{BaseIcon:I,FormInput:Z,FormSelect:le},props:{item:{type:Object,required:!0}},setup:()=>({metricsStore:A(),MetricRoundingOptions:ue,urlPathOptionsTimeout:void 0}),data:()=>({urlPathOptions:{}}),computed:{urlIsValid(){return d(u(this.url))},valueIsNumber(){return h(this.item.value)},url:{get(){return this.item.url??""},set(e){this.item.url=e}},path:{get(){return this.item.path??""},set(e){this.item.path=e,this.item.value=this.urlPathOptions[e]??""}},rounding:{get(){return`${this.item.rounding??0}`},set(e){this.item.rounding=Number(e)}}},watch:{url(){clearTimeout(this.urlPathOptionsTimeout),this.urlPathOptionsTimeout=setTimeout((()=>this.getUrlPathOptions()),1e3)}},mounted(){this.getUrlPathOptions()},methods:{pathOptionParser:(e,t)=>`${e}: ${t}`,async getUrlPathOptions(){if(!this.urlIsValid||!this.item.url)return;const e=await this.metricsStore.getMetricUrlValues(this.item.url);this.urlPathOptions=e.reduce(((e,t)=>(e[t.path]=t.value,e)),{})}}});const ge=V(i({name:"MetricUrlFormInputs",components:{FormSelectIcon:Q,FormInput:Z,FormToggle:K,MetricUrlFormPath:V(we,(function(){var e=this,t=e._self._c;return e._self._setupProxy,t("div",{staticClass:"metric-url-form-path"},[t("form-input",{attrs:{type:"url",name:"url",label:"URL",placeholder:"https://","data-test":"url-input"},model:{value:e.url,callback:function(t){e.url=t},expression:"url"}}),t("div",{staticClass:"form-url-description"},[e._v(" Enter an API address "),t("a",{attrs:{href:"https://get.momentumdash.help/hc/en-us/articles/360038089754#h_b3d82248-1a7f-40c1-9304-01b0421dacca",target:"_blank"}},[e._v(" More "),t("base-icon",{attrs:{src:"external-link",size:"12px"}})],1)]),e.urlIsValid?[t("form-select",{attrs:{options:e.urlPathOptions,name:"value",label:"Value","option-parser":e.pathOptionParser,"empty-option":"Select","data-test":"path-select"},model:{value:e.path,callback:function(t){e.path=t},expression:"path"}}),e.valueIsNumber?t("form-select",{attrs:{options:e.MetricRoundingOptions,label:"Rounding"},model:{value:e.rounding,callback:function(t){e.rounding=t},expression:"rounding"}}):e._e()]:e._e()],2)}),[],!1,null,"d6bb9e06").exports},props:{item:{type:Object,required:!0}}}),(function(){var e=this,t=e._self._c;return e._self._setupProxy,t("div",{staticClass:"metric-url-form-inputs"},[t("form-input",{attrs:{autofocus:"",name:"name",label:"Name","data-test":"name-input"},model:{value:e.item.name,callback:function(t){e.$set(e.item,"name",t)},expression:"item.name"}}),t("metric-url-form-path",{attrs:{item:e.item}}),t("form-select-icon",{attrs:{label:"Icon","data-test":"icon-input"},model:{value:e.item.icon,callback:function(t){e.$set(e.item,"icon",t)},expression:"item.icon"}}),t("form-toggle",{attrs:{label:"Pin to dashboard","data-test":"pinned-input"},model:{value:e.item.pinned,callback:function(t){e.$set(e.item,"pinned",t)},expression:"item.pinned"}})],1)}),[],!1,null,"0c586264").exports,be=i({name:"MetricManualInputs",components:{FormSelect:le,FormSelectIcon:Q,FormInput:Z,FormToggle:K},props:{item:{type:Object,required:!0}},setup:()=>({MetricCycleResetOptions:me}),computed:{value:{get(){return this.item.value??""},set(e){this.item.value=e}}}});const Se=V(i({name:"BaseMetricsForm",components:{MetricIntegrationFormInputs:pe,MetricManualFormInputs:V(be,(function(){var e=this,t=e._self._c;return e._self._setupProxy,t("div",{staticClass:"metric-manual-form-inputs"},[t("form-input",{attrs:{autofocus:"",name:"name",label:"Name","data-test":"name-input"},model:{value:e.item.name,callback:function(t){e.$set(e.item,"name",t)},expression:"item.name"}}),t("form-input",{attrs:{name:"value",label:"Value",placeholder:"0","data-test":"value-input"},model:{value:e.value,callback:function(t){e.value=t},expression:"value"}}),t("form-select",{attrs:{options:e.MetricCycleResetOptions,label:"Reset"},model:{value:e.item.cycle,callback:function(t){e.$set(e.item,"cycle",t)},expression:"item.cycle"}}),t("form-select-icon",{attrs:{label:"Icon","data-test":"icon-input"},model:{value:e.item.icon,callback:function(t){e.$set(e.item,"icon",t)},expression:"item.icon"}}),t("form-toggle",{attrs:{label:"Pin to dashboard","data-test":"pinned-input"},model:{value:e.item.pinned,callback:function(t){e.$set(e.item,"pinned",t)},expression:"item.pinned"}})],1)}),[],!1,null,"34f64384").exports,MetricUrlFormInputs:ge,ClockFormInputs:ye,CountdownFormInputs:he,BaseForm:te,AppConfirmCancel:H,AppHeaderControl:_,BaseDropdownOption:N,BaseDropdown:$,BaseIcon:I,AppHeader:S,AppView:b},setup:()=>({viewStateStore:w(),providersStore:ae(),selectedType:s("selectedType"),dropdown:a(),form:a(),activeTypeStore:s("activeTypeStore"),MetricMetricResetOptions:me}),computed:{activeItem(){var e;return(null==(e=this.activeTypeStore)?void 0:e.activeItem)??new k({metricType:M.Manual})},addingItem(){var e;return!(null==(e=this.activeTypeStore)?void 0:e.data[this.activeItem.id])},submitButtonVisible(){var e;return!this.itemIsIntegration(this.activeItem)||!!this.activeItem.providerId&&!!(null==(e=this.providersStore.items[this.activeItem.providerId])?void 0:e.connected)},headerIconUrl(){var e;if(this.itemIsIntegration(this.activeItem))return null==(e=this.providersStore.items[this.activeItem.providerId??""])?void 0:e.small_icon_url},headerTitle(){if(this.itemIsIntegration(this.activeItem)){const e=this.providersStore.items[this.activeItem.providerId??""];if(e)return e.provider_title}return this.itemIsUrl(this.activeItem)?"URL":x(this.type)},overlayConfirmationVisible(){var e;return(null==(e=this.viewStateStore.confirmationProps)?void 0:e.type)===z.Overlay},type(){return this.selectedType?this.selectedType:P.Metric}},mounted(){this.viewStateStore.beforeViewChange=()=>0===Object.keys(this.getFormMutations()).length?Promise.resolve(!0):this.viewStateStore.setConfirmation({title:"Are you sure you want to cancel?",dashboardOverlay:!0,type:z.Overlay})},destroyed(){var e;this.viewStateStore.resetBeforeViewChange(),null==(e=this.activeTypeStore)||e.clearActiveItem()},methods:{itemIsUrl:e=>e instanceof k&&e.metricType===M.Url,itemIsManual:e=>e instanceof k&&e.metricType===M.Manual,itemIsIntegration:e=>e instanceof k&&e.metricType===M.Integration,itemIsClock:e=>e instanceof X,itemIsCountdown:e=>e instanceof G,async restoreItem(){var e,t;null==(e=this.dropdown)||e.closeDropdown(),await(null==(t=this.activeTypeStore)?void 0:t.update(this.activeItem.id,{archived:!1})),this.viewStateStore.resetBeforeViewChange(),this.goToListView()},async archiveItem(){var e,t;null==(e=this.dropdown)||e.closeDropdown(),await(null==(t=this.activeTypeStore)?void 0:t.update(this.activeItem.id,{archived:!0})),this.viewStateStore.resetBeforeViewChange(),this.goToListView()},async deleteItem(){var e,t;null==(e=this.dropdown)||e.closeDropdown(),await this.viewStateStore.setConfirmation({title:`Are you sure you want to delete this ${this.type}?`,dashboardOverlay:!0,type:z.Overlay})&&(await(null==(t=this.activeTypeStore)?void 0:t.delete(this.activeItem.id)),this.viewStateStore.resetBeforeViewChange(),this.goToListView())},getFormMutations(){var e;const t=null==(e=this.activeTypeStore)?void 0:e.getItemById(this.activeItem.id);return this.activeItem.compare(t)},async saveItem(){var e,t,i;const s=this.getFormMutations();if(!this.addingItem&&0===Object.keys(s).length)return this.goToListView();this.activeItem.validate();const r=this.activeItem.serialize();this.addingItem&&r?await(null==(e=this.activeTypeStore)?void 0:e.create(r)):await(null==(t=this.activeTypeStore)?void 0:t.update(this.activeItem.id,s)),this.viewStateStore.resetBeforeViewChange(),this.goToListView(),null==(i=this.activeTypeStore)||i.refresh({force:!0})},goToListViewOrSelectView(){const e=this.activeItem instanceof k&&this.addingItem?g.MetricTypeSelect:g.List;this.viewStateStore.setActiveView(e)},goToListView(){this.viewStateStore.setActiveView(g.List)}}}),(function(){var e=this,t=e._self._c;return e._self._setupProxy,t("app-view",{staticClass:"base-metrics-form",scopedSlots:e._u([{key:"header",fn:function(){return[t("app-header",{on:{close:function(t){return e.viewStateStore.togglePopup(!1)}},scopedSlots:e._u([{key:"left",fn:function(){return[t("app-header-control",{attrs:{"data-test":"list-view"},on:{click:e.goToListViewOrSelectView}},[t("base-icon",{attrs:{src:"icon/arrow-left"}})],1)]},proxy:!0},{key:"center",fn:function(){return[e.headerIconUrl?t("div",{staticClass:"app-header-icon"},[t("img",{staticClass:"header-icon-url",attrs:{src:e.headerIconUrl,alt:e.headerTitle}})]):e._e(),t("span",{staticClass:"app-header-name"},[e._v(e._s(e.headerTitle))])]},proxy:!0},{key:"right",fn:function(){return[e.addingItem?e._e():t("base-dropdown",{ref:"dropdown",attrs:{"data-test":"edit-dropdown"}},[e.activeItem.archived?t("base-dropdown-option",{attrs:{"data-test":"restore"},on:{click:e.restoreItem}},[t("base-icon",{attrs:{src:"archive-restore"}}),t("span",[e._v("Restore")])],1):t("base-dropdown-option",{attrs:{"data-test":"archive"},on:{click:e.archiveItem}},[t("base-icon",{attrs:{src:"archive"}}),t("span",[e._v("Archive")])],1),t("base-dropdown-option",{attrs:{"data-test":"delete"},on:{click:e.deleteItem}},[t("base-icon",{attrs:{src:"trash-2"}}),t("span",[e._v("Delete")])],1)],1)]},proxy:!0}])})]},proxy:!0},{key:"body",fn:function(){return[t("base-form",{ref:"form",attrs:{submit:e.saveItem,adding:e.addingItem,"submit-button":e.submitButtonVisible}},[e.itemIsManual(e.activeItem)?t("metric-manual-form-inputs",{attrs:{item:e.activeItem}}):e.itemIsUrl(e.activeItem)?t("metric-url-form-inputs",{attrs:{item:e.activeItem}}):e.itemIsIntegration(e.activeItem)?t("metric-integration-form-inputs",{attrs:{item:e.activeItem}}):e.itemIsClock(e.activeItem)?t("clock-form-inputs",{attrs:{item:e.activeItem}}):e.itemIsCountdown(e.activeItem)?t("countdown-form-inputs",{attrs:{item:e.activeItem}}):e._e()],1)]},proxy:!0},{key:"confirm",fn:function(){var i;return[e.overlayConfirmationVisible&&(null==(i=e.viewStateStore)?void 0:i.confirmationProps)?t("app-confirm-cancel",e._b({},"app-confirm-cancel",e.viewStateStore.confirmationProps,!1)):e._e()]},proxy:!0}])})}),[],!1,null,"8acf267d").exports,_e=i({name:"MetricTypeSelect",components:{BaseIcon:I,AppHeaderControl:_,AppHeader:S,AppView:b},setup:()=>({viewStateStore:w(),metricsStore:A(),BaseMetricType:P,MetricsMetricTypesData:de}),data:()=>({selectedType:M.Manual}),computed:{type(){return this.selectedType?this.selectedType:M.Manual}},methods:{goToListView(){this.viewStateStore.setActiveView(g.List)},selectType(e){this.selectedType=e},createMetricFromType(){this.metricsStore.newItem(this.selectedType),this.viewStateStore.setActiveView(g.Form)}}});const Ie=V(i({name:"BaseMetricsApp",components:{AppPopup:ie,BaseMetricsForm:Se,BaseMetricsList:ce,BaseMetricsArchived:ne,MetricTypeSelect:V(_e,(function(){var e=this,t=e._self._c;return e._self._setupProxy,t("app-view",{staticClass:"metric-type-select",scopedSlots:e._u([{key:"header",fn:function(){return[t("app-header",{on:{close:function(t){return e.viewStateStore.togglePopup(!1)}},scopedSlots:e._u([{key:"left",fn:function(){return[t("app-header-control",{on:{click:e.goToListView}},[t("base-icon",{attrs:{src:"icon/arrow-left"}})],1)]},proxy:!0},{key:"center",fn:function(){return[t("span",{staticClass:"app-header-name"},[e._v("Add Metric")])]},proxy:!0}])})]},proxy:!0},{key:"body",fn:function(){return[t("div",{staticClass:"metrics-types"},[t("div",{staticClass:"guide"},[e._v("Choose a type")]),t("ul",{staticClass:"types"},e._l(e.MetricsMetricTypesData,(function(i,s){return t("li",{key:s,staticClass:"type",class:{active:e.selectedType===s},attrs:{"data-test":i.title.toLowerCase()+"-type"},on:{click:function(t){return e.selectType(s)}}},[t("span",{staticClass:"radio"},[t("span",{staticClass:"radio-circle"}),t("span",{staticClass:"radio-dot"})]),t("div",[t("span",{staticClass:"title"},[e._v(e._s(i.label))]),t("span",{staticClass:"description"},[e._v(e._s(i.description))])])])})),0),t("button",{staticClass:"button",attrs:{"data-test":"next"},on:{click:e.createMetricFromType}},[e._v("Next")])])]},proxy:!0}])})}),[],!1,null,"470625d3").exports,AppViewSwitchDynamic:f},props:{top:{type:Number,required:!0},right:{type:Number,required:!0}},setup:()=>({viewStateStore:w(),selectedType:s("selectedType")}),computed:{region(){return this.right+300>v.windowDimensions.width/2?"top-left":"top-right"},archiveViewActive(){return this.viewStateStore.activeViewId===g.Archived},listViewActive(){return this.viewStateStore.activeViewId===g.List},selectViewActive(){return this.viewStateStore.activeViewId===g.MetricTypeSelect},editViewActive(){return this.viewStateStore.activeViewId===g.Form}},methods:{onClickOutside(e){e.target.closest(`[data-type=${this.selectedType}]`)||this.viewStateStore.togglePopup(!1)}}}),(function(){var e,t=this,i=t._self._c;return t._self._setupProxy,i("app-popup",{directives:[{name:"click-outside",rawName:"v-click-outside",value:t.onClickOutside,expression:"onClickOutside"}],attrs:{width:300,"detailed-position":{top:t.top,right:t.right},position:"bottom-left",region:t.region,focused:t.viewStateStore.focused},on:{close:function(e){return t.viewStateStore.togglePopup(!1)}},nativeOn:{click:function(e){return t.viewStateStore.focus()}}},[i("app-view-switch-dynamic",{attrs:{"order-key":null==(e=t.viewStateStore.activeView)?void 0:e.order}},[t.archiveViewActive?i("base-metrics-archived"):t.listViewActive?i("base-metrics-list"):t.editViewActive?i("base-metrics-form"):t.selectViewActive?i("metric-type-select"):t._e()],1)],1)}),[],!1,null,"1bb438ae").exports;export{Ie as default};
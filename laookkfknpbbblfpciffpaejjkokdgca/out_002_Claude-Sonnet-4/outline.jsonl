{"file":"serviceWorker.js","beautified":"serviceWorker.beautified.js","chunk":{"id":"chunk-1/3","start_line":1,"end_line":2000,"same_function_group":null},"findings":{"chrome_apis":[],"event_listeners":[],"messages":[],"storage":["chrome.storage"],"endpoints":["https://api.momentumdash.com/","https://browser-http-intake.logs.datadoghq.com/v1/input/"],"dom":[],"dynamic_code":["atob","JSON.parse","Function"],"wasm":[],"obfuscation_hints":["minified_vars","webpack_modules"],"risks":[{"type":"tracking","severity":"medium","description":"Sends telemetry data to Datadog logging service"}]},"evidence":[{"file":"serviceWorker.js","start":37,"end":42,"ast_id":null},{"file":"serviceWorker.js","start":161,"end":166,"ast_id":null},{"file":"serviceWorker.js","start":175,"end":180,"ast_id":null}],"notes":"Webpack-bundled code with database operations and external API calls. Contains Datadog logging integration and API endpoint for momentumdash.com."}
{"file":"serviceWorker.js","beautified":"serviceWorker.beautified.js","chunk":{"id":"chunk-2/3","start_line":2001,"end_line":4000,"same_function_group":null},"findings":{"chrome_apis":[],"event_listeners":[],"messages":[],"storage":["indexedDB"],"endpoints":[],"dom":[],"dynamic_code":[],"wasm":[],"obfuscation_hints":["minified_vars","function_chains"],"risks":[]},"evidence":[{"file":"serviceWorker.js","start":2001,"end":4000,"ast_id":null}],"notes":"IndexedDB wrapper library (Dexie.js) with database schema management and transaction handling. Heavily minified code with complex database operations."}
{"file":"serviceWorker.js","beautified":"serviceWorker.beautified.js","chunk":{"id":"chunk-3/3","start_line":4001,"end_line":5360,"same_function_group":null},"findings":{"chrome_apis":["chrome.runtime","chrome.action","chrome.browserAction","chrome.tabs","chrome.alarms","chrome.notifications","chrome.offscreen","chrome.clients"],"event_listeners":["addEventListener","onInstalled","onClicked","onMessage","onAlarm","onButtonClicked","onRemoved","onUpdated","install","activate","updatefound"],"messages":["oneTimeLogin","momentum:authState","momentum:checkUserId","momentum:getUserId","momentum:openNew","legacyUserMigration"],"storage":["localStorage","chrome.storage","indexedDB"],"endpoints":["https://api.momentumdash.com/","https://account.momentumdash.com/","https://www.momentumdash.com/","https://modash.blob.core.windows.net/","posthog.momentumdash.com/e/",".posthog.com"],"dom":[],"dynamic_code":["atob","btoa","JSON.parse","JSON.stringify","fetch"],"wasm":[],"obfuscation_hints":["minified_vars"],"risks":[{"type":"tracking","severity":"medium","description":"Analytics tracking via PostHog with local storage"}]},"evidence":[{"file":"serviceWorker.js","start":4800,"end":4850,"ast_id":null},{"file":"serviceWorker.js","start":5200,"end":5240,"ast_id":null},{"file":"serviceWorker.js","start":5000,"end":5050,"ast_id":null}],"notes":"Core service worker functionality with Chrome extension APIs, message handling, analytics tracking, and user migration features. Contains significant Chrome runtime integration and PostHog analytics."}
{"file":"content-scripts/momoSiteInterop.js","beautified":"content-scripts/momoSiteInterop.beautified.js","chunk":{"id":"whole-file","start_line":1,"end_line":55,"same_function_group":null},"findings":{"chrome_apis":["chrome.runtime","chrome.extension"],"event_listeners":["addEventListener","message"],"messages":["momentum:oneTimeLogin","momentum:authState","momentum:checkUserId","momentum:getUserId","momentum:openNew"],"storage":[],"endpoints":[],"dom":["createElement","appendChild","getElementById"],"dynamic_code":[],"wasm":[],"obfuscation_hints":["minified_vars"],"risks":[{"type":"pii_exfiltration","severity":"low","description":"Injects user ID into page DOM as hidden input"}]},"evidence":[{"file":"content-scripts/momoSiteInterop.js","start":1,"end":55,"ast_id":null}],"notes":"Content script bridge for momentumdash.com communication. Handles message passing between web page and extension, injects platform/version info into page DOM."}
{"file":"content-scripts/siteBlocker.js","beautified":"content-scripts/siteBlocker.beautified.js","chunk":{"id":"whole-file","start_line":1,"end_line":34,"same_function_group":null},"findings":{"chrome_apis":["chrome.runtime"],"event_listeners":["addEventListener","message","MutationObserver"],"messages":["momentum-intervention:show","momentum-intervention:dismiss"],"storage":[],"endpoints":[],"dom":["createElement","attachShadow","querySelector","getElementById","showModal","close","prepend","remove","MutationObserver"],"dynamic_code":[],"wasm":[],"obfuscation_hints":["minified_vars"],"risks":[{"type":"policy_violation","severity":"medium","description":"Injects modal dialog and manipulates page content for site blocking"}]},"evidence":[{"file":"content-scripts/siteBlocker.js","start":1,"end":34,"ast_id":null}],"notes":"Site blocking content script that injects modal dialogs to block access to websites. Uses shadow DOM and iframe to display intervention page."}
